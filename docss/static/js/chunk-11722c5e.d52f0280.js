(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-11722c5e","chunk-41f6b9dd"],{"00fd":function(e,t,n){var r=n("9e69"),i=Object.prototype,o=i.hasOwnProperty,a=i.toString,s=r?r.toStringTag:void 0;function l(e){var t=o.call(e,s),n=e[s];try{e[s]=void 0;var r=!0}catch(l){}var i=a.call(e);return r&&(t?e[s]=n:delete e[s]),i}e.exports=l},"0676":function(e,t){function n(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}e.exports=n,e.exports.__esModule=!0,e.exports["default"]=e.exports},"0a4f":function(e,t,n){var r=n("3eba"),i=n("f934");n("365b"),n("c03d7");var o=n("793f");if(!o.isSupported)throw new Error("Sorry your browser not support wordCloud");function a(e){for(var t=e.getContext("2d"),n=t.getImageData(0,0,e.width,e.height),r=t.createImageData(n),i=0,o=0,a=0;a<n.data.length;a+=4){var s=n.data[a+3];if(s>128){var l=n.data[a]+n.data[a+1]+n.data[a+2];i+=l,++o}}var u=i/o;for(a=0;a<n.data.length;a+=4){l=n.data[a]+n.data[a+1]+n.data[a+2],s=n.data[a+3];s<128||l>u?(r.data[a]=0,r.data[a+1]=0,r.data[a+2]=0,r.data[a+3]=0):(r.data[a]=255,r.data[a+1]=255,r.data[a+2]=255,r.data[a+3]=255)}t.putImageData(r,0,0)}r.registerLayout((function(e,t){e.eachSeriesByType("wordCloud",(function(n){var s=i.getLayoutRect(n.getBoxLayoutParams(),{width:t.getWidth(),height:t.getHeight()}),l=n.getData(),u=document.createElement("canvas");u.width=s.width,u.height=s.height;var c=u.getContext("2d"),d=n.get("maskImage");if(d)try{c.drawImage(d,0,0,u.width,u.height),a(u)}catch(y){console.error("Invalid mask image"),console.error(y.toString())}var f=n.get("sizeRange"),h=n.get("rotationRange"),p=l.getDataExtent("value"),m=Math.PI/180,v=n.get("gridSize");function g(e){var t=e.detail.item;e.detail.drawn&&n.layoutInstance.ondraw&&(e.detail.drawn.gx+=s.x/v,e.detail.drawn.gy+=s.y/v,n.layoutInstance.ondraw(t[0],t[1],t[2],e.detail.drawn))}o(u,{list:l.mapArray("value",(function(e,t){var n=l.getItemModel(t);return[l.getName(t),n.get("textStyle.normal.textSize",!0)||r.number.linearMap(e,p,f),t]})).sort((function(e,t){return t[1]-e[1]})),fontFamily:n.get("textStyle.normal.fontFamily")||n.get("textStyle.emphasis.fontFamily")||e.get("textStyle.fontFamily"),fontWeight:n.get("textStyle.normal.fontWeight")||n.get("textStyle.emphasis.fontWeight")||e.get("textStyle.fontWeight"),gridSize:v,ellipticity:s.height/s.width,minRotation:h[0]*m,maxRotation:h[1]*m,clearCanvas:!d,rotateRatio:1,rotationStep:n.get("rotationStep")*m,drawOutOfBound:n.get("drawOutOfBound"),shuffle:!1,shape:n.get("shape")}),u.addEventListener("wordclouddrawn",g),n.layoutInstance&&n.layoutInstance.dispose(),n.layoutInstance={ondraw:null,dispose:function(){u.removeEventListener("wordclouddrawn",g),u.addEventListener("wordclouddrawn",(function(e){e.preventDefault()}))}}}))})),r.registerPreprocessor((function(e){var t=(e||{}).series;!r.util.isArray(t)&&(t=t?[t]:[]);var n=["shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY"];function i(e){e&&r.util.each(n,(function(t){e.hasOwnProperty(t)&&(e["text"+r.format.capitalFirst(t)]=e[t])}))}r.util.each(t,(function(e){if(e&&"wordCloud"===e.type){var t=e.textStyle||{};i(t.normal),i(t.emphasis)}}))}))},"0d6d":function(e,t,n){var r=n("d3f4"),i=n("67ab").onFreeze;n("5eda")("freeze",(function(e){return function(t){return e&&r(t)?e(i(t)):t}}))},"11b0":function(e,t){function n(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}e.exports=n,e.exports.__esModule=!0,e.exports["default"]=e.exports},1310:function(e,t){function n(e){return null!=e&&"object"==typeof e}e.exports=n},"14b9":function(e,t,n){var r=n("5ca1");r(r.P,"String",{repeat:n("9744")})},"1a8c":function(e,t){function n(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}e.exports=n},"1d92":function(e,t,n){var r=n("e0ef");function i(e){return r(2,e)}e.exports=i},2236:function(e,t,n){var r=n("5a43");function i(e){if(Array.isArray(e))return r(e)}e.exports=i,e.exports.__esModule=!0,e.exports["default"]=e.exports},2655:function(e,t){function n(e){return!!e&&("object"===typeof e||"function"===typeof e)&&"function"===typeof e.then}e.exports=n,e.exports.default=n},"278c":function(e,t,n){var r=n("c135"),i=n("9b42"),o=n("6613"),a=n("c240");function s(e,t){return r(e)||i(e,t)||o(e,t)||a()}e.exports=s,e.exports.__esModule=!0,e.exports["default"]=e.exports},"29f3":function(e,t){var n=Object.prototype,r=n.toString;function i(e){return r.call(e)}e.exports=i},"2b3e":function(e,t,n){var r=n("585a"),i="object"==typeof self&&self&&self.Object===Object&&self,o=r||i||Function("return this")();e.exports=o},"2e39":function(e,t,n){"use strict";function r(e,t){var n=t.length,r=e.length;if(r>n)return!1;if(r===n)return e===t;e:for(var i=0,o=0;i<r;i++){var a=e.charCodeAt(i);while(o<n)if(t.charCodeAt(o++)===a)continue e;return!1}return!0}e.exports=r},"2f21":function(e,t,n){"use strict";var r=n("79e5");e.exports=function(e,t){return!!e&&r((function(){t?e.call(null,(function(){}),1):e.call(null)}))}},"365b":function(e,t,n){var r=n("862d"),i=n("3eba");i.extendSeriesModel({type:"series.wordCloud",visualColorAccessPath:"textStyle.normal.color",optionUpdated:function(){var e=this.option;e.gridSize=Math.max(Math.floor(e.gridSize),4)},getInitialData:function(e,t){var n=r(["value"],e.data),o=new i.List(n,this);return o.initData(e.data),o},defaultOption:{maskImage:null,shape:"circle",left:"center",top:"center",width:"70%",height:"80%",sizeRange:[12,60],rotationRange:[-90,90],rotationStep:45,gridSize:8,drawOutOfBound:!1,textStyle:{normal:{fontWeight:"normal"}}}})},"36bd":function(e,t,n){"use strict";var r=n("4bf8"),i=n("77f1"),o=n("9def");e.exports=function(e){var t=r(this),n=o(t.length),a=arguments.length,s=i(a>1?arguments[1]:void 0,n),l=a>2?arguments[2]:void 0,u=void 0===l?n:i(l,n);while(u>s)t[s++]=e;return t}},3729:function(e,t,n){var r=n("9e69"),i=n("00fd"),o=n("29f3"),a="[object Null]",s="[object Undefined]",l=r?r.toStringTag:void 0;function u(e){return null==e?void 0===e?s:a:l&&l in Object(e)?i(e):o(e)}e.exports=u},"386b":function(e,t,n){var r=n("5ca1"),i=n("79e5"),o=n("be13"),a=/"/g,s=function(e,t,n,r){var i=String(o(e)),s="<"+t;return""!==n&&(s+=" "+n+'="'+String(r).replace(a,"&quot;")+'"'),s+">"+i+"</"+t+">"};e.exports=function(e,t){var n={};n[e]=t(s),r(r.P+r.F*i((function(){var t=""[e]('"');return t!==t.toLowerCase()||t.split('"').length>3})),"String",n)}},"408c":function(e,t,n){var r=n("2b3e"),i=function(){return r.Date.now()};e.exports=i},4127:function(e,t,n){"use strict";var r=n("d233"),i=n("b313"),o=Object.prototype.hasOwnProperty,a={brackets:function(e){return e+"[]"},comma:"comma",indices:function(e,t){return e+"["+t+"]"},repeat:function(e){return e}},s=Array.isArray,l=Array.prototype.push,u=function(e,t){l.apply(e,s(t)?t:[t])},c=Date.prototype.toISOString,d=i["default"],f={addQueryPrefix:!1,allowDots:!1,charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encoder:r.encode,encodeValuesOnly:!1,format:d,formatter:i.formatters[d],indices:!1,serializeDate:function(e){return c.call(e)},skipNulls:!1,strictNullHandling:!1},h=function(e){return"string"===typeof e||"number"===typeof e||"boolean"===typeof e||"symbol"===typeof e||"bigint"===typeof e},p=function e(t,n,i,o,a,l,c,d,p,m,v,g,y){var _=t;if("function"===typeof c?_=c(n,_):_ instanceof Date?_=m(_):"comma"===i&&s(_)&&(_=_.join(",")),null===_){if(o)return l&&!g?l(n,f.encoder,y,"key"):n;_=""}if(h(_)||r.isBuffer(_)){if(l){var x=g?n:l(n,f.encoder,y,"key");return[v(x)+"="+v(l(_,f.encoder,y,"value"))]}return[v(n)+"="+v(String(_))]}var b,w=[];if("undefined"===typeof _)return w;if(s(c))b=c;else{var A=Object.keys(_);b=d?A.sort(d):A}for(var T=0;T<b.length;++T){var S=b[T];a&&null===_[S]||(s(_)?u(w,e(_[S],"function"===typeof i?i(n,S):n,i,o,a,l,c,d,p,m,v,g,y)):u(w,e(_[S],n+(p?"."+S:"["+S+"]"),i,o,a,l,c,d,p,m,v,g,y)))}return w},m=function(e){if(!e)return f;if(null!==e.encoder&&void 0!==e.encoder&&"function"!==typeof e.encoder)throw new TypeError("Encoder has to be a function.");var t=e.charset||f.charset;if("undefined"!==typeof e.charset&&"utf-8"!==e.charset&&"iso-8859-1"!==e.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var n=i["default"];if("undefined"!==typeof e.format){if(!o.call(i.formatters,e.format))throw new TypeError("Unknown format option provided.");n=e.format}var r=i.formatters[n],a=f.filter;return("function"===typeof e.filter||s(e.filter))&&(a=e.filter),{addQueryPrefix:"boolean"===typeof e.addQueryPrefix?e.addQueryPrefix:f.addQueryPrefix,allowDots:"undefined"===typeof e.allowDots?f.allowDots:!!e.allowDots,charset:t,charsetSentinel:"boolean"===typeof e.charsetSentinel?e.charsetSentinel:f.charsetSentinel,delimiter:"undefined"===typeof e.delimiter?f.delimiter:e.delimiter,encode:"boolean"===typeof e.encode?e.encode:f.encode,encoder:"function"===typeof e.encoder?e.encoder:f.encoder,encodeValuesOnly:"boolean"===typeof e.encodeValuesOnly?e.encodeValuesOnly:f.encodeValuesOnly,filter:a,formatter:r,serializeDate:"function"===typeof e.serializeDate?e.serializeDate:f.serializeDate,skipNulls:"boolean"===typeof e.skipNulls?e.skipNulls:f.skipNulls,sort:"function"===typeof e.sort?e.sort:null,strictNullHandling:"boolean"===typeof e.strictNullHandling?e.strictNullHandling:f.strictNullHandling}};e.exports=function(e,t){var n,r,i=e,o=m(t);"function"===typeof o.filter?(r=o.filter,i=r("",i)):s(o.filter)&&(r=o.filter,n=r);var l,c=[];if("object"!==typeof i||null===i)return"";l=t&&t.arrayFormat in a?t.arrayFormat:t&&"indices"in t?t.indices?"indices":"repeat":"indices";var d=a[l];n||(n=Object.keys(i)),o.sort&&n.sort(o.sort);for(var f=0;f<n.length;++f){var h=n[f];o.skipNulls&&null===i[h]||u(c,p(i[h],h,d,o.strictNullHandling,o.skipNulls,o.encode?o.encoder:null,o.filter,o.sort,o.allowDots,o.serializeDate,o.formatter,o.encodeValuesOnly,o.charset))}var v=c.join(o.delimiter),g=!0===o.addQueryPrefix?"?":"";return o.charsetSentinel&&("iso-8859-1"===o.charset?g+="utf8=%26%2310003%3B&":g+="utf8=%E2%9C%93&"),v.length>0?g+v:""}},4328:function(e,t,n){"use strict";var r=n("4127"),i=n("9e6a"),o=n("b313");e.exports={formats:o,parse:i,stringify:r}},4416:function(e,t){function n(e){var t=null==e?0:e.length;return t?e[t-1]:void 0}e.exports=n},"448a":function(e,t,n){var r=n("2236"),i=n("11b0"),o=n("6613"),a=n("0676");function s(e){return r(e)||i(e)||o(e)||a()}e.exports=s,e.exports.__esModule=!0,e.exports["default"]=e.exports},"4b17":function(e,t,n){var r=n("6428");function i(e){var t=r(e),n=t%1;return t===t?n?t-n:t:0}e.exports=i},"4ba6":function(e,t,n){(function(e){e(n("56b3"))})((function(e){"use strict";function t(e,t,n,r,i,o){this.indented=e,this.column=t,this.type=n,this.info=r,this.align=i,this.prev=o}function n(e,n,r,i){var o=e.indented;return e.context&&"statement"==e.context.type&&"statement"!=r&&(o=e.context.indented),e.context=new t(o,n,r,i,null,e.context)}function r(e){var t=e.context.type;return")"!=t&&"]"!=t&&"}"!=t||(e.indented=e.context.indented),e.context=e.context.prev}function i(e,t,n){return"variable"==t.prevToken||"type"==t.prevToken||(!!/\S(?:[^- ]>|[*\]])\s*$|\*$/.test(e.string.slice(0,n))||(!(!t.typeAtEndOfLine||e.column()!=e.indentation())||void 0))}function o(e){for(;;){if(!e||"top"==e.type)return!0;if("}"==e.type&&"namespace"!=e.prev.info)return!1;e=e.prev}}function a(e){for(var t={},n=e.split(" "),r=0;r<n.length;++r)t[n[r]]=!0;return t}function s(e,t){return"function"===typeof e?e(t):e.propertyIsEnumerable(t)}e.defineMode("clike",(function(a,l){var u,c,d=a.indentUnit,f=l.statementIndentUnit||d,h=l.dontAlignCalls,p=l.keywords||{},m=l.types||{},v=l.builtin||{},g=l.blockKeywords||{},y=l.defKeywords||{},_=l.atoms||{},x=l.hooks||{},b=l.multiLineStrings,w=!1!==l.indentStatements,A=!1!==l.indentSwitch,T=l.namespaceSeparator,S=l.isPunctuationChar||/[\[\]{}\(\),;\:\.]/,E=l.numberStart||/[\d\.]/,C=l.number||/^(?:0x[a-f\d]+|0b[01]+|(?:\d+\.?\d*|\.\d+)(?:e[-+]?\d+)?)(u|ll?|l|f)?/i,M=l.isOperatorChar||/[+\-*&%=<>!?|\/]/,L=l.isIdentifierChar||/[\w\$_\xa1-\uffff]/,N=l.isReservedIdentifier||!1;function D(e,t){var n=e.next();if(x[n]){var r=x[n](e,t);if(!1!==r)return r}if('"'==n||"'"==n)return t.tokenize=O(n),t.tokenize(e,t);if(S.test(n))return u=n,null;if(E.test(n)){if(e.backUp(1),e.match(C))return"number";e.next()}if("/"==n){if(e.eat("*"))return t.tokenize=I,I(e,t);if(e.eat("/"))return e.skipToEnd(),"comment"}if(M.test(n)){while(!e.match(/^\/[\/*]/,!1)&&e.eat(M));return"operator"}if(e.eatWhile(L),T)while(e.match(T))e.eatWhile(L);var i=e.current();return s(p,i)?(s(g,i)&&(u="newstatement"),s(y,i)&&(c=!0),"keyword"):s(m,i)?"type":s(v,i)||N&&N(i)?(s(g,i)&&(u="newstatement"),"builtin"):s(_,i)?"atom":"variable"}function O(e){return function(t,n){var r,i=!1,o=!1;while(null!=(r=t.next())){if(r==e&&!i){o=!0;break}i=!i&&"\\"==r}return(o||!i&&!b)&&(n.tokenize=null),"string"}}function I(e,t){var n,r=!1;while(n=e.next()){if("/"==n&&r){t.tokenize=null;break}r="*"==n}return"comment"}function R(e,t){l.typeFirstDefinitions&&e.eol()&&o(t.context)&&(t.typeAtEndOfLine=i(e,t,e.pos))}return{startState:function(e){return{tokenize:null,context:new t((e||0)-d,0,"top",null,!1),indented:0,startOfLine:!0,prevToken:null}},token:function(e,t){var a=t.context;if(e.sol()&&(null==a.align&&(a.align=!1),t.indented=e.indentation(),t.startOfLine=!0),e.eatSpace())return R(e,t),null;u=c=null;var s=(t.tokenize||D)(e,t);if("comment"==s||"meta"==s)return s;if(null==a.align&&(a.align=!0),";"==u||":"==u||","==u&&e.match(/^\s*(?:\/\/.*)?$/,!1))while("statement"==t.context.type)r(t);else if("{"==u)n(t,e.column(),"}");else if("["==u)n(t,e.column(),"]");else if("("==u)n(t,e.column(),")");else if("}"==u){while("statement"==a.type)a=r(t);"}"==a.type&&(a=r(t));while("statement"==a.type)a=r(t)}else u==a.type?r(t):w&&(("}"==a.type||"top"==a.type)&&";"!=u||"statement"==a.type&&"newstatement"==u)&&n(t,e.column(),"statement",e.current());if("variable"==s&&("def"==t.prevToken||l.typeFirstDefinitions&&i(e,t,e.start)&&o(t.context)&&e.match(/^\s*\(/,!1))&&(s="def"),x.token){var d=x.token(e,t,s);void 0!==d&&(s=d)}return"def"==s&&!1===l.styleDefs&&(s="variable"),t.startOfLine=!1,t.prevToken=c?"def":s||u,R(e,t),s},indent:function(t,n){if(t.tokenize!=D&&null!=t.tokenize||t.typeAtEndOfLine)return e.Pass;var r=t.context,i=n&&n.charAt(0),o=i==r.type;if("statement"==r.type&&"}"==i&&(r=r.prev),l.dontIndentStatements)while("statement"==r.type&&l.dontIndentStatements.test(r.info))r=r.prev;if(x.indent){var a=x.indent(t,r,n,d);if("number"==typeof a)return a}var s=r.prev&&"switch"==r.prev.info;if(l.allmanIndentation&&/[{(]/.test(i)){while("top"!=r.type&&"}"!=r.type)r=r.prev;return r.indented}return"statement"==r.type?r.indented+("{"==i?0:f):!r.align||h&&")"==r.type?")"!=r.type||o?r.indented+(o?0:d)+(o||!s||/^(?:case|default)\b/.test(n)?0:d):r.indented+f:r.column+(o?0:1)},electricInput:A?/^\s*(?:case .*?:|default:|\{\}?|\})$/:/^\s*[{}]$/,blockCommentStart:"/*",blockCommentEnd:"*/",blockCommentContinue:" * ",lineComment:"//",fold:"brace"}}));var l="auto if break case register continue return default do sizeof static else struct switch extern typedef union for goto while enum const volatile inline restrict asm fortran",u="alignas alignof and and_eq audit axiom bitand bitor catch class compl concept constexpr const_cast decltype delete dynamic_cast explicit export final friend import module mutable namespace new noexcept not not_eq operator or or_eq override private protected public reinterpret_cast requires static_assert static_cast template this thread_local throw try typeid typename using virtual xor xor_eq",c="bycopy byref in inout oneway out self super atomic nonatomic retain copy readwrite readonly strong weak assign typeof nullable nonnull null_resettable _cmd @interface @implementation @end @protocol @encode @property @synthesize @dynamic @class @public @package @private @protected @required @optional @try @catch @finally @import @selector @encode @defs @synchronized @autoreleasepool @compatibility_alias @available",d="FOUNDATION_EXPORT FOUNDATION_EXTERN NS_INLINE NS_FORMAT_FUNCTION  NS_RETURNS_RETAINEDNS_ERROR_ENUM NS_RETURNS_NOT_RETAINED NS_RETURNS_INNER_POINTER NS_DESIGNATED_INITIALIZER NS_ENUM NS_OPTIONS NS_REQUIRES_NIL_TERMINATION NS_ASSUME_NONNULL_BEGIN NS_ASSUME_NONNULL_END NS_SWIFT_NAME NS_REFINED_FOR_SWIFT",f=a("int long char short double float unsigned signed void bool"),h=a("SEL instancetype id Class Protocol BOOL");function p(e){return s(f,e)||/.+_t$/.test(e)}function m(e){return p(e)||s(h,e)}var v="case do else for if switch while struct enum union",g="struct enum union";function y(e,t){if(!t.startOfLine)return!1;for(var n,r=null;n=e.peek();){if("\\"==n&&e.match(/^.$/)){r=y;break}if("/"==n&&e.match(/^\/[\/\*]/,!1))break;e.next()}return t.tokenize=r,"meta"}function _(e,t){return"type"==t.prevToken&&"type"}function x(e){return!(!e||e.length<2)&&("_"==e[0]&&("_"==e[1]||e[1]!==e[1].toLowerCase()))}function b(e){return e.eatWhile(/[\w\.']/),"number"}function w(e,t){if(e.backUp(1),e.match(/(R|u8R|uR|UR|LR)/)){var n=e.match(/"([^\s\\()]{0,16})\(/);return!!n&&(t.cpp11RawStringDelim=n[1],t.tokenize=S,S(e,t))}return e.match(/(u8|u|U|L)/)?!!e.match(/["']/,!1)&&"string":(e.next(),!1)}function A(e){var t=/(\w+)::~?(\w+)$/.exec(e);return t&&t[1]==t[2]}function T(e,t){var n;while(null!=(n=e.next()))if('"'==n&&!e.eat('"')){t.tokenize=null;break}return"string"}function S(e,t){var n=t.cpp11RawStringDelim.replace(/[^\w\s]/g,"\\$&"),r=e.match(new RegExp(".*?\\)"+n+'"'));return r?t.tokenize=null:e.skipToEnd(),"string"}function E(t,n){"string"==typeof t&&(t=[t]);var r=[];function i(e){if(e)for(var t in e)e.hasOwnProperty(t)&&r.push(t)}i(n.keywords),i(n.types),i(n.builtin),i(n.atoms),r.length&&(n.helperType=t[0],e.registerHelper("hintWords",t[0],r));for(var o=0;o<t.length;++o)e.defineMIME(t[o],n)}function C(e,t){var n=!1;while(!e.eol()){if(!n&&e.match('"""')){t.tokenize=null;break}n="\\"==e.next()&&!n}return"string"}function M(e){return function(t,n){var r;while(r=t.next()){if("*"==r&&t.eat("/")){if(1==e){n.tokenize=null;break}return n.tokenize=M(e-1),n.tokenize(t,n)}if("/"==r&&t.eat("*"))return n.tokenize=M(e+1),n.tokenize(t,n)}return"comment"}}function L(e){return function(t,n){var r,i=!1,o=!1;while(!t.eol()){if(!e&&!i&&t.match('"')){o=!0;break}if(e&&t.match('"""')){o=!0;break}r=t.next(),!i&&"$"==r&&t.match("{")&&t.skipTo("}"),i=!i&&"\\"==r&&!e}return!o&&e||(n.tokenize=null),"string"}}E(["text/x-csrc","text/x-c","text/x-chdr"],{name:"clike",keywords:a(l),types:p,blockKeywords:a(v),defKeywords:a(g),typeFirstDefinitions:!0,atoms:a("NULL true false"),isReservedIdentifier:x,hooks:{"#":y,"*":_},modeProps:{fold:["brace","include"]}}),E(["text/x-c++src","text/x-c++hdr"],{name:"clike",keywords:a(l+" "+u),types:p,blockKeywords:a(v+" class try catch"),defKeywords:a(g+" class namespace"),typeFirstDefinitions:!0,atoms:a("true false NULL nullptr"),dontIndentStatements:/^template$/,isIdentifierChar:/[\w\$_~\xa1-\uffff]/,isReservedIdentifier:x,hooks:{"#":y,"*":_,u:w,U:w,L:w,R:w,0:b,1:b,2:b,3:b,4:b,5:b,6:b,7:b,8:b,9:b,token:function(e,t,n){if("variable"==n&&"("==e.peek()&&(";"==t.prevToken||null==t.prevToken||"}"==t.prevToken)&&A(e.current()))return"def"}},namespaceSeparator:"::",modeProps:{fold:["brace","include"]}}),E("text/x-java",{name:"clike",keywords:a("abstract assert break case catch class const continue default do else enum extends final finally for goto if implements import instanceof interface native new package private protected public return static strictfp super switch synchronized this throw throws transient try volatile while @interface"),types:a("byte short int long float double boolean char void Boolean Byte Character Double Float Integer Long Number Object Short String StringBuffer StringBuilder Void"),blockKeywords:a("catch class do else finally for if switch try while"),defKeywords:a("class interface enum @interface"),typeFirstDefinitions:!0,atoms:a("true false null"),number:/^(?:0x[a-f\d_]+|0b[01_]+|(?:[\d_]+\.?\d*|\.\d+)(?:e[-+]?[\d_]+)?)(u|ll?|l|f)?/i,hooks:{"@":function(e){return!e.match("interface",!1)&&(e.eatWhile(/[\w\$_]/),"meta")}},modeProps:{fold:["brace","import"]}}),E("text/x-csharp",{name:"clike",keywords:a("abstract as async await base break case catch checked class const continue default delegate do else enum event explicit extern finally fixed for foreach goto if implicit in interface internal is lock namespace new operator out override params private protected public readonly ref return sealed sizeof stackalloc static struct switch this throw try typeof unchecked unsafe using virtual void volatile while add alias ascending descending dynamic from get global group into join let orderby partial remove select set value var yield"),types:a("Action Boolean Byte Char DateTime DateTimeOffset Decimal Double Func Guid Int16 Int32 Int64 Object SByte Single String Task TimeSpan UInt16 UInt32 UInt64 bool byte char decimal double short int long object sbyte float string ushort uint ulong"),blockKeywords:a("catch class do else finally for foreach if struct switch try while"),defKeywords:a("class interface namespace struct var"),typeFirstDefinitions:!0,atoms:a("true false null"),hooks:{"@":function(e,t){return e.eat('"')?(t.tokenize=T,T(e,t)):(e.eatWhile(/[\w\$_]/),"meta")}}}),E("text/x-scala",{name:"clike",keywords:a("abstract case catch class def do else extends final finally for forSome if implicit import lazy match new null object override package private protected return sealed super this throw trait try type val var while with yield _ assert assume require print println printf readLine readBoolean readByte readShort readChar readInt readLong readFloat readDouble"),types:a("AnyVal App Application Array BufferedIterator BigDecimal BigInt Char Console Either Enumeration Equiv Error Exception Fractional Function IndexedSeq Int Integral Iterable Iterator List Map Numeric Nil NotNull Option Ordered Ordering PartialFunction PartialOrdering Product Proxy Range Responder Seq Serializable Set Specializable Stream StringBuilder StringContext Symbol Throwable Traversable TraversableOnce Tuple Unit Vector Boolean Byte Character CharSequence Class ClassLoader Cloneable Comparable Compiler Double Exception Float Integer Long Math Number Object Package Pair Process Runtime Runnable SecurityManager Short StackTraceElement StrictMath String StringBuffer System Thread ThreadGroup ThreadLocal Throwable Triple Void"),multiLineStrings:!0,blockKeywords:a("catch class enum do else finally for forSome if match switch try while"),defKeywords:a("class enum def object package trait type val var"),atoms:a("true false null"),indentStatements:!1,indentSwitch:!1,isOperatorChar:/[+\-*&%=<>!?|\/#:@]/,hooks:{"@":function(e){return e.eatWhile(/[\w\$_]/),"meta"},'"':function(e,t){return!!e.match('""')&&(t.tokenize=C,t.tokenize(e,t))},"'":function(e){return e.eatWhile(/[\w\$_\xa1-\uffff]/),"atom"},"=":function(e,n){var r=n.context;return!("}"!=r.type||!r.align||!e.eat(">"))&&(n.context=new t(r.indented,r.column,r.type,r.info,null,r.prev),"operator")},"/":function(e,t){return!!e.eat("*")&&(t.tokenize=M(1),t.tokenize(e,t))}},modeProps:{closeBrackets:{pairs:'()[]{}""',triples:'"'}}}),E("text/x-kotlin",{name:"clike",keywords:a("package as typealias class interface this super val operator var fun for is in This throw return annotation break continue object if else while do try when !in !is as? file import where by get set abstract enum open inner override private public internal protected catch finally out final vararg reified dynamic companion constructor init sealed field property receiver param sparam lateinit data inline noinline tailrec external annotation crossinline const operator infix suspend actual expect setparam"),types:a("Boolean Byte Character CharSequence Class ClassLoader Cloneable Comparable Compiler Double Exception Float Integer Long Math Number Object Package Pair Process Runtime Runnable SecurityManager Short StackTraceElement StrictMath String StringBuffer System Thread ThreadGroup ThreadLocal Throwable Triple Void Annotation Any BooleanArray ByteArray Char CharArray DeprecationLevel DoubleArray Enum FloatArray Function Int IntArray Lazy LazyThreadSafetyMode LongArray Nothing ShortArray Unit"),intendSwitch:!1,indentStatements:!1,multiLineStrings:!0,number:/^(?:0x[a-f\d_]+|0b[01_]+|(?:[\d_]+(\.\d+)?|\.\d+)(?:e[-+]?[\d_]+)?)(u|ll?|l|f)?/i,blockKeywords:a("catch class do else finally for if where try while enum"),defKeywords:a("class val var object interface fun"),atoms:a("true false null this"),hooks:{"@":function(e){return e.eatWhile(/[\w\$_]/),"meta"},"*":function(e,t){return"."==t.prevToken?"variable":"operator"},'"':function(e,t){return t.tokenize=L(e.match('""')),t.tokenize(e,t)},"/":function(e,t){return!!e.eat("*")&&(t.tokenize=M(1),t.tokenize(e,t))},indent:function(e,t,n,r){var i=n&&n.charAt(0);return"}"!=e.prevToken&&")"!=e.prevToken||""!=n?"operator"==e.prevToken&&"}"!=n&&"}"!=e.context.type||"variable"==e.prevToken&&"."==i||("}"==e.prevToken||")"==e.prevToken)&&"."==i?2*r+t.indented:t.align&&"}"==t.type?t.indented+(e.context.type==(n||"").charAt(0)?0:r):void 0:e.indented}},modeProps:{closeBrackets:{triples:'"'}}}),E(["x-shader/x-vertex","x-shader/x-fragment"],{name:"clike",keywords:a("sampler1D sampler2D sampler3D samplerCube sampler1DShadow sampler2DShadow const attribute uniform varying break continue discard return for while do if else struct in out inout"),types:a("float int bool void vec2 vec3 vec4 ivec2 ivec3 ivec4 bvec2 bvec3 bvec4 mat2 mat3 mat4"),blockKeywords:a("for while do if else struct"),builtin:a("radians degrees sin cos tan asin acos atan pow exp log exp2 sqrt inversesqrt abs sign floor ceil fract mod min max clamp mix step smoothstep length distance dot cross normalize ftransform faceforward reflect refract matrixCompMult lessThan lessThanEqual greaterThan greaterThanEqual equal notEqual any all not texture1D texture1DProj texture1DLod texture1DProjLod texture2D texture2DProj texture2DLod texture2DProjLod texture3D texture3DProj texture3DLod texture3DProjLod textureCube textureCubeLod shadow1D shadow2D shadow1DProj shadow2DProj shadow1DLod shadow2DLod shadow1DProjLod shadow2DProjLod dFdx dFdy fwidth noise1 noise2 noise3 noise4"),atoms:a("true false gl_FragColor gl_SecondaryColor gl_Normal gl_Vertex gl_MultiTexCoord0 gl_MultiTexCoord1 gl_MultiTexCoord2 gl_MultiTexCoord3 gl_MultiTexCoord4 gl_MultiTexCoord5 gl_MultiTexCoord6 gl_MultiTexCoord7 gl_FogCoord gl_PointCoord gl_Position gl_PointSize gl_ClipVertex gl_FrontColor gl_BackColor gl_FrontSecondaryColor gl_BackSecondaryColor gl_TexCoord gl_FogFragCoord gl_FragCoord gl_FrontFacing gl_FragData gl_FragDepth gl_ModelViewMatrix gl_ProjectionMatrix gl_ModelViewProjectionMatrix gl_TextureMatrix gl_NormalMatrix gl_ModelViewMatrixInverse gl_ProjectionMatrixInverse gl_ModelViewProjectionMatrixInverse gl_TexureMatrixTranspose gl_ModelViewMatrixInverseTranspose gl_ProjectionMatrixInverseTranspose gl_ModelViewProjectionMatrixInverseTranspose gl_TextureMatrixInverseTranspose gl_NormalScale gl_DepthRange gl_ClipPlane gl_Point gl_FrontMaterial gl_BackMaterial gl_LightSource gl_LightModel gl_FrontLightModelProduct gl_BackLightModelProduct gl_TextureColor gl_EyePlaneS gl_EyePlaneT gl_EyePlaneR gl_EyePlaneQ gl_FogParameters gl_MaxLights gl_MaxClipPlanes gl_MaxTextureUnits gl_MaxTextureCoords gl_MaxVertexAttribs gl_MaxVertexUniformComponents gl_MaxVaryingFloats gl_MaxVertexTextureImageUnits gl_MaxTextureImageUnits gl_MaxFragmentUniformComponents gl_MaxCombineTextureImageUnits gl_MaxDrawBuffers"),indentSwitch:!1,hooks:{"#":y},modeProps:{fold:["brace","include"]}}),E("text/x-nesc",{name:"clike",keywords:a(l+" as atomic async call command component components configuration event generic implementation includes interface module new norace nx_struct nx_union post provides signal task uses abstract extends"),types:p,blockKeywords:a(v),atoms:a("null true false"),hooks:{"#":y},modeProps:{fold:["brace","include"]}}),E("text/x-objectivec",{name:"clike",keywords:a(l+" "+c),types:m,builtin:a(d),blockKeywords:a(v+" @synthesize @try @catch @finally @autoreleasepool @synchronized"),defKeywords:a(g+" @interface @implementation @protocol @class"),dontIndentStatements:/^@.*$/,typeFirstDefinitions:!0,atoms:a("YES NO NULL Nil nil true false nullptr"),isReservedIdentifier:x,hooks:{"#":y,"*":_},modeProps:{fold:["brace","include"]}}),E("text/x-objectivec++",{name:"clike",keywords:a(l+" "+c+" "+u),types:m,builtin:a(d),blockKeywords:a(v+" @synthesize @try @catch @finally @autoreleasepool @synchronized class try catch"),defKeywords:a(g+" @interface @implementation @protocol @class class namespace"),dontIndentStatements:/^@.*$|^template$/,typeFirstDefinitions:!0,atoms:a("YES NO NULL Nil nil true false nullptr"),isReservedIdentifier:x,hooks:{"#":y,"*":_,u:w,U:w,L:w,R:w,0:b,1:b,2:b,3:b,4:b,5:b,6:b,7:b,8:b,9:b,token:function(e,t,n){if("variable"==n&&"("==e.peek()&&(";"==t.prevToken||null==t.prevToken||"}"==t.prevToken)&&A(e.current()))return"def"}},namespaceSeparator:"::",modeProps:{fold:["brace","include"]}}),E("text/x-squirrel",{name:"clike",keywords:a("base break clone continue const default delete enum extends function in class foreach local resume return this throw typeof yield constructor instanceof static"),types:p,blockKeywords:a("case catch class else for foreach if switch try while"),defKeywords:a("function local class"),typeFirstDefinitions:!0,atoms:a("true false null"),hooks:{"#":y},modeProps:{fold:["brace","include"]}});var N=null;function D(e){return function(t,n){var r,i=!1,o=!1;while(!t.eol()){if(!i&&t.match('"')&&("single"==e||t.match('""'))){o=!0;break}if(!i&&t.match("``")){N=D(e),o=!0;break}r=t.next(),i="single"==e&&!i&&"\\"==r}return o&&(n.tokenize=null),"string"}}E("text/x-ceylon",{name:"clike",keywords:a("abstracts alias assembly assert assign break case catch class continue dynamic else exists extends finally for function given if import in interface is let module new nonempty object of out outer package return satisfies super switch then this throw try value void while"),types:function(e){var t=e.charAt(0);return t===t.toUpperCase()&&t!==t.toLowerCase()},blockKeywords:a("case catch class dynamic else finally for function if interface module new object switch try while"),defKeywords:a("class dynamic function interface module object package value"),builtin:a("abstract actual aliased annotation by default deprecated doc final formal late license native optional sealed see serializable shared suppressWarnings tagged throws variable"),isPunctuationChar:/[\[\]{}\(\),;\:\.`]/,isOperatorChar:/[+\-*&%=<>!?|^~:\/]/,numberStart:/[\d#$]/,number:/^(?:#[\da-fA-F_]+|\$[01_]+|[\d_]+[kMGTPmunpf]?|[\d_]+\.[\d_]+(?:[eE][-+]?\d+|[kMGTPmunpf]|)|)/i,multiLineStrings:!0,typeFirstDefinitions:!0,atoms:a("true false null larger smaller equal empty finished"),indentSwitch:!1,styleDefs:!1,hooks:{"@":function(e){return e.eatWhile(/[\w\$_]/),"meta"},'"':function(e,t){return t.tokenize=D(e.match('""')?"triple":"single"),t.tokenize(e,t)},"`":function(e,t){return!(!N||!e.match("`"))&&(t.tokenize=N,N=null,t.tokenize(e,t))},"'":function(e){return e.eatWhile(/[\w\$_\xa1-\uffff]/),"atom"},token:function(e,t,n){if(("variable"==n||"type"==n)&&"."==t.prevToken)return"variable-2"}},modeProps:{fold:["brace","import"],closeBrackets:{triples:'"'}}})}))},"4cef":function(e,t){var n=/\s/;function r(e){var t=e.length;while(t--&&n.test(e.charAt(t)));return t}e.exports=r},"542c":function(e,t,n){},"55dd":function(e,t,n){"use strict";var r=n("5ca1"),i=n("d8e8"),o=n("4bf8"),a=n("79e5"),s=[].sort,l=[1,2,3];r(r.P+r.F*(a((function(){l.sort(void 0)}))||!a((function(){l.sort(null)}))||!n("2f21")(s)),"Array",{sort:function(e){return void 0===e?s.call(o(this)):s.call(o(this),i(e))}})},"56b3":function(e,t,n){(function(t,n){e.exports=n()})(0,(function(){"use strict";var e=navigator.userAgent,t=navigator.platform,n=/gecko\/\d/i.test(e),r=/MSIE \d/.test(e),i=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(e),o=/Edge\/(\d+)/.exec(e),a=r||i||o,s=a&&(r?document.documentMode||6:+(o||i)[1]),l=!o&&/WebKit\//.test(e),u=l&&/Qt\/\d+\.\d+/.test(e),c=!o&&/Chrome\//.test(e),d=/Opera\//.test(e),f=/Apple Computer/.test(navigator.vendor),h=/Mac OS X 1\d\D([8-9]|\d\d)\D/.test(e),p=/PhantomJS/.test(e),m=!o&&/AppleWebKit/.test(e)&&/Mobile\/\w+/.test(e),v=/Android/.test(e),g=m||v||/webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(e),y=m||/Mac/.test(t),_=/\bCrOS\b/.test(e),x=/win/i.test(t),b=d&&e.match(/Version\/(\d*\.\d*)/);b&&(b=Number(b[1])),b&&b>=15&&(d=!1,l=!0);var w=y&&(u||d&&(null==b||b<12.11)),A=n||a&&s>=9;function T(e){return new RegExp("(^|\\s)"+e+"(?:$|\\s)\\s*")}var S,E=function(e,t){var n=e.className,r=T(t).exec(n);if(r){var i=n.slice(r.index+r[0].length);e.className=n.slice(0,r.index)+(i?r[1]+i:"")}};function C(e){for(var t=e.childNodes.length;t>0;--t)e.removeChild(e.firstChild);return e}function M(e,t){return C(e).appendChild(t)}function L(e,t,n,r){var i=document.createElement(e);if(n&&(i.className=n),r&&(i.style.cssText=r),"string"==typeof t)i.appendChild(document.createTextNode(t));else if(t)for(var o=0;o<t.length;++o)i.appendChild(t[o]);return i}function N(e,t,n,r){var i=L(e,t,n,r);return i.setAttribute("role","presentation"),i}function D(e,t){if(3==t.nodeType&&(t=t.parentNode),e.contains)return e.contains(t);do{if(11==t.nodeType&&(t=t.host),t==e)return!0}while(t=t.parentNode)}function O(){var e;try{e=document.activeElement}catch(t){e=document.body||null}while(e&&e.shadowRoot&&e.shadowRoot.activeElement)e=e.shadowRoot.activeElement;return e}function I(e,t){var n=e.className;T(t).test(n)||(e.className+=(n?" ":"")+t)}function R(e,t){for(var n=e.split(" "),r=0;r<n.length;r++)n[r]&&!T(n[r]).test(t)&&(t+=" "+n[r]);return t}S=document.createRange?function(e,t,n,r){var i=document.createRange();return i.setEnd(r||e,n),i.setStart(e,t),i}:function(e,t,n){var r=document.body.createTextRange();try{r.moveToElementText(e.parentNode)}catch(i){return r}return r.collapse(!0),r.moveEnd("character",n),r.moveStart("character",t),r};var P=function(e){e.select()};function k(e){var t=Array.prototype.slice.call(arguments,1);return function(){return e.apply(null,t)}}function B(e,t,n){for(var r in t||(t={}),e)!e.hasOwnProperty(r)||!1===n&&t.hasOwnProperty(r)||(t[r]=e[r]);return t}function F(e,t,n,r,i){null==t&&(t=e.search(/[^\s\u00a0]/),-1==t&&(t=e.length));for(var o=r||0,a=i||0;;){var s=e.indexOf("\t",o);if(s<0||s>=t)return a+(t-o);a+=s-o,a+=n-a%n,o=s+1}}m?P=function(e){e.selectionStart=0,e.selectionEnd=e.value.length}:a&&(P=function(e){try{e.select()}catch(t){}});var z=function(){this.id=null,this.f=null,this.time=0,this.handler=k(this.onTimeout,this)};function H(e,t){for(var n=0;n<e.length;++n)if(e[n]==t)return n;return-1}z.prototype.onTimeout=function(e){e.id=0,e.time<=+new Date?e.f():setTimeout(e.handler,e.time-+new Date)},z.prototype.set=function(e,t){this.f=t;var n=+new Date+e;(!this.id||n<this.time)&&(clearTimeout(this.id),this.id=setTimeout(this.handler,e),this.time=n)};var U=30,G={toString:function(){return"CodeMirror.Pass"}},V={scroll:!1},j={origin:"*mouse"},W={origin:"+move"};function X(e,t,n){for(var r=0,i=0;;){var o=e.indexOf("\t",r);-1==o&&(o=e.length);var a=o-r;if(o==e.length||i+a>=t)return r+Math.min(a,t-i);if(i+=o-r,i+=n-i%n,r=o+1,i>=t)return r}}var Y=[""];function q(e){while(Y.length<=e)Y.push(Q(Y)+" ");return Y[e]}function Q(e){return e[e.length-1]}function $(e,t){for(var n=[],r=0;r<e.length;r++)n[r]=t(e[r],r);return n}function K(e,t,n){var r=0,i=n(t);while(r<e.length&&n(e[r])<=i)r++;e.splice(r,0,t)}function Z(){}function J(e,t){var n;return Object.create?n=Object.create(e):(Z.prototype=e,n=new Z),t&&B(t,n),n}var ee=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;function te(e){return/\w/.test(e)||e>""&&(e.toUpperCase()!=e.toLowerCase()||ee.test(e))}function ne(e,t){return t?!!(t.source.indexOf("\\w")>-1&&te(e))||t.test(e):te(e)}function re(e){for(var t in e)if(e.hasOwnProperty(t)&&e[t])return!1;return!0}var ie=/[\u0300-\u036f\u0483-\u0489\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u065e\u0670\u06d6-\u06dc\u06de-\u06e4\u06e7\u06e8\u06ea-\u06ed\u0711\u0730-\u074a\u07a6-\u07b0\u07eb-\u07f3\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0900-\u0902\u093c\u0941-\u0948\u094d\u0951-\u0955\u0962\u0963\u0981\u09bc\u09be\u09c1-\u09c4\u09cd\u09d7\u09e2\u09e3\u0a01\u0a02\u0a3c\u0a41\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a70\u0a71\u0a75\u0a81\u0a82\u0abc\u0ac1-\u0ac5\u0ac7\u0ac8\u0acd\u0ae2\u0ae3\u0b01\u0b3c\u0b3e\u0b3f\u0b41-\u0b44\u0b4d\u0b56\u0b57\u0b62\u0b63\u0b82\u0bbe\u0bc0\u0bcd\u0bd7\u0c3e-\u0c40\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62\u0c63\u0cbc\u0cbf\u0cc2\u0cc6\u0ccc\u0ccd\u0cd5\u0cd6\u0ce2\u0ce3\u0d3e\u0d41-\u0d44\u0d4d\u0d57\u0d62\u0d63\u0dca\u0dcf\u0dd2-\u0dd4\u0dd6\u0ddf\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0eb1\u0eb4-\u0eb9\u0ebb\u0ebc\u0ec8-\u0ecd\u0f18\u0f19\u0f35\u0f37\u0f39\u0f71-\u0f7e\u0f80-\u0f84\u0f86\u0f87\u0f90-\u0f97\u0f99-\u0fbc\u0fc6\u102d-\u1030\u1032-\u1037\u1039\u103a\u103d\u103e\u1058\u1059\u105e-\u1060\u1071-\u1074\u1082\u1085\u1086\u108d\u109d\u135f\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17b7-\u17bd\u17c6\u17c9-\u17d3\u17dd\u180b-\u180d\u18a9\u1920-\u1922\u1927\u1928\u1932\u1939-\u193b\u1a17\u1a18\u1a56\u1a58-\u1a5e\u1a60\u1a62\u1a65-\u1a6c\u1a73-\u1a7c\u1a7f\u1b00-\u1b03\u1b34\u1b36-\u1b3a\u1b3c\u1b42\u1b6b-\u1b73\u1b80\u1b81\u1ba2-\u1ba5\u1ba8\u1ba9\u1c2c-\u1c33\u1c36\u1c37\u1cd0-\u1cd2\u1cd4-\u1ce0\u1ce2-\u1ce8\u1ced\u1dc0-\u1de6\u1dfd-\u1dff\u200c\u200d\u20d0-\u20f0\u2cef-\u2cf1\u2de0-\u2dff\u302a-\u302f\u3099\u309a\ua66f-\ua672\ua67c\ua67d\ua6f0\ua6f1\ua802\ua806\ua80b\ua825\ua826\ua8c4\ua8e0-\ua8f1\ua926-\ua92d\ua947-\ua951\ua980-\ua982\ua9b3\ua9b6-\ua9b9\ua9bc\uaa29-\uaa2e\uaa31\uaa32\uaa35\uaa36\uaa43\uaa4c\uaab0\uaab2-\uaab4\uaab7\uaab8\uaabe\uaabf\uaac1\uabe5\uabe8\uabed\udc00-\udfff\ufb1e\ufe00-\ufe0f\ufe20-\ufe26\uff9e\uff9f]/;function oe(e){return e.charCodeAt(0)>=768&&ie.test(e)}function ae(e,t,n){while((n<0?t>0:t<e.length)&&oe(e.charAt(t)))t+=n;return t}function se(e,t,n){for(var r=t>n?-1:1;;){if(t==n)return t;var i=(t+n)/2,o=r<0?Math.ceil(i):Math.floor(i);if(o==t)return e(o)?t:n;e(o)?n=o:t=o+r}}function le(e,t,n,r){if(!e)return r(t,n,"ltr",0);for(var i=!1,o=0;o<e.length;++o){var a=e[o];(a.from<n&&a.to>t||t==n&&a.to==t)&&(r(Math.max(a.from,t),Math.min(a.to,n),1==a.level?"rtl":"ltr",o),i=!0)}i||r(t,n,"ltr")}var ue=null;function ce(e,t,n){var r;ue=null;for(var i=0;i<e.length;++i){var o=e[i];if(o.from<t&&o.to>t)return i;o.to==t&&(o.from!=o.to&&"before"==n?r=i:ue=i),o.from==t&&(o.from!=o.to&&"before"!=n?r=i:ue=i)}return null!=r?r:ue}var de=function(){var e="bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN",t="nnnnnnNNr%%r,rNNmmmmmmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmmmnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmnNmmmmmmrrmmNmmmmrr1111111111";function n(n){return n<=247?e.charAt(n):1424<=n&&n<=1524?"R":1536<=n&&n<=1785?t.charAt(n-1536):1774<=n&&n<=2220?"r":8192<=n&&n<=8203?"w":8204==n?"b":"L"}var r=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/,i=/[stwN]/,o=/[LRr]/,a=/[Lb1n]/,s=/[1n]/;function l(e,t,n){this.level=e,this.from=t,this.to=n}return function(e,t){var u="ltr"==t?"L":"R";if(0==e.length||"ltr"==t&&!r.test(e))return!1;for(var c=e.length,d=[],f=0;f<c;++f)d.push(n(e.charCodeAt(f)));for(var h=0,p=u;h<c;++h){var m=d[h];"m"==m?d[h]=p:p=m}for(var v=0,g=u;v<c;++v){var y=d[v];"1"==y&&"r"==g?d[v]="n":o.test(y)&&(g=y,"r"==y&&(d[v]="R"))}for(var _=1,x=d[0];_<c-1;++_){var b=d[_];"+"==b&&"1"==x&&"1"==d[_+1]?d[_]="1":","!=b||x!=d[_+1]||"1"!=x&&"n"!=x||(d[_]=x),x=b}for(var w=0;w<c;++w){var A=d[w];if(","==A)d[w]="N";else if("%"==A){var T=void 0;for(T=w+1;T<c&&"%"==d[T];++T);for(var S=w&&"!"==d[w-1]||T<c&&"1"==d[T]?"1":"N",E=w;E<T;++E)d[E]=S;w=T-1}}for(var C=0,M=u;C<c;++C){var L=d[C];"L"==M&&"1"==L?d[C]="L":o.test(L)&&(M=L)}for(var N=0;N<c;++N)if(i.test(d[N])){var D=void 0;for(D=N+1;D<c&&i.test(d[D]);++D);for(var O="L"==(N?d[N-1]:u),I="L"==(D<c?d[D]:u),R=O==I?O?"L":"R":u,P=N;P<D;++P)d[P]=R;N=D-1}for(var k,B=[],F=0;F<c;)if(a.test(d[F])){var z=F;for(++F;F<c&&a.test(d[F]);++F);B.push(new l(0,z,F))}else{var H=F,U=B.length;for(++F;F<c&&"L"!=d[F];++F);for(var G=H;G<F;)if(s.test(d[G])){H<G&&B.splice(U,0,new l(1,H,G));var V=G;for(++G;G<F&&s.test(d[G]);++G);B.splice(U,0,new l(2,V,G)),H=G}else++G;H<F&&B.splice(U,0,new l(1,H,F))}return"ltr"==t&&(1==B[0].level&&(k=e.match(/^\s+/))&&(B[0].from=k[0].length,B.unshift(new l(0,0,k[0].length))),1==Q(B).level&&(k=e.match(/\s+$/))&&(Q(B).to-=k[0].length,B.push(new l(0,c-k[0].length,c)))),"rtl"==t?B.reverse():B}}();function fe(e,t){var n=e.order;return null==n&&(n=e.order=de(e.text,t)),n}var he=[],pe=function(e,t,n){if(e.addEventListener)e.addEventListener(t,n,!1);else if(e.attachEvent)e.attachEvent("on"+t,n);else{var r=e._handlers||(e._handlers={});r[t]=(r[t]||he).concat(n)}};function me(e,t){return e._handlers&&e._handlers[t]||he}function ve(e,t,n){if(e.removeEventListener)e.removeEventListener(t,n,!1);else if(e.detachEvent)e.detachEvent("on"+t,n);else{var r=e._handlers,i=r&&r[t];if(i){var o=H(i,n);o>-1&&(r[t]=i.slice(0,o).concat(i.slice(o+1)))}}}function ge(e,t){var n=me(e,t);if(n.length)for(var r=Array.prototype.slice.call(arguments,2),i=0;i<n.length;++i)n[i].apply(null,r)}function ye(e,t,n){return"string"==typeof t&&(t={type:t,preventDefault:function(){this.defaultPrevented=!0}}),ge(e,n||t.type,e,t),Te(t)||t.codemirrorIgnore}function _e(e){var t=e._handlers&&e._handlers.cursorActivity;if(t)for(var n=e.curOp.cursorActivityHandlers||(e.curOp.cursorActivityHandlers=[]),r=0;r<t.length;++r)-1==H(n,t[r])&&n.push(t[r])}function xe(e,t){return me(e,t).length>0}function be(e){e.prototype.on=function(e,t){pe(this,e,t)},e.prototype.off=function(e,t){ve(this,e,t)}}function we(e){e.preventDefault?e.preventDefault():e.returnValue=!1}function Ae(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0}function Te(e){return null!=e.defaultPrevented?e.defaultPrevented:0==e.returnValue}function Se(e){we(e),Ae(e)}function Ee(e){return e.target||e.srcElement}function Ce(e){var t=e.which;return null==t&&(1&e.button?t=1:2&e.button?t=3:4&e.button&&(t=2)),y&&e.ctrlKey&&1==t&&(t=3),t}var Me,Le,Ne=function(){if(a&&s<9)return!1;var e=L("div");return"draggable"in e||"dragDrop"in e}();function De(e){if(null==Me){var t=L("span","​");M(e,L("span",[t,document.createTextNode("x")])),0!=e.firstChild.offsetHeight&&(Me=t.offsetWidth<=1&&t.offsetHeight>2&&!(a&&s<8))}var n=Me?L("span","​"):L("span"," ",null,"display: inline-block; width: 1px; margin-right: -1px");return n.setAttribute("cm-text",""),n}function Oe(e){if(null!=Le)return Le;var t=M(e,document.createTextNode("AخA")),n=S(t,0,1).getBoundingClientRect(),r=S(t,1,2).getBoundingClientRect();return C(e),!(!n||n.left==n.right)&&(Le=r.right-n.right<3)}var Ie=3!="\n\nb".split(/\n/).length?function(e){var t=0,n=[],r=e.length;while(t<=r){var i=e.indexOf("\n",t);-1==i&&(i=e.length);var o=e.slice(t,"\r"==e.charAt(i-1)?i-1:i),a=o.indexOf("\r");-1!=a?(n.push(o.slice(0,a)),t+=a+1):(n.push(o),t=i+1)}return n}:function(e){return e.split(/\r\n?|\n/)},Re=window.getSelection?function(e){try{return e.selectionStart!=e.selectionEnd}catch(t){return!1}}:function(e){var t;try{t=e.ownerDocument.selection.createRange()}catch(n){}return!(!t||t.parentElement()!=e)&&0!=t.compareEndPoints("StartToEnd",t)},Pe=function(){var e=L("div");return"oncopy"in e||(e.setAttribute("oncopy","return;"),"function"==typeof e.oncopy)}(),ke=null;function Be(e){if(null!=ke)return ke;var t=M(e,L("span","x")),n=t.getBoundingClientRect(),r=S(t,0,1).getBoundingClientRect();return ke=Math.abs(n.left-r.left)>1}var Fe={},ze={};function He(e,t){arguments.length>2&&(t.dependencies=Array.prototype.slice.call(arguments,2)),Fe[e]=t}function Ue(e,t){ze[e]=t}function Ge(e){if("string"==typeof e&&ze.hasOwnProperty(e))e=ze[e];else if(e&&"string"==typeof e.name&&ze.hasOwnProperty(e.name)){var t=ze[e.name];"string"==typeof t&&(t={name:t}),e=J(t,e),e.name=t.name}else{if("string"==typeof e&&/^[\w\-]+\/[\w\-]+\+xml$/.test(e))return Ge("application/xml");if("string"==typeof e&&/^[\w\-]+\/[\w\-]+\+json$/.test(e))return Ge("application/json")}return"string"==typeof e?{name:e}:e||{name:"null"}}function Ve(e,t){t=Ge(t);var n=Fe[t.name];if(!n)return Ve(e,"text/plain");var r=n(e,t);if(je.hasOwnProperty(t.name)){var i=je[t.name];for(var o in i)i.hasOwnProperty(o)&&(r.hasOwnProperty(o)&&(r["_"+o]=r[o]),r[o]=i[o])}if(r.name=t.name,t.helperType&&(r.helperType=t.helperType),t.modeProps)for(var a in t.modeProps)r[a]=t.modeProps[a];return r}var je={};function We(e,t){var n=je.hasOwnProperty(e)?je[e]:je[e]={};B(t,n)}function Xe(e,t){if(!0===t)return t;if(e.copyState)return e.copyState(t);var n={};for(var r in t){var i=t[r];i instanceof Array&&(i=i.concat([])),n[r]=i}return n}function Ye(e,t){var n;while(e.innerMode){if(n=e.innerMode(t),!n||n.mode==e)break;t=n.state,e=n.mode}return n||{mode:e,state:t}}function qe(e,t,n){return!e.startState||e.startState(t,n)}var Qe=function(e,t,n){this.pos=this.start=0,this.string=e,this.tabSize=t||8,this.lastColumnPos=this.lastColumnValue=0,this.lineStart=0,this.lineOracle=n};function $e(e,t){if(t-=e.first,t<0||t>=e.size)throw new Error("There is no line "+(t+e.first)+" in the document.");var n=e;while(!n.lines)for(var r=0;;++r){var i=n.children[r],o=i.chunkSize();if(t<o){n=i;break}t-=o}return n.lines[t]}function Ke(e,t,n){var r=[],i=t.line;return e.iter(t.line,n.line+1,(function(e){var o=e.text;i==n.line&&(o=o.slice(0,n.ch)),i==t.line&&(o=o.slice(t.ch)),r.push(o),++i})),r}function Ze(e,t,n){var r=[];return e.iter(t,n,(function(e){r.push(e.text)})),r}function Je(e,t){var n=t-e.height;if(n)for(var r=e;r;r=r.parent)r.height+=n}function et(e){if(null==e.parent)return null;for(var t=e.parent,n=H(t.lines,e),r=t.parent;r;t=r,r=r.parent)for(var i=0;;++i){if(r.children[i]==t)break;n+=r.children[i].chunkSize()}return n+t.first}function tt(e,t){var n=e.first;e:do{for(var r=0;r<e.children.length;++r){var i=e.children[r],o=i.height;if(t<o){e=i;continue e}t-=o,n+=i.chunkSize()}return n}while(!e.lines);for(var a=0;a<e.lines.length;++a){var s=e.lines[a],l=s.height;if(t<l)break;t-=l}return n+a}function nt(e,t){return t>=e.first&&t<e.first+e.size}function rt(e,t){return String(e.lineNumberFormatter(t+e.firstLineNumber))}function it(e,t,n){if(void 0===n&&(n=null),!(this instanceof it))return new it(e,t,n);this.line=e,this.ch=t,this.sticky=n}function ot(e,t){return e.line-t.line||e.ch-t.ch}function at(e,t){return e.sticky==t.sticky&&0==ot(e,t)}function st(e){return it(e.line,e.ch)}function lt(e,t){return ot(e,t)<0?t:e}function ut(e,t){return ot(e,t)<0?e:t}function ct(e,t){return Math.max(e.first,Math.min(t,e.first+e.size-1))}function dt(e,t){if(t.line<e.first)return it(e.first,0);var n=e.first+e.size-1;return t.line>n?it(n,$e(e,n).text.length):ft(t,$e(e,t.line).text.length)}function ft(e,t){var n=e.ch;return null==n||n>t?it(e.line,t):n<0?it(e.line,0):e}function ht(e,t){for(var n=[],r=0;r<t.length;r++)n[r]=dt(e,t[r]);return n}Qe.prototype.eol=function(){return this.pos>=this.string.length},Qe.prototype.sol=function(){return this.pos==this.lineStart},Qe.prototype.peek=function(){return this.string.charAt(this.pos)||void 0},Qe.prototype.next=function(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)},Qe.prototype.eat=function(e){var t,n=this.string.charAt(this.pos);if(t="string"==typeof e?n==e:n&&(e.test?e.test(n):e(n)),t)return++this.pos,n},Qe.prototype.eatWhile=function(e){var t=this.pos;while(this.eat(e));return this.pos>t},Qe.prototype.eatSpace=function(){var e=this,t=this.pos;while(/[\s\u00a0]/.test(this.string.charAt(this.pos)))++e.pos;return this.pos>t},Qe.prototype.skipToEnd=function(){this.pos=this.string.length},Qe.prototype.skipTo=function(e){var t=this.string.indexOf(e,this.pos);if(t>-1)return this.pos=t,!0},Qe.prototype.backUp=function(e){this.pos-=e},Qe.prototype.column=function(){return this.lastColumnPos<this.start&&(this.lastColumnValue=F(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue-(this.lineStart?F(this.string,this.lineStart,this.tabSize):0)},Qe.prototype.indentation=function(){return F(this.string,null,this.tabSize)-(this.lineStart?F(this.string,this.lineStart,this.tabSize):0)},Qe.prototype.match=function(e,t,n){if("string"!=typeof e){var r=this.string.slice(this.pos).match(e);return r&&r.index>0?null:(r&&!1!==t&&(this.pos+=r[0].length),r)}var i=function(e){return n?e.toLowerCase():e},o=this.string.substr(this.pos,e.length);if(i(o)==i(e))return!1!==t&&(this.pos+=e.length),!0},Qe.prototype.current=function(){return this.string.slice(this.start,this.pos)},Qe.prototype.hideFirstChars=function(e,t){this.lineStart+=e;try{return t()}finally{this.lineStart-=e}},Qe.prototype.lookAhead=function(e){var t=this.lineOracle;return t&&t.lookAhead(e)},Qe.prototype.baseToken=function(){var e=this.lineOracle;return e&&e.baseToken(this.pos)};var pt=function(e,t){this.state=e,this.lookAhead=t},mt=function(e,t,n,r){this.state=t,this.doc=e,this.line=n,this.maxLookAhead=r||0,this.baseTokens=null,this.baseTokenPos=1};function vt(e,t,n,r){var i=[e.state.modeGen],o={};St(e,t.text,e.doc.mode,n,(function(e,t){return i.push(e,t)}),o,r);for(var a=n.state,s=function(r){n.baseTokens=i;var s=e.state.overlays[r],l=1,u=0;n.state=!0,St(e,t.text,s.mode,n,(function(e,t){var n=l;while(u<e){var r=i[l];r>e&&i.splice(l,1,e,i[l+1],r),l+=2,u=Math.min(e,r)}if(t)if(s.opaque)i.splice(n,l-n,e,"overlay "+t),l=n+2;else for(;n<l;n+=2){var o=i[n+1];i[n+1]=(o?o+" ":"")+"overlay "+t}}),o),n.state=a,n.baseTokens=null,n.baseTokenPos=1},l=0;l<e.state.overlays.length;++l)s(l);return{styles:i,classes:o.bgClass||o.textClass?o:null}}function gt(e,t,n){if(!t.styles||t.styles[0]!=e.state.modeGen){var r=yt(e,et(t)),i=t.text.length>e.options.maxHighlightLength&&Xe(e.doc.mode,r.state),o=vt(e,t,r);i&&(r.state=i),t.stateAfter=r.save(!i),t.styles=o.styles,o.classes?t.styleClasses=o.classes:t.styleClasses&&(t.styleClasses=null),n===e.doc.highlightFrontier&&(e.doc.modeFrontier=Math.max(e.doc.modeFrontier,++e.doc.highlightFrontier))}return t.styles}function yt(e,t,n){var r=e.doc,i=e.display;if(!r.mode.startState)return new mt(r,!0,t);var o=Et(e,t,n),a=o>r.first&&$e(r,o-1).stateAfter,s=a?mt.fromSaved(r,a,o):new mt(r,qe(r.mode),o);return r.iter(o,t,(function(n){_t(e,n.text,s);var r=s.line;n.stateAfter=r==t-1||r%5==0||r>=i.viewFrom&&r<i.viewTo?s.save():null,s.nextLine()})),n&&(r.modeFrontier=s.line),s}function _t(e,t,n,r){var i=e.doc.mode,o=new Qe(t,e.options.tabSize,n);o.start=o.pos=r||0,""==t&&xt(i,n.state);while(!o.eol())bt(i,o,n.state),o.start=o.pos}function xt(e,t){if(e.blankLine)return e.blankLine(t);if(e.innerMode){var n=Ye(e,t);return n.mode.blankLine?n.mode.blankLine(n.state):void 0}}function bt(e,t,n,r){for(var i=0;i<10;i++){r&&(r[0]=Ye(e,n).mode);var o=e.token(t,n);if(t.pos>t.start)return o}throw new Error("Mode "+e.name+" failed to advance stream.")}mt.prototype.lookAhead=function(e){var t=this.doc.getLine(this.line+e);return null!=t&&e>this.maxLookAhead&&(this.maxLookAhead=e),t},mt.prototype.baseToken=function(e){var t=this;if(!this.baseTokens)return null;while(this.baseTokens[this.baseTokenPos]<=e)t.baseTokenPos+=2;var n=this.baseTokens[this.baseTokenPos+1];return{type:n&&n.replace(/( |^)overlay .*/,""),size:this.baseTokens[this.baseTokenPos]-e}},mt.prototype.nextLine=function(){this.line++,this.maxLookAhead>0&&this.maxLookAhead--},mt.fromSaved=function(e,t,n){return t instanceof pt?new mt(e,Xe(e.mode,t.state),n,t.lookAhead):new mt(e,Xe(e.mode,t),n)},mt.prototype.save=function(e){var t=!1!==e?Xe(this.doc.mode,this.state):this.state;return this.maxLookAhead>0?new pt(t,this.maxLookAhead):t};var wt=function(e,t,n){this.start=e.start,this.end=e.pos,this.string=e.current(),this.type=t||null,this.state=n};function At(e,t,n,r){var i,o=e.doc,a=o.mode;t=dt(o,t);var s,l=$e(o,t.line),u=yt(e,t.line,n),c=new Qe(l.text,e.options.tabSize,u);r&&(s=[]);while((r||c.pos<t.ch)&&!c.eol())c.start=c.pos,i=bt(a,c,u.state),r&&s.push(new wt(c,i,Xe(o.mode,u.state)));return r?s:new wt(c,i,u.state)}function Tt(e,t){if(e)for(;;){var n=e.match(/(?:^|\s+)line-(background-)?(\S+)/);if(!n)break;e=e.slice(0,n.index)+e.slice(n.index+n[0].length);var r=n[1]?"bgClass":"textClass";null==t[r]?t[r]=n[2]:new RegExp("(?:^|s)"+n[2]+"(?:$|s)").test(t[r])||(t[r]+=" "+n[2])}return e}function St(e,t,n,r,i,o,a){var s=n.flattenSpans;null==s&&(s=e.options.flattenSpans);var l,u=0,c=null,d=new Qe(t,e.options.tabSize,r),f=e.options.addModeClass&&[null];""==t&&Tt(xt(n,r.state),o);while(!d.eol()){if(d.pos>e.options.maxHighlightLength?(s=!1,a&&_t(e,t,r,d.pos),d.pos=t.length,l=null):l=Tt(bt(n,d,r.state,f),o),f){var h=f[0].name;h&&(l="m-"+(l?h+" "+l:h))}if(!s||c!=l){while(u<d.start)u=Math.min(d.start,u+5e3),i(u,c);c=l}d.start=d.pos}while(u<d.pos){var p=Math.min(d.pos,u+5e3);i(p,c),u=p}}function Et(e,t,n){for(var r,i,o=e.doc,a=n?-1:t-(e.doc.mode.innerMode?1e3:100),s=t;s>a;--s){if(s<=o.first)return o.first;var l=$e(o,s-1),u=l.stateAfter;if(u&&(!n||s+(u instanceof pt?u.lookAhead:0)<=o.modeFrontier))return s;var c=F(l.text,null,e.options.tabSize);(null==i||r>c)&&(i=s-1,r=c)}return i}function Ct(e,t){if(e.modeFrontier=Math.min(e.modeFrontier,t),!(e.highlightFrontier<t-10)){for(var n=e.first,r=t-1;r>n;r--){var i=$e(e,r).stateAfter;if(i&&(!(i instanceof pt)||r+i.lookAhead<t)){n=r+1;break}}e.highlightFrontier=Math.min(e.highlightFrontier,n)}}var Mt=!1,Lt=!1;function Nt(){Mt=!0}function Dt(){Lt=!0}function Ot(e,t,n){this.marker=e,this.from=t,this.to=n}function It(e,t){if(e)for(var n=0;n<e.length;++n){var r=e[n];if(r.marker==t)return r}}function Rt(e,t){for(var n,r=0;r<e.length;++r)e[r]!=t&&(n||(n=[])).push(e[r]);return n}function Pt(e,t){e.markedSpans=e.markedSpans?e.markedSpans.concat([t]):[t],t.marker.attachLine(e)}function kt(e,t,n){var r;if(e)for(var i=0;i<e.length;++i){var o=e[i],a=o.marker,s=null==o.from||(a.inclusiveLeft?o.from<=t:o.from<t);if(s||o.from==t&&"bookmark"==a.type&&(!n||!o.marker.insertLeft)){var l=null==o.to||(a.inclusiveRight?o.to>=t:o.to>t);(r||(r=[])).push(new Ot(a,o.from,l?null:o.to))}}return r}function Bt(e,t,n){var r;if(e)for(var i=0;i<e.length;++i){var o=e[i],a=o.marker,s=null==o.to||(a.inclusiveRight?o.to>=t:o.to>t);if(s||o.from==t&&"bookmark"==a.type&&(!n||o.marker.insertLeft)){var l=null==o.from||(a.inclusiveLeft?o.from<=t:o.from<t);(r||(r=[])).push(new Ot(a,l?null:o.from-t,null==o.to?null:o.to-t))}}return r}function Ft(e,t){if(t.full)return null;var n=nt(e,t.from.line)&&$e(e,t.from.line).markedSpans,r=nt(e,t.to.line)&&$e(e,t.to.line).markedSpans;if(!n&&!r)return null;var i=t.from.ch,o=t.to.ch,a=0==ot(t.from,t.to),s=kt(n,i,a),l=Bt(r,o,a),u=1==t.text.length,c=Q(t.text).length+(u?i:0);if(s)for(var d=0;d<s.length;++d){var f=s[d];if(null==f.to){var h=It(l,f.marker);h?u&&(f.to=null==h.to?null:h.to+c):f.to=i}}if(l)for(var p=0;p<l.length;++p){var m=l[p];if(null!=m.to&&(m.to+=c),null==m.from){var v=It(s,m.marker);v||(m.from=c,u&&(s||(s=[])).push(m))}else m.from+=c,u&&(s||(s=[])).push(m)}s&&(s=zt(s)),l&&l!=s&&(l=zt(l));var g=[s];if(!u){var y,_=t.text.length-2;if(_>0&&s)for(var x=0;x<s.length;++x)null==s[x].to&&(y||(y=[])).push(new Ot(s[x].marker,null,null));for(var b=0;b<_;++b)g.push(y);g.push(l)}return g}function zt(e){for(var t=0;t<e.length;++t){var n=e[t];null!=n.from&&n.from==n.to&&!1!==n.marker.clearWhenEmpty&&e.splice(t--,1)}return e.length?e:null}function Ht(e,t,n){var r=null;if(e.iter(t.line,n.line+1,(function(e){if(e.markedSpans)for(var t=0;t<e.markedSpans.length;++t){var n=e.markedSpans[t].marker;!n.readOnly||r&&-1!=H(r,n)||(r||(r=[])).push(n)}})),!r)return null;for(var i=[{from:t,to:n}],o=0;o<r.length;++o)for(var a=r[o],s=a.find(0),l=0;l<i.length;++l){var u=i[l];if(!(ot(u.to,s.from)<0||ot(u.from,s.to)>0)){var c=[l,1],d=ot(u.from,s.from),f=ot(u.to,s.to);(d<0||!a.inclusiveLeft&&!d)&&c.push({from:u.from,to:s.from}),(f>0||!a.inclusiveRight&&!f)&&c.push({from:s.to,to:u.to}),i.splice.apply(i,c),l+=c.length-3}}return i}function Ut(e){var t=e.markedSpans;if(t){for(var n=0;n<t.length;++n)t[n].marker.detachLine(e);e.markedSpans=null}}function Gt(e,t){if(t){for(var n=0;n<t.length;++n)t[n].marker.attachLine(e);e.markedSpans=t}}function Vt(e){return e.inclusiveLeft?-1:0}function jt(e){return e.inclusiveRight?1:0}function Wt(e,t){var n=e.lines.length-t.lines.length;if(0!=n)return n;var r=e.find(),i=t.find(),o=ot(r.from,i.from)||Vt(e)-Vt(t);if(o)return-o;var a=ot(r.to,i.to)||jt(e)-jt(t);return a||t.id-e.id}function Xt(e,t){var n,r=Lt&&e.markedSpans;if(r)for(var i=void 0,o=0;o<r.length;++o)i=r[o],i.marker.collapsed&&null==(t?i.from:i.to)&&(!n||Wt(n,i.marker)<0)&&(n=i.marker);return n}function Yt(e){return Xt(e,!0)}function qt(e){return Xt(e,!1)}function Qt(e,t){var n,r=Lt&&e.markedSpans;if(r)for(var i=0;i<r.length;++i){var o=r[i];o.marker.collapsed&&(null==o.from||o.from<t)&&(null==o.to||o.to>t)&&(!n||Wt(n,o.marker)<0)&&(n=o.marker)}return n}function $t(e,t,n,r,i){var o=$e(e,t),a=Lt&&o.markedSpans;if(a)for(var s=0;s<a.length;++s){var l=a[s];if(l.marker.collapsed){var u=l.marker.find(0),c=ot(u.from,n)||Vt(l.marker)-Vt(i),d=ot(u.to,r)||jt(l.marker)-jt(i);if(!(c>=0&&d<=0||c<=0&&d>=0)&&(c<=0&&(l.marker.inclusiveRight&&i.inclusiveLeft?ot(u.to,n)>=0:ot(u.to,n)>0)||c>=0&&(l.marker.inclusiveRight&&i.inclusiveLeft?ot(u.from,r)<=0:ot(u.from,r)<0)))return!0}}}function Kt(e){var t;while(t=Yt(e))e=t.find(-1,!0).line;return e}function Zt(e){var t;while(t=qt(e))e=t.find(1,!0).line;return e}function Jt(e){var t,n;while(t=qt(e))e=t.find(1,!0).line,(n||(n=[])).push(e);return n}function en(e,t){var n=$e(e,t),r=Kt(n);return n==r?t:et(r)}function tn(e,t){if(t>e.lastLine())return t;var n,r=$e(e,t);if(!nn(e,r))return t;while(n=qt(r))r=n.find(1,!0).line;return et(r)+1}function nn(e,t){var n=Lt&&t.markedSpans;if(n)for(var r=void 0,i=0;i<n.length;++i)if(r=n[i],r.marker.collapsed){if(null==r.from)return!0;if(!r.marker.widgetNode&&0==r.from&&r.marker.inclusiveLeft&&rn(e,t,r))return!0}}function rn(e,t,n){if(null==n.to){var r=n.marker.find(1,!0);return rn(e,r.line,It(r.line.markedSpans,n.marker))}if(n.marker.inclusiveRight&&n.to==t.text.length)return!0;for(var i=void 0,o=0;o<t.markedSpans.length;++o)if(i=t.markedSpans[o],i.marker.collapsed&&!i.marker.widgetNode&&i.from==n.to&&(null==i.to||i.to!=n.from)&&(i.marker.inclusiveLeft||n.marker.inclusiveRight)&&rn(e,t,i))return!0}function on(e){e=Kt(e);for(var t=0,n=e.parent,r=0;r<n.lines.length;++r){var i=n.lines[r];if(i==e)break;t+=i.height}for(var o=n.parent;o;n=o,o=n.parent)for(var a=0;a<o.children.length;++a){var s=o.children[a];if(s==n)break;t+=s.height}return t}function an(e){if(0==e.height)return 0;var t,n=e.text.length,r=e;while(t=Yt(r)){var i=t.find(0,!0);r=i.from.line,n+=i.from.ch-i.to.ch}r=e;while(t=qt(r)){var o=t.find(0,!0);n-=r.text.length-o.from.ch,r=o.to.line,n+=r.text.length-o.to.ch}return n}function sn(e){var t=e.display,n=e.doc;t.maxLine=$e(n,n.first),t.maxLineLength=an(t.maxLine),t.maxLineChanged=!0,n.iter((function(e){var n=an(e);n>t.maxLineLength&&(t.maxLineLength=n,t.maxLine=e)}))}var ln=function(e,t,n){this.text=e,Gt(this,t),this.height=n?n(this):1};function un(e,t,n,r){e.text=t,e.stateAfter&&(e.stateAfter=null),e.styles&&(e.styles=null),null!=e.order&&(e.order=null),Ut(e),Gt(e,n);var i=r?r(e):1;i!=e.height&&Je(e,i)}function cn(e){e.parent=null,Ut(e)}ln.prototype.lineNo=function(){return et(this)},be(ln);var dn={},fn={};function hn(e,t){if(!e||/^\s*$/.test(e))return null;var n=t.addModeClass?fn:dn;return n[e]||(n[e]=e.replace(/\S+/g,"cm-$&"))}function pn(e,t){var n=N("span",null,null,l?"padding-right: .1px":null),r={pre:N("pre",[n],"CodeMirror-line"),content:n,col:0,pos:0,cm:e,trailingSpace:!1,splitSpaces:e.getOption("lineWrapping")};t.measure={};for(var i=0;i<=(t.rest?t.rest.length:0);i++){var o=i?t.rest[i-1]:t.line,a=void 0;r.pos=0,r.addToken=vn,Oe(e.display.measure)&&(a=fe(o,e.doc.direction))&&(r.addToken=yn(r.addToken,a)),r.map=[];var s=t!=e.display.externalMeasured&&et(o);xn(o,r,gt(e,o,s)),o.styleClasses&&(o.styleClasses.bgClass&&(r.bgClass=R(o.styleClasses.bgClass,r.bgClass||"")),o.styleClasses.textClass&&(r.textClass=R(o.styleClasses.textClass,r.textClass||""))),0==r.map.length&&r.map.push(0,0,r.content.appendChild(De(e.display.measure))),0==i?(t.measure.map=r.map,t.measure.cache={}):((t.measure.maps||(t.measure.maps=[])).push(r.map),(t.measure.caches||(t.measure.caches=[])).push({}))}if(l){var u=r.content.lastChild;(/\bcm-tab\b/.test(u.className)||u.querySelector&&u.querySelector(".cm-tab"))&&(r.content.className="cm-tab-wrap-hack")}return ge(e,"renderLine",e,t.line,r.pre),r.pre.className&&(r.textClass=R(r.pre.className,r.textClass||"")),r}function mn(e){var t=L("span","•","cm-invalidchar");return t.title="\\u"+e.charCodeAt(0).toString(16),t.setAttribute("aria-label",t.title),t}function vn(e,t,n,r,i,o,l){if(t){var u,c=e.splitSpaces?gn(t,e.trailingSpace):t,d=e.cm.state.specialChars,f=!1;if(d.test(t)){u=document.createDocumentFragment();var h=0;while(1){d.lastIndex=h;var p=d.exec(t),m=p?p.index-h:t.length-h;if(m){var v=document.createTextNode(c.slice(h,h+m));a&&s<9?u.appendChild(L("span",[v])):u.appendChild(v),e.map.push(e.pos,e.pos+m,v),e.col+=m,e.pos+=m}if(!p)break;h+=m+1;var g=void 0;if("\t"==p[0]){var y=e.cm.options.tabSize,_=y-e.col%y;g=u.appendChild(L("span",q(_),"cm-tab")),g.setAttribute("role","presentation"),g.setAttribute("cm-text","\t"),e.col+=_}else"\r"==p[0]||"\n"==p[0]?(g=u.appendChild(L("span","\r"==p[0]?"␍":"␤","cm-invalidchar")),g.setAttribute("cm-text",p[0]),e.col+=1):(g=e.cm.options.specialCharPlaceholder(p[0]),g.setAttribute("cm-text",p[0]),a&&s<9?u.appendChild(L("span",[g])):u.appendChild(g),e.col+=1);e.map.push(e.pos,e.pos+1,g),e.pos++}}else e.col+=t.length,u=document.createTextNode(c),e.map.push(e.pos,e.pos+t.length,u),a&&s<9&&(f=!0),e.pos+=t.length;if(e.trailingSpace=32==c.charCodeAt(t.length-1),n||r||i||f||o){var x=n||"";r&&(x+=r),i&&(x+=i);var b=L("span",[u],x,o);if(l)for(var w in l)l.hasOwnProperty(w)&&"style"!=w&&"class"!=w&&b.setAttribute(w,l[w]);return e.content.appendChild(b)}e.content.appendChild(u)}}function gn(e,t){if(e.length>1&&!/  /.test(e))return e;for(var n=t,r="",i=0;i<e.length;i++){var o=e.charAt(i);" "!=o||!n||i!=e.length-1&&32!=e.charCodeAt(i+1)||(o=" "),r+=o,n=" "==o}return r}function yn(e,t){return function(n,r,i,o,a,s,l){i=i?i+" cm-force-border":"cm-force-border";for(var u=n.pos,c=u+r.length;;){for(var d=void 0,f=0;f<t.length;f++)if(d=t[f],d.to>u&&d.from<=u)break;if(d.to>=c)return e(n,r,i,o,a,s,l);e(n,r.slice(0,d.to-u),i,o,null,s,l),o=null,r=r.slice(d.to-u),u=d.to}}}function _n(e,t,n,r){var i=!r&&n.widgetNode;i&&e.map.push(e.pos,e.pos+t,i),!r&&e.cm.display.input.needsContentAttribute&&(i||(i=e.content.appendChild(document.createElement("span"))),i.setAttribute("cm-marker",n.id)),i&&(e.cm.display.input.setUneditable(i),e.content.appendChild(i)),e.pos+=t,e.trailingSpace=!1}function xn(e,t,n){var r=e.markedSpans,i=e.text,o=0;if(r)for(var a,s,l,u,c,d,f,h=i.length,p=0,m=1,v="",g=0;;){if(g==p){l=u=c=s="",f=null,d=null,g=1/0;for(var y=[],_=void 0,x=0;x<r.length;++x){var b=r[x],w=b.marker;if("bookmark"==w.type&&b.from==p&&w.widgetNode)y.push(w);else if(b.from<=p&&(null==b.to||b.to>p||w.collapsed&&b.to==p&&b.from==p)){if(null!=b.to&&b.to!=p&&g>b.to&&(g=b.to,u=""),w.className&&(l+=" "+w.className),w.css&&(s=(s?s+";":"")+w.css),w.startStyle&&b.from==p&&(c+=" "+w.startStyle),w.endStyle&&b.to==g&&(_||(_=[])).push(w.endStyle,b.to),w.title&&((f||(f={})).title=w.title),w.attributes)for(var A in w.attributes)(f||(f={}))[A]=w.attributes[A];w.collapsed&&(!d||Wt(d.marker,w)<0)&&(d=b)}else b.from>p&&g>b.from&&(g=b.from)}if(_)for(var T=0;T<_.length;T+=2)_[T+1]==g&&(u+=" "+_[T]);if(!d||d.from==p)for(var S=0;S<y.length;++S)_n(t,0,y[S]);if(d&&(d.from||0)==p){if(_n(t,(null==d.to?h+1:d.to)-p,d.marker,null==d.from),null==d.to)return;d.to==p&&(d=!1)}}if(p>=h)break;var E=Math.min(h,g);while(1){if(v){var C=p+v.length;if(!d){var M=C>E?v.slice(0,E-p):v;t.addToken(t,M,a?a+l:l,c,p+M.length==g?u:"",s,f)}if(C>=E){v=v.slice(E-p),p=E;break}p=C,c=""}v=i.slice(o,o=n[m++]),a=hn(n[m++],t.cm.options)}}else for(var L=1;L<n.length;L+=2)t.addToken(t,i.slice(o,o=n[L]),hn(n[L+1],t.cm.options))}function bn(e,t,n){this.line=t,this.rest=Jt(t),this.size=this.rest?et(Q(this.rest))-n+1:1,this.node=this.text=null,this.hidden=nn(e,t)}function wn(e,t,n){for(var r,i=[],o=t;o<n;o=r){var a=new bn(e.doc,$e(e.doc,o),o);r=o+a.size,i.push(a)}return i}var An=null;function Tn(e){An?An.ops.push(e):e.ownsGroup=An={ops:[e],delayedCallbacks:[]}}function Sn(e){var t=e.delayedCallbacks,n=0;do{for(;n<t.length;n++)t[n].call(null);for(var r=0;r<e.ops.length;r++){var i=e.ops[r];if(i.cursorActivityHandlers)while(i.cursorActivityCalled<i.cursorActivityHandlers.length)i.cursorActivityHandlers[i.cursorActivityCalled++].call(null,i.cm)}}while(n<t.length)}function En(e,t){var n=e.ownsGroup;if(n)try{Sn(n)}finally{An=null,t(n)}}var Cn=null;function Mn(e,t){var n=me(e,t);if(n.length){var r,i=Array.prototype.slice.call(arguments,2);An?r=An.delayedCallbacks:Cn?r=Cn:(r=Cn=[],setTimeout(Ln,0));for(var o=function(e){r.push((function(){return n[e].apply(null,i)}))},a=0;a<n.length;++a)o(a)}}function Ln(){var e=Cn;Cn=null;for(var t=0;t<e.length;++t)e[t]()}function Nn(e,t,n,r){for(var i=0;i<t.changes.length;i++){var o=t.changes[i];"text"==o?Rn(e,t):"gutter"==o?kn(e,t,n,r):"class"==o?Pn(e,t):"widget"==o&&Bn(e,t,r)}t.changes=null}function Dn(e){return e.node==e.text&&(e.node=L("div",null,null,"position: relative"),e.text.parentNode&&e.text.parentNode.replaceChild(e.node,e.text),e.node.appendChild(e.text),a&&s<8&&(e.node.style.zIndex=2)),e.node}function On(e,t){var n=t.bgClass?t.bgClass+" "+(t.line.bgClass||""):t.line.bgClass;if(n&&(n+=" CodeMirror-linebackground"),t.background)n?t.background.className=n:(t.background.parentNode.removeChild(t.background),t.background=null);else if(n){var r=Dn(t);t.background=r.insertBefore(L("div",null,n),r.firstChild),e.display.input.setUneditable(t.background)}}function In(e,t){var n=e.display.externalMeasured;return n&&n.line==t.line?(e.display.externalMeasured=null,t.measure=n.measure,n.built):pn(e,t)}function Rn(e,t){var n=t.text.className,r=In(e,t);t.text==t.node&&(t.node=r.pre),t.text.parentNode.replaceChild(r.pre,t.text),t.text=r.pre,r.bgClass!=t.bgClass||r.textClass!=t.textClass?(t.bgClass=r.bgClass,t.textClass=r.textClass,Pn(e,t)):n&&(t.text.className=n)}function Pn(e,t){On(e,t),t.line.wrapClass?Dn(t).className=t.line.wrapClass:t.node!=t.text&&(t.node.className="");var n=t.textClass?t.textClass+" "+(t.line.textClass||""):t.line.textClass;t.text.className=n||""}function kn(e,t,n,r){if(t.gutter&&(t.node.removeChild(t.gutter),t.gutter=null),t.gutterBackground&&(t.node.removeChild(t.gutterBackground),t.gutterBackground=null),t.line.gutterClass){var i=Dn(t);t.gutterBackground=L("div",null,"CodeMirror-gutter-background "+t.line.gutterClass,"left: "+(e.options.fixedGutter?r.fixedPos:-r.gutterTotalWidth)+"px; width: "+r.gutterTotalWidth+"px"),e.display.input.setUneditable(t.gutterBackground),i.insertBefore(t.gutterBackground,t.text)}var o=t.line.gutterMarkers;if(e.options.lineNumbers||o){var a=Dn(t),s=t.gutter=L("div",null,"CodeMirror-gutter-wrapper","left: "+(e.options.fixedGutter?r.fixedPos:-r.gutterTotalWidth)+"px");if(e.display.input.setUneditable(s),a.insertBefore(s,t.text),t.line.gutterClass&&(s.className+=" "+t.line.gutterClass),!e.options.lineNumbers||o&&o["CodeMirror-linenumbers"]||(t.lineNumber=s.appendChild(L("div",rt(e.options,n),"CodeMirror-linenumber CodeMirror-gutter-elt","left: "+r.gutterLeft["CodeMirror-linenumbers"]+"px; width: "+e.display.lineNumInnerWidth+"px"))),o)for(var l=0;l<e.display.gutterSpecs.length;++l){var u=e.display.gutterSpecs[l].className,c=o.hasOwnProperty(u)&&o[u];c&&s.appendChild(L("div",[c],"CodeMirror-gutter-elt","left: "+r.gutterLeft[u]+"px; width: "+r.gutterWidth[u]+"px"))}}}function Bn(e,t,n){t.alignable&&(t.alignable=null);for(var r=t.node.firstChild,i=void 0;r;r=i)i=r.nextSibling,"CodeMirror-linewidget"==r.className&&t.node.removeChild(r);zn(e,t,n)}function Fn(e,t,n,r){var i=In(e,t);return t.text=t.node=i.pre,i.bgClass&&(t.bgClass=i.bgClass),i.textClass&&(t.textClass=i.textClass),Pn(e,t),kn(e,t,n,r),zn(e,t,r),t.node}function zn(e,t,n){if(Hn(e,t.line,t,n,!0),t.rest)for(var r=0;r<t.rest.length;r++)Hn(e,t.rest[r],t,n,!1)}function Hn(e,t,n,r,i){if(t.widgets)for(var o=Dn(n),a=0,s=t.widgets;a<s.length;++a){var l=s[a],u=L("div",[l.node],"CodeMirror-linewidget");l.handleMouseEvents||u.setAttribute("cm-ignore-events","true"),Un(l,u,n,r),e.display.input.setUneditable(u),i&&l.above?o.insertBefore(u,n.gutter||n.text):o.appendChild(u),Mn(l,"redraw")}}function Un(e,t,n,r){if(e.noHScroll){(n.alignable||(n.alignable=[])).push(t);var i=r.wrapperWidth;t.style.left=r.fixedPos+"px",e.coverGutter||(i-=r.gutterTotalWidth,t.style.paddingLeft=r.gutterTotalWidth+"px"),t.style.width=i+"px"}e.coverGutter&&(t.style.zIndex=5,t.style.position="relative",e.noHScroll||(t.style.marginLeft=-r.gutterTotalWidth+"px"))}function Gn(e){if(null!=e.height)return e.height;var t=e.doc.cm;if(!t)return 0;if(!D(document.body,e.node)){var n="position: relative;";e.coverGutter&&(n+="margin-left: -"+t.display.gutters.offsetWidth+"px;"),e.noHScroll&&(n+="width: "+t.display.wrapper.clientWidth+"px;"),M(t.display.measure,L("div",[e.node],null,n))}return e.height=e.node.parentNode.offsetHeight}function Vn(e,t){for(var n=Ee(t);n!=e.wrapper;n=n.parentNode)if(!n||1==n.nodeType&&"true"==n.getAttribute("cm-ignore-events")||n.parentNode==e.sizer&&n!=e.mover)return!0}function jn(e){return e.lineSpace.offsetTop}function Wn(e){return e.mover.offsetHeight-e.lineSpace.offsetHeight}function Xn(e){if(e.cachedPaddingH)return e.cachedPaddingH;var t=M(e.measure,L("pre","x","CodeMirror-line-like")),n=window.getComputedStyle?window.getComputedStyle(t):t.currentStyle,r={left:parseInt(n.paddingLeft),right:parseInt(n.paddingRight)};return isNaN(r.left)||isNaN(r.right)||(e.cachedPaddingH=r),r}function Yn(e){return U-e.display.nativeBarWidth}function qn(e){return e.display.scroller.clientWidth-Yn(e)-e.display.barWidth}function Qn(e){return e.display.scroller.clientHeight-Yn(e)-e.display.barHeight}function $n(e,t,n){var r=e.options.lineWrapping,i=r&&qn(e);if(!t.measure.heights||r&&t.measure.width!=i){var o=t.measure.heights=[];if(r){t.measure.width=i;for(var a=t.text.firstChild.getClientRects(),s=0;s<a.length-1;s++){var l=a[s],u=a[s+1];Math.abs(l.bottom-u.bottom)>2&&o.push((l.bottom+u.top)/2-n.top)}}o.push(n.bottom-n.top)}}function Kn(e,t,n){if(e.line==t)return{map:e.measure.map,cache:e.measure.cache};for(var r=0;r<e.rest.length;r++)if(e.rest[r]==t)return{map:e.measure.maps[r],cache:e.measure.caches[r]};for(var i=0;i<e.rest.length;i++)if(et(e.rest[i])>n)return{map:e.measure.maps[i],cache:e.measure.caches[i],before:!0}}function Zn(e,t){t=Kt(t);var n=et(t),r=e.display.externalMeasured=new bn(e.doc,t,n);r.lineN=n;var i=r.built=pn(e,r);return r.text=i.pre,M(e.display.lineMeasure,i.pre),r}function Jn(e,t,n,r){return nr(e,tr(e,t),n,r)}function er(e,t){if(t>=e.display.viewFrom&&t<e.display.viewTo)return e.display.view[Pr(e,t)];var n=e.display.externalMeasured;return n&&t>=n.lineN&&t<n.lineN+n.size?n:void 0}function tr(e,t){var n=et(t),r=er(e,n);r&&!r.text?r=null:r&&r.changes&&(Nn(e,r,n,Nr(e)),e.curOp.forceUpdate=!0),r||(r=Zn(e,t));var i=Kn(r,t,n);return{line:t,view:r,rect:null,map:i.map,cache:i.cache,before:i.before,hasHeights:!1}}function nr(e,t,n,r,i){t.before&&(n=-1);var o,a=n+(r||"");return t.cache.hasOwnProperty(a)?o=t.cache[a]:(t.rect||(t.rect=t.view.text.getBoundingClientRect()),t.hasHeights||($n(e,t.view,t.rect),t.hasHeights=!0),o=sr(e,t,n,r),o.bogus||(t.cache[a]=o)),{left:o.left,right:o.right,top:i?o.rtop:o.top,bottom:i?o.rbottom:o.bottom}}var rr,ir={left:0,right:0,top:0,bottom:0};function or(e,t,n){for(var r,i,o,a,s,l,u=0;u<e.length;u+=3)if(s=e[u],l=e[u+1],t<s?(i=0,o=1,a="left"):t<l?(i=t-s,o=i+1):(u==e.length-3||t==l&&e[u+3]>t)&&(o=l-s,i=o-1,t>=l&&(a="right")),null!=i){if(r=e[u+2],s==l&&n==(r.insertLeft?"left":"right")&&(a=n),"left"==n&&0==i)while(u&&e[u-2]==e[u-3]&&e[u-1].insertLeft)r=e[2+(u-=3)],a="left";if("right"==n&&i==l-s)while(u<e.length-3&&e[u+3]==e[u+4]&&!e[u+5].insertLeft)r=e[(u+=3)+2],a="right";break}return{node:r,start:i,end:o,collapse:a,coverStart:s,coverEnd:l}}function ar(e,t){var n=ir;if("left"==t){for(var r=0;r<e.length;r++)if((n=e[r]).left!=n.right)break}else for(var i=e.length-1;i>=0;i--)if((n=e[i]).left!=n.right)break;return n}function sr(e,t,n,r){var i,o=or(t.map,n,r),l=o.node,u=o.start,c=o.end,d=o.collapse;if(3==l.nodeType){for(var f=0;f<4;f++){while(u&&oe(t.line.text.charAt(o.coverStart+u)))--u;while(o.coverStart+c<o.coverEnd&&oe(t.line.text.charAt(o.coverStart+c)))++c;if(i=a&&s<9&&0==u&&c==o.coverEnd-o.coverStart?l.parentNode.getBoundingClientRect():ar(S(l,u,c).getClientRects(),r),i.left||i.right||0==u)break;c=u,u-=1,d="right"}a&&s<11&&(i=lr(e.display.measure,i))}else{var h;u>0&&(d=r="right"),i=e.options.lineWrapping&&(h=l.getClientRects()).length>1?h["right"==r?h.length-1:0]:l.getBoundingClientRect()}if(a&&s<9&&!u&&(!i||!i.left&&!i.right)){var p=l.parentNode.getClientRects()[0];i=p?{left:p.left,right:p.left+Lr(e.display),top:p.top,bottom:p.bottom}:ir}for(var m=i.top-t.rect.top,v=i.bottom-t.rect.top,g=(m+v)/2,y=t.view.measure.heights,_=0;_<y.length-1;_++)if(g<y[_])break;var x=_?y[_-1]:0,b=y[_],w={left:("right"==d?i.right:i.left)-t.rect.left,right:("left"==d?i.left:i.right)-t.rect.left,top:x,bottom:b};return i.left||i.right||(w.bogus=!0),e.options.singleCursorHeightPerLine||(w.rtop=m,w.rbottom=v),w}function lr(e,t){if(!window.screen||null==screen.logicalXDPI||screen.logicalXDPI==screen.deviceXDPI||!Be(e))return t;var n=screen.logicalXDPI/screen.deviceXDPI,r=screen.logicalYDPI/screen.deviceYDPI;return{left:t.left*n,right:t.right*n,top:t.top*r,bottom:t.bottom*r}}function ur(e){if(e.measure&&(e.measure.cache={},e.measure.heights=null,e.rest))for(var t=0;t<e.rest.length;t++)e.measure.caches[t]={}}function cr(e){e.display.externalMeasure=null,C(e.display.lineMeasure);for(var t=0;t<e.display.view.length;t++)ur(e.display.view[t])}function dr(e){cr(e),e.display.cachedCharWidth=e.display.cachedTextHeight=e.display.cachedPaddingH=null,e.options.lineWrapping||(e.display.maxLineChanged=!0),e.display.lineNumChars=null}function fr(){return c&&v?-(document.body.getBoundingClientRect().left-parseInt(getComputedStyle(document.body).marginLeft)):window.pageXOffset||(document.documentElement||document.body).scrollLeft}function hr(){return c&&v?-(document.body.getBoundingClientRect().top-parseInt(getComputedStyle(document.body).marginTop)):window.pageYOffset||(document.documentElement||document.body).scrollTop}function pr(e){var t=0;if(e.widgets)for(var n=0;n<e.widgets.length;++n)e.widgets[n].above&&(t+=Gn(e.widgets[n]));return t}function mr(e,t,n,r,i){if(!i){var o=pr(t);n.top+=o,n.bottom+=o}if("line"==r)return n;r||(r="local");var a=on(t);if("local"==r?a+=jn(e.display):a-=e.display.viewOffset,"page"==r||"window"==r){var s=e.display.lineSpace.getBoundingClientRect();a+=s.top+("window"==r?0:hr());var l=s.left+("window"==r?0:fr());n.left+=l,n.right+=l}return n.top+=a,n.bottom+=a,n}function vr(e,t,n){if("div"==n)return t;var r=t.left,i=t.top;if("page"==n)r-=fr(),i-=hr();else if("local"==n||!n){var o=e.display.sizer.getBoundingClientRect();r+=o.left,i+=o.top}var a=e.display.lineSpace.getBoundingClientRect();return{left:r-a.left,top:i-a.top}}function gr(e,t,n,r,i){return r||(r=$e(e.doc,t.line)),mr(e,r,Jn(e,r,t.ch,i),n)}function yr(e,t,n,r,i,o){function a(t,a){var s=nr(e,i,t,a?"right":"left",o);return a?s.left=s.right:s.right=s.left,mr(e,r,s,n)}r=r||$e(e.doc,t.line),i||(i=tr(e,r));var s=fe(r,e.doc.direction),l=t.ch,u=t.sticky;if(l>=r.text.length?(l=r.text.length,u="before"):l<=0&&(l=0,u="after"),!s)return a("before"==u?l-1:l,"before"==u);function c(e,t,n){var r=s[t],i=1==r.level;return a(n?e-1:e,i!=n)}var d=ce(s,l,u),f=ue,h=c(l,d,"before"==u);return null!=f&&(h.other=c(l,f,"before"!=u)),h}function _r(e,t){var n=0;t=dt(e.doc,t),e.options.lineWrapping||(n=Lr(e.display)*t.ch);var r=$e(e.doc,t.line),i=on(r)+jn(e.display);return{left:n,right:n,top:i,bottom:i+r.height}}function xr(e,t,n,r,i){var o=it(e,t,n);return o.xRel=i,r&&(o.outside=r),o}function br(e,t,n){var r=e.doc;if(n+=e.display.viewOffset,n<0)return xr(r.first,0,null,-1,-1);var i=tt(r,n),o=r.first+r.size-1;if(i>o)return xr(r.first+r.size-1,$e(r,o).text.length,null,1,1);t<0&&(t=0);for(var a=$e(r,i);;){var s=Sr(e,a,i,t,n),l=Qt(a,s.ch+(s.xRel>0||s.outside>0?1:0));if(!l)return s;var u=l.find(1);if(u.line==i)return u;a=$e(r,i=u.line)}}function wr(e,t,n,r){r-=pr(t);var i=t.text.length,o=se((function(t){return nr(e,n,t-1).bottom<=r}),i,0);return i=se((function(t){return nr(e,n,t).top>r}),o,i),{begin:o,end:i}}function Ar(e,t,n,r){n||(n=tr(e,t));var i=mr(e,t,nr(e,n,r),"line").top;return wr(e,t,n,i)}function Tr(e,t,n,r){return!(e.bottom<=n)&&(e.top>n||(r?e.left:e.right)>t)}function Sr(e,t,n,r,i){i-=on(t);var o=tr(e,t),a=pr(t),s=0,l=t.text.length,u=!0,c=fe(t,e.doc.direction);if(c){var d=(e.options.lineWrapping?Cr:Er)(e,t,n,o,c,r,i);u=1!=d.level,s=u?d.from:d.to-1,l=u?d.to:d.from-1}var f,h,p=null,m=null,v=se((function(t){var n=nr(e,o,t);return n.top+=a,n.bottom+=a,!!Tr(n,r,i,!1)&&(n.top<=i&&n.left<=r&&(p=t,m=n),!0)}),s,l),g=!1;if(m){var y=r-m.left<m.right-r,_=y==u;v=p+(_?0:1),h=_?"after":"before",f=y?m.left:m.right}else{u||v!=l&&v!=s||v++,h=0==v?"after":v==t.text.length?"before":nr(e,o,v-(u?1:0)).bottom+a<=i==u?"after":"before";var x=yr(e,it(n,v,h),"line",t,o);f=x.left,g=i<x.top?-1:i>=x.bottom?1:0}return v=ae(t.text,v,1),xr(n,v,h,g,r-f)}function Er(e,t,n,r,i,o,a){var s=se((function(s){var l=i[s],u=1!=l.level;return Tr(yr(e,it(n,u?l.to:l.from,u?"before":"after"),"line",t,r),o,a,!0)}),0,i.length-1),l=i[s];if(s>0){var u=1!=l.level,c=yr(e,it(n,u?l.from:l.to,u?"after":"before"),"line",t,r);Tr(c,o,a,!0)&&c.top>a&&(l=i[s-1])}return l}function Cr(e,t,n,r,i,o,a){var s=wr(e,t,r,a),l=s.begin,u=s.end;/\s/.test(t.text.charAt(u-1))&&u--;for(var c=null,d=null,f=0;f<i.length;f++){var h=i[f];if(!(h.from>=u||h.to<=l)){var p=1!=h.level,m=nr(e,r,p?Math.min(u,h.to)-1:Math.max(l,h.from)).right,v=m<o?o-m+1e9:m-o;(!c||d>v)&&(c=h,d=v)}}return c||(c=i[i.length-1]),c.from<l&&(c={from:l,to:c.to,level:c.level}),c.to>u&&(c={from:c.from,to:u,level:c.level}),c}function Mr(e){if(null!=e.cachedTextHeight)return e.cachedTextHeight;if(null==rr){rr=L("pre",null,"CodeMirror-line-like");for(var t=0;t<49;++t)rr.appendChild(document.createTextNode("x")),rr.appendChild(L("br"));rr.appendChild(document.createTextNode("x"))}M(e.measure,rr);var n=rr.offsetHeight/50;return n>3&&(e.cachedTextHeight=n),C(e.measure),n||1}function Lr(e){if(null!=e.cachedCharWidth)return e.cachedCharWidth;var t=L("span","xxxxxxxxxx"),n=L("pre",[t],"CodeMirror-line-like");M(e.measure,n);var r=t.getBoundingClientRect(),i=(r.right-r.left)/10;return i>2&&(e.cachedCharWidth=i),i||10}function Nr(e){for(var t=e.display,n={},r={},i=t.gutters.clientLeft,o=t.gutters.firstChild,a=0;o;o=o.nextSibling,++a){var s=e.display.gutterSpecs[a].className;n[s]=o.offsetLeft+o.clientLeft+i,r[s]=o.clientWidth}return{fixedPos:Dr(t),gutterTotalWidth:t.gutters.offsetWidth,gutterLeft:n,gutterWidth:r,wrapperWidth:t.wrapper.clientWidth}}function Dr(e){return e.scroller.getBoundingClientRect().left-e.sizer.getBoundingClientRect().left}function Or(e){var t=Mr(e.display),n=e.options.lineWrapping,r=n&&Math.max(5,e.display.scroller.clientWidth/Lr(e.display)-3);return function(i){if(nn(e.doc,i))return 0;var o=0;if(i.widgets)for(var a=0;a<i.widgets.length;a++)i.widgets[a].height&&(o+=i.widgets[a].height);return n?o+(Math.ceil(i.text.length/r)||1)*t:o+t}}function Ir(e){var t=e.doc,n=Or(e);t.iter((function(e){var t=n(e);t!=e.height&&Je(e,t)}))}function Rr(e,t,n,r){var i=e.display;if(!n&&"true"==Ee(t).getAttribute("cm-not-content"))return null;var o,a,s=i.lineSpace.getBoundingClientRect();try{o=t.clientX-s.left,a=t.clientY-s.top}catch(t){return null}var l,u=br(e,o,a);if(r&&1==u.xRel&&(l=$e(e.doc,u.line).text).length==u.ch){var c=F(l,l.length,e.options.tabSize)-l.length;u=it(u.line,Math.max(0,Math.round((o-Xn(e.display).left)/Lr(e.display))-c))}return u}function Pr(e,t){if(t>=e.display.viewTo)return null;if(t-=e.display.viewFrom,t<0)return null;for(var n=e.display.view,r=0;r<n.length;r++)if(t-=n[r].size,t<0)return r}function kr(e,t,n,r){null==t&&(t=e.doc.first),null==n&&(n=e.doc.first+e.doc.size),r||(r=0);var i=e.display;if(r&&n<i.viewTo&&(null==i.updateLineNumbers||i.updateLineNumbers>t)&&(i.updateLineNumbers=t),e.curOp.viewChanged=!0,t>=i.viewTo)Lt&&en(e.doc,t)<i.viewTo&&Fr(e);else if(n<=i.viewFrom)Lt&&tn(e.doc,n+r)>i.viewFrom?Fr(e):(i.viewFrom+=r,i.viewTo+=r);else if(t<=i.viewFrom&&n>=i.viewTo)Fr(e);else if(t<=i.viewFrom){var o=zr(e,n,n+r,1);o?(i.view=i.view.slice(o.index),i.viewFrom=o.lineN,i.viewTo+=r):Fr(e)}else if(n>=i.viewTo){var a=zr(e,t,t,-1);a?(i.view=i.view.slice(0,a.index),i.viewTo=a.lineN):Fr(e)}else{var s=zr(e,t,t,-1),l=zr(e,n,n+r,1);s&&l?(i.view=i.view.slice(0,s.index).concat(wn(e,s.lineN,l.lineN)).concat(i.view.slice(l.index)),i.viewTo+=r):Fr(e)}var u=i.externalMeasured;u&&(n<u.lineN?u.lineN+=r:t<u.lineN+u.size&&(i.externalMeasured=null))}function Br(e,t,n){e.curOp.viewChanged=!0;var r=e.display,i=e.display.externalMeasured;if(i&&t>=i.lineN&&t<i.lineN+i.size&&(r.externalMeasured=null),!(t<r.viewFrom||t>=r.viewTo)){var o=r.view[Pr(e,t)];if(null!=o.node){var a=o.changes||(o.changes=[]);-1==H(a,n)&&a.push(n)}}}function Fr(e){e.display.viewFrom=e.display.viewTo=e.doc.first,e.display.view=[],e.display.viewOffset=0}function zr(e,t,n,r){var i,o=Pr(e,t),a=e.display.view;if(!Lt||n==e.doc.first+e.doc.size)return{index:o,lineN:n};for(var s=e.display.viewFrom,l=0;l<o;l++)s+=a[l].size;if(s!=t){if(r>0){if(o==a.length-1)return null;i=s+a[o].size-t,o++}else i=s-t;t+=i,n+=i}while(en(e.doc,n)!=n){if(o==(r<0?0:a.length-1))return null;n+=r*a[o-(r<0?1:0)].size,o+=r}return{index:o,lineN:n}}function Hr(e,t,n){var r=e.display,i=r.view;0==i.length||t>=r.viewTo||n<=r.viewFrom?(r.view=wn(e,t,n),r.viewFrom=t):(r.viewFrom>t?r.view=wn(e,t,r.viewFrom).concat(r.view):r.viewFrom<t&&(r.view=r.view.slice(Pr(e,t))),r.viewFrom=t,r.viewTo<n?r.view=r.view.concat(wn(e,r.viewTo,n)):r.viewTo>n&&(r.view=r.view.slice(0,Pr(e,n)))),r.viewTo=n}function Ur(e){for(var t=e.display.view,n=0,r=0;r<t.length;r++){var i=t[r];i.hidden||i.node&&!i.changes||++n}return n}function Gr(e){e.display.input.showSelection(e.display.input.prepareSelection())}function Vr(e,t){void 0===t&&(t=!0);for(var n=e.doc,r={},i=r.cursors=document.createDocumentFragment(),o=r.selection=document.createDocumentFragment(),a=0;a<n.sel.ranges.length;a++)if(t||a!=n.sel.primIndex){var s=n.sel.ranges[a];if(!(s.from().line>=e.display.viewTo||s.to().line<e.display.viewFrom)){var l=s.empty();(l||e.options.showCursorWhenSelecting)&&jr(e,s.head,i),l||Xr(e,s,o)}}return r}function jr(e,t,n){var r=yr(e,t,"div",null,null,!e.options.singleCursorHeightPerLine),i=n.appendChild(L("div"," ","CodeMirror-cursor"));if(i.style.left=r.left+"px",i.style.top=r.top+"px",i.style.height=Math.max(0,r.bottom-r.top)*e.options.cursorHeight+"px",r.other){var o=n.appendChild(L("div"," ","CodeMirror-cursor CodeMirror-secondarycursor"));o.style.display="",o.style.left=r.other.left+"px",o.style.top=r.other.top+"px",o.style.height=.85*(r.other.bottom-r.other.top)+"px"}}function Wr(e,t){return e.top-t.top||e.left-t.left}function Xr(e,t,n){var r=e.display,i=e.doc,o=document.createDocumentFragment(),a=Xn(e.display),s=a.left,l=Math.max(r.sizerWidth,qn(e)-r.sizer.offsetLeft)-a.right,u="ltr"==i.direction;function c(e,t,n,r){t<0&&(t=0),t=Math.round(t),r=Math.round(r),o.appendChild(L("div",null,"CodeMirror-selected","position: absolute; left: "+e+"px;\n                             top: "+t+"px; width: "+(null==n?l-e:n)+"px;\n                             height: "+(r-t)+"px"))}function d(t,n,r){var o,a,d=$e(i,t),f=d.text.length;function h(n,r){return gr(e,it(t,n),"div",d,r)}function p(t,n,r){var i=Ar(e,d,null,t),o="ltr"==n==("after"==r)?"left":"right",a="after"==r?i.begin:i.end-(/\s/.test(d.text.charAt(i.end-1))?2:1);return h(a,o)[o]}var m=fe(d,i.direction);return le(m,n||0,null==r?f:r,(function(e,t,i,d){var v="ltr"==i,g=h(e,v?"left":"right"),y=h(t-1,v?"right":"left"),_=null==n&&0==e,x=null==r&&t==f,b=0==d,w=!m||d==m.length-1;if(y.top-g.top<=3){var A=(u?_:x)&&b,T=(u?x:_)&&w,S=A?s:(v?g:y).left,E=T?l:(v?y:g).right;c(S,g.top,E-S,g.bottom)}else{var C,M,L,N;v?(C=u&&_&&b?s:g.left,M=u?l:p(e,i,"before"),L=u?s:p(t,i,"after"),N=u&&x&&w?l:y.right):(C=u?p(e,i,"before"):s,M=!u&&_&&b?l:g.right,L=!u&&x&&w?s:y.left,N=u?p(t,i,"after"):l),c(C,g.top,M-C,g.bottom),g.bottom<y.top&&c(s,g.bottom,null,y.top),c(L,y.top,N-L,y.bottom)}(!o||Wr(g,o)<0)&&(o=g),Wr(y,o)<0&&(o=y),(!a||Wr(g,a)<0)&&(a=g),Wr(y,a)<0&&(a=y)})),{start:o,end:a}}var f=t.from(),h=t.to();if(f.line==h.line)d(f.line,f.ch,h.ch);else{var p=$e(i,f.line),m=$e(i,h.line),v=Kt(p)==Kt(m),g=d(f.line,f.ch,v?p.text.length+1:null).end,y=d(h.line,v?0:null,h.ch).start;v&&(g.top<y.top-2?(c(g.right,g.top,null,g.bottom),c(s,y.top,y.left,y.bottom)):c(g.right,g.top,y.left-g.right,g.bottom)),g.bottom<y.top&&c(s,g.bottom,null,y.top)}n.appendChild(o)}function Yr(e){if(e.state.focused){var t=e.display;clearInterval(t.blinker);var n=!0;t.cursorDiv.style.visibility="",e.options.cursorBlinkRate>0?t.blinker=setInterval((function(){return t.cursorDiv.style.visibility=(n=!n)?"":"hidden"}),e.options.cursorBlinkRate):e.options.cursorBlinkRate<0&&(t.cursorDiv.style.visibility="hidden")}}function qr(e){e.state.focused||(e.display.input.focus(),$r(e))}function Qr(e){e.state.delayingBlurEvent=!0,setTimeout((function(){e.state.delayingBlurEvent&&(e.state.delayingBlurEvent=!1,Kr(e))}),100)}function $r(e,t){e.state.delayingBlurEvent&&(e.state.delayingBlurEvent=!1),"nocursor"!=e.options.readOnly&&(e.state.focused||(ge(e,"focus",e,t),e.state.focused=!0,I(e.display.wrapper,"CodeMirror-focused"),e.curOp||e.display.selForContextMenu==e.doc.sel||(e.display.input.reset(),l&&setTimeout((function(){return e.display.input.reset(!0)}),20)),e.display.input.receivedFocus()),Yr(e))}function Kr(e,t){e.state.delayingBlurEvent||(e.state.focused&&(ge(e,"blur",e,t),e.state.focused=!1,E(e.display.wrapper,"CodeMirror-focused")),clearInterval(e.display.blinker),setTimeout((function(){e.state.focused||(e.display.shift=!1)}),150))}function Zr(e){for(var t=e.display,n=t.lineDiv.offsetTop,r=0;r<t.view.length;r++){var i=t.view[r],o=e.options.lineWrapping,l=void 0,u=0;if(!i.hidden){if(a&&s<8){var c=i.node.offsetTop+i.node.offsetHeight;l=c-n,n=c}else{var d=i.node.getBoundingClientRect();l=d.bottom-d.top,!o&&i.text.firstChild&&(u=i.text.firstChild.getBoundingClientRect().right-d.left-1)}var f=i.line.height-l;if((f>.005||f<-.005)&&(Je(i.line,l),Jr(i.line),i.rest))for(var h=0;h<i.rest.length;h++)Jr(i.rest[h]);if(u>e.display.sizerWidth){var p=Math.ceil(u/Lr(e.display));p>e.display.maxLineLength&&(e.display.maxLineLength=p,e.display.maxLine=i.line,e.display.maxLineChanged=!0)}}}}function Jr(e){if(e.widgets)for(var t=0;t<e.widgets.length;++t){var n=e.widgets[t],r=n.node.parentNode;r&&(n.height=r.offsetHeight)}}function ei(e,t,n){var r=n&&null!=n.top?Math.max(0,n.top):e.scroller.scrollTop;r=Math.floor(r-jn(e));var i=n&&null!=n.bottom?n.bottom:r+e.wrapper.clientHeight,o=tt(t,r),a=tt(t,i);if(n&&n.ensure){var s=n.ensure.from.line,l=n.ensure.to.line;s<o?(o=s,a=tt(t,on($e(t,s))+e.wrapper.clientHeight)):Math.min(l,t.lastLine())>=a&&(o=tt(t,on($e(t,l))-e.wrapper.clientHeight),a=l)}return{from:o,to:Math.max(a,o+1)}}function ti(e,t){if(!ye(e,"scrollCursorIntoView")){var n=e.display,r=n.sizer.getBoundingClientRect(),i=null;if(t.top+r.top<0?i=!0:t.bottom+r.top>(window.innerHeight||document.documentElement.clientHeight)&&(i=!1),null!=i&&!p){var o=L("div","​",null,"position: absolute;\n                         top: "+(t.top-n.viewOffset-jn(e.display))+"px;\n                         height: "+(t.bottom-t.top+Yn(e)+n.barHeight)+"px;\n                         left: "+t.left+"px; width: "+Math.max(2,t.right-t.left)+"px;");e.display.lineSpace.appendChild(o),o.scrollIntoView(i),e.display.lineSpace.removeChild(o)}}}function ni(e,t,n,r){var i;null==r&&(r=0),e.options.lineWrapping||t!=n||(t=t.ch?it(t.line,"before"==t.sticky?t.ch-1:t.ch,"after"):t,n="before"==t.sticky?it(t.line,t.ch+1,"before"):t);for(var o=0;o<5;o++){var a=!1,s=yr(e,t),l=n&&n!=t?yr(e,n):s;i={left:Math.min(s.left,l.left),top:Math.min(s.top,l.top)-r,right:Math.max(s.left,l.left),bottom:Math.max(s.bottom,l.bottom)+r};var u=ii(e,i),c=e.doc.scrollTop,d=e.doc.scrollLeft;if(null!=u.scrollTop&&(di(e,u.scrollTop),Math.abs(e.doc.scrollTop-c)>1&&(a=!0)),null!=u.scrollLeft&&(hi(e,u.scrollLeft),Math.abs(e.doc.scrollLeft-d)>1&&(a=!0)),!a)break}return i}function ri(e,t){var n=ii(e,t);null!=n.scrollTop&&di(e,n.scrollTop),null!=n.scrollLeft&&hi(e,n.scrollLeft)}function ii(e,t){var n=e.display,r=Mr(e.display);t.top<0&&(t.top=0);var i=e.curOp&&null!=e.curOp.scrollTop?e.curOp.scrollTop:n.scroller.scrollTop,o=Qn(e),a={};t.bottom-t.top>o&&(t.bottom=t.top+o);var s=e.doc.height+Wn(n),l=t.top<r,u=t.bottom>s-r;if(t.top<i)a.scrollTop=l?0:t.top;else if(t.bottom>i+o){var c=Math.min(t.top,(u?s:t.bottom)-o);c!=i&&(a.scrollTop=c)}var d=e.curOp&&null!=e.curOp.scrollLeft?e.curOp.scrollLeft:n.scroller.scrollLeft,f=qn(e)-(e.options.fixedGutter?n.gutters.offsetWidth:0),h=t.right-t.left>f;return h&&(t.right=t.left+f),t.left<10?a.scrollLeft=0:t.left<d?a.scrollLeft=Math.max(0,t.left-(h?0:10)):t.right>f+d-3&&(a.scrollLeft=t.right+(h?0:10)-f),a}function oi(e,t){null!=t&&(ui(e),e.curOp.scrollTop=(null==e.curOp.scrollTop?e.doc.scrollTop:e.curOp.scrollTop)+t)}function ai(e){ui(e);var t=e.getCursor();e.curOp.scrollToPos={from:t,to:t,margin:e.options.cursorScrollMargin}}function si(e,t,n){null==t&&null==n||ui(e),null!=t&&(e.curOp.scrollLeft=t),null!=n&&(e.curOp.scrollTop=n)}function li(e,t){ui(e),e.curOp.scrollToPos=t}function ui(e){var t=e.curOp.scrollToPos;if(t){e.curOp.scrollToPos=null;var n=_r(e,t.from),r=_r(e,t.to);ci(e,n,r,t.margin)}}function ci(e,t,n,r){var i=ii(e,{left:Math.min(t.left,n.left),top:Math.min(t.top,n.top)-r,right:Math.max(t.right,n.right),bottom:Math.max(t.bottom,n.bottom)+r});si(e,i.scrollLeft,i.scrollTop)}function di(e,t){Math.abs(e.doc.scrollTop-t)<2||(n||Gi(e,{top:t}),fi(e,t,!0),n&&Gi(e),Ri(e,100))}function fi(e,t,n){t=Math.min(e.display.scroller.scrollHeight-e.display.scroller.clientHeight,t),(e.display.scroller.scrollTop!=t||n)&&(e.doc.scrollTop=t,e.display.scrollbars.setScrollTop(t),e.display.scroller.scrollTop!=t&&(e.display.scroller.scrollTop=t))}function hi(e,t,n,r){t=Math.min(t,e.display.scroller.scrollWidth-e.display.scroller.clientWidth),(n?t==e.doc.scrollLeft:Math.abs(e.doc.scrollLeft-t)<2)&&!r||(e.doc.scrollLeft=t,Xi(e),e.display.scroller.scrollLeft!=t&&(e.display.scroller.scrollLeft=t),e.display.scrollbars.setScrollLeft(t))}function pi(e){var t=e.display,n=t.gutters.offsetWidth,r=Math.round(e.doc.height+Wn(e.display));return{clientHeight:t.scroller.clientHeight,viewHeight:t.wrapper.clientHeight,scrollWidth:t.scroller.scrollWidth,clientWidth:t.scroller.clientWidth,viewWidth:t.wrapper.clientWidth,barLeft:e.options.fixedGutter?n:0,docHeight:r,scrollHeight:r+Yn(e)+t.barHeight,nativeBarWidth:t.nativeBarWidth,gutterWidth:n}}var mi=function(e,t,n){this.cm=n;var r=this.vert=L("div",[L("div",null,null,"min-width: 1px")],"CodeMirror-vscrollbar"),i=this.horiz=L("div",[L("div",null,null,"height: 100%; min-height: 1px")],"CodeMirror-hscrollbar");r.tabIndex=i.tabIndex=-1,e(r),e(i),pe(r,"scroll",(function(){r.clientHeight&&t(r.scrollTop,"vertical")})),pe(i,"scroll",(function(){i.clientWidth&&t(i.scrollLeft,"horizontal")})),this.checkedZeroWidth=!1,a&&s<8&&(this.horiz.style.minHeight=this.vert.style.minWidth="18px")};mi.prototype.update=function(e){var t=e.scrollWidth>e.clientWidth+1,n=e.scrollHeight>e.clientHeight+1,r=e.nativeBarWidth;if(n){this.vert.style.display="block",this.vert.style.bottom=t?r+"px":"0";var i=e.viewHeight-(t?r:0);this.vert.firstChild.style.height=Math.max(0,e.scrollHeight-e.clientHeight+i)+"px"}else this.vert.style.display="",this.vert.firstChild.style.height="0";if(t){this.horiz.style.display="block",this.horiz.style.right=n?r+"px":"0",this.horiz.style.left=e.barLeft+"px";var o=e.viewWidth-e.barLeft-(n?r:0);this.horiz.firstChild.style.width=Math.max(0,e.scrollWidth-e.clientWidth+o)+"px"}else this.horiz.style.display="",this.horiz.firstChild.style.width="0";return!this.checkedZeroWidth&&e.clientHeight>0&&(0==r&&this.zeroWidthHack(),this.checkedZeroWidth=!0),{right:n?r:0,bottom:t?r:0}},mi.prototype.setScrollLeft=function(e){this.horiz.scrollLeft!=e&&(this.horiz.scrollLeft=e),this.disableHoriz&&this.enableZeroWidthBar(this.horiz,this.disableHoriz,"horiz")},mi.prototype.setScrollTop=function(e){this.vert.scrollTop!=e&&(this.vert.scrollTop=e),this.disableVert&&this.enableZeroWidthBar(this.vert,this.disableVert,"vert")},mi.prototype.zeroWidthHack=function(){var e=y&&!h?"12px":"18px";this.horiz.style.height=this.vert.style.width=e,this.horiz.style.pointerEvents=this.vert.style.pointerEvents="none",this.disableHoriz=new z,this.disableVert=new z},mi.prototype.enableZeroWidthBar=function(e,t,n){function r(){var i=e.getBoundingClientRect(),o="vert"==n?document.elementFromPoint(i.right-1,(i.top+i.bottom)/2):document.elementFromPoint((i.right+i.left)/2,i.bottom-1);o!=e?e.style.pointerEvents="none":t.set(1e3,r)}e.style.pointerEvents="auto",t.set(1e3,r)},mi.prototype.clear=function(){var e=this.horiz.parentNode;e.removeChild(this.horiz),e.removeChild(this.vert)};var vi=function(){};function gi(e,t){t||(t=pi(e));var n=e.display.barWidth,r=e.display.barHeight;yi(e,t);for(var i=0;i<4&&n!=e.display.barWidth||r!=e.display.barHeight;i++)n!=e.display.barWidth&&e.options.lineWrapping&&Zr(e),yi(e,pi(e)),n=e.display.barWidth,r=e.display.barHeight}function yi(e,t){var n=e.display,r=n.scrollbars.update(t);n.sizer.style.paddingRight=(n.barWidth=r.right)+"px",n.sizer.style.paddingBottom=(n.barHeight=r.bottom)+"px",n.heightForcer.style.borderBottom=r.bottom+"px solid transparent",r.right&&r.bottom?(n.scrollbarFiller.style.display="block",n.scrollbarFiller.style.height=r.bottom+"px",n.scrollbarFiller.style.width=r.right+"px"):n.scrollbarFiller.style.display="",r.bottom&&e.options.coverGutterNextToScrollbar&&e.options.fixedGutter?(n.gutterFiller.style.display="block",n.gutterFiller.style.height=r.bottom+"px",n.gutterFiller.style.width=t.gutterWidth+"px"):n.gutterFiller.style.display=""}vi.prototype.update=function(){return{bottom:0,right:0}},vi.prototype.setScrollLeft=function(){},vi.prototype.setScrollTop=function(){},vi.prototype.clear=function(){};var _i={native:mi,null:vi};function xi(e){e.display.scrollbars&&(e.display.scrollbars.clear(),e.display.scrollbars.addClass&&E(e.display.wrapper,e.display.scrollbars.addClass)),e.display.scrollbars=new _i[e.options.scrollbarStyle]((function(t){e.display.wrapper.insertBefore(t,e.display.scrollbarFiller),pe(t,"mousedown",(function(){e.state.focused&&setTimeout((function(){return e.display.input.focus()}),0)})),t.setAttribute("cm-not-content","true")}),(function(t,n){"horizontal"==n?hi(e,t):di(e,t)}),e),e.display.scrollbars.addClass&&I(e.display.wrapper,e.display.scrollbars.addClass)}var bi=0;function wi(e){e.curOp={cm:e,viewChanged:!1,startHeight:e.doc.height,forceUpdate:!1,updateInput:0,typing:!1,changeObjs:null,cursorActivityHandlers:null,cursorActivityCalled:0,selectionChanged:!1,updateMaxLine:!1,scrollLeft:null,scrollTop:null,scrollToPos:null,focus:!1,id:++bi},Tn(e.curOp)}function Ai(e){var t=e.curOp;t&&En(t,(function(e){for(var t=0;t<e.ops.length;t++)e.ops[t].cm.curOp=null;Ti(e)}))}function Ti(e){for(var t=e.ops,n=0;n<t.length;n++)Si(t[n]);for(var r=0;r<t.length;r++)Ei(t[r]);for(var i=0;i<t.length;i++)Ci(t[i]);for(var o=0;o<t.length;o++)Mi(t[o]);for(var a=0;a<t.length;a++)Li(t[a])}function Si(e){var t=e.cm,n=t.display;Bi(t),e.updateMaxLine&&sn(t),e.mustUpdate=e.viewChanged||e.forceUpdate||null!=e.scrollTop||e.scrollToPos&&(e.scrollToPos.from.line<n.viewFrom||e.scrollToPos.to.line>=n.viewTo)||n.maxLineChanged&&t.options.lineWrapping,e.update=e.mustUpdate&&new ki(t,e.mustUpdate&&{top:e.scrollTop,ensure:e.scrollToPos},e.forceUpdate)}function Ei(e){e.updatedDisplay=e.mustUpdate&&Hi(e.cm,e.update)}function Ci(e){var t=e.cm,n=t.display;e.updatedDisplay&&Zr(t),e.barMeasure=pi(t),n.maxLineChanged&&!t.options.lineWrapping&&(e.adjustWidthTo=Jn(t,n.maxLine,n.maxLine.text.length).left+3,t.display.sizerWidth=e.adjustWidthTo,e.barMeasure.scrollWidth=Math.max(n.scroller.clientWidth,n.sizer.offsetLeft+e.adjustWidthTo+Yn(t)+t.display.barWidth),e.maxScrollLeft=Math.max(0,n.sizer.offsetLeft+e.adjustWidthTo-qn(t))),(e.updatedDisplay||e.selectionChanged)&&(e.preparedSelection=n.input.prepareSelection())}function Mi(e){var t=e.cm;null!=e.adjustWidthTo&&(t.display.sizer.style.minWidth=e.adjustWidthTo+"px",e.maxScrollLeft<t.doc.scrollLeft&&hi(t,Math.min(t.display.scroller.scrollLeft,e.maxScrollLeft),!0),t.display.maxLineChanged=!1);var n=e.focus&&e.focus==O();e.preparedSelection&&t.display.input.showSelection(e.preparedSelection,n),(e.updatedDisplay||e.startHeight!=t.doc.height)&&gi(t,e.barMeasure),e.updatedDisplay&&Wi(t,e.barMeasure),e.selectionChanged&&Yr(t),t.state.focused&&e.updateInput&&t.display.input.reset(e.typing),n&&qr(e.cm)}function Li(e){var t=e.cm,n=t.display,r=t.doc;if(e.updatedDisplay&&Ui(t,e.update),null==n.wheelStartX||null==e.scrollTop&&null==e.scrollLeft&&!e.scrollToPos||(n.wheelStartX=n.wheelStartY=null),null!=e.scrollTop&&fi(t,e.scrollTop,e.forceScroll),null!=e.scrollLeft&&hi(t,e.scrollLeft,!0,!0),e.scrollToPos){var i=ni(t,dt(r,e.scrollToPos.from),dt(r,e.scrollToPos.to),e.scrollToPos.margin);ti(t,i)}var o=e.maybeHiddenMarkers,a=e.maybeUnhiddenMarkers;if(o)for(var s=0;s<o.length;++s)o[s].lines.length||ge(o[s],"hide");if(a)for(var l=0;l<a.length;++l)a[l].lines.length&&ge(a[l],"unhide");n.wrapper.offsetHeight&&(r.scrollTop=t.display.scroller.scrollTop),e.changeObjs&&ge(t,"changes",t,e.changeObjs),e.update&&e.update.finish()}function Ni(e,t){if(e.curOp)return t();wi(e);try{return t()}finally{Ai(e)}}function Di(e,t){return function(){if(e.curOp)return t.apply(e,arguments);wi(e);try{return t.apply(e,arguments)}finally{Ai(e)}}}function Oi(e){return function(){if(this.curOp)return e.apply(this,arguments);wi(this);try{return e.apply(this,arguments)}finally{Ai(this)}}}function Ii(e){return function(){var t=this.cm;if(!t||t.curOp)return e.apply(this,arguments);wi(t);try{return e.apply(this,arguments)}finally{Ai(t)}}}function Ri(e,t){e.doc.highlightFrontier<e.display.viewTo&&e.state.highlight.set(t,k(Pi,e))}function Pi(e){var t=e.doc;if(!(t.highlightFrontier>=e.display.viewTo)){var n=+new Date+e.options.workTime,r=yt(e,t.highlightFrontier),i=[];t.iter(r.line,Math.min(t.first+t.size,e.display.viewTo+500),(function(o){if(r.line>=e.display.viewFrom){var a=o.styles,s=o.text.length>e.options.maxHighlightLength?Xe(t.mode,r.state):null,l=vt(e,o,r,!0);s&&(r.state=s),o.styles=l.styles;var u=o.styleClasses,c=l.classes;c?o.styleClasses=c:u&&(o.styleClasses=null);for(var d=!a||a.length!=o.styles.length||u!=c&&(!u||!c||u.bgClass!=c.bgClass||u.textClass!=c.textClass),f=0;!d&&f<a.length;++f)d=a[f]!=o.styles[f];d&&i.push(r.line),o.stateAfter=r.save(),r.nextLine()}else o.text.length<=e.options.maxHighlightLength&&_t(e,o.text,r),o.stateAfter=r.line%5==0?r.save():null,r.nextLine();if(+new Date>n)return Ri(e,e.options.workDelay),!0})),t.highlightFrontier=r.line,t.modeFrontier=Math.max(t.modeFrontier,r.line),i.length&&Ni(e,(function(){for(var t=0;t<i.length;t++)Br(e,i[t],"text")}))}}var ki=function(e,t,n){var r=e.display;this.viewport=t,this.visible=ei(r,e.doc,t),this.editorIsHidden=!r.wrapper.offsetWidth,this.wrapperHeight=r.wrapper.clientHeight,this.wrapperWidth=r.wrapper.clientWidth,this.oldDisplayWidth=qn(e),this.force=n,this.dims=Nr(e),this.events=[]};function Bi(e){var t=e.display;!t.scrollbarsClipped&&t.scroller.offsetWidth&&(t.nativeBarWidth=t.scroller.offsetWidth-t.scroller.clientWidth,t.heightForcer.style.height=Yn(e)+"px",t.sizer.style.marginBottom=-t.nativeBarWidth+"px",t.sizer.style.borderRightWidth=Yn(e)+"px",t.scrollbarsClipped=!0)}function Fi(e){if(e.hasFocus())return null;var t=O();if(!t||!D(e.display.lineDiv,t))return null;var n={activeElt:t};if(window.getSelection){var r=window.getSelection();r.anchorNode&&r.extend&&D(e.display.lineDiv,r.anchorNode)&&(n.anchorNode=r.anchorNode,n.anchorOffset=r.anchorOffset,n.focusNode=r.focusNode,n.focusOffset=r.focusOffset)}return n}function zi(e){if(e&&e.activeElt&&e.activeElt!=O()&&(e.activeElt.focus(),e.anchorNode&&D(document.body,e.anchorNode)&&D(document.body,e.focusNode))){var t=window.getSelection(),n=document.createRange();n.setEnd(e.anchorNode,e.anchorOffset),n.collapse(!1),t.removeAllRanges(),t.addRange(n),t.extend(e.focusNode,e.focusOffset)}}function Hi(e,t){var n=e.display,r=e.doc;if(t.editorIsHidden)return Fr(e),!1;if(!t.force&&t.visible.from>=n.viewFrom&&t.visible.to<=n.viewTo&&(null==n.updateLineNumbers||n.updateLineNumbers>=n.viewTo)&&n.renderedView==n.view&&0==Ur(e))return!1;Yi(e)&&(Fr(e),t.dims=Nr(e));var i=r.first+r.size,o=Math.max(t.visible.from-e.options.viewportMargin,r.first),a=Math.min(i,t.visible.to+e.options.viewportMargin);n.viewFrom<o&&o-n.viewFrom<20&&(o=Math.max(r.first,n.viewFrom)),n.viewTo>a&&n.viewTo-a<20&&(a=Math.min(i,n.viewTo)),Lt&&(o=en(e.doc,o),a=tn(e.doc,a));var s=o!=n.viewFrom||a!=n.viewTo||n.lastWrapHeight!=t.wrapperHeight||n.lastWrapWidth!=t.wrapperWidth;Hr(e,o,a),n.viewOffset=on($e(e.doc,n.viewFrom)),e.display.mover.style.top=n.viewOffset+"px";var l=Ur(e);if(!s&&0==l&&!t.force&&n.renderedView==n.view&&(null==n.updateLineNumbers||n.updateLineNumbers>=n.viewTo))return!1;var u=Fi(e);return l>4&&(n.lineDiv.style.display="none"),Vi(e,n.updateLineNumbers,t.dims),l>4&&(n.lineDiv.style.display=""),n.renderedView=n.view,zi(u),C(n.cursorDiv),C(n.selectionDiv),n.gutters.style.height=n.sizer.style.minHeight=0,s&&(n.lastWrapHeight=t.wrapperHeight,n.lastWrapWidth=t.wrapperWidth,Ri(e,400)),n.updateLineNumbers=null,!0}function Ui(e,t){for(var n=t.viewport,r=!0;;r=!1){if((!r||!e.options.lineWrapping||t.oldDisplayWidth==qn(e))&&(n&&null!=n.top&&(n={top:Math.min(e.doc.height+Wn(e.display)-Qn(e),n.top)}),t.visible=ei(e.display,e.doc,n),t.visible.from>=e.display.viewFrom&&t.visible.to<=e.display.viewTo))break;if(!Hi(e,t))break;Zr(e);var i=pi(e);Gr(e),gi(e,i),Wi(e,i),t.force=!1}t.signal(e,"update",e),e.display.viewFrom==e.display.reportedViewFrom&&e.display.viewTo==e.display.reportedViewTo||(t.signal(e,"viewportChange",e,e.display.viewFrom,e.display.viewTo),e.display.reportedViewFrom=e.display.viewFrom,e.display.reportedViewTo=e.display.viewTo)}function Gi(e,t){var n=new ki(e,t);if(Hi(e,n)){Zr(e),Ui(e,n);var r=pi(e);Gr(e),gi(e,r),Wi(e,r),n.finish()}}function Vi(e,t,n){var r=e.display,i=e.options.lineNumbers,o=r.lineDiv,a=o.firstChild;function s(t){var n=t.nextSibling;return l&&y&&e.display.currentWheelTarget==t?t.style.display="none":t.parentNode.removeChild(t),n}for(var u=r.view,c=r.viewFrom,d=0;d<u.length;d++){var f=u[d];if(f.hidden);else if(f.node&&f.node.parentNode==o){while(a!=f.node)a=s(a);var h=i&&null!=t&&t<=c&&f.lineNumber;f.changes&&(H(f.changes,"gutter")>-1&&(h=!1),Nn(e,f,c,n)),h&&(C(f.lineNumber),f.lineNumber.appendChild(document.createTextNode(rt(e.options,c)))),a=f.node.nextSibling}else{var p=Fn(e,f,c,n);o.insertBefore(p,a)}c+=f.size}while(a)a=s(a)}function ji(e){var t=e.gutters.offsetWidth;e.sizer.style.marginLeft=t+"px"}function Wi(e,t){e.display.sizer.style.minHeight=t.docHeight+"px",e.display.heightForcer.style.top=t.docHeight+"px",e.display.gutters.style.height=t.docHeight+e.display.barHeight+Yn(e)+"px"}function Xi(e){var t=e.display,n=t.view;if(t.alignWidgets||t.gutters.firstChild&&e.options.fixedGutter){for(var r=Dr(t)-t.scroller.scrollLeft+e.doc.scrollLeft,i=t.gutters.offsetWidth,o=r+"px",a=0;a<n.length;a++)if(!n[a].hidden){e.options.fixedGutter&&(n[a].gutter&&(n[a].gutter.style.left=o),n[a].gutterBackground&&(n[a].gutterBackground.style.left=o));var s=n[a].alignable;if(s)for(var l=0;l<s.length;l++)s[l].style.left=o}e.options.fixedGutter&&(t.gutters.style.left=r+i+"px")}}function Yi(e){if(!e.options.lineNumbers)return!1;var t=e.doc,n=rt(e.options,t.first+t.size-1),r=e.display;if(n.length!=r.lineNumChars){var i=r.measure.appendChild(L("div",[L("div",n)],"CodeMirror-linenumber CodeMirror-gutter-elt")),o=i.firstChild.offsetWidth,a=i.offsetWidth-o;return r.lineGutter.style.width="",r.lineNumInnerWidth=Math.max(o,r.lineGutter.offsetWidth-a)+1,r.lineNumWidth=r.lineNumInnerWidth+a,r.lineNumChars=r.lineNumInnerWidth?n.length:-1,r.lineGutter.style.width=r.lineNumWidth+"px",ji(e.display),!0}return!1}function qi(e,t){for(var n=[],r=!1,i=0;i<e.length;i++){var o=e[i],a=null;if("string"!=typeof o&&(a=o.style,o=o.className),"CodeMirror-linenumbers"==o){if(!t)continue;r=!0}n.push({className:o,style:a})}return t&&!r&&n.push({className:"CodeMirror-linenumbers",style:null}),n}function Qi(e){var t=e.gutters,n=e.gutterSpecs;C(t),e.lineGutter=null;for(var r=0;r<n.length;++r){var i=n[r],o=i.className,a=i.style,s=t.appendChild(L("div",null,"CodeMirror-gutter "+o));a&&(s.style.cssText=a),"CodeMirror-linenumbers"==o&&(e.lineGutter=s,s.style.width=(e.lineNumWidth||1)+"px")}t.style.display=n.length?"":"none",ji(e)}function $i(e){Qi(e.display),kr(e),Xi(e)}function Ki(e,t,r,i){var o=this;this.input=r,o.scrollbarFiller=L("div",null,"CodeMirror-scrollbar-filler"),o.scrollbarFiller.setAttribute("cm-not-content","true"),o.gutterFiller=L("div",null,"CodeMirror-gutter-filler"),o.gutterFiller.setAttribute("cm-not-content","true"),o.lineDiv=N("div",null,"CodeMirror-code"),o.selectionDiv=L("div",null,null,"position: relative; z-index: 1"),o.cursorDiv=L("div",null,"CodeMirror-cursors"),o.measure=L("div",null,"CodeMirror-measure"),o.lineMeasure=L("div",null,"CodeMirror-measure"),o.lineSpace=N("div",[o.measure,o.lineMeasure,o.selectionDiv,o.cursorDiv,o.lineDiv],null,"position: relative; outline: none");var u=N("div",[o.lineSpace],"CodeMirror-lines");o.mover=L("div",[u],null,"position: relative"),o.sizer=L("div",[o.mover],"CodeMirror-sizer"),o.sizerWidth=null,o.heightForcer=L("div",null,null,"position: absolute; height: "+U+"px; width: 1px;"),o.gutters=L("div",null,"CodeMirror-gutters"),o.lineGutter=null,o.scroller=L("div",[o.sizer,o.heightForcer,o.gutters],"CodeMirror-scroll"),o.scroller.setAttribute("tabIndex","-1"),o.wrapper=L("div",[o.scrollbarFiller,o.gutterFiller,o.scroller],"CodeMirror"),a&&s<8&&(o.gutters.style.zIndex=-1,o.scroller.style.paddingRight=0),l||n&&g||(o.scroller.draggable=!0),e&&(e.appendChild?e.appendChild(o.wrapper):e(o.wrapper)),o.viewFrom=o.viewTo=t.first,o.reportedViewFrom=o.reportedViewTo=t.first,o.view=[],o.renderedView=null,o.externalMeasured=null,o.viewOffset=0,o.lastWrapHeight=o.lastWrapWidth=0,o.updateLineNumbers=null,o.nativeBarWidth=o.barHeight=o.barWidth=0,o.scrollbarsClipped=!1,o.lineNumWidth=o.lineNumInnerWidth=o.lineNumChars=null,o.alignWidgets=!1,o.cachedCharWidth=o.cachedTextHeight=o.cachedPaddingH=null,o.maxLine=null,o.maxLineLength=0,o.maxLineChanged=!1,o.wheelDX=o.wheelDY=o.wheelStartX=o.wheelStartY=null,o.shift=!1,o.selForContextMenu=null,o.activeTouch=null,o.gutterSpecs=qi(i.gutters,i.lineNumbers),Qi(o),r.init(o)}ki.prototype.signal=function(e,t){xe(e,t)&&this.events.push(arguments)},ki.prototype.finish=function(){for(var e=this,t=0;t<this.events.length;t++)ge.apply(null,e.events[t])};var Zi=0,Ji=null;function eo(e){var t=e.wheelDeltaX,n=e.wheelDeltaY;return null==t&&e.detail&&e.axis==e.HORIZONTAL_AXIS&&(t=e.detail),null==n&&e.detail&&e.axis==e.VERTICAL_AXIS?n=e.detail:null==n&&(n=e.wheelDelta),{x:t,y:n}}function to(e){var t=eo(e);return t.x*=Ji,t.y*=Ji,t}function no(e,t){var r=eo(t),i=r.x,o=r.y,a=e.display,s=a.scroller,u=s.scrollWidth>s.clientWidth,c=s.scrollHeight>s.clientHeight;if(i&&u||o&&c){if(o&&y&&l)e:for(var f=t.target,h=a.view;f!=s;f=f.parentNode)for(var p=0;p<h.length;p++)if(h[p].node==f){e.display.currentWheelTarget=f;break e}if(i&&!n&&!d&&null!=Ji)return o&&c&&di(e,Math.max(0,s.scrollTop+o*Ji)),hi(e,Math.max(0,s.scrollLeft+i*Ji)),(!o||o&&c)&&we(t),void(a.wheelStartX=null);if(o&&null!=Ji){var m=o*Ji,v=e.doc.scrollTop,g=v+a.wrapper.clientHeight;m<0?v=Math.max(0,v+m-50):g=Math.min(e.doc.height,g+m+50),Gi(e,{top:v,bottom:g})}Zi<20&&(null==a.wheelStartX?(a.wheelStartX=s.scrollLeft,a.wheelStartY=s.scrollTop,a.wheelDX=i,a.wheelDY=o,setTimeout((function(){if(null!=a.wheelStartX){var e=s.scrollLeft-a.wheelStartX,t=s.scrollTop-a.wheelStartY,n=t&&a.wheelDY&&t/a.wheelDY||e&&a.wheelDX&&e/a.wheelDX;a.wheelStartX=a.wheelStartY=null,n&&(Ji=(Ji*Zi+n)/(Zi+1),++Zi)}}),200)):(a.wheelDX+=i,a.wheelDY+=o))}}a?Ji=-.53:n?Ji=15:c?Ji=-.7:f&&(Ji=-1/3);var ro=function(e,t){this.ranges=e,this.primIndex=t};ro.prototype.primary=function(){return this.ranges[this.primIndex]},ro.prototype.equals=function(e){var t=this;if(e==this)return!0;if(e.primIndex!=this.primIndex||e.ranges.length!=this.ranges.length)return!1;for(var n=0;n<this.ranges.length;n++){var r=t.ranges[n],i=e.ranges[n];if(!at(r.anchor,i.anchor)||!at(r.head,i.head))return!1}return!0},ro.prototype.deepCopy=function(){for(var e=this,t=[],n=0;n<this.ranges.length;n++)t[n]=new io(st(e.ranges[n].anchor),st(e.ranges[n].head));return new ro(t,this.primIndex)},ro.prototype.somethingSelected=function(){for(var e=this,t=0;t<this.ranges.length;t++)if(!e.ranges[t].empty())return!0;return!1},ro.prototype.contains=function(e,t){var n=this;t||(t=e);for(var r=0;r<this.ranges.length;r++){var i=n.ranges[r];if(ot(t,i.from())>=0&&ot(e,i.to())<=0)return r}return-1};var io=function(e,t){this.anchor=e,this.head=t};function oo(e,t,n){var r=e&&e.options.selectionsMayTouch,i=t[n];t.sort((function(e,t){return ot(e.from(),t.from())})),n=H(t,i);for(var o=1;o<t.length;o++){var a=t[o],s=t[o-1],l=ot(s.to(),a.from());if(r&&!a.empty()?l>0:l>=0){var u=ut(s.from(),a.from()),c=lt(s.to(),a.to()),d=s.empty()?a.from()==a.head:s.from()==s.head;o<=n&&--n,t.splice(--o,2,new io(d?c:u,d?u:c))}}return new ro(t,n)}function ao(e,t){return new ro([new io(e,t||e)],0)}function so(e){return e.text?it(e.from.line+e.text.length-1,Q(e.text).length+(1==e.text.length?e.from.ch:0)):e.to}function lo(e,t){if(ot(e,t.from)<0)return e;if(ot(e,t.to)<=0)return so(t);var n=e.line+t.text.length-(t.to.line-t.from.line)-1,r=e.ch;return e.line==t.to.line&&(r+=so(t).ch-t.to.ch),it(n,r)}function uo(e,t){for(var n=[],r=0;r<e.sel.ranges.length;r++){var i=e.sel.ranges[r];n.push(new io(lo(i.anchor,t),lo(i.head,t)))}return oo(e.cm,n,e.sel.primIndex)}function co(e,t,n){return e.line==t.line?it(n.line,e.ch-t.ch+n.ch):it(n.line+(e.line-t.line),e.ch)}function fo(e,t,n){for(var r=[],i=it(e.first,0),o=i,a=0;a<t.length;a++){var s=t[a],l=co(s.from,i,o),u=co(so(s),i,o);if(i=s.to,o=u,"around"==n){var c=e.sel.ranges[a],d=ot(c.head,c.anchor)<0;r[a]=new io(d?u:l,d?l:u)}else r[a]=new io(l,l)}return new ro(r,e.sel.primIndex)}function ho(e){e.doc.mode=Ve(e.options,e.doc.modeOption),po(e)}function po(e){e.doc.iter((function(e){e.stateAfter&&(e.stateAfter=null),e.styles&&(e.styles=null)})),e.doc.modeFrontier=e.doc.highlightFrontier=e.doc.first,Ri(e,100),e.state.modeGen++,e.curOp&&kr(e)}function mo(e,t){return 0==t.from.ch&&0==t.to.ch&&""==Q(t.text)&&(!e.cm||e.cm.options.wholeLineUpdateBefore)}function vo(e,t,n,r){function i(e){return n?n[e]:null}function o(e,n,i){un(e,n,i,r),Mn(e,"change",e,t)}function a(e,t){for(var n=[],o=e;o<t;++o)n.push(new ln(u[o],i(o),r));return n}var s=t.from,l=t.to,u=t.text,c=$e(e,s.line),d=$e(e,l.line),f=Q(u),h=i(u.length-1),p=l.line-s.line;if(t.full)e.insert(0,a(0,u.length)),e.remove(u.length,e.size-u.length);else if(mo(e,t)){var m=a(0,u.length-1);o(d,d.text,h),p&&e.remove(s.line,p),m.length&&e.insert(s.line,m)}else if(c==d)if(1==u.length)o(c,c.text.slice(0,s.ch)+f+c.text.slice(l.ch),h);else{var v=a(1,u.length-1);v.push(new ln(f+c.text.slice(l.ch),h,r)),o(c,c.text.slice(0,s.ch)+u[0],i(0)),e.insert(s.line+1,v)}else if(1==u.length)o(c,c.text.slice(0,s.ch)+u[0]+d.text.slice(l.ch),i(0)),e.remove(s.line+1,p);else{o(c,c.text.slice(0,s.ch)+u[0],i(0)),o(d,f+d.text.slice(l.ch),h);var g=a(1,u.length-1);p>1&&e.remove(s.line+1,p-1),e.insert(s.line+1,g)}Mn(e,"change",e,t)}function go(e,t,n){function r(e,i,o){if(e.linked)for(var a=0;a<e.linked.length;++a){var s=e.linked[a];if(s.doc!=i){var l=o&&s.sharedHist;n&&!l||(t(s.doc,l),r(s.doc,e,l))}}}r(e,null,!0)}function yo(e,t){if(t.cm)throw new Error("This document is already in use.");e.doc=t,t.cm=e,Ir(e),ho(e),_o(e),e.options.lineWrapping||sn(e),e.options.mode=t.modeOption,kr(e)}function _o(e){("rtl"==e.doc.direction?I:E)(e.display.lineDiv,"CodeMirror-rtl")}function xo(e){Ni(e,(function(){_o(e),kr(e)}))}function bo(e){this.done=[],this.undone=[],this.undoDepth=1/0,this.lastModTime=this.lastSelTime=0,this.lastOp=this.lastSelOp=null,this.lastOrigin=this.lastSelOrigin=null,this.generation=this.maxGeneration=e||1}function wo(e,t){var n={from:st(t.from),to:so(t),text:Ke(e,t.from,t.to)};return Lo(e,n,t.from.line,t.to.line+1),go(e,(function(e){return Lo(e,n,t.from.line,t.to.line+1)}),!0),n}function Ao(e){while(e.length){var t=Q(e);if(!t.ranges)break;e.pop()}}function To(e,t){return t?(Ao(e.done),Q(e.done)):e.done.length&&!Q(e.done).ranges?Q(e.done):e.done.length>1&&!e.done[e.done.length-2].ranges?(e.done.pop(),Q(e.done)):void 0}function So(e,t,n,r){var i=e.history;i.undone.length=0;var o,a,s=+new Date;if((i.lastOp==r||i.lastOrigin==t.origin&&t.origin&&("+"==t.origin.charAt(0)&&i.lastModTime>s-(e.cm?e.cm.options.historyEventDelay:500)||"*"==t.origin.charAt(0)))&&(o=To(i,i.lastOp==r)))a=Q(o.changes),0==ot(t.from,t.to)&&0==ot(t.from,a.to)?a.to=so(t):o.changes.push(wo(e,t));else{var l=Q(i.done);l&&l.ranges||Mo(e.sel,i.done),o={changes:[wo(e,t)],generation:i.generation},i.done.push(o);while(i.done.length>i.undoDepth)i.done.shift(),i.done[0].ranges||i.done.shift()}i.done.push(n),i.generation=++i.maxGeneration,i.lastModTime=i.lastSelTime=s,i.lastOp=i.lastSelOp=r,i.lastOrigin=i.lastSelOrigin=t.origin,a||ge(e,"historyAdded")}function Eo(e,t,n,r){var i=t.charAt(0);return"*"==i||"+"==i&&n.ranges.length==r.ranges.length&&n.somethingSelected()==r.somethingSelected()&&new Date-e.history.lastSelTime<=(e.cm?e.cm.options.historyEventDelay:500)}function Co(e,t,n,r){var i=e.history,o=r&&r.origin;n==i.lastSelOp||o&&i.lastSelOrigin==o&&(i.lastModTime==i.lastSelTime&&i.lastOrigin==o||Eo(e,o,Q(i.done),t))?i.done[i.done.length-1]=t:Mo(t,i.done),i.lastSelTime=+new Date,i.lastSelOrigin=o,i.lastSelOp=n,r&&!1!==r.clearRedo&&Ao(i.undone)}function Mo(e,t){var n=Q(t);n&&n.ranges&&n.equals(e)||t.push(e)}function Lo(e,t,n,r){var i=t["spans_"+e.id],o=0;e.iter(Math.max(e.first,n),Math.min(e.first+e.size,r),(function(n){n.markedSpans&&((i||(i=t["spans_"+e.id]={}))[o]=n.markedSpans),++o}))}function No(e){if(!e)return null;for(var t,n=0;n<e.length;++n)e[n].marker.explicitlyCleared?t||(t=e.slice(0,n)):t&&t.push(e[n]);return t?t.length?t:null:e}function Do(e,t){var n=t["spans_"+e.id];if(!n)return null;for(var r=[],i=0;i<t.text.length;++i)r.push(No(n[i]));return r}function Oo(e,t){var n=Do(e,t),r=Ft(e,t);if(!n)return r;if(!r)return n;for(var i=0;i<n.length;++i){var o=n[i],a=r[i];if(o&&a)e:for(var s=0;s<a.length;++s){for(var l=a[s],u=0;u<o.length;++u)if(o[u].marker==l.marker)continue e;o.push(l)}else a&&(n[i]=a)}return n}function Io(e,t,n){for(var r=[],i=0;i<e.length;++i){var o=e[i];if(o.ranges)r.push(n?ro.prototype.deepCopy.call(o):o);else{var a=o.changes,s=[];r.push({changes:s});for(var l=0;l<a.length;++l){var u=a[l],c=void 0;if(s.push({from:u.from,to:u.to,text:u.text}),t)for(var d in u)(c=d.match(/^spans_(\d+)$/))&&H(t,Number(c[1]))>-1&&(Q(s)[d]=u[d],delete u[d])}}}return r}function Ro(e,t,n,r){if(r){var i=e.anchor;if(n){var o=ot(t,i)<0;o!=ot(n,i)<0?(i=t,t=n):o!=ot(t,n)<0&&(t=n)}return new io(i,t)}return new io(n||t,t)}function Po(e,t,n,r,i){null==i&&(i=e.cm&&(e.cm.display.shift||e.extend)),Uo(e,new ro([Ro(e.sel.primary(),t,n,i)],0),r)}function ko(e,t,n){for(var r=[],i=e.cm&&(e.cm.display.shift||e.extend),o=0;o<e.sel.ranges.length;o++)r[o]=Ro(e.sel.ranges[o],t[o],null,i);var a=oo(e.cm,r,e.sel.primIndex);Uo(e,a,n)}function Bo(e,t,n,r){var i=e.sel.ranges.slice(0);i[t]=n,Uo(e,oo(e.cm,i,e.sel.primIndex),r)}function Fo(e,t,n,r){Uo(e,ao(t,n),r)}function zo(e,t,n){var r={ranges:t.ranges,update:function(t){var n=this;this.ranges=[];for(var r=0;r<t.length;r++)n.ranges[r]=new io(dt(e,t[r].anchor),dt(e,t[r].head))},origin:n&&n.origin};return ge(e,"beforeSelectionChange",e,r),e.cm&&ge(e.cm,"beforeSelectionChange",e.cm,r),r.ranges!=t.ranges?oo(e.cm,r.ranges,r.ranges.length-1):t}function Ho(e,t,n){var r=e.history.done,i=Q(r);i&&i.ranges?(r[r.length-1]=t,Go(e,t,n)):Uo(e,t,n)}function Uo(e,t,n){Go(e,t,n),Co(e,e.sel,e.cm?e.cm.curOp.id:NaN,n)}function Go(e,t,n){(xe(e,"beforeSelectionChange")||e.cm&&xe(e.cm,"beforeSelectionChange"))&&(t=zo(e,t,n));var r=n&&n.bias||(ot(t.primary().head,e.sel.primary().head)<0?-1:1);Vo(e,Wo(e,t,r,!0)),n&&!1===n.scroll||!e.cm||ai(e.cm)}function Vo(e,t){t.equals(e.sel)||(e.sel=t,e.cm&&(e.cm.curOp.updateInput=1,e.cm.curOp.selectionChanged=!0,_e(e.cm)),Mn(e,"cursorActivity",e))}function jo(e){Vo(e,Wo(e,e.sel,null,!1))}function Wo(e,t,n,r){for(var i,o=0;o<t.ranges.length;o++){var a=t.ranges[o],s=t.ranges.length==e.sel.ranges.length&&e.sel.ranges[o],l=Yo(e,a.anchor,s&&s.anchor,n,r),u=Yo(e,a.head,s&&s.head,n,r);(i||l!=a.anchor||u!=a.head)&&(i||(i=t.ranges.slice(0,o)),i[o]=new io(l,u))}return i?oo(e.cm,i,t.primIndex):t}function Xo(e,t,n,r,i){var o=$e(e,t.line);if(o.markedSpans)for(var a=0;a<o.markedSpans.length;++a){var s=o.markedSpans[a],l=s.marker,u="selectLeft"in l?!l.selectLeft:l.inclusiveLeft,c="selectRight"in l?!l.selectRight:l.inclusiveRight;if((null==s.from||(u?s.from<=t.ch:s.from<t.ch))&&(null==s.to||(c?s.to>=t.ch:s.to>t.ch))){if(i&&(ge(l,"beforeCursorEnter"),l.explicitlyCleared)){if(o.markedSpans){--a;continue}break}if(!l.atomic)continue;if(n){var d=l.find(r<0?1:-1),f=void 0;if((r<0?c:u)&&(d=qo(e,d,-r,d&&d.line==t.line?o:null)),d&&d.line==t.line&&(f=ot(d,n))&&(r<0?f<0:f>0))return Xo(e,d,t,r,i)}var h=l.find(r<0?-1:1);return(r<0?u:c)&&(h=qo(e,h,r,h.line==t.line?o:null)),h?Xo(e,h,t,r,i):null}}return t}function Yo(e,t,n,r,i){var o=r||1,a=Xo(e,t,n,o,i)||!i&&Xo(e,t,n,o,!0)||Xo(e,t,n,-o,i)||!i&&Xo(e,t,n,-o,!0);return a||(e.cantEdit=!0,it(e.first,0))}function qo(e,t,n,r){return n<0&&0==t.ch?t.line>e.first?dt(e,it(t.line-1)):null:n>0&&t.ch==(r||$e(e,t.line)).text.length?t.line<e.first+e.size-1?it(t.line+1,0):null:new it(t.line,t.ch+n)}function Qo(e){e.setSelection(it(e.firstLine(),0),it(e.lastLine()),V)}function $o(e,t,n){var r={canceled:!1,from:t.from,to:t.to,text:t.text,origin:t.origin,cancel:function(){return r.canceled=!0}};return n&&(r.update=function(t,n,i,o){t&&(r.from=dt(e,t)),n&&(r.to=dt(e,n)),i&&(r.text=i),void 0!==o&&(r.origin=o)}),ge(e,"beforeChange",e,r),e.cm&&ge(e.cm,"beforeChange",e.cm,r),r.canceled?(e.cm&&(e.cm.curOp.updateInput=2),null):{from:r.from,to:r.to,text:r.text,origin:r.origin}}function Ko(e,t,n){if(e.cm){if(!e.cm.curOp)return Di(e.cm,Ko)(e,t,n);if(e.cm.state.suppressEdits)return}if(!(xe(e,"beforeChange")||e.cm&&xe(e.cm,"beforeChange"))||(t=$o(e,t,!0),t)){var r=Mt&&!n&&Ht(e,t.from,t.to);if(r)for(var i=r.length-1;i>=0;--i)Zo(e,{from:r[i].from,to:r[i].to,text:i?[""]:t.text,origin:t.origin});else Zo(e,t)}}function Zo(e,t){if(1!=t.text.length||""!=t.text[0]||0!=ot(t.from,t.to)){var n=uo(e,t);So(e,t,n,e.cm?e.cm.curOp.id:NaN),ta(e,t,n,Ft(e,t));var r=[];go(e,(function(e,n){n||-1!=H(r,e.history)||(aa(e.history,t),r.push(e.history)),ta(e,t,null,Ft(e,t))}))}}function Jo(e,t,n){var r=e.cm&&e.cm.state.suppressEdits;if(!r||n){for(var i,o=e.history,a=e.sel,s="undo"==t?o.done:o.undone,l="undo"==t?o.undone:o.done,u=0;u<s.length;u++)if(i=s[u],n?i.ranges&&!i.equals(e.sel):!i.ranges)break;if(u!=s.length){for(o.lastOrigin=o.lastSelOrigin=null;;){if(i=s.pop(),!i.ranges){if(r)return void s.push(i);break}if(Mo(i,l),n&&!i.equals(e.sel))return void Uo(e,i,{clearRedo:!1});a=i}var c=[];Mo(a,l),l.push({changes:c,generation:o.generation}),o.generation=i.generation||++o.maxGeneration;for(var d=xe(e,"beforeChange")||e.cm&&xe(e.cm,"beforeChange"),f=function(n){var r=i.changes[n];if(r.origin=t,d&&!$o(e,r,!1))return s.length=0,{};c.push(wo(e,r));var o=n?uo(e,r):Q(s);ta(e,r,o,Oo(e,r)),!n&&e.cm&&e.cm.scrollIntoView({from:r.from,to:so(r)});var a=[];go(e,(function(e,t){t||-1!=H(a,e.history)||(aa(e.history,r),a.push(e.history)),ta(e,r,null,Oo(e,r))}))},h=i.changes.length-1;h>=0;--h){var p=f(h);if(p)return p.v}}}}function ea(e,t){if(0!=t&&(e.first+=t,e.sel=new ro($(e.sel.ranges,(function(e){return new io(it(e.anchor.line+t,e.anchor.ch),it(e.head.line+t,e.head.ch))})),e.sel.primIndex),e.cm)){kr(e.cm,e.first,e.first-t,t);for(var n=e.cm.display,r=n.viewFrom;r<n.viewTo;r++)Br(e.cm,r,"gutter")}}function ta(e,t,n,r){if(e.cm&&!e.cm.curOp)return Di(e.cm,ta)(e,t,n,r);if(t.to.line<e.first)ea(e,t.text.length-1-(t.to.line-t.from.line));else if(!(t.from.line>e.lastLine())){if(t.from.line<e.first){var i=t.text.length-1-(e.first-t.from.line);ea(e,i),t={from:it(e.first,0),to:it(t.to.line+i,t.to.ch),text:[Q(t.text)],origin:t.origin}}var o=e.lastLine();t.to.line>o&&(t={from:t.from,to:it(o,$e(e,o).text.length),text:[t.text[0]],origin:t.origin}),t.removed=Ke(e,t.from,t.to),n||(n=uo(e,t)),e.cm?na(e.cm,t,r):vo(e,t,r),Go(e,n,V),e.cantEdit&&Yo(e,it(e.firstLine(),0))&&(e.cantEdit=!1)}}function na(e,t,n){var r=e.doc,i=e.display,o=t.from,a=t.to,s=!1,l=o.line;e.options.lineWrapping||(l=et(Kt($e(r,o.line))),r.iter(l,a.line+1,(function(e){if(e==i.maxLine)return s=!0,!0}))),r.sel.contains(t.from,t.to)>-1&&_e(e),vo(r,t,n,Or(e)),e.options.lineWrapping||(r.iter(l,o.line+t.text.length,(function(e){var t=an(e);t>i.maxLineLength&&(i.maxLine=e,i.maxLineLength=t,i.maxLineChanged=!0,s=!1)})),s&&(e.curOp.updateMaxLine=!0)),Ct(r,o.line),Ri(e,400);var u=t.text.length-(a.line-o.line)-1;t.full?kr(e):o.line!=a.line||1!=t.text.length||mo(e.doc,t)?kr(e,o.line,a.line+1,u):Br(e,o.line,"text");var c=xe(e,"changes"),d=xe(e,"change");if(d||c){var f={from:o,to:a,text:t.text,removed:t.removed,origin:t.origin};d&&Mn(e,"change",e,f),c&&(e.curOp.changeObjs||(e.curOp.changeObjs=[])).push(f)}e.display.selForContextMenu=null}function ra(e,t,n,r,i){var o;r||(r=n),ot(r,n)<0&&(o=[r,n],n=o[0],r=o[1]),"string"==typeof t&&(t=e.splitLines(t)),Ko(e,{from:n,to:r,text:t,origin:i})}function ia(e,t,n,r){n<e.line?e.line+=r:t<e.line&&(e.line=t,e.ch=0)}function oa(e,t,n,r){for(var i=0;i<e.length;++i){var o=e[i],a=!0;if(o.ranges){o.copied||(o=e[i]=o.deepCopy(),o.copied=!0);for(var s=0;s<o.ranges.length;s++)ia(o.ranges[s].anchor,t,n,r),ia(o.ranges[s].head,t,n,r)}else{for(var l=0;l<o.changes.length;++l){var u=o.changes[l];if(n<u.from.line)u.from=it(u.from.line+r,u.from.ch),u.to=it(u.to.line+r,u.to.ch);else if(t<=u.to.line){a=!1;break}}a||(e.splice(0,i+1),i=0)}}}function aa(e,t){var n=t.from.line,r=t.to.line,i=t.text.length-(r-n)-1;oa(e.done,n,r,i),oa(e.undone,n,r,i)}function sa(e,t,n,r){var i=t,o=t;return"number"==typeof t?o=$e(e,ct(e,t)):i=et(t),null==i?null:(r(o,i)&&e.cm&&Br(e.cm,i,n),o)}function la(e){var t=this;this.lines=e,this.parent=null;for(var n=0,r=0;r<e.length;++r)e[r].parent=t,n+=e[r].height;this.height=n}function ua(e){var t=this;this.children=e;for(var n=0,r=0,i=0;i<e.length;++i){var o=e[i];n+=o.chunkSize(),r+=o.height,o.parent=t}this.size=n,this.height=r,this.parent=null}io.prototype.from=function(){return ut(this.anchor,this.head)},io.prototype.to=function(){return lt(this.anchor,this.head)},io.prototype.empty=function(){return this.head.line==this.anchor.line&&this.head.ch==this.anchor.ch},la.prototype={chunkSize:function(){return this.lines.length},removeInner:function(e,t){for(var n=this,r=e,i=e+t;r<i;++r){var o=n.lines[r];n.height-=o.height,cn(o),Mn(o,"delete")}this.lines.splice(e,t)},collapse:function(e){e.push.apply(e,this.lines)},insertInner:function(e,t,n){var r=this;this.height+=n,this.lines=this.lines.slice(0,e).concat(t).concat(this.lines.slice(e));for(var i=0;i<t.length;++i)t[i].parent=r},iterN:function(e,t,n){for(var r=this,i=e+t;e<i;++e)if(n(r.lines[e]))return!0}},ua.prototype={chunkSize:function(){return this.size},removeInner:function(e,t){var n=this;this.size-=t;for(var r=0;r<this.children.length;++r){var i=n.children[r],o=i.chunkSize();if(e<o){var a=Math.min(t,o-e),s=i.height;if(i.removeInner(e,a),n.height-=s-i.height,o==a&&(n.children.splice(r--,1),i.parent=null),0==(t-=a))break;e=0}else e-=o}if(this.size-t<25&&(this.children.length>1||!(this.children[0]instanceof la))){var l=[];this.collapse(l),this.children=[new la(l)],this.children[0].parent=this}},collapse:function(e){for(var t=this,n=0;n<this.children.length;++n)t.children[n].collapse(e)},insertInner:function(e,t,n){var r=this;this.size+=t.length,this.height+=n;for(var i=0;i<this.children.length;++i){var o=r.children[i],a=o.chunkSize();if(e<=a){if(o.insertInner(e,t,n),o.lines&&o.lines.length>50){for(var s=o.lines.length%25+25,l=s;l<o.lines.length;){var u=new la(o.lines.slice(l,l+=25));o.height-=u.height,r.children.splice(++i,0,u),u.parent=r}o.lines=o.lines.slice(0,s),r.maybeSpill()}break}e-=a}},maybeSpill:function(){if(!(this.children.length<=10)){var e=this;do{var t=e.children.splice(e.children.length-5,5),n=new ua(t);if(e.parent){e.size-=n.size,e.height-=n.height;var r=H(e.parent.children,e);e.parent.children.splice(r+1,0,n)}else{var i=new ua(e.children);i.parent=e,e.children=[i,n],e=i}n.parent=e.parent}while(e.children.length>10);e.parent.maybeSpill()}},iterN:function(e,t,n){for(var r=this,i=0;i<this.children.length;++i){var o=r.children[i],a=o.chunkSize();if(e<a){var s=Math.min(t,a-e);if(o.iterN(e,s,n))return!0;if(0==(t-=s))break;e=0}else e-=a}}};var ca=function(e,t,n){var r=this;if(n)for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i]);this.doc=e,this.node=t};function da(e,t,n){on(t)<(e.curOp&&e.curOp.scrollTop||e.doc.scrollTop)&&oi(e,n)}function fa(e,t,n,r){var i=new ca(e,n,r),o=e.cm;return o&&i.noHScroll&&(o.display.alignWidgets=!0),sa(e,t,"widget",(function(t){var n=t.widgets||(t.widgets=[]);if(null==i.insertAt?n.push(i):n.splice(Math.min(n.length-1,Math.max(0,i.insertAt)),0,i),i.line=t,o&&!nn(e,t)){var r=on(t)<e.scrollTop;Je(t,t.height+Gn(i)),r&&oi(o,i.height),o.curOp.forceUpdate=!0}return!0})),o&&Mn(o,"lineWidgetAdded",o,i,"number"==typeof t?t:et(t)),i}ca.prototype.clear=function(){var e=this,t=this.doc.cm,n=this.line.widgets,r=this.line,i=et(r);if(null!=i&&n){for(var o=0;o<n.length;++o)n[o]==e&&n.splice(o--,1);n.length||(r.widgets=null);var a=Gn(this);Je(r,Math.max(0,r.height-a)),t&&(Ni(t,(function(){da(t,r,-a),Br(t,i,"widget")})),Mn(t,"lineWidgetCleared",t,this,i))}},ca.prototype.changed=function(){var e=this,t=this.height,n=this.doc.cm,r=this.line;this.height=null;var i=Gn(this)-t;i&&(nn(this.doc,r)||Je(r,r.height+i),n&&Ni(n,(function(){n.curOp.forceUpdate=!0,da(n,r,i),Mn(n,"lineWidgetChanged",n,e,et(r))})))},be(ca);var ha=0,pa=function(e,t){this.lines=[],this.type=t,this.doc=e,this.id=++ha};function ma(e,t,n,r,i){if(r&&r.shared)return ga(e,t,n,r,i);if(e.cm&&!e.cm.curOp)return Di(e.cm,ma)(e,t,n,r,i);var o=new pa(e,i),a=ot(t,n);if(r&&B(r,o,!1),a>0||0==a&&!1!==o.clearWhenEmpty)return o;if(o.replacedWith&&(o.collapsed=!0,o.widgetNode=N("span",[o.replacedWith],"CodeMirror-widget"),r.handleMouseEvents||o.widgetNode.setAttribute("cm-ignore-events","true"),r.insertLeft&&(o.widgetNode.insertLeft=!0)),o.collapsed){if($t(e,t.line,t,n,o)||t.line!=n.line&&$t(e,n.line,t,n,o))throw new Error("Inserting collapsed marker partially overlapping an existing one");Dt()}o.addToHistory&&So(e,{from:t,to:n,origin:"markText"},e.sel,NaN);var s,l=t.line,u=e.cm;if(e.iter(l,n.line+1,(function(e){u&&o.collapsed&&!u.options.lineWrapping&&Kt(e)==u.display.maxLine&&(s=!0),o.collapsed&&l!=t.line&&Je(e,0),Pt(e,new Ot(o,l==t.line?t.ch:null,l==n.line?n.ch:null)),++l})),o.collapsed&&e.iter(t.line,n.line+1,(function(t){nn(e,t)&&Je(t,0)})),o.clearOnEnter&&pe(o,"beforeCursorEnter",(function(){return o.clear()})),o.readOnly&&(Nt(),(e.history.done.length||e.history.undone.length)&&e.clearHistory()),o.collapsed&&(o.id=++ha,o.atomic=!0),u){if(s&&(u.curOp.updateMaxLine=!0),o.collapsed)kr(u,t.line,n.line+1);else if(o.className||o.startStyle||o.endStyle||o.css||o.attributes||o.title)for(var c=t.line;c<=n.line;c++)Br(u,c,"text");o.atomic&&jo(u.doc),Mn(u,"markerAdded",u,o)}return o}pa.prototype.clear=function(){var e=this;if(!this.explicitlyCleared){var t=this.doc.cm,n=t&&!t.curOp;if(n&&wi(t),xe(this,"clear")){var r=this.find();r&&Mn(this,"clear",r.from,r.to)}for(var i=null,o=null,a=0;a<this.lines.length;++a){var s=e.lines[a],l=It(s.markedSpans,e);t&&!e.collapsed?Br(t,et(s),"text"):t&&(null!=l.to&&(o=et(s)),null!=l.from&&(i=et(s))),s.markedSpans=Rt(s.markedSpans,l),null==l.from&&e.collapsed&&!nn(e.doc,s)&&t&&Je(s,Mr(t.display))}if(t&&this.collapsed&&!t.options.lineWrapping)for(var u=0;u<this.lines.length;++u){var c=Kt(e.lines[u]),d=an(c);d>t.display.maxLineLength&&(t.display.maxLine=c,t.display.maxLineLength=d,t.display.maxLineChanged=!0)}null!=i&&t&&this.collapsed&&kr(t,i,o+1),this.lines.length=0,this.explicitlyCleared=!0,this.atomic&&this.doc.cantEdit&&(this.doc.cantEdit=!1,t&&jo(t.doc)),t&&Mn(t,"markerCleared",t,this,i,o),n&&Ai(t),this.parent&&this.parent.clear()}},pa.prototype.find=function(e,t){var n,r,i=this;null==e&&"bookmark"==this.type&&(e=1);for(var o=0;o<this.lines.length;++o){var a=i.lines[o],s=It(a.markedSpans,i);if(null!=s.from&&(n=it(t?a:et(a),s.from),-1==e))return n;if(null!=s.to&&(r=it(t?a:et(a),s.to),1==e))return r}return n&&{from:n,to:r}},pa.prototype.changed=function(){var e=this,t=this.find(-1,!0),n=this,r=this.doc.cm;t&&r&&Ni(r,(function(){var i=t.line,o=et(t.line),a=er(r,o);if(a&&(ur(a),r.curOp.selectionChanged=r.curOp.forceUpdate=!0),r.curOp.updateMaxLine=!0,!nn(n.doc,i)&&null!=n.height){var s=n.height;n.height=null;var l=Gn(n)-s;l&&Je(i,i.height+l)}Mn(r,"markerChanged",r,e)}))},pa.prototype.attachLine=function(e){if(!this.lines.length&&this.doc.cm){var t=this.doc.cm.curOp;t.maybeHiddenMarkers&&-1!=H(t.maybeHiddenMarkers,this)||(t.maybeUnhiddenMarkers||(t.maybeUnhiddenMarkers=[])).push(this)}this.lines.push(e)},pa.prototype.detachLine=function(e){if(this.lines.splice(H(this.lines,e),1),!this.lines.length&&this.doc.cm){var t=this.doc.cm.curOp;(t.maybeHiddenMarkers||(t.maybeHiddenMarkers=[])).push(this)}},be(pa);var va=function(e,t){var n=this;this.markers=e,this.primary=t;for(var r=0;r<e.length;++r)e[r].parent=n};function ga(e,t,n,r,i){r=B(r),r.shared=!1;var o=[ma(e,t,n,r,i)],a=o[0],s=r.widgetNode;return go(e,(function(e){s&&(r.widgetNode=s.cloneNode(!0)),o.push(ma(e,dt(e,t),dt(e,n),r,i));for(var l=0;l<e.linked.length;++l)if(e.linked[l].isParent)return;a=Q(o)})),new va(o,a)}function ya(e){return e.findMarks(it(e.first,0),e.clipPos(it(e.lastLine())),(function(e){return e.parent}))}function _a(e,t){for(var n=0;n<t.length;n++){var r=t[n],i=r.find(),o=e.clipPos(i.from),a=e.clipPos(i.to);if(ot(o,a)){var s=ma(e,o,a,r.primary,r.primary.type);r.markers.push(s),s.parent=r}}}function xa(e){for(var t=function(t){var n=e[t],r=[n.primary.doc];go(n.primary.doc,(function(e){return r.push(e)}));for(var i=0;i<n.markers.length;i++){var o=n.markers[i];-1==H(r,o.doc)&&(o.parent=null,n.markers.splice(i--,1))}},n=0;n<e.length;n++)t(n)}va.prototype.clear=function(){var e=this;if(!this.explicitlyCleared){this.explicitlyCleared=!0;for(var t=0;t<this.markers.length;++t)e.markers[t].clear();Mn(this,"clear")}},va.prototype.find=function(e,t){return this.primary.find(e,t)},be(va);var ba=0,wa=function(e,t,n,r,i){if(!(this instanceof wa))return new wa(e,t,n,r,i);null==n&&(n=0),ua.call(this,[new la([new ln("",null)])]),this.first=n,this.scrollTop=this.scrollLeft=0,this.cantEdit=!1,this.cleanGeneration=1,this.modeFrontier=this.highlightFrontier=n;var o=it(n,0);this.sel=ao(o),this.history=new bo(null),this.id=++ba,this.modeOption=t,this.lineSep=r,this.direction="rtl"==i?"rtl":"ltr",this.extend=!1,"string"==typeof e&&(e=this.splitLines(e)),vo(this,{from:o,to:o,text:e}),Uo(this,ao(o),V)};wa.prototype=J(ua.prototype,{constructor:wa,iter:function(e,t,n){n?this.iterN(e-this.first,t-e,n):this.iterN(this.first,this.first+this.size,e)},insert:function(e,t){for(var n=0,r=0;r<t.length;++r)n+=t[r].height;this.insertInner(e-this.first,t,n)},remove:function(e,t){this.removeInner(e-this.first,t)},getValue:function(e){var t=Ze(this,this.first,this.first+this.size);return!1===e?t:t.join(e||this.lineSeparator())},setValue:Ii((function(e){var t=it(this.first,0),n=this.first+this.size-1;Ko(this,{from:t,to:it(n,$e(this,n).text.length),text:this.splitLines(e),origin:"setValue",full:!0},!0),this.cm&&si(this.cm,0,0),Uo(this,ao(t),V)})),replaceRange:function(e,t,n,r){t=dt(this,t),n=n?dt(this,n):t,ra(this,e,t,n,r)},getRange:function(e,t,n){var r=Ke(this,dt(this,e),dt(this,t));return!1===n?r:r.join(n||this.lineSeparator())},getLine:function(e){var t=this.getLineHandle(e);return t&&t.text},getLineHandle:function(e){if(nt(this,e))return $e(this,e)},getLineNumber:function(e){return et(e)},getLineHandleVisualStart:function(e){return"number"==typeof e&&(e=$e(this,e)),Kt(e)},lineCount:function(){return this.size},firstLine:function(){return this.first},lastLine:function(){return this.first+this.size-1},clipPos:function(e){return dt(this,e)},getCursor:function(e){var t,n=this.sel.primary();return t=null==e||"head"==e?n.head:"anchor"==e?n.anchor:"end"==e||"to"==e||!1===e?n.to():n.from(),t},listSelections:function(){return this.sel.ranges},somethingSelected:function(){return this.sel.somethingSelected()},setCursor:Ii((function(e,t,n){Fo(this,dt(this,"number"==typeof e?it(e,t||0):e),null,n)})),setSelection:Ii((function(e,t,n){Fo(this,dt(this,e),dt(this,t||e),n)})),extendSelection:Ii((function(e,t,n){Po(this,dt(this,e),t&&dt(this,t),n)})),extendSelections:Ii((function(e,t){ko(this,ht(this,e),t)})),extendSelectionsBy:Ii((function(e,t){var n=$(this.sel.ranges,e);ko(this,ht(this,n),t)})),setSelections:Ii((function(e,t,n){var r=this;if(e.length){for(var i=[],o=0;o<e.length;o++)i[o]=new io(dt(r,e[o].anchor),dt(r,e[o].head));null==t&&(t=Math.min(e.length-1,this.sel.primIndex)),Uo(this,oo(this.cm,i,t),n)}})),addSelection:Ii((function(e,t,n){var r=this.sel.ranges.slice(0);r.push(new io(dt(this,e),dt(this,t||e))),Uo(this,oo(this.cm,r,r.length-1),n)})),getSelection:function(e){for(var t,n=this,r=this.sel.ranges,i=0;i<r.length;i++){var o=Ke(n,r[i].from(),r[i].to());t=t?t.concat(o):o}return!1===e?t:t.join(e||this.lineSeparator())},getSelections:function(e){for(var t=this,n=[],r=this.sel.ranges,i=0;i<r.length;i++){var o=Ke(t,r[i].from(),r[i].to());!1!==e&&(o=o.join(e||t.lineSeparator())),n[i]=o}return n},replaceSelection:function(e,t,n){for(var r=[],i=0;i<this.sel.ranges.length;i++)r[i]=e;this.replaceSelections(r,t,n||"+input")},replaceSelections:Ii((function(e,t,n){for(var r=this,i=[],o=this.sel,a=0;a<o.ranges.length;a++){var s=o.ranges[a];i[a]={from:s.from(),to:s.to(),text:r.splitLines(e[a]),origin:n}}for(var l=t&&"end"!=t&&fo(this,i,t),u=i.length-1;u>=0;u--)Ko(r,i[u]);l?Ho(this,l):this.cm&&ai(this.cm)})),undo:Ii((function(){Jo(this,"undo")})),redo:Ii((function(){Jo(this,"redo")})),undoSelection:Ii((function(){Jo(this,"undo",!0)})),redoSelection:Ii((function(){Jo(this,"redo",!0)})),setExtending:function(e){this.extend=e},getExtending:function(){return this.extend},historySize:function(){for(var e=this.history,t=0,n=0,r=0;r<e.done.length;r++)e.done[r].ranges||++t;for(var i=0;i<e.undone.length;i++)e.undone[i].ranges||++n;return{undo:t,redo:n}},clearHistory:function(){this.history=new bo(this.history.maxGeneration)},markClean:function(){this.cleanGeneration=this.changeGeneration(!0)},changeGeneration:function(e){return e&&(this.history.lastOp=this.history.lastSelOp=this.history.lastOrigin=null),this.history.generation},isClean:function(e){return this.history.generation==(e||this.cleanGeneration)},getHistory:function(){return{done:Io(this.history.done),undone:Io(this.history.undone)}},setHistory:function(e){var t=this.history=new bo(this.history.maxGeneration);t.done=Io(e.done.slice(0),null,!0),t.undone=Io(e.undone.slice(0),null,!0)},setGutterMarker:Ii((function(e,t,n){return sa(this,e,"gutter",(function(e){var r=e.gutterMarkers||(e.gutterMarkers={});return r[t]=n,!n&&re(r)&&(e.gutterMarkers=null),!0}))})),clearGutter:Ii((function(e){var t=this;this.iter((function(n){n.gutterMarkers&&n.gutterMarkers[e]&&sa(t,n,"gutter",(function(){return n.gutterMarkers[e]=null,re(n.gutterMarkers)&&(n.gutterMarkers=null),!0}))}))})),lineInfo:function(e){var t;if("number"==typeof e){if(!nt(this,e))return null;if(t=e,e=$e(this,e),!e)return null}else if(t=et(e),null==t)return null;return{line:t,handle:e,text:e.text,gutterMarkers:e.gutterMarkers,textClass:e.textClass,bgClass:e.bgClass,wrapClass:e.wrapClass,widgets:e.widgets}},addLineClass:Ii((function(e,t,n){return sa(this,e,"gutter"==t?"gutter":"class",(function(e){var r="text"==t?"textClass":"background"==t?"bgClass":"gutter"==t?"gutterClass":"wrapClass";if(e[r]){if(T(n).test(e[r]))return!1;e[r]+=" "+n}else e[r]=n;return!0}))})),removeLineClass:Ii((function(e,t,n){return sa(this,e,"gutter"==t?"gutter":"class",(function(e){var r="text"==t?"textClass":"background"==t?"bgClass":"gutter"==t?"gutterClass":"wrapClass",i=e[r];if(!i)return!1;if(null==n)e[r]=null;else{var o=i.match(T(n));if(!o)return!1;var a=o.index+o[0].length;e[r]=i.slice(0,o.index)+(o.index&&a!=i.length?" ":"")+i.slice(a)||null}return!0}))})),addLineWidget:Ii((function(e,t,n){return fa(this,e,t,n)})),removeLineWidget:function(e){e.clear()},markText:function(e,t,n){return ma(this,dt(this,e),dt(this,t),n,n&&n.type||"range")},setBookmark:function(e,t){var n={replacedWith:t&&(null==t.nodeType?t.widget:t),insertLeft:t&&t.insertLeft,clearWhenEmpty:!1,shared:t&&t.shared,handleMouseEvents:t&&t.handleMouseEvents};return e=dt(this,e),ma(this,e,e,n,"bookmark")},findMarksAt:function(e){e=dt(this,e);var t=[],n=$e(this,e.line).markedSpans;if(n)for(var r=0;r<n.length;++r){var i=n[r];(null==i.from||i.from<=e.ch)&&(null==i.to||i.to>=e.ch)&&t.push(i.marker.parent||i.marker)}return t},findMarks:function(e,t,n){e=dt(this,e),t=dt(this,t);var r=[],i=e.line;return this.iter(e.line,t.line+1,(function(o){var a=o.markedSpans;if(a)for(var s=0;s<a.length;s++){var l=a[s];null!=l.to&&i==e.line&&e.ch>=l.to||null==l.from&&i!=e.line||null!=l.from&&i==t.line&&l.from>=t.ch||n&&!n(l.marker)||r.push(l.marker.parent||l.marker)}++i})),r},getAllMarks:function(){var e=[];return this.iter((function(t){var n=t.markedSpans;if(n)for(var r=0;r<n.length;++r)null!=n[r].from&&e.push(n[r].marker)})),e},posFromIndex:function(e){var t,n=this.first,r=this.lineSeparator().length;return this.iter((function(i){var o=i.text.length+r;if(o>e)return t=e,!0;e-=o,++n})),dt(this,it(n,t))},indexFromPos:function(e){e=dt(this,e);var t=e.ch;if(e.line<this.first||e.ch<0)return 0;var n=this.lineSeparator().length;return this.iter(this.first,e.line,(function(e){t+=e.text.length+n})),t},copy:function(e){var t=new wa(Ze(this,this.first,this.first+this.size),this.modeOption,this.first,this.lineSep,this.direction);return t.scrollTop=this.scrollTop,t.scrollLeft=this.scrollLeft,t.sel=this.sel,t.extend=!1,e&&(t.history.undoDepth=this.history.undoDepth,t.setHistory(this.getHistory())),t},linkedDoc:function(e){e||(e={});var t=this.first,n=this.first+this.size;null!=e.from&&e.from>t&&(t=e.from),null!=e.to&&e.to<n&&(n=e.to);var r=new wa(Ze(this,t,n),e.mode||this.modeOption,t,this.lineSep,this.direction);return e.sharedHist&&(r.history=this.history),(this.linked||(this.linked=[])).push({doc:r,sharedHist:e.sharedHist}),r.linked=[{doc:this,isParent:!0,sharedHist:e.sharedHist}],_a(r,ya(this)),r},unlinkDoc:function(e){var t=this;if(e instanceof ks&&(e=e.doc),this.linked)for(var n=0;n<this.linked.length;++n){var r=t.linked[n];if(r.doc==e){t.linked.splice(n,1),e.unlinkDoc(t),xa(ya(t));break}}if(e.history==this.history){var i=[e.id];go(e,(function(e){return i.push(e.id)}),!0),e.history=new bo(null),e.history.done=Io(this.history.done,i),e.history.undone=Io(this.history.undone,i)}},iterLinkedDocs:function(e){go(this,e)},getMode:function(){return this.mode},getEditor:function(){return this.cm},splitLines:function(e){return this.lineSep?e.split(this.lineSep):Ie(e)},lineSeparator:function(){return this.lineSep||"\n"},setDirection:Ii((function(e){"rtl"!=e&&(e="ltr"),e!=this.direction&&(this.direction=e,this.iter((function(e){return e.order=null})),this.cm&&xo(this.cm))}))}),wa.prototype.eachLine=wa.prototype.iter;var Aa=0;function Ta(e){var t=this;if(Ca(t),!ye(t,e)&&!Vn(t.display,e)){we(e),a&&(Aa=+new Date);var n=Rr(t,e,!0),r=e.dataTransfer.files;if(n&&!t.isReadOnly())if(r&&r.length&&window.FileReader&&window.File)for(var i=r.length,o=Array(i),s=0,l=function(e,r){if(!t.options.allowDropFileTypes||-1!=H(t.options.allowDropFileTypes,e.type)){var a=new FileReader;a.onload=Di(t,(function(){var e=a.result;if(/[\x00-\x08\x0e-\x1f]{2}/.test(e)&&(e=""),o[r]=e,++s==i){n=dt(t.doc,n);var l={from:n,to:n,text:t.doc.splitLines(o.join(t.doc.lineSeparator())),origin:"paste"};Ko(t.doc,l),Ho(t.doc,ao(n,so(l)))}})),a.readAsText(e)}},u=0;u<i;++u)l(r[u],u);else{if(t.state.draggingText&&t.doc.sel.contains(n)>-1)return t.state.draggingText(e),void setTimeout((function(){return t.display.input.focus()}),20);try{var c=e.dataTransfer.getData("Text");if(c){var d;if(t.state.draggingText&&!t.state.draggingText.copy&&(d=t.listSelections()),Go(t.doc,ao(n,n)),d)for(var f=0;f<d.length;++f)ra(t.doc,"",d[f].anchor,d[f].head,"drag");t.replaceSelection(c,"around","paste"),t.display.input.focus()}}catch(e){}}}}function Sa(e,t){if(a&&(!e.state.draggingText||+new Date-Aa<100))Se(t);else if(!ye(e,t)&&!Vn(e.display,t)&&(t.dataTransfer.setData("Text",e.getSelection()),t.dataTransfer.effectAllowed="copyMove",t.dataTransfer.setDragImage&&!f)){var n=L("img",null,null,"position: fixed; left: 0; top: 0;");n.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",d&&(n.width=n.height=1,e.display.wrapper.appendChild(n),n._top=n.offsetTop),t.dataTransfer.setDragImage(n,0,0),d&&n.parentNode.removeChild(n)}}function Ea(e,t){var n=Rr(e,t);if(n){var r=document.createDocumentFragment();jr(e,n,r),e.display.dragCursor||(e.display.dragCursor=L("div",null,"CodeMirror-cursors CodeMirror-dragcursors"),e.display.lineSpace.insertBefore(e.display.dragCursor,e.display.cursorDiv)),M(e.display.dragCursor,r)}}function Ca(e){e.display.dragCursor&&(e.display.lineSpace.removeChild(e.display.dragCursor),e.display.dragCursor=null)}function Ma(e){if(document.getElementsByClassName){for(var t=document.getElementsByClassName("CodeMirror"),n=[],r=0;r<t.length;r++){var i=t[r].CodeMirror;i&&n.push(i)}n.length&&n[0].operation((function(){for(var t=0;t<n.length;t++)e(n[t])}))}}var La=!1;function Na(){La||(Da(),La=!0)}function Da(){var e;pe(window,"resize",(function(){null==e&&(e=setTimeout((function(){e=null,Ma(Oa)}),100))})),pe(window,"blur",(function(){return Ma(Kr)}))}function Oa(e){var t=e.display;t.cachedCharWidth=t.cachedTextHeight=t.cachedPaddingH=null,t.scrollbarsClipped=!1,e.setSize()}for(var Ia={3:"Pause",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",61:"=",91:"Mod",92:"Mod",93:"Mod",106:"*",107:"=",109:"-",110:".",111:"/",145:"ScrollLock",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",63232:"Up",63233:"Down",63234:"Left",63235:"Right",63272:"Delete",63273:"Home",63275:"End",63276:"PageUp",63277:"PageDown",63302:"Insert"},Ra=0;Ra<10;Ra++)Ia[Ra+48]=Ia[Ra+96]=String(Ra);for(var Pa=65;Pa<=90;Pa++)Ia[Pa]=String.fromCharCode(Pa);for(var ka=1;ka<=12;ka++)Ia[ka+111]=Ia[ka+63235]="F"+ka;var Ba={};function Fa(e){var t,n,r,i,o=e.split(/-(?!$)/);e=o[o.length-1];for(var a=0;a<o.length-1;a++){var s=o[a];if(/^(cmd|meta|m)$/i.test(s))i=!0;else if(/^a(lt)?$/i.test(s))t=!0;else if(/^(c|ctrl|control)$/i.test(s))n=!0;else{if(!/^s(hift)?$/i.test(s))throw new Error("Unrecognized modifier name: "+s);r=!0}}return t&&(e="Alt-"+e),n&&(e="Ctrl-"+e),i&&(e="Cmd-"+e),r&&(e="Shift-"+e),e}function za(e){var t={};for(var n in e)if(e.hasOwnProperty(n)){var r=e[n];if(/^(name|fallthrough|(de|at)tach)$/.test(n))continue;if("..."==r){delete e[n];continue}for(var i=$(n.split(" "),Fa),o=0;o<i.length;o++){var a=void 0,s=void 0;o==i.length-1?(s=i.join(" "),a=r):(s=i.slice(0,o+1).join(" "),a="...");var l=t[s];if(l){if(l!=a)throw new Error("Inconsistent bindings for "+s)}else t[s]=a}delete e[n]}for(var u in t)e[u]=t[u];return e}function Ha(e,t,n,r){t=ja(t);var i=t.call?t.call(e,r):t[e];if(!1===i)return"nothing";if("..."===i)return"multi";if(null!=i&&n(i))return"handled";if(t.fallthrough){if("[object Array]"!=Object.prototype.toString.call(t.fallthrough))return Ha(e,t.fallthrough,n,r);for(var o=0;o<t.fallthrough.length;o++){var a=Ha(e,t.fallthrough[o],n,r);if(a)return a}}}function Ua(e){var t="string"==typeof e?e:Ia[e.keyCode];return"Ctrl"==t||"Alt"==t||"Shift"==t||"Mod"==t}function Ga(e,t,n){var r=e;return t.altKey&&"Alt"!=r&&(e="Alt-"+e),(w?t.metaKey:t.ctrlKey)&&"Ctrl"!=r&&(e="Ctrl-"+e),(w?t.ctrlKey:t.metaKey)&&"Cmd"!=r&&(e="Cmd-"+e),!n&&t.shiftKey&&"Shift"!=r&&(e="Shift-"+e),e}function Va(e,t){if(d&&34==e.keyCode&&e["char"])return!1;var n=Ia[e.keyCode];return null!=n&&!e.altGraphKey&&(3==e.keyCode&&e.code&&(n=e.code),Ga(n,e,t))}function ja(e){return"string"==typeof e?Ba[e]:e}function Wa(e,t){for(var n=e.doc.sel.ranges,r=[],i=0;i<n.length;i++){var o=t(n[i]);while(r.length&&ot(o.from,Q(r).to)<=0){var a=r.pop();if(ot(a.from,o.from)<0){o.from=a.from;break}}r.push(o)}Ni(e,(function(){for(var t=r.length-1;t>=0;t--)ra(e.doc,"",r[t].from,r[t].to,"+delete");ai(e)}))}function Xa(e,t,n){var r=ae(e.text,t+n,n);return r<0||r>e.text.length?null:r}function Ya(e,t,n){var r=Xa(e,t.ch,n);return null==r?null:new it(t.line,r,n<0?"after":"before")}function qa(e,t,n,r,i){if(e){var o=fe(n,t.doc.direction);if(o){var a,s=i<0?Q(o):o[0],l=i<0==(1==s.level),u=l?"after":"before";if(s.level>0||"rtl"==t.doc.direction){var c=tr(t,n);a=i<0?n.text.length-1:0;var d=nr(t,c,a).top;a=se((function(e){return nr(t,c,e).top==d}),i<0==(1==s.level)?s.from:s.to-1,a),"before"==u&&(a=Xa(n,a,1))}else a=i<0?s.to:s.from;return new it(r,a,u)}}return new it(r,i<0?n.text.length:0,i<0?"before":"after")}function Qa(e,t,n,r){var i=fe(t,e.doc.direction);if(!i)return Ya(t,n,r);n.ch>=t.text.length?(n.ch=t.text.length,n.sticky="before"):n.ch<=0&&(n.ch=0,n.sticky="after");var o=ce(i,n.ch,n.sticky),a=i[o];if("ltr"==e.doc.direction&&a.level%2==0&&(r>0?a.to>n.ch:a.from<n.ch))return Ya(t,n,r);var s,l=function(e,n){return Xa(t,e instanceof it?e.ch:e,n)},u=function(n){return e.options.lineWrapping?(s=s||tr(e,t),Ar(e,t,s,n)):{begin:0,end:t.text.length}},c=u("before"==n.sticky?l(n,-1):n.ch);if("rtl"==e.doc.direction||1==a.level){var d=1==a.level==r<0,f=l(n,d?1:-1);if(null!=f&&(d?f<=a.to&&f<=c.end:f>=a.from&&f>=c.begin)){var h=d?"before":"after";return new it(n.line,f,h)}}var p=function(e,t,r){for(var o=function(e,t){return t?new it(n.line,l(e,1),"before"):new it(n.line,e,"after")};e>=0&&e<i.length;e+=t){var a=i[e],s=t>0==(1!=a.level),u=s?r.begin:l(r.end,-1);if(a.from<=u&&u<a.to)return o(u,s);if(u=s?a.from:l(a.to,-1),r.begin<=u&&u<r.end)return o(u,s)}},m=p(o+r,r,c);if(m)return m;var v=r>0?c.end:l(c.begin,-1);return null==v||r>0&&v==t.text.length||(m=p(r>0?0:i.length-1,r,u(v)),!m)?null:m}Ba.basic={Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharAfter",Backspace:"delCharBefore","Shift-Backspace":"delCharBefore",Tab:"defaultTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite",Esc:"singleSelection"},Ba.pcDefault={"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Up":"goLineUp","Ctrl-Down":"goLineDown","Ctrl-Left":"goGroupLeft","Ctrl-Right":"goGroupRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delGroupBefore","Ctrl-Delete":"delGroupAfter","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore","Ctrl-U":"undoSelection","Shift-Ctrl-U":"redoSelection","Alt-U":"redoSelection",fallthrough:"basic"},Ba.emacsy={"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Alt-F":"goWordRight","Alt-B":"goWordLeft","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharAfter","Ctrl-H":"delCharBefore","Alt-D":"delWordAfter","Alt-Backspace":"delWordBefore","Ctrl-K":"killLine","Ctrl-T":"transposeChars","Ctrl-O":"openLine"},Ba.macDefault={"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Home":"goDocStart","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goGroupLeft","Alt-Right":"goGroupRight","Cmd-Left":"goLineLeft","Cmd-Right":"goLineRight","Alt-Backspace":"delGroupBefore","Ctrl-Alt-Backspace":"delGroupAfter","Alt-Delete":"delGroupAfter","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore","Cmd-Backspace":"delWrappedLineLeft","Cmd-Delete":"delWrappedLineRight","Cmd-U":"undoSelection","Shift-Cmd-U":"redoSelection","Ctrl-Up":"goDocStart","Ctrl-Down":"goDocEnd",fallthrough:["basic","emacsy"]},Ba["default"]=y?Ba.macDefault:Ba.pcDefault;var $a={selectAll:Qo,singleSelection:function(e){return e.setSelection(e.getCursor("anchor"),e.getCursor("head"),V)},killLine:function(e){return Wa(e,(function(t){if(t.empty()){var n=$e(e.doc,t.head.line).text.length;return t.head.ch==n&&t.head.line<e.lastLine()?{from:t.head,to:it(t.head.line+1,0)}:{from:t.head,to:it(t.head.line,n)}}return{from:t.from(),to:t.to()}}))},deleteLine:function(e){return Wa(e,(function(t){return{from:it(t.from().line,0),to:dt(e.doc,it(t.to().line+1,0))}}))},delLineLeft:function(e){return Wa(e,(function(e){return{from:it(e.from().line,0),to:e.from()}}))},delWrappedLineLeft:function(e){return Wa(e,(function(t){var n=e.charCoords(t.head,"div").top+5,r=e.coordsChar({left:0,top:n},"div");return{from:r,to:t.from()}}))},delWrappedLineRight:function(e){return Wa(e,(function(t){var n=e.charCoords(t.head,"div").top+5,r=e.coordsChar({left:e.display.lineDiv.offsetWidth+100,top:n},"div");return{from:t.from(),to:r}}))},undo:function(e){return e.undo()},redo:function(e){return e.redo()},undoSelection:function(e){return e.undoSelection()},redoSelection:function(e){return e.redoSelection()},goDocStart:function(e){return e.extendSelection(it(e.firstLine(),0))},goDocEnd:function(e){return e.extendSelection(it(e.lastLine()))},goLineStart:function(e){return e.extendSelectionsBy((function(t){return Ka(e,t.head.line)}),{origin:"+move",bias:1})},goLineStartSmart:function(e){return e.extendSelectionsBy((function(t){return Ja(e,t.head)}),{origin:"+move",bias:1})},goLineEnd:function(e){return e.extendSelectionsBy((function(t){return Za(e,t.head.line)}),{origin:"+move",bias:-1})},goLineRight:function(e){return e.extendSelectionsBy((function(t){var n=e.cursorCoords(t.head,"div").top+5;return e.coordsChar({left:e.display.lineDiv.offsetWidth+100,top:n},"div")}),W)},goLineLeft:function(e){return e.extendSelectionsBy((function(t){var n=e.cursorCoords(t.head,"div").top+5;return e.coordsChar({left:0,top:n},"div")}),W)},goLineLeftSmart:function(e){return e.extendSelectionsBy((function(t){var n=e.cursorCoords(t.head,"div").top+5,r=e.coordsChar({left:0,top:n},"div");return r.ch<e.getLine(r.line).search(/\S/)?Ja(e,t.head):r}),W)},goLineUp:function(e){return e.moveV(-1,"line")},goLineDown:function(e){return e.moveV(1,"line")},goPageUp:function(e){return e.moveV(-1,"page")},goPageDown:function(e){return e.moveV(1,"page")},goCharLeft:function(e){return e.moveH(-1,"char")},goCharRight:function(e){return e.moveH(1,"char")},goColumnLeft:function(e){return e.moveH(-1,"column")},goColumnRight:function(e){return e.moveH(1,"column")},goWordLeft:function(e){return e.moveH(-1,"word")},goGroupRight:function(e){return e.moveH(1,"group")},goGroupLeft:function(e){return e.moveH(-1,"group")},goWordRight:function(e){return e.moveH(1,"word")},delCharBefore:function(e){return e.deleteH(-1,"char")},delCharAfter:function(e){return e.deleteH(1,"char")},delWordBefore:function(e){return e.deleteH(-1,"word")},delWordAfter:function(e){return e.deleteH(1,"word")},delGroupBefore:function(e){return e.deleteH(-1,"group")},delGroupAfter:function(e){return e.deleteH(1,"group")},indentAuto:function(e){return e.indentSelection("smart")},indentMore:function(e){return e.indentSelection("add")},indentLess:function(e){return e.indentSelection("subtract")},insertTab:function(e){return e.replaceSelection("\t")},insertSoftTab:function(e){for(var t=[],n=e.listSelections(),r=e.options.tabSize,i=0;i<n.length;i++){var o=n[i].from(),a=F(e.getLine(o.line),o.ch,r);t.push(q(r-a%r))}e.replaceSelections(t)},defaultTab:function(e){e.somethingSelected()?e.indentSelection("add"):e.execCommand("insertTab")},transposeChars:function(e){return Ni(e,(function(){for(var t=e.listSelections(),n=[],r=0;r<t.length;r++)if(t[r].empty()){var i=t[r].head,o=$e(e.doc,i.line).text;if(o)if(i.ch==o.length&&(i=new it(i.line,i.ch-1)),i.ch>0)i=new it(i.line,i.ch+1),e.replaceRange(o.charAt(i.ch-1)+o.charAt(i.ch-2),it(i.line,i.ch-2),i,"+transpose");else if(i.line>e.doc.first){var a=$e(e.doc,i.line-1).text;a&&(i=new it(i.line,1),e.replaceRange(o.charAt(0)+e.doc.lineSeparator()+a.charAt(a.length-1),it(i.line-1,a.length-1),i,"+transpose"))}n.push(new io(i,i))}e.setSelections(n)}))},newlineAndIndent:function(e){return Ni(e,(function(){for(var t=e.listSelections(),n=t.length-1;n>=0;n--)e.replaceRange(e.doc.lineSeparator(),t[n].anchor,t[n].head,"+input");t=e.listSelections();for(var r=0;r<t.length;r++)e.indentLine(t[r].from().line,null,!0);ai(e)}))},openLine:function(e){return e.replaceSelection("\n","start")},toggleOverwrite:function(e){return e.toggleOverwrite()}};function Ka(e,t){var n=$e(e.doc,t),r=Kt(n);return r!=n&&(t=et(r)),qa(!0,e,r,t,1)}function Za(e,t){var n=$e(e.doc,t),r=Zt(n);return r!=n&&(t=et(r)),qa(!0,e,n,t,-1)}function Ja(e,t){var n=Ka(e,t.line),r=$e(e.doc,n.line),i=fe(r,e.doc.direction);if(!i||0==i[0].level){var o=Math.max(0,r.text.search(/\S/)),a=t.line==n.line&&t.ch<=o&&t.ch;return it(n.line,a?0:o,n.sticky)}return n}function es(e,t,n){if("string"==typeof t&&(t=$a[t],!t))return!1;e.display.input.ensurePolled();var r=e.display.shift,i=!1;try{e.isReadOnly()&&(e.state.suppressEdits=!0),n&&(e.display.shift=!1),i=t(e)!=G}finally{e.display.shift=r,e.state.suppressEdits=!1}return i}function ts(e,t,n){for(var r=0;r<e.state.keyMaps.length;r++){var i=Ha(t,e.state.keyMaps[r],n,e);if(i)return i}return e.options.extraKeys&&Ha(t,e.options.extraKeys,n,e)||Ha(t,e.options.keyMap,n,e)}var ns=new z;function rs(e,t,n,r){var i=e.state.keySeq;if(i){if(Ua(t))return"handled";if(/\'$/.test(t)?e.state.keySeq=null:ns.set(50,(function(){e.state.keySeq==i&&(e.state.keySeq=null,e.display.input.reset())})),is(e,i+" "+t,n,r))return!0}return is(e,t,n,r)}function is(e,t,n,r){var i=ts(e,t,r);return"multi"==i&&(e.state.keySeq=t),"handled"==i&&Mn(e,"keyHandled",e,t,n),"handled"!=i&&"multi"!=i||(we(n),Yr(e)),!!i}function os(e,t){var n=Va(t,!0);return!!n&&(t.shiftKey&&!e.state.keySeq?rs(e,"Shift-"+n,t,(function(t){return es(e,t,!0)}))||rs(e,n,t,(function(t){if("string"==typeof t?/^go[A-Z]/.test(t):t.motion)return es(e,t)})):rs(e,n,t,(function(t){return es(e,t)})))}function as(e,t,n){return rs(e,"'"+n+"'",t,(function(t){return es(e,t,!0)}))}var ss=null;function ls(e){var t=this;if(t.curOp.focus=O(),!ye(t,e)){a&&s<11&&27==e.keyCode&&(e.returnValue=!1);var n=e.keyCode;t.display.shift=16==n||e.shiftKey;var r=os(t,e);d&&(ss=r?n:null,r||88!=n||Pe||!(y?e.metaKey:e.ctrlKey)||t.replaceSelection("",null,"cut")),18!=n||/\bCodeMirror-crosshair\b/.test(t.display.lineDiv.className)||us(t)}}function us(e){var t=e.display.lineDiv;function n(e){18!=e.keyCode&&e.altKey||(E(t,"CodeMirror-crosshair"),ve(document,"keyup",n),ve(document,"mouseover",n))}I(t,"CodeMirror-crosshair"),pe(document,"keyup",n),pe(document,"mouseover",n)}function cs(e){16==e.keyCode&&(this.doc.sel.shift=!1),ye(this,e)}function ds(e){var t=this;if(!(Vn(t.display,e)||ye(t,e)||e.ctrlKey&&!e.altKey||y&&e.metaKey)){var n=e.keyCode,r=e.charCode;if(d&&n==ss)return ss=null,void we(e);if(!d||e.which&&!(e.which<10)||!os(t,e)){var i=String.fromCharCode(null==r?n:r);"\b"!=i&&(as(t,e,i)||t.display.input.onKeyPress(e))}}}var fs,hs,ps=400,ms=function(e,t,n){this.time=e,this.pos=t,this.button=n};function vs(e,t){var n=+new Date;return hs&&hs.compare(n,e,t)?(fs=hs=null,"triple"):fs&&fs.compare(n,e,t)?(hs=new ms(n,e,t),fs=null,"double"):(fs=new ms(n,e,t),hs=null,"single")}function gs(e){var t=this,n=t.display;if(!(ye(t,e)||n.activeTouch&&n.input.supportsTouch()))if(n.input.ensurePolled(),n.shift=e.shiftKey,Vn(n,e))l||(n.scroller.draggable=!1,setTimeout((function(){return n.scroller.draggable=!0}),100));else if(!Es(t,e)){var r=Rr(t,e),i=Ce(e),o=r?vs(r,i):"single";window.focus(),1==i&&t.state.selectingText&&t.state.selectingText(e),r&&ys(t,i,r,o,e)||(1==i?r?xs(t,r,o,e):Ee(e)==n.scroller&&we(e):2==i?(r&&Po(t.doc,r),setTimeout((function(){return n.input.focus()}),20)):3==i&&(A?t.display.input.onContextMenu(e):Qr(t)))}}function ys(e,t,n,r,i){var o="Click";return"double"==r?o="Double"+o:"triple"==r&&(o="Triple"+o),o=(1==t?"Left":2==t?"Middle":"Right")+o,rs(e,Ga(o,i),i,(function(t){if("string"==typeof t&&(t=$a[t]),!t)return!1;var r=!1;try{e.isReadOnly()&&(e.state.suppressEdits=!0),r=t(e,n)!=G}finally{e.state.suppressEdits=!1}return r}))}function _s(e,t,n){var r=e.getOption("configureMouse"),i=r?r(e,t,n):{};if(null==i.unit){var o=_?n.shiftKey&&n.metaKey:n.altKey;i.unit=o?"rectangle":"single"==t?"char":"double"==t?"word":"line"}return(null==i.extend||e.doc.extend)&&(i.extend=e.doc.extend||n.shiftKey),null==i.addNew&&(i.addNew=y?n.metaKey:n.ctrlKey),null==i.moveOnDrag&&(i.moveOnDrag=!(y?n.altKey:n.ctrlKey)),i}function xs(e,t,n,r){a?setTimeout(k(qr,e),0):e.curOp.focus=O();var i,o=_s(e,n,r),s=e.doc.sel;e.options.dragDrop&&Ne&&!e.isReadOnly()&&"single"==n&&(i=s.contains(t))>-1&&(ot((i=s.ranges[i]).from(),t)<0||t.xRel>0)&&(ot(i.to(),t)>0||t.xRel<0)?bs(e,r,t,o):As(e,r,t,o)}function bs(e,t,n,r){var i=e.display,o=!1,u=Di(e,(function(t){l&&(i.scroller.draggable=!1),e.state.draggingText=!1,ve(i.wrapper.ownerDocument,"mouseup",u),ve(i.wrapper.ownerDocument,"mousemove",c),ve(i.scroller,"dragstart",d),ve(i.scroller,"drop",u),o||(we(t),r.addNew||Po(e.doc,n,null,null,r.extend),l||a&&9==s?setTimeout((function(){i.wrapper.ownerDocument.body.focus(),i.input.focus()}),20):i.input.focus())})),c=function(e){o=o||Math.abs(t.clientX-e.clientX)+Math.abs(t.clientY-e.clientY)>=10},d=function(){return o=!0};l&&(i.scroller.draggable=!0),e.state.draggingText=u,u.copy=!r.moveOnDrag,i.scroller.dragDrop&&i.scroller.dragDrop(),pe(i.wrapper.ownerDocument,"mouseup",u),pe(i.wrapper.ownerDocument,"mousemove",c),pe(i.scroller,"dragstart",d),pe(i.scroller,"drop",u),Qr(e),setTimeout((function(){return i.input.focus()}),20)}function ws(e,t,n){if("char"==n)return new io(t,t);if("word"==n)return e.findWordAt(t);if("line"==n)return new io(it(t.line,0),dt(e.doc,it(t.line+1,0)));var r=n(e,t);return new io(r.from,r.to)}function As(e,t,n,r){var i=e.display,o=e.doc;we(t);var a,s,l=o.sel,u=l.ranges;if(r.addNew&&!r.extend?(s=o.sel.contains(n),a=s>-1?u[s]:new io(n,n)):(a=o.sel.primary(),s=o.sel.primIndex),"rectangle"==r.unit)r.addNew||(a=new io(n,n)),n=Rr(e,t,!0,!0),s=-1;else{var c=ws(e,n,r.unit);a=r.extend?Ro(a,c.anchor,c.head,r.extend):c}r.addNew?-1==s?(s=u.length,Uo(o,oo(e,u.concat([a]),s),{scroll:!1,origin:"*mouse"})):u.length>1&&u[s].empty()&&"char"==r.unit&&!r.extend?(Uo(o,oo(e,u.slice(0,s).concat(u.slice(s+1)),0),{scroll:!1,origin:"*mouse"}),l=o.sel):Bo(o,s,a,j):(s=0,Uo(o,new ro([a],0),j),l=o.sel);var d=n;function f(t){if(0!=ot(d,t))if(d=t,"rectangle"==r.unit){for(var i=[],u=e.options.tabSize,c=F($e(o,n.line).text,n.ch,u),f=F($e(o,t.line).text,t.ch,u),h=Math.min(c,f),p=Math.max(c,f),m=Math.min(n.line,t.line),v=Math.min(e.lastLine(),Math.max(n.line,t.line));m<=v;m++){var g=$e(o,m).text,y=X(g,h,u);h==p?i.push(new io(it(m,y),it(m,y))):g.length>y&&i.push(new io(it(m,y),it(m,X(g,p,u))))}i.length||i.push(new io(n,n)),Uo(o,oo(e,l.ranges.slice(0,s).concat(i),s),{origin:"*mouse",scroll:!1}),e.scrollIntoView(t)}else{var _,x=a,b=ws(e,t,r.unit),w=x.anchor;ot(b.anchor,w)>0?(_=b.head,w=ut(x.from(),b.anchor)):(_=b.anchor,w=lt(x.to(),b.head));var A=l.ranges.slice(0);A[s]=Ts(e,new io(dt(o,w),_)),Uo(o,oo(e,A,s),j)}}var h=i.wrapper.getBoundingClientRect(),p=0;function m(t){var n=++p,a=Rr(e,t,!0,"rectangle"==r.unit);if(a)if(0!=ot(a,d)){e.curOp.focus=O(),f(a);var s=ei(i,o);(a.line>=s.to||a.line<s.from)&&setTimeout(Di(e,(function(){p==n&&m(t)})),150)}else{var l=t.clientY<h.top?-20:t.clientY>h.bottom?20:0;l&&setTimeout(Di(e,(function(){p==n&&(i.scroller.scrollTop+=l,m(t))})),50)}}function v(t){e.state.selectingText=!1,p=1/0,t&&(we(t),i.input.focus()),ve(i.wrapper.ownerDocument,"mousemove",g),ve(i.wrapper.ownerDocument,"mouseup",y),o.history.lastSelOrigin=null}var g=Di(e,(function(e){0!==e.buttons&&Ce(e)?m(e):v(e)})),y=Di(e,v);e.state.selectingText=y,pe(i.wrapper.ownerDocument,"mousemove",g),pe(i.wrapper.ownerDocument,"mouseup",y)}function Ts(e,t){var n=t.anchor,r=t.head,i=$e(e.doc,n.line);if(0==ot(n,r)&&n.sticky==r.sticky)return t;var o=fe(i);if(!o)return t;var a=ce(o,n.ch,n.sticky),s=o[a];if(s.from!=n.ch&&s.to!=n.ch)return t;var l,u=a+(s.from==n.ch==(1!=s.level)?0:1);if(0==u||u==o.length)return t;if(r.line!=n.line)l=(r.line-n.line)*("ltr"==e.doc.direction?1:-1)>0;else{var c=ce(o,r.ch,r.sticky),d=c-a||(r.ch-n.ch)*(1==s.level?-1:1);l=c==u-1||c==u?d<0:d>0}var f=o[u+(l?-1:0)],h=l==(1==f.level),p=h?f.from:f.to,m=h?"after":"before";return n.ch==p&&n.sticky==m?t:new io(new it(n.line,p,m),r)}function Ss(e,t,n,r){var i,o;if(t.touches)i=t.touches[0].clientX,o=t.touches[0].clientY;else try{i=t.clientX,o=t.clientY}catch(t){return!1}if(i>=Math.floor(e.display.gutters.getBoundingClientRect().right))return!1;r&&we(t);var a=e.display,s=a.lineDiv.getBoundingClientRect();if(o>s.bottom||!xe(e,n))return Te(t);o-=s.top-a.viewOffset;for(var l=0;l<e.display.gutterSpecs.length;++l){var u=a.gutters.childNodes[l];if(u&&u.getBoundingClientRect().right>=i){var c=tt(e.doc,o),d=e.display.gutterSpecs[l];return ge(e,n,e,c,d.className,t),Te(t)}}}function Es(e,t){return Ss(e,t,"gutterClick",!0)}function Cs(e,t){Vn(e.display,t)||Ms(e,t)||ye(e,t,"contextmenu")||A||e.display.input.onContextMenu(t)}function Ms(e,t){return!!xe(e,"gutterContextMenu")&&Ss(e,t,"gutterContextMenu",!1)}function Ls(e){e.display.wrapper.className=e.display.wrapper.className.replace(/\s*cm-s-\S+/g,"")+e.options.theme.replace(/(^|\s)\s*/g," cm-s-"),dr(e)}ms.prototype.compare=function(e,t,n){return this.time+ps>e&&0==ot(t,this.pos)&&n==this.button};var Ns={toString:function(){return"CodeMirror.Init"}},Ds={},Os={};function Is(e){var t=e.optionHandlers;function n(n,r,i,o){e.defaults[n]=r,i&&(t[n]=o?function(e,t,n){n!=Ns&&i(e,t,n)}:i)}e.defineOption=n,e.Init=Ns,n("value","",(function(e,t){return e.setValue(t)}),!0),n("mode",null,(function(e,t){e.doc.modeOption=t,ho(e)}),!0),n("indentUnit",2,ho,!0),n("indentWithTabs",!1),n("smartIndent",!0),n("tabSize",4,(function(e){po(e),dr(e),kr(e)}),!0),n("lineSeparator",null,(function(e,t){if(e.doc.lineSep=t,t){var n=[],r=e.doc.first;e.doc.iter((function(e){for(var i=0;;){var o=e.text.indexOf(t,i);if(-1==o)break;i=o+t.length,n.push(it(r,o))}r++}));for(var i=n.length-1;i>=0;i--)ra(e.doc,t,n[i],it(n[i].line,n[i].ch+t.length))}})),n("specialChars",/[\u0000-\u001f\u007f-\u009f\u00ad\u061c\u200b-\u200f\u2028\u2029\ufeff\ufff9-\ufffc]/g,(function(e,t,n){e.state.specialChars=new RegExp(t.source+(t.test("\t")?"":"|\t"),"g"),n!=Ns&&e.refresh()})),n("specialCharPlaceholder",mn,(function(e){return e.refresh()}),!0),n("electricChars",!0),n("inputStyle",g?"contenteditable":"textarea",(function(){throw new Error("inputStyle can not (yet) be changed in a running editor")}),!0),n("spellcheck",!1,(function(e,t){return e.getInputField().spellcheck=t}),!0),n("autocorrect",!1,(function(e,t){return e.getInputField().autocorrect=t}),!0),n("autocapitalize",!1,(function(e,t){return e.getInputField().autocapitalize=t}),!0),n("rtlMoveVisually",!x),n("wholeLineUpdateBefore",!0),n("theme","default",(function(e){Ls(e),$i(e)}),!0),n("keyMap","default",(function(e,t,n){var r=ja(t),i=n!=Ns&&ja(n);i&&i.detach&&i.detach(e,r),r.attach&&r.attach(e,i||null)})),n("extraKeys",null),n("configureMouse",null),n("lineWrapping",!1,Ps,!0),n("gutters",[],(function(e,t){e.display.gutterSpecs=qi(t,e.options.lineNumbers),$i(e)}),!0),n("fixedGutter",!0,(function(e,t){e.display.gutters.style.left=t?Dr(e.display)+"px":"0",e.refresh()}),!0),n("coverGutterNextToScrollbar",!1,(function(e){return gi(e)}),!0),n("scrollbarStyle","native",(function(e){xi(e),gi(e),e.display.scrollbars.setScrollTop(e.doc.scrollTop),e.display.scrollbars.setScrollLeft(e.doc.scrollLeft)}),!0),n("lineNumbers",!1,(function(e,t){e.display.gutterSpecs=qi(e.options.gutters,t),$i(e)}),!0),n("firstLineNumber",1,$i,!0),n("lineNumberFormatter",(function(e){return e}),$i,!0),n("showCursorWhenSelecting",!1,Gr,!0),n("resetSelectionOnContextMenu",!0),n("lineWiseCopyCut",!0),n("pasteLinesPerSelection",!0),n("selectionsMayTouch",!1),n("readOnly",!1,(function(e,t){"nocursor"==t&&(Kr(e),e.display.input.blur()),e.display.input.readOnlyChanged(t)})),n("disableInput",!1,(function(e,t){t||e.display.input.reset()}),!0),n("dragDrop",!0,Rs),n("allowDropFileTypes",null),n("cursorBlinkRate",530),n("cursorScrollMargin",0),n("cursorHeight",1,Gr,!0),n("singleCursorHeightPerLine",!0,Gr,!0),n("workTime",100),n("workDelay",100),n("flattenSpans",!0,po,!0),n("addModeClass",!1,po,!0),n("pollInterval",100),n("undoDepth",200,(function(e,t){return e.doc.history.undoDepth=t})),n("historyEventDelay",1250),n("viewportMargin",10,(function(e){return e.refresh()}),!0),n("maxHighlightLength",1e4,po,!0),n("moveInputWithCursor",!0,(function(e,t){t||e.display.input.resetPosition()})),n("tabindex",null,(function(e,t){return e.display.input.getField().tabIndex=t||""})),n("autofocus",null),n("direction","ltr",(function(e,t){return e.doc.setDirection(t)}),!0),n("phrases",null)}function Rs(e,t,n){var r=n&&n!=Ns;if(!t!=!r){var i=e.display.dragFunctions,o=t?pe:ve;o(e.display.scroller,"dragstart",i.start),o(e.display.scroller,"dragenter",i.enter),o(e.display.scroller,"dragover",i.over),o(e.display.scroller,"dragleave",i.leave),o(e.display.scroller,"drop",i.drop)}}function Ps(e){e.options.lineWrapping?(I(e.display.wrapper,"CodeMirror-wrap"),e.display.sizer.style.minWidth="",e.display.sizerWidth=null):(E(e.display.wrapper,"CodeMirror-wrap"),sn(e)),Ir(e),kr(e),dr(e),setTimeout((function(){return gi(e)}),100)}function ks(e,t){var n=this;if(!(this instanceof ks))return new ks(e,t);this.options=t=t?B(t):{},B(Ds,t,!1);var r=t.value;"string"==typeof r?r=new wa(r,t.mode,null,t.lineSeparator,t.direction):t.mode&&(r.modeOption=t.mode),this.doc=r;var i=new ks.inputStyles[t.inputStyle](this),o=this.display=new Ki(e,r,i,t);for(var u in o.wrapper.CodeMirror=this,Ls(this),t.lineWrapping&&(this.display.wrapper.className+=" CodeMirror-wrap"),xi(this),this.state={keyMaps:[],overlays:[],modeGen:0,overwrite:!1,delayingBlurEvent:!1,focused:!1,suppressEdits:!1,pasteIncoming:-1,cutIncoming:-1,selectingText:!1,draggingText:!1,highlight:new z,keySeq:null,specialChars:null},t.autofocus&&!g&&o.input.focus(),a&&s<11&&setTimeout((function(){return n.display.input.reset(!0)}),20),Bs(this),Na(),wi(this),this.curOp.forceUpdate=!0,yo(this,r),t.autofocus&&!g||this.hasFocus()?setTimeout(k($r,this),20):Kr(this),Os)Os.hasOwnProperty(u)&&Os[u](n,t[u],Ns);Yi(this),t.finishInit&&t.finishInit(this);for(var c=0;c<Fs.length;++c)Fs[c](n);Ai(this),l&&t.lineWrapping&&"optimizelegibility"==getComputedStyle(o.lineDiv).textRendering&&(o.lineDiv.style.textRendering="auto")}function Bs(e){var t=e.display;pe(t.scroller,"mousedown",Di(e,gs)),pe(t.scroller,"dblclick",a&&s<11?Di(e,(function(t){if(!ye(e,t)){var n=Rr(e,t);if(n&&!Es(e,t)&&!Vn(e.display,t)){we(t);var r=e.findWordAt(n);Po(e.doc,r.anchor,r.head)}}})):function(t){return ye(e,t)||we(t)}),pe(t.scroller,"contextmenu",(function(t){return Cs(e,t)}));var n,r={end:0};function i(){t.activeTouch&&(n=setTimeout((function(){return t.activeTouch=null}),1e3),r=t.activeTouch,r.end=+new Date)}function o(e){if(1!=e.touches.length)return!1;var t=e.touches[0];return t.radiusX<=1&&t.radiusY<=1}function l(e,t){if(null==t.left)return!0;var n=t.left-e.left,r=t.top-e.top;return n*n+r*r>400}pe(t.scroller,"touchstart",(function(i){if(!ye(e,i)&&!o(i)&&!Es(e,i)){t.input.ensurePolled(),clearTimeout(n);var a=+new Date;t.activeTouch={start:a,moved:!1,prev:a-r.end<=300?r:null},1==i.touches.length&&(t.activeTouch.left=i.touches[0].pageX,t.activeTouch.top=i.touches[0].pageY)}})),pe(t.scroller,"touchmove",(function(){t.activeTouch&&(t.activeTouch.moved=!0)})),pe(t.scroller,"touchend",(function(n){var r=t.activeTouch;if(r&&!Vn(t,n)&&null!=r.left&&!r.moved&&new Date-r.start<300){var o,a=e.coordsChar(t.activeTouch,"page");o=!r.prev||l(r,r.prev)?new io(a,a):!r.prev.prev||l(r,r.prev.prev)?e.findWordAt(a):new io(it(a.line,0),dt(e.doc,it(a.line+1,0))),e.setSelection(o.anchor,o.head),e.focus(),we(n)}i()})),pe(t.scroller,"touchcancel",i),pe(t.scroller,"scroll",(function(){t.scroller.clientHeight&&(di(e,t.scroller.scrollTop),hi(e,t.scroller.scrollLeft,!0),ge(e,"scroll",e))})),pe(t.scroller,"mousewheel",(function(t){return no(e,t)})),pe(t.scroller,"DOMMouseScroll",(function(t){return no(e,t)})),pe(t.wrapper,"scroll",(function(){return t.wrapper.scrollTop=t.wrapper.scrollLeft=0})),t.dragFunctions={enter:function(t){ye(e,t)||Se(t)},over:function(t){ye(e,t)||(Ea(e,t),Se(t))},start:function(t){return Sa(e,t)},drop:Di(e,Ta),leave:function(t){ye(e,t)||Ca(e)}};var u=t.input.getField();pe(u,"keyup",(function(t){return cs.call(e,t)})),pe(u,"keydown",Di(e,ls)),pe(u,"keypress",Di(e,ds)),pe(u,"focus",(function(t){return $r(e,t)})),pe(u,"blur",(function(t){return Kr(e,t)}))}ks.defaults=Ds,ks.optionHandlers=Os;var Fs=[];function zs(e,t,n,r){var i,o=e.doc;null==n&&(n="add"),"smart"==n&&(o.mode.indent?i=yt(e,t).state:n="prev");var a=e.options.tabSize,s=$e(o,t),l=F(s.text,null,a);s.stateAfter&&(s.stateAfter=null);var u,c=s.text.match(/^\s*/)[0];if(r||/\S/.test(s.text)){if("smart"==n&&(u=o.mode.indent(i,s.text.slice(c.length),s.text),u==G||u>150)){if(!r)return;n="prev"}}else u=0,n="not";"prev"==n?u=t>o.first?F($e(o,t-1).text,null,a):0:"add"==n?u=l+e.options.indentUnit:"subtract"==n?u=l-e.options.indentUnit:"number"==typeof n&&(u=l+n),u=Math.max(0,u);var d="",f=0;if(e.options.indentWithTabs)for(var h=Math.floor(u/a);h;--h)f+=a,d+="\t";if(f<u&&(d+=q(u-f)),d!=c)return ra(o,d,it(t,0),it(t,c.length),"+input"),s.stateAfter=null,!0;for(var p=0;p<o.sel.ranges.length;p++){var m=o.sel.ranges[p];if(m.head.line==t&&m.head.ch<c.length){var v=it(t,c.length);Bo(o,p,new io(v,v));break}}}ks.defineInitHook=function(e){return Fs.push(e)};var Hs=null;function Us(e){Hs=e}function Gs(e,t,n,r,i){var o=e.doc;e.display.shift=!1,r||(r=o.sel);var a=+new Date-200,s="paste"==i||e.state.pasteIncoming>a,l=Ie(t),u=null;if(s&&r.ranges.length>1)if(Hs&&Hs.text.join("\n")==t){if(r.ranges.length%Hs.text.length==0){u=[];for(var c=0;c<Hs.text.length;c++)u.push(o.splitLines(Hs.text[c]))}}else l.length==r.ranges.length&&e.options.pasteLinesPerSelection&&(u=$(l,(function(e){return[e]})));for(var d=e.curOp.updateInput,f=r.ranges.length-1;f>=0;f--){var h=r.ranges[f],p=h.from(),m=h.to();h.empty()&&(n&&n>0?p=it(p.line,p.ch-n):e.state.overwrite&&!s?m=it(m.line,Math.min($e(o,m.line).text.length,m.ch+Q(l).length)):s&&Hs&&Hs.lineWise&&Hs.text.join("\n")==t&&(p=m=it(p.line,0)));var v={from:p,to:m,text:u?u[f%u.length]:l,origin:i||(s?"paste":e.state.cutIncoming>a?"cut":"+input")};Ko(e.doc,v),Mn(e,"inputRead",e,v)}t&&!s&&js(e,t),ai(e),e.curOp.updateInput<2&&(e.curOp.updateInput=d),e.curOp.typing=!0,e.state.pasteIncoming=e.state.cutIncoming=-1}function Vs(e,t){var n=e.clipboardData&&e.clipboardData.getData("Text");if(n)return e.preventDefault(),t.isReadOnly()||t.options.disableInput||Ni(t,(function(){return Gs(t,n,0,null,"paste")})),!0}function js(e,t){if(e.options.electricChars&&e.options.smartIndent)for(var n=e.doc.sel,r=n.ranges.length-1;r>=0;r--){var i=n.ranges[r];if(!(i.head.ch>100||r&&n.ranges[r-1].head.line==i.head.line)){var o=e.getModeAt(i.head),a=!1;if(o.electricChars){for(var s=0;s<o.electricChars.length;s++)if(t.indexOf(o.electricChars.charAt(s))>-1){a=zs(e,i.head.line,"smart");break}}else o.electricInput&&o.electricInput.test($e(e.doc,i.head.line).text.slice(0,i.head.ch))&&(a=zs(e,i.head.line,"smart"));a&&Mn(e,"electricInput",e,i.head.line)}}}function Ws(e){for(var t=[],n=[],r=0;r<e.doc.sel.ranges.length;r++){var i=e.doc.sel.ranges[r].head.line,o={anchor:it(i,0),head:it(i+1,0)};n.push(o),t.push(e.getRange(o.anchor,o.head))}return{text:t,ranges:n}}function Xs(e,t,n,r){e.setAttribute("autocorrect",n?"":"off"),e.setAttribute("autocapitalize",r?"":"off"),e.setAttribute("spellcheck",!!t)}function Ys(){var e=L("textarea",null,null,"position: absolute; bottom: -1em; padding: 0; width: 1px; height: 1em; outline: none"),t=L("div",[e],null,"overflow: hidden; position: relative; width: 3px; height: 0px;");return l?e.style.width="1000px":e.setAttribute("wrap","off"),m&&(e.style.border="1px solid black"),Xs(e),t}function qs(e){var t=e.optionHandlers,n=e.helpers={};e.prototype={constructor:e,focus:function(){window.focus(),this.display.input.focus()},setOption:function(e,n){var r=this.options,i=r[e];r[e]==n&&"mode"!=e||(r[e]=n,t.hasOwnProperty(e)&&Di(this,t[e])(this,n,i),ge(this,"optionChange",this,e))},getOption:function(e){return this.options[e]},getDoc:function(){return this.doc},addKeyMap:function(e,t){this.state.keyMaps[t?"push":"unshift"](ja(e))},removeKeyMap:function(e){for(var t=this.state.keyMaps,n=0;n<t.length;++n)if(t[n]==e||t[n].name==e)return t.splice(n,1),!0},addOverlay:Oi((function(t,n){var r=t.token?t:e.getMode(this.options,t);if(r.startState)throw new Error("Overlays may not be stateful.");K(this.state.overlays,{mode:r,modeSpec:t,opaque:n&&n.opaque,priority:n&&n.priority||0},(function(e){return e.priority})),this.state.modeGen++,kr(this)})),removeOverlay:Oi((function(e){for(var t=this,n=this.state.overlays,r=0;r<n.length;++r){var i=n[r].modeSpec;if(i==e||"string"==typeof e&&i.name==e)return n.splice(r,1),t.state.modeGen++,void kr(t)}})),indentLine:Oi((function(e,t,n){"string"!=typeof t&&"number"!=typeof t&&(t=null==t?this.options.smartIndent?"smart":"prev":t?"add":"subtract"),nt(this.doc,e)&&zs(this,e,t,n)})),indentSelection:Oi((function(e){for(var t=this,n=this.doc.sel.ranges,r=-1,i=0;i<n.length;i++){var o=n[i];if(o.empty())o.head.line>r&&(zs(t,o.head.line,e,!0),r=o.head.line,i==t.doc.sel.primIndex&&ai(t));else{var a=o.from(),s=o.to(),l=Math.max(r,a.line);r=Math.min(t.lastLine(),s.line-(s.ch?0:1))+1;for(var u=l;u<r;++u)zs(t,u,e);var c=t.doc.sel.ranges;0==a.ch&&n.length==c.length&&c[i].from().ch>0&&Bo(t.doc,i,new io(a,c[i].to()),V)}}})),getTokenAt:function(e,t){return At(this,e,t)},getLineTokens:function(e,t){return At(this,it(e),t,!0)},getTokenTypeAt:function(e){e=dt(this.doc,e);var t,n=gt(this,$e(this.doc,e.line)),r=0,i=(n.length-1)/2,o=e.ch;if(0==o)t=n[2];else for(;;){var a=r+i>>1;if((a?n[2*a-1]:0)>=o)i=a;else{if(!(n[2*a+1]<o)){t=n[2*a+2];break}r=a+1}}var s=t?t.indexOf("overlay "):-1;return s<0?t:0==s?null:t.slice(0,s-1)},getModeAt:function(t){var n=this.doc.mode;return n.innerMode?e.innerMode(n,this.getTokenAt(t).state).mode:n},getHelper:function(e,t){return this.getHelpers(e,t)[0]},getHelpers:function(e,t){var r=this,i=[];if(!n.hasOwnProperty(t))return i;var o=n[t],a=this.getModeAt(e);if("string"==typeof a[t])o[a[t]]&&i.push(o[a[t]]);else if(a[t])for(var s=0;s<a[t].length;s++){var l=o[a[t][s]];l&&i.push(l)}else a.helperType&&o[a.helperType]?i.push(o[a.helperType]):o[a.name]&&i.push(o[a.name]);for(var u=0;u<o._global.length;u++){var c=o._global[u];c.pred(a,r)&&-1==H(i,c.val)&&i.push(c.val)}return i},getStateAfter:function(e,t){var n=this.doc;return e=ct(n,null==e?n.first+n.size-1:e),yt(this,e+1,t).state},cursorCoords:function(e,t){var n,r=this.doc.sel.primary();return n=null==e?r.head:"object"==typeof e?dt(this.doc,e):e?r.from():r.to(),yr(this,n,t||"page")},charCoords:function(e,t){return gr(this,dt(this.doc,e),t||"page")},coordsChar:function(e,t){return e=vr(this,e,t||"page"),br(this,e.left,e.top)},lineAtHeight:function(e,t){return e=vr(this,{top:e,left:0},t||"page").top,tt(this.doc,e+this.display.viewOffset)},heightAtLine:function(e,t,n){var r,i=!1;if("number"==typeof e){var o=this.doc.first+this.doc.size-1;e<this.doc.first?e=this.doc.first:e>o&&(e=o,i=!0),r=$e(this.doc,e)}else r=e;return mr(this,r,{top:0,left:0},t||"page",n||i).top+(i?this.doc.height-on(r):0)},defaultTextHeight:function(){return Mr(this.display)},defaultCharWidth:function(){return Lr(this.display)},getViewport:function(){return{from:this.display.viewFrom,to:this.display.viewTo}},addWidget:function(e,t,n,r,i){var o=this.display;e=yr(this,dt(this.doc,e));var a=e.bottom,s=e.left;if(t.style.position="absolute",t.setAttribute("cm-ignore-events","true"),this.display.input.setUneditable(t),o.sizer.appendChild(t),"over"==r)a=e.top;else if("above"==r||"near"==r){var l=Math.max(o.wrapper.clientHeight,this.doc.height),u=Math.max(o.sizer.clientWidth,o.lineSpace.clientWidth);("above"==r||e.bottom+t.offsetHeight>l)&&e.top>t.offsetHeight?a=e.top-t.offsetHeight:e.bottom+t.offsetHeight<=l&&(a=e.bottom),s+t.offsetWidth>u&&(s=u-t.offsetWidth)}t.style.top=a+"px",t.style.left=t.style.right="","right"==i?(s=o.sizer.clientWidth-t.offsetWidth,t.style.right="0px"):("left"==i?s=0:"middle"==i&&(s=(o.sizer.clientWidth-t.offsetWidth)/2),t.style.left=s+"px"),n&&ri(this,{left:s,top:a,right:s+t.offsetWidth,bottom:a+t.offsetHeight})},triggerOnKeyDown:Oi(ls),triggerOnKeyPress:Oi(ds),triggerOnKeyUp:cs,triggerOnMouseDown:Oi(gs),execCommand:function(e){if($a.hasOwnProperty(e))return $a[e].call(null,this)},triggerElectric:Oi((function(e){js(this,e)})),findPosH:function(e,t,n,r){var i=this,o=1;t<0&&(o=-1,t=-t);for(var a=dt(this.doc,e),s=0;s<t;++s)if(a=Qs(i.doc,a,o,n,r),a.hitSide)break;return a},moveH:Oi((function(e,t){var n=this;this.extendSelectionsBy((function(r){return n.display.shift||n.doc.extend||r.empty()?Qs(n.doc,r.head,e,t,n.options.rtlMoveVisually):e<0?r.from():r.to()}),W)})),deleteH:Oi((function(e,t){var n=this.doc.sel,r=this.doc;n.somethingSelected()?r.replaceSelection("",null,"+delete"):Wa(this,(function(n){var i=Qs(r,n.head,e,t,!1);return e<0?{from:i,to:n.head}:{from:n.head,to:i}}))})),findPosV:function(e,t,n,r){var i=this,o=1,a=r;t<0&&(o=-1,t=-t);for(var s=dt(this.doc,e),l=0;l<t;++l){var u=yr(i,s,"div");if(null==a?a=u.left:u.left=a,s=$s(i,u,o,n),s.hitSide)break}return s},moveV:Oi((function(e,t){var n=this,r=this.doc,i=[],o=!this.display.shift&&!r.extend&&r.sel.somethingSelected();if(r.extendSelectionsBy((function(a){if(o)return e<0?a.from():a.to();var s=yr(n,a.head,"div");null!=a.goalColumn&&(s.left=a.goalColumn),i.push(s.left);var l=$s(n,s,e,t);return"page"==t&&a==r.sel.primary()&&oi(n,gr(n,l,"div").top-s.top),l}),W),i.length)for(var a=0;a<r.sel.ranges.length;a++)r.sel.ranges[a].goalColumn=i[a]})),findWordAt:function(e){var t=this.doc,n=$e(t,e.line).text,r=e.ch,i=e.ch;if(n){var o=this.getHelper(e,"wordChars");"before"!=e.sticky&&i!=n.length||!r?++i:--r;var a=n.charAt(r),s=ne(a,o)?function(e){return ne(e,o)}:/\s/.test(a)?function(e){return/\s/.test(e)}:function(e){return!/\s/.test(e)&&!ne(e)};while(r>0&&s(n.charAt(r-1)))--r;while(i<n.length&&s(n.charAt(i)))++i}return new io(it(e.line,r),it(e.line,i))},toggleOverwrite:function(e){null!=e&&e==this.state.overwrite||((this.state.overwrite=!this.state.overwrite)?I(this.display.cursorDiv,"CodeMirror-overwrite"):E(this.display.cursorDiv,"CodeMirror-overwrite"),ge(this,"overwriteToggle",this,this.state.overwrite))},hasFocus:function(){return this.display.input.getField()==O()},isReadOnly:function(){return!(!this.options.readOnly&&!this.doc.cantEdit)},scrollTo:Oi((function(e,t){si(this,e,t)})),getScrollInfo:function(){var e=this.display.scroller;return{left:e.scrollLeft,top:e.scrollTop,height:e.scrollHeight-Yn(this)-this.display.barHeight,width:e.scrollWidth-Yn(this)-this.display.barWidth,clientHeight:Qn(this),clientWidth:qn(this)}},scrollIntoView:Oi((function(e,t){null==e?(e={from:this.doc.sel.primary().head,to:null},null==t&&(t=this.options.cursorScrollMargin)):"number"==typeof e?e={from:it(e,0),to:null}:null==e.from&&(e={from:e,to:null}),e.to||(e.to=e.from),e.margin=t||0,null!=e.from.line?li(this,e):ci(this,e.from,e.to,e.margin)})),setSize:Oi((function(e,t){var n=this,r=function(e){return"number"==typeof e||/^\d+$/.test(String(e))?e+"px":e};null!=e&&(this.display.wrapper.style.width=r(e)),null!=t&&(this.display.wrapper.style.height=r(t)),this.options.lineWrapping&&cr(this);var i=this.display.viewFrom;this.doc.iter(i,this.display.viewTo,(function(e){if(e.widgets)for(var t=0;t<e.widgets.length;t++)if(e.widgets[t].noHScroll){Br(n,i,"widget");break}++i})),this.curOp.forceUpdate=!0,ge(this,"refresh",this)})),operation:function(e){return Ni(this,e)},startOperation:function(){return wi(this)},endOperation:function(){return Ai(this)},refresh:Oi((function(){var e=this.display.cachedTextHeight;kr(this),this.curOp.forceUpdate=!0,dr(this),si(this,this.doc.scrollLeft,this.doc.scrollTop),ji(this.display),(null==e||Math.abs(e-Mr(this.display))>.5)&&Ir(this),ge(this,"refresh",this)})),swapDoc:Oi((function(e){var t=this.doc;return t.cm=null,this.state.selectingText&&this.state.selectingText(),yo(this,e),dr(this),this.display.input.reset(),si(this,e.scrollLeft,e.scrollTop),this.curOp.forceScroll=!0,Mn(this,"swapDoc",this,t),t})),phrase:function(e){var t=this.options.phrases;return t&&Object.prototype.hasOwnProperty.call(t,e)?t[e]:e},getInputField:function(){return this.display.input.getField()},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},getGutterElement:function(){return this.display.gutters}},be(e),e.registerHelper=function(t,r,i){n.hasOwnProperty(t)||(n[t]=e[t]={_global:[]}),n[t][r]=i},e.registerGlobalHelper=function(t,r,i,o){e.registerHelper(t,r,o),n[t]._global.push({pred:i,val:o})}}function Qs(e,t,n,r,i){var o=t,a=n,s=$e(e,t.line);function l(){var r=t.line+n;return!(r<e.first||r>=e.first+e.size)&&(t=new it(r,t.ch,t.sticky),s=$e(e,r))}function u(r){var o;if(o=i?Qa(e.cm,s,t,n):Ya(s,t,n),null==o){if(r||!l())return!1;t=qa(i,e.cm,s,t.line,n)}else t=o;return!0}if("char"==r)u();else if("column"==r)u(!0);else if("word"==r||"group"==r)for(var c=null,d="group"==r,f=e.cm&&e.cm.getHelper(t,"wordChars"),h=!0;;h=!1){if(n<0&&!u(!h))break;var p=s.text.charAt(t.ch)||"\n",m=ne(p,f)?"w":d&&"\n"==p?"n":!d||/\s/.test(p)?null:"p";if(!d||h||m||(m="s"),c&&c!=m){n<0&&(n=1,u(),t.sticky="after");break}if(m&&(c=m),n>0&&!u(!h))break}var v=Yo(e,t,o,a,!0);return at(o,v)&&(v.hitSide=!0),v}function $s(e,t,n,r){var i,o,a=e.doc,s=t.left;if("page"==r){var l=Math.min(e.display.wrapper.clientHeight,window.innerHeight||document.documentElement.clientHeight),u=Math.max(l-.5*Mr(e.display),3);i=(n>0?t.bottom:t.top)+n*u}else"line"==r&&(i=n>0?t.bottom+3:t.top-3);for(;;){if(o=br(e,s,i),!o.outside)break;if(n<0?i<=0:i>=a.height){o.hitSide=!0;break}i+=5*n}return o}var Ks=function(e){this.cm=e,this.lastAnchorNode=this.lastAnchorOffset=this.lastFocusNode=this.lastFocusOffset=null,this.polling=new z,this.composing=null,this.gracePeriod=!1,this.readDOMTimeout=null};function Zs(e,t){var n=er(e,t.line);if(!n||n.hidden)return null;var r=$e(e.doc,t.line),i=Kn(n,r,t.line),o=fe(r,e.doc.direction),a="left";if(o){var s=ce(o,t.ch);a=s%2?"right":"left"}var l=or(i.map,t.ch,a);return l.offset="right"==l.collapse?l.end:l.start,l}function Js(e){for(var t=e;t;t=t.parentNode)if(/CodeMirror-gutter-wrapper/.test(t.className))return!0;return!1}function el(e,t){return t&&(e.bad=!0),e}function tl(e,t,n,r,i){var o="",a=!1,s=e.doc.lineSeparator(),l=!1;function u(e){return function(t){return t.id==e}}function c(){a&&(o+=s,l&&(o+=s),a=l=!1)}function d(e){e&&(c(),o+=e)}function f(t){if(1==t.nodeType){var n=t.getAttribute("cm-text");if(n)return void d(n);var o,h=t.getAttribute("cm-marker");if(h){var p=e.findMarks(it(r,0),it(i+1,0),u(+h));return void(p.length&&(o=p[0].find(0))&&d(Ke(e.doc,o.from,o.to).join(s)))}if("false"==t.getAttribute("contenteditable"))return;var m=/^(pre|div|p|li|table|br)$/i.test(t.nodeName);if(!/^br$/i.test(t.nodeName)&&0==t.textContent.length)return;m&&c();for(var v=0;v<t.childNodes.length;v++)f(t.childNodes[v]);/^(pre|p)$/i.test(t.nodeName)&&(l=!0),m&&(a=!0)}else 3==t.nodeType&&d(t.nodeValue.replace(/\u200b/g,"").replace(/\u00a0/g," "))}for(;;){if(f(t),t==n)break;t=t.nextSibling,l=!1}return o}function nl(e,t,n){var r;if(t==e.display.lineDiv){if(r=e.display.lineDiv.childNodes[n],!r)return el(e.clipPos(it(e.display.viewTo-1)),!0);t=null,n=0}else for(r=t;;r=r.parentNode){if(!r||r==e.display.lineDiv)return null;if(r.parentNode&&r.parentNode==e.display.lineDiv)break}for(var i=0;i<e.display.view.length;i++){var o=e.display.view[i];if(o.node==r)return rl(o,t,n)}}function rl(e,t,n){var r=e.text.firstChild,i=!1;if(!t||!D(r,t))return el(it(et(e.line),0),!0);if(t==r&&(i=!0,t=r.childNodes[n],n=0,!t)){var o=e.rest?Q(e.rest):e.line;return el(it(et(o),o.text.length),i)}var a=3==t.nodeType?t:null,s=t;a||1!=t.childNodes.length||3!=t.firstChild.nodeType||(a=t.firstChild,n&&(n=a.nodeValue.length));while(s.parentNode!=r)s=s.parentNode;var l=e.measure,u=l.maps;function c(t,n,r){for(var i=-1;i<(u?u.length:0);i++)for(var o=i<0?l.map:u[i],a=0;a<o.length;a+=3){var s=o[a+2];if(s==t||s==n){var c=et(i<0?e.line:e.rest[i]),d=o[a]+r;return(r<0||s!=t)&&(d=o[a+(r?1:0)]),it(c,d)}}}var d=c(a,s,n);if(d)return el(d,i);for(var f=s.nextSibling,h=a?a.nodeValue.length-n:0;f;f=f.nextSibling){if(d=c(f,f.firstChild,0),d)return el(it(d.line,d.ch-h),i);h+=f.textContent.length}for(var p=s.previousSibling,m=n;p;p=p.previousSibling){if(d=c(p,p.firstChild,-1),d)return el(it(d.line,d.ch+m),i);m+=p.textContent.length}}Ks.prototype.init=function(e){var t=this,n=this,r=n.cm,i=n.div=e.lineDiv;function o(e){if(!ye(r,e)){if(r.somethingSelected())Us({lineWise:!1,text:r.getSelections()}),"cut"==e.type&&r.replaceSelection("",null,"cut");else{if(!r.options.lineWiseCopyCut)return;var t=Ws(r);Us({lineWise:!0,text:t.text}),"cut"==e.type&&r.operation((function(){r.setSelections(t.ranges,0,V),r.replaceSelection("",null,"cut")}))}if(e.clipboardData){e.clipboardData.clearData();var o=Hs.text.join("\n");if(e.clipboardData.setData("Text",o),e.clipboardData.getData("Text")==o)return void e.preventDefault()}var a=Ys(),s=a.firstChild;r.display.lineSpace.insertBefore(a,r.display.lineSpace.firstChild),s.value=Hs.text.join("\n");var l=document.activeElement;P(s),setTimeout((function(){r.display.lineSpace.removeChild(a),l.focus(),l==i&&n.showPrimarySelection()}),50)}}Xs(i,r.options.spellcheck,r.options.autocorrect,r.options.autocapitalize),pe(i,"paste",(function(e){ye(r,e)||Vs(e,r)||s<=11&&setTimeout(Di(r,(function(){return t.updateFromDOM()})),20)})),pe(i,"compositionstart",(function(e){t.composing={data:e.data,done:!1}})),pe(i,"compositionupdate",(function(e){t.composing||(t.composing={data:e.data,done:!1})})),pe(i,"compositionend",(function(e){t.composing&&(e.data!=t.composing.data&&t.readFromDOMSoon(),t.composing.done=!0)})),pe(i,"touchstart",(function(){return n.forceCompositionEnd()})),pe(i,"input",(function(){t.composing||t.readFromDOMSoon()})),pe(i,"copy",o),pe(i,"cut",o)},Ks.prototype.prepareSelection=function(){var e=Vr(this.cm,!1);return e.focus=this.cm.state.focused,e},Ks.prototype.showSelection=function(e,t){e&&this.cm.display.view.length&&((e.focus||t)&&this.showPrimarySelection(),this.showMultipleSelections(e))},Ks.prototype.getSelection=function(){return this.cm.display.wrapper.ownerDocument.getSelection()},Ks.prototype.showPrimarySelection=function(){var e=this.getSelection(),t=this.cm,r=t.doc.sel.primary(),i=r.from(),o=r.to();if(t.display.viewTo==t.display.viewFrom||i.line>=t.display.viewTo||o.line<t.display.viewFrom)e.removeAllRanges();else{var a=nl(t,e.anchorNode,e.anchorOffset),s=nl(t,e.focusNode,e.focusOffset);if(!a||a.bad||!s||s.bad||0!=ot(ut(a,s),i)||0!=ot(lt(a,s),o)){var l=t.display.view,u=i.line>=t.display.viewFrom&&Zs(t,i)||{node:l[0].measure.map[2],offset:0},c=o.line<t.display.viewTo&&Zs(t,o);if(!c){var d=l[l.length-1].measure,f=d.maps?d.maps[d.maps.length-1]:d.map;c={node:f[f.length-1],offset:f[f.length-2]-f[f.length-3]}}if(u&&c){var h,p=e.rangeCount&&e.getRangeAt(0);try{h=S(u.node,u.offset,c.offset,c.node)}catch(m){}h&&(!n&&t.state.focused?(e.collapse(u.node,u.offset),h.collapsed||(e.removeAllRanges(),e.addRange(h))):(e.removeAllRanges(),e.addRange(h)),p&&null==e.anchorNode?e.addRange(p):n&&this.startGracePeriod()),this.rememberSelection()}else e.removeAllRanges()}}},Ks.prototype.startGracePeriod=function(){var e=this;clearTimeout(this.gracePeriod),this.gracePeriod=setTimeout((function(){e.gracePeriod=!1,e.selectionChanged()&&e.cm.operation((function(){return e.cm.curOp.selectionChanged=!0}))}),20)},Ks.prototype.showMultipleSelections=function(e){M(this.cm.display.cursorDiv,e.cursors),M(this.cm.display.selectionDiv,e.selection)},Ks.prototype.rememberSelection=function(){var e=this.getSelection();this.lastAnchorNode=e.anchorNode,this.lastAnchorOffset=e.anchorOffset,this.lastFocusNode=e.focusNode,this.lastFocusOffset=e.focusOffset},Ks.prototype.selectionInEditor=function(){var e=this.getSelection();if(!e.rangeCount)return!1;var t=e.getRangeAt(0).commonAncestorContainer;return D(this.div,t)},Ks.prototype.focus=function(){"nocursor"!=this.cm.options.readOnly&&(this.selectionInEditor()||this.showSelection(this.prepareSelection(),!0),this.div.focus())},Ks.prototype.blur=function(){this.div.blur()},Ks.prototype.getField=function(){return this.div},Ks.prototype.supportsTouch=function(){return!0},Ks.prototype.receivedFocus=function(){var e=this;function t(){e.cm.state.focused&&(e.pollSelection(),e.polling.set(e.cm.options.pollInterval,t))}this.selectionInEditor()?this.pollSelection():Ni(this.cm,(function(){return e.cm.curOp.selectionChanged=!0})),this.polling.set(this.cm.options.pollInterval,t)},Ks.prototype.selectionChanged=function(){var e=this.getSelection();return e.anchorNode!=this.lastAnchorNode||e.anchorOffset!=this.lastAnchorOffset||e.focusNode!=this.lastFocusNode||e.focusOffset!=this.lastFocusOffset},Ks.prototype.pollSelection=function(){if(null==this.readDOMTimeout&&!this.gracePeriod&&this.selectionChanged()){var e=this.getSelection(),t=this.cm;if(v&&c&&this.cm.display.gutterSpecs.length&&Js(e.anchorNode))return this.cm.triggerOnKeyDown({type:"keydown",keyCode:8,preventDefault:Math.abs}),this.blur(),void this.focus();if(!this.composing){this.rememberSelection();var n=nl(t,e.anchorNode,e.anchorOffset),r=nl(t,e.focusNode,e.focusOffset);n&&r&&Ni(t,(function(){Uo(t.doc,ao(n,r),V),(n.bad||r.bad)&&(t.curOp.selectionChanged=!0)}))}}},Ks.prototype.pollContent=function(){null!=this.readDOMTimeout&&(clearTimeout(this.readDOMTimeout),this.readDOMTimeout=null);var e,t,n,r=this.cm,i=r.display,o=r.doc.sel.primary(),a=o.from(),s=o.to();if(0==a.ch&&a.line>r.firstLine()&&(a=it(a.line-1,$e(r.doc,a.line-1).length)),s.ch==$e(r.doc,s.line).text.length&&s.line<r.lastLine()&&(s=it(s.line+1,0)),a.line<i.viewFrom||s.line>i.viewTo-1)return!1;a.line==i.viewFrom||0==(e=Pr(r,a.line))?(t=et(i.view[0].line),n=i.view[0].node):(t=et(i.view[e].line),n=i.view[e-1].node.nextSibling);var l,u,c=Pr(r,s.line);if(c==i.view.length-1?(l=i.viewTo-1,u=i.lineDiv.lastChild):(l=et(i.view[c+1].line)-1,u=i.view[c+1].node.previousSibling),!n)return!1;var d=r.doc.splitLines(tl(r,n,u,t,l)),f=Ke(r.doc,it(t,0),it(l,$e(r.doc,l).text.length));while(d.length>1&&f.length>1)if(Q(d)==Q(f))d.pop(),f.pop(),l--;else{if(d[0]!=f[0])break;d.shift(),f.shift(),t++}var h=0,p=0,m=d[0],v=f[0],g=Math.min(m.length,v.length);while(h<g&&m.charCodeAt(h)==v.charCodeAt(h))++h;var y=Q(d),_=Q(f),x=Math.min(y.length-(1==d.length?h:0),_.length-(1==f.length?h:0));while(p<x&&y.charCodeAt(y.length-p-1)==_.charCodeAt(_.length-p-1))++p;if(1==d.length&&1==f.length&&t==a.line)while(h&&h>a.ch&&y.charCodeAt(y.length-p-1)==_.charCodeAt(_.length-p-1))h--,p++;d[d.length-1]=y.slice(0,y.length-p).replace(/^\u200b+/,""),d[0]=d[0].slice(h).replace(/\u200b+$/,"");var b=it(t,h),w=it(l,f.length?Q(f).length-p:0);return d.length>1||d[0]||ot(b,w)?(ra(r.doc,d,b,w,"+input"),!0):void 0},Ks.prototype.ensurePolled=function(){this.forceCompositionEnd()},Ks.prototype.reset=function(){this.forceCompositionEnd()},Ks.prototype.forceCompositionEnd=function(){this.composing&&(clearTimeout(this.readDOMTimeout),this.composing=null,this.updateFromDOM(),this.div.blur(),this.div.focus())},Ks.prototype.readFromDOMSoon=function(){var e=this;null==this.readDOMTimeout&&(this.readDOMTimeout=setTimeout((function(){if(e.readDOMTimeout=null,e.composing){if(!e.composing.done)return;e.composing=null}e.updateFromDOM()}),80))},Ks.prototype.updateFromDOM=function(){var e=this;!this.cm.isReadOnly()&&this.pollContent()||Ni(this.cm,(function(){return kr(e.cm)}))},Ks.prototype.setUneditable=function(e){e.contentEditable="false"},Ks.prototype.onKeyPress=function(e){0==e.charCode||this.composing||(e.preventDefault(),this.cm.isReadOnly()||Di(this.cm,Gs)(this.cm,String.fromCharCode(null==e.charCode?e.keyCode:e.charCode),0))},Ks.prototype.readOnlyChanged=function(e){this.div.contentEditable=String("nocursor"!=e)},Ks.prototype.onContextMenu=function(){},Ks.prototype.resetPosition=function(){},Ks.prototype.needsContentAttribute=!0;var il=function(e){this.cm=e,this.prevInput="",this.pollingFast=!1,this.polling=new z,this.hasSelection=!1,this.composing=null};function ol(e,t){if(t=t?B(t):{},t.value=e.value,!t.tabindex&&e.tabIndex&&(t.tabindex=e.tabIndex),!t.placeholder&&e.placeholder&&(t.placeholder=e.placeholder),null==t.autofocus){var n=O();t.autofocus=n==e||null!=e.getAttribute("autofocus")&&n==document.body}function r(){e.value=s.getValue()}var i;if(e.form&&(pe(e.form,"submit",r),!t.leaveSubmitMethodAlone)){var o=e.form;i=o.submit;try{var a=o.submit=function(){r(),o.submit=i,o.submit(),o.submit=a}}catch(l){}}t.finishInit=function(n){n.save=r,n.getTextArea=function(){return e},n.toTextArea=function(){n.toTextArea=isNaN,r(),e.parentNode.removeChild(n.getWrapperElement()),e.style.display="",e.form&&(ve(e.form,"submit",r),t.leaveSubmitMethodAlone||"function"!=typeof e.form.submit||(e.form.submit=i))}},e.style.display="none";var s=ks((function(t){return e.parentNode.insertBefore(t,e.nextSibling)}),t);return s}function al(e){e.off=ve,e.on=pe,e.wheelEventPixels=to,e.Doc=wa,e.splitLines=Ie,e.countColumn=F,e.findColumn=X,e.isWordChar=te,e.Pass=G,e.signal=ge,e.Line=ln,e.changeEnd=so,e.scrollbarModel=_i,e.Pos=it,e.cmpPos=ot,e.modes=Fe,e.mimeModes=ze,e.resolveMode=Ge,e.getMode=Ve,e.modeExtensions=je,e.extendMode=We,e.copyState=Xe,e.startState=qe,e.innerMode=Ye,e.commands=$a,e.keyMap=Ba,e.keyName=Va,e.isModifierKey=Ua,e.lookupKey=Ha,e.normalizeKeyMap=za,e.StringStream=Qe,e.SharedTextMarker=va,e.TextMarker=pa,e.LineWidget=ca,e.e_preventDefault=we,e.e_stopPropagation=Ae,e.e_stop=Se,e.addClass=I,e.contains=D,e.rmClass=E,e.keyNames=Ia}il.prototype.init=function(e){var t=this,n=this,r=this.cm;this.createField(e);var i=this.textarea;function o(e){if(!ye(r,e)){if(r.somethingSelected())Us({lineWise:!1,text:r.getSelections()});else{if(!r.options.lineWiseCopyCut)return;var t=Ws(r);Us({lineWise:!0,text:t.text}),"cut"==e.type?r.setSelections(t.ranges,null,V):(n.prevInput="",i.value=t.text.join("\n"),P(i))}"cut"==e.type&&(r.state.cutIncoming=+new Date)}}e.wrapper.insertBefore(this.wrapper,e.wrapper.firstChild),m&&(i.style.width="0px"),pe(i,"input",(function(){a&&s>=9&&t.hasSelection&&(t.hasSelection=null),n.poll()})),pe(i,"paste",(function(e){ye(r,e)||Vs(e,r)||(r.state.pasteIncoming=+new Date,n.fastPoll())})),pe(i,"cut",o),pe(i,"copy",o),pe(e.scroller,"paste",(function(t){if(!Vn(e,t)&&!ye(r,t)){if(!i.dispatchEvent)return r.state.pasteIncoming=+new Date,void n.focus();var o=new Event("paste");o.clipboardData=t.clipboardData,i.dispatchEvent(o)}})),pe(e.lineSpace,"selectstart",(function(t){Vn(e,t)||we(t)})),pe(i,"compositionstart",(function(){var e=r.getCursor("from");n.composing&&n.composing.range.clear(),n.composing={start:e,range:r.markText(e,r.getCursor("to"),{className:"CodeMirror-composing"})}})),pe(i,"compositionend",(function(){n.composing&&(n.poll(),n.composing.range.clear(),n.composing=null)}))},il.prototype.createField=function(e){this.wrapper=Ys(),this.textarea=this.wrapper.firstChild},il.prototype.prepareSelection=function(){var e=this.cm,t=e.display,n=e.doc,r=Vr(e);if(e.options.moveInputWithCursor){var i=yr(e,n.sel.primary().head,"div"),o=t.wrapper.getBoundingClientRect(),a=t.lineDiv.getBoundingClientRect();r.teTop=Math.max(0,Math.min(t.wrapper.clientHeight-10,i.top+a.top-o.top)),r.teLeft=Math.max(0,Math.min(t.wrapper.clientWidth-10,i.left+a.left-o.left))}return r},il.prototype.showSelection=function(e){var t=this.cm,n=t.display;M(n.cursorDiv,e.cursors),M(n.selectionDiv,e.selection),null!=e.teTop&&(this.wrapper.style.top=e.teTop+"px",this.wrapper.style.left=e.teLeft+"px")},il.prototype.reset=function(e){if(!this.contextMenuPending&&!this.composing){var t=this.cm;if(t.somethingSelected()){this.prevInput="";var n=t.getSelection();this.textarea.value=n,t.state.focused&&P(this.textarea),a&&s>=9&&(this.hasSelection=n)}else e||(this.prevInput=this.textarea.value="",a&&s>=9&&(this.hasSelection=null))}},il.prototype.getField=function(){return this.textarea},il.prototype.supportsTouch=function(){return!1},il.prototype.focus=function(){if("nocursor"!=this.cm.options.readOnly&&(!g||O()!=this.textarea))try{this.textarea.focus()}catch(e){}},il.prototype.blur=function(){this.textarea.blur()},il.prototype.resetPosition=function(){this.wrapper.style.top=this.wrapper.style.left=0},il.prototype.receivedFocus=function(){this.slowPoll()},il.prototype.slowPoll=function(){var e=this;this.pollingFast||this.polling.set(this.cm.options.pollInterval,(function(){e.poll(),e.cm.state.focused&&e.slowPoll()}))},il.prototype.fastPoll=function(){var e=!1,t=this;function n(){var r=t.poll();r||e?(t.pollingFast=!1,t.slowPoll()):(e=!0,t.polling.set(60,n))}t.pollingFast=!0,t.polling.set(20,n)},il.prototype.poll=function(){var e=this,t=this.cm,n=this.textarea,r=this.prevInput;if(this.contextMenuPending||!t.state.focused||Re(n)&&!r&&!this.composing||t.isReadOnly()||t.options.disableInput||t.state.keySeq)return!1;var i=n.value;if(i==r&&!t.somethingSelected())return!1;if(a&&s>=9&&this.hasSelection===i||y&&/[\uf700-\uf7ff]/.test(i))return t.display.input.reset(),!1;if(t.doc.sel==t.display.selForContextMenu){var o=i.charCodeAt(0);if(8203!=o||r||(r="​"),8666==o)return this.reset(),this.cm.execCommand("undo")}var l=0,u=Math.min(r.length,i.length);while(l<u&&r.charCodeAt(l)==i.charCodeAt(l))++l;return Ni(t,(function(){Gs(t,i.slice(l),r.length-l,null,e.composing?"*compose":null),i.length>1e3||i.indexOf("\n")>-1?n.value=e.prevInput="":e.prevInput=i,e.composing&&(e.composing.range.clear(),e.composing.range=t.markText(e.composing.start,t.getCursor("to"),{className:"CodeMirror-composing"}))})),!0},il.prototype.ensurePolled=function(){this.pollingFast&&this.poll()&&(this.pollingFast=!1)},il.prototype.onKeyPress=function(){a&&s>=9&&(this.hasSelection=null),this.fastPoll()},il.prototype.onContextMenu=function(e){var t=this,n=t.cm,r=n.display,i=t.textarea;t.contextMenuPending&&t.contextMenuPending();var o=Rr(n,e),u=r.scroller.scrollTop;if(o&&!d){var c=n.options.resetSelectionOnContextMenu;c&&-1==n.doc.sel.contains(o)&&Di(n,Uo)(n.doc,ao(o),V);var f,h=i.style.cssText,p=t.wrapper.style.cssText,m=t.wrapper.offsetParent.getBoundingClientRect();if(t.wrapper.style.cssText="position: static",i.style.cssText="position: absolute; width: 30px; height: 30px;\n      top: "+(e.clientY-m.top-5)+"px; left: "+(e.clientX-m.left-5)+"px;\n      z-index: 1000; background: "+(a?"rgba(255, 255, 255, .05)":"transparent")+";\n      outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);",l&&(f=window.scrollY),r.input.focus(),l&&window.scrollTo(null,f),r.input.reset(),n.somethingSelected()||(i.value=t.prevInput=" "),t.contextMenuPending=y,r.selForContextMenu=n.doc.sel,clearTimeout(r.detectingSelectAll),a&&s>=9&&g(),A){Se(e);var v=function(){ve(window,"mouseup",v),setTimeout(y,20)};pe(window,"mouseup",v)}else setTimeout(y,50)}function g(){if(null!=i.selectionStart){var e=n.somethingSelected(),o="​"+(e?i.value:"");i.value="⇚",i.value=o,t.prevInput=e?"":"​",i.selectionStart=1,i.selectionEnd=o.length,r.selForContextMenu=n.doc.sel}}function y(){if(t.contextMenuPending==y&&(t.contextMenuPending=!1,t.wrapper.style.cssText=p,i.style.cssText=h,a&&s<9&&r.scrollbars.setScrollTop(r.scroller.scrollTop=u),null!=i.selectionStart)){(!a||a&&s<9)&&g();var e=0,o=function(){r.selForContextMenu==n.doc.sel&&0==i.selectionStart&&i.selectionEnd>0&&"​"==t.prevInput?Di(n,Qo)(n):e++<10?r.detectingSelectAll=setTimeout(o,500):(r.selForContextMenu=null,r.input.reset())};r.detectingSelectAll=setTimeout(o,200)}}},il.prototype.readOnlyChanged=function(e){e||this.reset(),this.textarea.disabled="nocursor"==e},il.prototype.setUneditable=function(){},il.prototype.needsContentAttribute=!1,Is(ks),qs(ks);var sl="iter insert remove copy getEditor constructor".split(" ");for(var ll in wa.prototype)wa.prototype.hasOwnProperty(ll)&&H(sl,ll)<0&&(ks.prototype[ll]=function(e){return function(){return e.apply(this.doc,arguments)}}(wa.prototype[ll]));return be(wa),ks.inputStyles={textarea:il,contenteditable:Ks},ks.defineMode=function(e){ks.defaults.mode||"null"==e||(ks.defaults.mode=e),He.apply(this,arguments)},ks.defineMIME=Ue,ks.defineMode("null",(function(){return{token:function(e){return e.skipToEnd()}}})),ks.defineMIME("text/plain","null"),ks.defineExtension=function(e,t){ks.prototype[e]=t},ks.defineDocExtension=function(e,t){wa.prototype[e]=t},ks.fromTextArea=ol,al(ks),ks.version="5.49.2",ks}))},"585a":function(e,t,n){(function(t){var n="object"==typeof t&&t&&t.Object===Object&&t;e.exports=n}).call(this,n("c8ba"))},"5a43":function(e,t){function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}e.exports=n,e.exports.__esModule=!0,e.exports["default"]=e.exports},6428:function(e,t,n){var r=n("b4b0"),i=1/0,o=17976931348623157e292;function a(e){if(!e)return 0===e?e:0;if(e=r(e),e===i||e===-i){var t=e<0?-1:1;return t*o}return e===e?e:0}e.exports=a},6613:function(e,t,n){var r=n("5a43");function i(e,t){if(e){if("string"==typeof e)return r(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}}e.exports=i,e.exports.__esModule=!0,e.exports["default"]=e.exports},6625:function(e,t,n){!function(t,n){e.exports=n()}("undefined"!=typeof self&&self,(function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=39)}([function(e,t){var n=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(e,t,n){var r=n(28)("wks"),i=n(29),o=n(0).Symbol,a="function"==typeof o;(e.exports=function(e){return r[e]||(r[e]=a&&o[e]||(a?o:i)("Symbol."+e))}).store=r},function(e,t){var n=e.exports={version:"2.5.7"};"number"==typeof __e&&(__e=n)},function(e,t,n){var r=n(6);e.exports=function(e){if(!r(e))throw TypeError(e+" is not an object!");return e}},function(e,t,n){var r=n(0),i=n(2),o=n(11),a=n(5),s=n(9),l=function(e,t,n){var u,c,d,f=e&l.F,h=e&l.G,p=e&l.S,m=e&l.P,v=e&l.B,g=e&l.W,y=h?i:i[t]||(i[t]={}),_=y.prototype,x=h?r:p?r[t]:(r[t]||{}).prototype;for(u in h&&(n=t),n)(c=!f&&x&&void 0!==x[u])&&s(y,u)||(d=c?x[u]:n[u],y[u]=h&&"function"!=typeof x[u]?n[u]:v&&c?o(d,r):g&&x[u]==d?function(e){var t=function(t,n,r){if(this instanceof e){switch(arguments.length){case 0:return new e;case 1:return new e(t);case 2:return new e(t,n)}return new e(t,n,r)}return e.apply(this,arguments)};return t.prototype=e.prototype,t}(d):m&&"function"==typeof d?o(Function.call,d):d,m&&((y.virtual||(y.virtual={}))[u]=d,e&l.R&&_&&!_[u]&&a(_,u,d)))};l.F=1,l.G=2,l.S=4,l.P=8,l.B=16,l.W=32,l.U=64,l.R=128,e.exports=l},function(e,t,n){var r=n(13),i=n(31);e.exports=n(7)?function(e,t,n){return r.f(e,t,i(1,n))}:function(e,t,n){return e[t]=n,e}},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t,n){e.exports=!n(14)((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},function(e,t){e.exports={}},function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},function(e,t){var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}},function(e,t,n){var r=n(12);e.exports=function(e,t,n){if(r(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,i){return e.call(t,n,r,i)}}return function(){return e.apply(t,arguments)}}},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t,n){var r=n(3),i=n(49),o=n(50),a=Object.defineProperty;t.f=n(7)?Object.defineProperty:function(e,t,n){if(r(e),t=o(t,!0),r(n),i)try{return a(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t,n){var r=n(16);e.exports=function(e){return Object(r(e))}},function(e,t){e.exports=function(e){if(void 0==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t,n){var r=n(45),i=n(30);e.exports=Object.keys||function(e){return r(e,i)}},function(e,t,n){var r=n(26),i=n(16);e.exports=function(e){return r(i(e))}},function(e,t){var n=Math.ceil,r=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?r:n)(e)}},function(e,t,n){var r=n(28)("keys"),i=n(29);e.exports=function(e){return r[e]||(r[e]=i(e))}},function(e,t){e.exports=!0},function(e,t,n){var r=n(6),i=n(0).document,o=r(i)&&r(i.createElement);e.exports=function(e){return o?i.createElement(e):{}}},function(e,t,n){var r=n(13).f,i=n(9),o=n(1)("toStringTag");e.exports=function(e,t,n){e&&!i(e=n?e:e.prototype,o)&&r(e,o,{configurable:!0,value:t})}},function(e,t,n){"use strict";var r=n(12);e.exports.f=function(e){return new function(e){var t,n;this.promise=new e((function(e,r){if(void 0!==t||void 0!==n)throw TypeError("Bad Promise constructor");t=e,n=r})),this.resolve=r(t),this.reject=r(n)}(e)}},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var r=l(n(42)),i=l(n(51)),o=l(n(79)),a=l(n(85)),s=l(n(86));function l(e){return e&&e.__esModule?e:{default:e}}t.default={name:"VueUeditorWrap",data:function(){return{status:0,initValue:"",defaultConfig:{UEDITOR_HOME_URL:e.env.BASE_URL?e.env.BASE_URL+"UEditor/":"/static/UEditor/",enableAutoSave:!1}}},props:{mode:{type:String,default:"observer",validator:function(e){return-1!==["observer","listener"].indexOf(e)}},value:{type:String,default:""},config:{type:Object,default:function(){return{}}},init:{type:Function,default:function(){return function(){}}},destroy:{type:Boolean,default:!1},name:{type:String,default:""},observerDebounceTime:{type:Number,default:50,validator:function(e){return e>=20}},observerOptions:{type:Object,default:function(){return{attributes:!0,attributeFilter:["src","style","type","name"],characterData:!0,childList:!0,subtree:!0}}},forceInit:{type:Boolean,default:!1}},computed:{mixedConfig:function(){return(0,o.default)({},this.defaultConfig,this.config)}},methods:{registerButton:function(e){var t=e.name,n=e.icon,r=e.tip,i=e.handler,o=e.index,a=e.UE,s=void 0===a?window.UE:a;s.registerUI(t,(function(e,t){e.registerCommand(t,{execCommand:function(){i(e,t)}});var o=new s.ui.Button({name:t,title:r,cssRules:"background-image: url("+n+") !important;background-size: cover;",onclick:function(){e.execCommand(t)}});return e.addListener("selectionchange",(function(){var n=e.queryCommandState(t);-1===n?(o.setDisabled(!0),o.setChecked(!1)):(o.setDisabled(!1),o.setChecked(n))})),o}),o,this.id)},_initEditor:function(){var e=this;this.$refs.script.id=this.id="editor_"+Math.random().toString(16).slice(-6),this.init(),this.$emit("beforeInit",this.id,this.mixedConfig),this.editor=window.UE.getEditor(this.id,this.mixedConfig),this.editor.addListener("ready",(function(){2===e.status?e.editor.setContent(e.value):(e.status=2,e.$emit("ready",e.editor),e.editor.setContent(e.initValue)),"observer"===e.mode&&window.MutationObserver?e._observerChangeListener():e._normalChangeListener()}))},_checkDependencies:function(){var e=this;return new i.default((function(t,n){window.UE&&window.UEDITOR_CONFIG&&0!==(0,r.default)(window.UEDITOR_CONFIG).length&&window.UE.getEditor?t():window.$loadEnv?window.$loadEnv.on("scriptsLoaded",(function(){t()})):(window.$loadEnv=new a.default,e._loadConfig().then((function(){return e._loadCore()})).then((function(){t(),window.$loadEnv.emit("scriptsLoaded")})))}))},_loadConfig:function(){var e=this;return new i.default((function(t,n){if(window.UE&&window.UEDITOR_CONFIG&&0!==(0,r.default)(window.UEDITOR_CONFIG).length)t();else{var i=document.createElement("script");i.type="text/javascript",i.src=e.mixedConfig.UEDITOR_HOME_URL+"ueditor.config.js",document.getElementsByTagName("head")[0].appendChild(i),i.onload=function(){window.UE&&window.UEDITOR_CONFIG&&0!==(0,r.default)(window.UEDITOR_CONFIG).length?t():console.error("加载ueditor.config.js失败,请检查您的配置地址UEDITOR_HOME_URL填写是否正确!\n",i.src)}}}))},_loadCore:function(){var e=this;return new i.default((function(t,n){if(window.UE&&window.UE.getEditor)t();else{var r=document.createElement("script");r.type="text/javascript",r.src=e.mixedConfig.UEDITOR_HOME_URL+"ueditor.all.min.js",document.getElementsByTagName("head")[0].appendChild(r),r.onload=function(){window.UE&&window.UE.getEditor?t():console.error("加载ueditor.all.min.js失败,请检查您的配置地址UEDITOR_HOME_URL填写是否正确!\n",r.src)}}}))},_setContent:function(e){e===this.editor.getContent()||this.editor.setContent(e)},contentChangeHandler:function(){this.$emit("input",this.editor.getContent())},_normalChangeListener:function(){this.editor.addListener("contentChange",this.contentChangeHandler)},_observerChangeListener:function(){var e=this;this.observer=new MutationObserver((0,s.default)((function(t){e.editor.document.getElementById("baidu_pastebin")||e.$emit("input",e.editor.getContent())}),this.observerDebounceTime)),this.observer.observe(this.editor.body,this.observerOptions)}},deactivated:function(){this.editor&&this.editor.removeListener("contentChange",this.contentChangeHandler),this.observer&&this.observer.disconnect()},beforeDestroy:function(){this.destroy&&this.editor&&this.editor.destroy&&this.editor.destroy(),this.observer&&this.observer.disconnect&&this.observer.disconnect()},watch:{value:{handler:function(t){var n=this;switch(this.status){case 0:this.status=1,this.initValue=t,(this.forceInit||void 0!==e&&e.client||"undefined"!=typeof window)&&this._checkDependencies().then((function(){n.$refs.script?n._initEditor():n.$nextTick((function(){return n._initEditor()}))}));break;case 1:this.initValue=t;break;case 2:this._setContent(t)}},immediate:!0}}}}).call(t,n(41))},function(e,t,n){var r=n(10);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==r(e)?e.split(""):Object(e)}},function(e,t,n){var r=n(19),i=Math.min;e.exports=function(e){return e>0?i(r(e),9007199254740991):0}},function(e,t,n){var r=n(2),i=n(0),o=i["__core-js_shared__"]||(i["__core-js_shared__"]={});(e.exports=function(e,t){return o[e]||(o[e]=void 0!==t?t:{})})("versions",[]).push({version:r.version,mode:n(21)?"pure":"global",copyright:"© 2018 Denis Pushkarev (zloirock.ru)"})},function(e,t){var n=0,r=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++n+r).toString(36))}},function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t,n){"use strict";var r=n(21),i=n(4),o=n(56),a=n(5),s=n(8),l=n(57),u=n(23),c=n(60),d=n(1)("iterator"),f=!([].keys&&"next"in[].keys()),h=function(){return this};e.exports=function(e,t,n,p,m,v,g){l(n,t,p);var y,_,x,b=function(e){if(!f&&e in S)return S[e];switch(e){case"keys":case"values":return function(){return new n(this,e)}}return function(){return new n(this,e)}},w=t+" Iterator",A="values"==m,T=!1,S=e.prototype,E=S[d]||S["@@iterator"]||m&&S[m],C=E||b(m),M=m?A?b("entries"):C:void 0,L="Array"==t&&S.entries||E;if(L&&(x=c(L.call(new e)))!==Object.prototype&&x.next&&(u(x,w,!0),r||"function"==typeof x[d]||a(x,d,h)),A&&E&&"values"!==E.name&&(T=!0,C=function(){return E.call(this)}),r&&!g||!f&&!T&&S[d]||a(S,d,C),s[t]=C,s[w]=h,m)if(y={values:A?C:b("values"),keys:v?C:b("keys"),entries:M},g)for(_ in y)_ in S||o(S,_,y[_]);else i(i.P+i.F*(f||T),t,y);return y}},function(e,t,n){var r=n(0).document;e.exports=r&&r.documentElement},function(e,t,n){var r=n(10),i=n(1)("toStringTag"),o="Arguments"==r(function(){return arguments}());e.exports=function(e){var t,n,a;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),i))?n:o?r(t):"Object"==(a=r(t))&&"function"==typeof t.callee?"Arguments":a}},function(e,t,n){var r=n(3),i=n(12),o=n(1)("species");e.exports=function(e,t){var n,a=r(e).constructor;return void 0===a||void 0==(n=r(a)[o])?t:i(n)}},function(e,t,n){var r,i,o,a=n(11),s=n(71),l=n(33),u=n(22),c=n(0),d=c.process,f=c.setImmediate,h=c.clearImmediate,p=c.MessageChannel,m=c.Dispatch,v=0,g={},y=function(){var e=+this;if(g.hasOwnProperty(e)){var t=g[e];delete g[e],t()}},_=function(e){y.call(e.data)};f&&h||(f=function(e){for(var t=[],n=1;arguments.length>n;)t.push(arguments[n++]);return g[++v]=function(){s("function"==typeof e?e:Function(e),t)},r(v),v},h=function(e){delete g[e]},"process"==n(10)(d)?r=function(e){d.nextTick(a(y,e,1))}:m&&m.now?r=function(e){m.now(a(y,e,1))}:p?(o=(i=new p).port2,i.port1.onmessage=_,r=a(o.postMessage,o,1)):c.addEventListener&&"function"==typeof postMessage&&!c.importScripts?(r=function(e){c.postMessage(e+"","*")},c.addEventListener("message",_,!1)):r="onreadystatechange"in u("script")?function(e){l.appendChild(u("script")).onreadystatechange=function(){l.removeChild(this),y.call(e)}}:function(e){setTimeout(a(y,e,1),0)}),e.exports={set:f,clear:h}},function(e,t){e.exports=function(e){try{return{e:!1,v:e()}}catch(e){return{e:!0,v:e}}}},function(e,t,n){var r=n(3),i=n(6),o=n(24);e.exports=function(e,t){if(r(e),i(t)&&t.constructor===e)return t;var n=o.f(e);return(0,n.resolve)(t),n.promise}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(25),i=n.n(r);for(var o in r)"default"!==o&&function(e){n.d(t,e,(function(){return r[e]}))}(o);var a=n(87),s=n(40)(i.a,a.a,!1,null,null,null);s.options.__file="src/components/vue-ueditor-wrap.vue",t.default=s.exports},function(e,t){e.exports=function(e,t,n,r,i,o){var a,s=e=e||{},l=typeof e.default;"object"!==l&&"function"!==l||(a=e,s=e.default);var u,c="function"==typeof s?s.options:s;if(t&&(c.render=t.render,c.staticRenderFns=t.staticRenderFns,c._compiled=!0),n&&(c.functional=!0),i&&(c._scopeId=i),o?(u=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),r&&r.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(o)},c._ssrRegister=u):r&&(u=r),u){var d=c.functional,f=d?c.render:c.beforeCreate;d?(c._injectStyles=u,c.render=function(e,t){return u.call(t),f(e,t)}):c.beforeCreate=f?[].concat(f,u):[u]}return{esModule:a,exports:s,options:c}}},function(e,t){var n,r,i=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(e){if(n===setTimeout)return setTimeout(e,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(e){n=o}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(e){r=a}}();var l,u=[],c=!1,d=-1;function f(){c&&l&&(c=!1,l.length?u=l.concat(u):d=-1,u.length&&h())}function h(){if(!c){var e=s(f);c=!0;for(var t=u.length;t;){for(l=u,u=[];++d<t;)l&&l[d].run();d=-1,t=u.length}l=null,c=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function m(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];u.push(new p(e,t)),1!==u.length||c||s(h)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=m,i.addListener=m,i.once=m,i.off=m,i.removeListener=m,i.removeAllListeners=m,i.emit=m,i.prependListener=m,i.prependOnceListener=m,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(e,t,n){e.exports={default:n(43),__esModule:!0}},function(e,t,n){n(44),e.exports=n(2).Object.keys},function(e,t,n){var r=n(15),i=n(17);n(48)("keys",(function(){return function(e){return i(r(e))}}))},function(e,t,n){var r=n(9),i=n(18),o=n(46)(!1),a=n(20)("IE_PROTO");e.exports=function(e,t){var n,s=i(e),l=0,u=[];for(n in s)n!=a&&r(s,n)&&u.push(n);for(;t.length>l;)r(s,n=t[l++])&&(~o(u,n)||u.push(n));return u}},function(e,t,n){var r=n(18),i=n(27),o=n(47);e.exports=function(e){return function(t,n,a){var s,l=r(t),u=i(l.length),c=o(a,u);if(e&&n!=n){for(;u>c;)if((s=l[c++])!=s)return!0}else for(;u>c;c++)if((e||c in l)&&l[c]===n)return e||c||0;return!e&&-1}}},function(e,t,n){var r=n(19),i=Math.max,o=Math.min;e.exports=function(e,t){return(e=r(e))<0?i(e+t,0):o(e,t)}},function(e,t,n){var r=n(4),i=n(2),o=n(14);e.exports=function(e,t){var n=(i.Object||{})[e]||Object[e],a={};a[e]=t(n),r(r.S+r.F*o((function(){n(1)})),"Object",a)}},function(e,t,n){e.exports=!n(7)&&!n(14)((function(){return 7!=Object.defineProperty(n(22)("div"),"a",{get:function(){return 7}}).a}))},function(e,t,n){var r=n(6);e.exports=function(e,t){if(!r(e))return e;var n,i;if(t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;if("function"==typeof(n=e.valueOf)&&!r(i=n.call(e)))return i;if(!t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;throw TypeError("Can't convert object to primitive value")}},function(e,t,n){e.exports={default:n(52),__esModule:!0}},function(e,t,n){n(53),n(54),n(61),n(65),n(77),n(78),e.exports=n(2).Promise},function(e,t){},function(e,t,n){"use strict";var r=n(55)(!0);n(32)(String,"String",(function(e){this._t=String(e),this._i=0}),(function(){var e,t=this._t,n=this._i;return n>=t.length?{value:void 0,done:!0}:(e=r(t,n),this._i+=e.length,{value:e,done:!1})}))},function(e,t,n){var r=n(19),i=n(16);e.exports=function(e){return function(t,n){var o,a,s=String(i(t)),l=r(n),u=s.length;return l<0||l>=u?e?"":void 0:(o=s.charCodeAt(l))<55296||o>56319||l+1===u||(a=s.charCodeAt(l+1))<56320||a>57343?e?s.charAt(l):o:e?s.slice(l,l+2):a-56320+(o-55296<<10)+65536}}},function(e,t,n){e.exports=n(5)},function(e,t,n){"use strict";var r=n(58),i=n(31),o=n(23),a={};n(5)(a,n(1)("iterator"),(function(){return this})),e.exports=function(e,t,n){e.prototype=r(a,{next:i(1,n)}),o(e,t+" Iterator")}},function(e,t,n){var r=n(3),i=n(59),o=n(30),a=n(20)("IE_PROTO"),s=function(){},l=function(){var e,t=n(22)("iframe"),r=o.length;for(t.style.display="none",n(33).appendChild(t),t.src="javascript:",(e=t.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),l=e.F;r--;)delete l.prototype[o[r]];return l()};e.exports=Object.create||function(e,t){var n;return null!==e?(s.prototype=r(e),n=new s,s.prototype=null,n[a]=e):n=l(),void 0===t?n:i(n,t)}},function(e,t,n){var r=n(13),i=n(3),o=n(17);e.exports=n(7)?Object.defineProperties:function(e,t){i(e);for(var n,a=o(t),s=a.length,l=0;s>l;)r.f(e,n=a[l++],t[n]);return e}},function(e,t,n){var r=n(9),i=n(15),o=n(20)("IE_PROTO"),a=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=i(e),r(e,o)?e[o]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?a:null}},function(e,t,n){n(62);for(var r=n(0),i=n(5),o=n(8),a=n(1)("toStringTag"),s="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),l=0;l<s.length;l++){var u=s[l],c=r[u],d=c&&c.prototype;d&&!d[a]&&i(d,a,u),o[u]=o.Array}},function(e,t,n){"use strict";var r=n(63),i=n(64),o=n(8),a=n(18);e.exports=n(32)(Array,"Array",(function(e,t){this._t=a(e),this._i=0,this._k=t}),(function(){var e=this._t,t=this._k,n=this._i++;return!e||n>=e.length?(this._t=void 0,i(1)):i(0,"keys"==t?n:"values"==t?e[n]:[n,e[n]])}),"values"),o.Arguments=o.Array,r("keys"),r("values"),r("entries")},function(e,t){e.exports=function(){}},function(e,t){e.exports=function(e,t){return{value:t,done:!!e}}},function(e,t,n){"use strict";var r,i,o,a,s=n(21),l=n(0),u=n(11),c=n(34),d=n(4),f=n(6),h=n(12),p=n(66),m=n(67),v=n(35),g=n(36).set,y=n(72)(),_=n(24),x=n(37),b=n(73),w=n(38),A=l.TypeError,T=l.process,S=T&&T.versions,E=S&&S.v8||"",C=l.Promise,M="process"==c(T),L=function(){},N=i=_.f,D=!!function(){try{var e=C.resolve(1),t=(e.constructor={})[n(1)("species")]=function(e){e(L,L)};return(M||"function"==typeof PromiseRejectionEvent)&&e.then(L)instanceof t&&0!==E.indexOf("6.6")&&-1===b.indexOf("Chrome/66")}catch(e){}}(),O=function(e){var t;return!(!f(e)||"function"!=typeof(t=e.then))&&t},I=function(e,t){if(!e._n){e._n=!0;var n=e._c;y((function(){for(var r=e._v,i=1==e._s,o=0,a=function(t){var n,o,a,s=i?t.ok:t.fail,l=t.resolve,u=t.reject,c=t.domain;try{s?(i||(2==e._h&&k(e),e._h=1),!0===s?n=r:(c&&c.enter(),n=s(r),c&&(c.exit(),a=!0)),n===t.promise?u(A("Promise-chain cycle")):(o=O(n))?o.call(n,l,u):l(n)):u(r)}catch(e){c&&!a&&c.exit(),u(e)}};n.length>o;)a(n[o++]);e._c=[],e._n=!1,t&&!e._h&&R(e)}))}},R=function(e){g.call(l,(function(){var t,n,r,i=e._v,o=P(e);if(o&&(t=x((function(){M?T.emit("unhandledRejection",i,e):(n=l.onunhandledrejection)?n({promise:e,reason:i}):(r=l.console)&&r.error&&r.error("Unhandled promise rejection",i)})),e._h=M||P(e)?2:1),e._a=void 0,o&&t.e)throw t.v}))},P=function(e){return 1!==e._h&&0===(e._a||e._c).length},k=function(e){g.call(l,(function(){var t;M?T.emit("rejectionHandled",e):(t=l.onrejectionhandled)&&t({promise:e,reason:e._v})}))},B=function(e){var t=this;t._d||(t._d=!0,(t=t._w||t)._v=e,t._s=2,t._a||(t._a=t._c.slice()),I(t,!0))},F=function(e){var t,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===e)throw A("Promise can't be resolved itself");(t=O(e))?y((function(){var r={_w:n,_d:!1};try{t.call(e,u(F,r,1),u(B,r,1))}catch(e){B.call(r,e)}})):(n._v=e,n._s=1,I(n,!1))}catch(e){B.call({_w:n,_d:!1},e)}}};D||(C=function(e){p(this,C,"Promise","_h"),h(e),r.call(this);try{e(u(F,this,1),u(B,this,1))}catch(e){B.call(this,e)}},(r=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=n(74)(C.prototype,{then:function(e,t){var n=N(v(this,C));return n.ok="function"!=typeof e||e,n.fail="function"==typeof t&&t,n.domain=M?T.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&I(this,!1),n.promise},catch:function(e){return this.then(void 0,e)}}),o=function(){var e=new r;this.promise=e,this.resolve=u(F,e,1),this.reject=u(B,e,1)},_.f=N=function(e){return e===C||e===a?new o(e):i(e)}),d(d.G+d.W+d.F*!D,{Promise:C}),n(23)(C,"Promise"),n(75)("Promise"),a=n(2).Promise,d(d.S+d.F*!D,"Promise",{reject:function(e){var t=N(this);return(0,t.reject)(e),t.promise}}),d(d.S+d.F*(s||!D),"Promise",{resolve:function(e){return w(s&&this===a?C:this,e)}}),d(d.S+d.F*!(D&&n(76)((function(e){C.all(e).catch(L)}))),"Promise",{all:function(e){var t=this,n=N(t),r=n.resolve,i=n.reject,o=x((function(){var n=[],o=0,a=1;m(e,!1,(function(e){var s=o++,l=!1;n.push(void 0),a++,t.resolve(e).then((function(e){l||(l=!0,n[s]=e,--a||r(n))}),i)})),--a||r(n)}));return o.e&&i(o.v),n.promise},race:function(e){var t=this,n=N(t),r=n.reject,i=x((function(){m(e,!1,(function(e){t.resolve(e).then(n.resolve,r)}))}));return i.e&&r(i.v),n.promise}})},function(e,t){e.exports=function(e,t,n,r){if(!(e instanceof t)||void 0!==r&&r in e)throw TypeError(n+": incorrect invocation!");return e}},function(e,t,n){var r=n(11),i=n(68),o=n(69),a=n(3),s=n(27),l=n(70),u={},c={};(t=e.exports=function(e,t,n,d,f){var h,p,m,v,g=f?function(){return e}:l(e),y=r(n,d,t?2:1),_=0;if("function"!=typeof g)throw TypeError(e+" is not iterable!");if(o(g)){for(h=s(e.length);h>_;_++)if((v=t?y(a(p=e[_])[0],p[1]):y(e[_]))===u||v===c)return v}else for(m=g.call(e);!(p=m.next()).done;)if((v=i(m,y,p.value,t))===u||v===c)return v}).BREAK=u,t.RETURN=c},function(e,t,n){var r=n(3);e.exports=function(e,t,n,i){try{return i?t(r(n)[0],n[1]):t(n)}catch(t){var o=e.return;throw void 0!==o&&r(o.call(e)),t}}},function(e,t,n){var r=n(8),i=n(1)("iterator"),o=Array.prototype;e.exports=function(e){return void 0!==e&&(r.Array===e||o[i]===e)}},function(e,t,n){var r=n(34),i=n(1)("iterator"),o=n(8);e.exports=n(2).getIteratorMethod=function(e){if(void 0!=e)return e[i]||e["@@iterator"]||o[r(e)]}},function(e,t){e.exports=function(e,t,n){var r=void 0===n;switch(t.length){case 0:return r?e():e.call(n);case 1:return r?e(t[0]):e.call(n,t[0]);case 2:return r?e(t[0],t[1]):e.call(n,t[0],t[1]);case 3:return r?e(t[0],t[1],t[2]):e.call(n,t[0],t[1],t[2]);case 4:return r?e(t[0],t[1],t[2],t[3]):e.call(n,t[0],t[1],t[2],t[3])}return e.apply(n,t)}},function(e,t,n){var r=n(0),i=n(36).set,o=r.MutationObserver||r.WebKitMutationObserver,a=r.process,s=r.Promise,l="process"==n(10)(a);e.exports=function(){var e,t,n,u=function(){var r,i;for(l&&(r=a.domain)&&r.exit();e;){i=e.fn,e=e.next;try{i()}catch(r){throw e?n():t=void 0,r}}t=void 0,r&&r.enter()};if(l)n=function(){a.nextTick(u)};else if(!o||r.navigator&&r.navigator.standalone)if(s&&s.resolve){var c=s.resolve(void 0);n=function(){c.then(u)}}else n=function(){i.call(r,u)};else{var d=!0,f=document.createTextNode("");new o(u).observe(f,{characterData:!0}),n=function(){f.data=d=!d}}return function(r){var i={fn:r,next:void 0};t&&(t.next=i),e||(e=i,n()),t=i}}},function(e,t,n){var r=n(0).navigator;e.exports=r&&r.userAgent||""},function(e,t,n){var r=n(5);e.exports=function(e,t,n){for(var i in t)n&&e[i]?e[i]=t[i]:r(e,i,t[i]);return e}},function(e,t,n){"use strict";var r=n(0),i=n(2),o=n(13),a=n(7),s=n(1)("species");e.exports=function(e){var t="function"==typeof i[e]?i[e]:r[e];a&&t&&!t[s]&&o.f(t,s,{configurable:!0,get:function(){return this}})}},function(e,t,n){var r=n(1)("iterator"),i=!1;try{var o=[7][r]();o.return=function(){i=!0},Array.from(o,(function(){throw 2}))}catch(e){}e.exports=function(e,t){if(!t&&!i)return!1;var n=!1;try{var o=[7],a=o[r]();a.next=function(){return{done:n=!0}},o[r]=function(){return a},e(o)}catch(e){}return n}},function(e,t,n){"use strict";var r=n(4),i=n(2),o=n(0),a=n(35),s=n(38);r(r.P+r.R,"Promise",{finally:function(e){var t=a(this,i.Promise||o.Promise),n="function"==typeof e;return this.then(n?function(n){return s(t,e()).then((function(){return n}))}:e,n?function(n){return s(t,e()).then((function(){throw n}))}:e)}})},function(e,t,n){"use strict";var r=n(4),i=n(24),o=n(37);r(r.S,"Promise",{try:function(e){var t=i.f(this),n=o(e);return(n.e?t.reject:t.resolve)(n.v),t.promise}})},function(e,t,n){e.exports={default:n(80),__esModule:!0}},function(e,t,n){n(81),e.exports=n(2).Object.assign},function(e,t,n){var r=n(4);r(r.S+r.F,"Object",{assign:n(82)})},function(e,t,n){"use strict";var r=n(17),i=n(83),o=n(84),a=n(15),s=n(26),l=Object.assign;e.exports=!l||n(14)((function(){var e={},t={},n=Symbol(),r="abcdefghijklmnopqrst";return e[n]=7,r.split("").forEach((function(e){t[e]=e})),7!=l({},e)[n]||Object.keys(l({},t)).join("")!=r}))?function(e,t){for(var n=a(e),l=arguments.length,u=1,c=i.f,d=o.f;l>u;)for(var f,h=s(arguments[u++]),p=c?r(h).concat(c(h)):r(h),m=p.length,v=0;m>v;)d.call(h,f=p[v++])&&(n[f]=h[f]);return n}:l},function(e,t){t.f=Object.getOwnPropertySymbols},function(e,t){t.f={}.propertyIsEnumerable},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){this.listeners={},this.on=function(e,t){void 0===this.listeners[e]&&(this.listeners[e]=[]),this.listeners[e].push(t)},this.emit=function(e){this.listeners[e]&&this.listeners[e].forEach((function(e){return e()}))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=null;return function(){var r=this,i=arguments;n&&clearTimeout(n),n=setTimeout((function(){e.apply(r,i)}),t)}}},function(e,t,n){"use strict";var r=function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("script",{ref:"script",attrs:{name:this.name,type:"text/plain"}})])};r._withStripped=!0;var i={render:r,staticRenderFns:[]};t.a=i}]).default}))},"693e":function(e,t,n){(function(t,n){e.exports=n()})("undefined"!==typeof self&&self,(function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s="70af")}({"0c42":function(e,t){var n=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},"14e4":function(e,t,n){t=e.exports=n("2350")(!1),t.push([e.i,'.vue-hover-mask{overflow:hidden;position:relative;line-height:1;background-color:#fff;border-radius:6px;-webkit-box-sizing:border-box;box-sizing:border-box;display:inline-block;font-size:0;vertical-align:middle}.vue-hover-mask_action{position:absolute;width:100%;height:100%;left:0;top:0;cursor:pointer;text-align:center;color:#fff;opacity:0;font-size:20px;z-index:1;background-color:rgba(0,0,0,.4);-webkit-transition:opacity .3s;transition:opacity .3s}.vue-hover-mask_action:after{display:inline-block;content:"";height:100%;vertical-align:middle}.vue-hover-mask_action:hover{opacity:1}',""])},"197a":function(e,t,n){var r=n("e843"),i=n("2529"),o=n("72b9"),a=Object.defineProperty;t.f=n("1efe")?Object.defineProperty:function(e,t,n){if(r(e),t=o(t,!0),r(n),i)try{return a(e,t,n)}catch(s){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},"1efe":function(e,t,n){e.exports=!n("77f6")((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},2350:function(e,t){function n(e,t){var n=e[1]||"",i=e[3];if(!i)return n;if(t&&"function"===typeof btoa){var o=r(i),a=i.sources.map((function(e){return"/*# sourceURL="+i.sourceRoot+e+" */"}));return[n].concat(a).concat([o]).join("\n")}return[n].join("\n")}function r(e){var t=btoa(unescape(encodeURIComponent(JSON.stringify(e)))),n="sourceMappingURL=data:application/json;charset=utf-8;base64,"+t;return"/*# "+n+" */"}e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var r=n(t,e);return t[2]?"@media "+t[2]+"{"+r+"}":r})).join("")},t.i=function(e,n){"string"===typeof e&&(e=[[null,e,""]]);for(var r={},i=0;i<this.length;i++){var o=this[i][0];"number"===typeof o&&(r[o]=!0)}for(i=0;i<e.length;i++){var a=e[i];"number"===typeof a[0]&&r[a[0]]||(n&&!a[2]?a[2]=n:n&&(a[2]="("+a[2]+") and ("+n+")"),t.push(a))}},t}},2529:function(e,t,n){e.exports=!n("1efe")&&!n("77f6")((function(){return 7!=Object.defineProperty(n("c006")("div"),"a",{get:function(){return 7}}).a}))},"3c50":function(e,t,n){"use strict";var r=n("d30b"),i=n.n(r);i.a},"499e":function(e,t,n){"use strict";function r(e,t){for(var n=[],r={},i=0;i<t.length;i++){var o=t[i],a=o[0],s=o[1],l=o[2],u=o[3],c={id:e+":"+i,css:s,media:l,sourceMap:u};r[a]?r[a].parts.push(c):n.push(r[a]={id:a,parts:[c]})}return n}n.r(t),n.d(t,"default",(function(){return p}));var i="undefined"!==typeof document;if("undefined"!==typeof DEBUG&&DEBUG&&!i)throw new Error("vue-style-loader cannot be used in a non-browser environment. Use { target: 'node' } in your Webpack config to indicate a server-rendering environment.");var o={},a=i&&(document.head||document.getElementsByTagName("head")[0]),s=null,l=0,u=!1,c=function(){},d=null,f="data-vue-ssr-id",h="undefined"!==typeof navigator&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());function p(e,t,n,i){u=n,d=i||{};var a=r(e,t);return m(a),function(t){for(var n=[],i=0;i<a.length;i++){var s=a[i],l=o[s.id];l.refs--,n.push(l)}for(t?(a=r(e,t),m(a)):a=[],i=0;i<n.length;i++)if(l=n[i],0===l.refs){for(var u=0;u<l.parts.length;u++)l.parts[u]();delete o[l.id]}}}function m(e){for(var t=0;t<e.length;t++){var n=e[t],r=o[n.id];if(r){r.refs++;for(var i=0;i<r.parts.length;i++)r.parts[i](n.parts[i]);for(;i<n.parts.length;i++)r.parts.push(g(n.parts[i]));r.parts.length>n.parts.length&&(r.parts.length=n.parts.length)}else{var a=[];for(i=0;i<n.parts.length;i++)a.push(g(n.parts[i]));o[n.id]={id:n.id,refs:1,parts:a}}}}function v(){var e=document.createElement("style");return e.type="text/css",a.appendChild(e),e}function g(e){var t,n,r=document.querySelector("style["+f+'~="'+e.id+'"]');if(r){if(u)return c;r.parentNode.removeChild(r)}if(h){var i=l++;r=s||(s=v()),t=_.bind(null,r,i,!1),n=_.bind(null,r,i,!0)}else r=v(),t=x.bind(null,r),n=function(){r.parentNode.removeChild(r)};return t(e),function(r){if(r){if(r.css===e.css&&r.media===e.media&&r.sourceMap===e.sourceMap)return;t(e=r)}else n()}}var y=function(){var e=[];return function(t,n){return e[t]=n,e.filter(Boolean).join("\n")}}();function _(e,t,n,r){var i=n?"":r.css;if(e.styleSheet)e.styleSheet.cssText=y(t,i);else{var o=document.createTextNode(i),a=e.childNodes;a[t]&&e.removeChild(a[t]),a.length?e.insertBefore(o,a[t]):e.appendChild(o)}}function x(e,t){var n=t.css,r=t.media,i=t.sourceMap;if(r&&e.setAttribute("media",r),d.ssrId&&e.setAttribute(f,t.id),i&&(n+="\n/*# sourceURL="+i.sources[0]+" */",n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(i))))+" */"),e.styleSheet)e.styleSheet.cssText=n;else{while(e.firstChild)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}},"67c5":function(e,t,n){var r=n("197a").f,i=Function.prototype,o=/^\s*function ([^ (]*)/,a="name";a in i||n("1efe")&&r(i,a,{configurable:!0,get:function(){try{return(""+this).match(o)[1]}catch(e){return""}}})},"6bc1":function(e,t){e.exports=function(e){return"object"===typeof e?null!==e:"function"===typeof e}},"70af":function(e,t,n){"use strict";var r;n.r(t),"undefined"!==typeof window&&(n("9589"),(r=window.document.currentScript)&&(r=r.src.match(/(.+\/)[^\/]+\.js(\?.*)?$/))&&(n.p=r[1])),n("67c5");var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"vue-hover-mask"},[e._t("default"),n("span",{staticClass:"vue-hover-mask_action",on:{click:e.handleClick}},[e._t("action")],2)],2)},o=[],a={name:"VueHoverMask",methods:{handleClick:function(){this.$emit("click")}}},s=a;function l(e,t,n,r,i,o,a,s){var l,u="function"===typeof e?e.options:e;if(t&&(u.render=t,u.staticRenderFns=n,u._compiled=!0),r&&(u.functional=!0),o&&(u._scopeId="data-v-"+o),a?(l=function(e){e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,e||"undefined"===typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),i&&i.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(a)},u._ssrRegister=l):i&&(l=s?function(){i.call(this,this.$root.$options.shadowRoot)}:i),l)if(u.functional){u._injectStyles=l;var c=u.render;u.render=function(e,t){return l.call(t),c(e,t)}}else{var d=u.beforeCreate;u.beforeCreate=d?[].concat(d,l):[l]}return{exports:e,options:u}}n("3c50");var u=l(s,i,o,!1,null,null,null),c=u.exports;window&&window.Vue&&window.Vue.component(c.name,c);var d=c;t["default"]=d},"72b9":function(e,t,n){var r=n("6bc1");e.exports=function(e,t){if(!r(e))return e;var n,i;if(t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;if("function"==typeof(n=e.valueOf)&&!r(i=n.call(e)))return i;if(!t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;throw TypeError("Can't convert object to primitive value")}},"77f6":function(e,t){e.exports=function(e){try{return!!e()}catch(t){return!0}}},9589:function(e,t){(function(e){var t="currentScript",n=e.getElementsByTagName("script");t in e||Object.defineProperty(e,t,{get:function(){try{throw new Error}catch(r){var e,t=(/.*at [^\(]*\((.*):.+:.+\)$/gi.exec(r.stack)||[!1])[1];for(e in n)if(n[e].src==t||"interactive"==n[e].readyState)return n[e];return null}}})})(document)},c006:function(e,t,n){var r=n("6bc1"),i=n("0c42").document,o=r(i)&&r(i.createElement);e.exports=function(e){return o?i.createElement(e):{}}},d30b:function(e,t,n){var r=n("14e4");"string"===typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);var i=n("499e").default;i("3694cb42",r,!0,{sourceMap:!1,shadowMode:!1})},e843:function(e,t,n){var r=n("6bc1");e.exports=function(e){if(!r(e))throw TypeError(e+" is not an object!");return e}}})["default"]}))},"6c7b":function(e,t,n){var r=n("5ca1");r(r.P,"Array",{fill:n("36bd")}),n("9c6c")("fill")},"6fad":function(e,t,n){(function(t,n){e.exports=n()})(window,(function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=141)}([function(e,t){function n(e){return e&&e.__esModule?e:{default:e}}e.exports=n},function(e,t,n){e.exports=n(142)},function(e,t,n){"use strict";n.r(t),n.d(t,"__extends",(function(){return i})),n.d(t,"__assign",(function(){return o})),n.d(t,"__rest",(function(){return a})),n.d(t,"__decorate",(function(){return s})),n.d(t,"__param",(function(){return l})),n.d(t,"__metadata",(function(){return u})),n.d(t,"__awaiter",(function(){return c})),n.d(t,"__generator",(function(){return d})),n.d(t,"__createBinding",(function(){return f})),n.d(t,"__exportStar",(function(){return h})),n.d(t,"__values",(function(){return p})),n.d(t,"__read",(function(){return m})),n.d(t,"__spread",(function(){return v})),n.d(t,"__spreadArrays",(function(){return g})),n.d(t,"__spreadArray",(function(){return y})),n.d(t,"__await",(function(){return _})),n.d(t,"__asyncGenerator",(function(){return x})),n.d(t,"__asyncDelegator",(function(){return b})),n.d(t,"__asyncValues",(function(){return w})),n.d(t,"__makeTemplateObject",(function(){return A})),n.d(t,"__importStar",(function(){return S})),n.d(t,"__importDefault",(function(){return E})),n.d(t,"__classPrivateFieldGet",(function(){return C})),n.d(t,"__classPrivateFieldSet",(function(){return M}));
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)};function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var o=function(){return o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n],t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},o.apply(this,arguments)};function a(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}function s(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}function l(e,t){return function(n,r){t(n,r,e)}}function u(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)}function c(e,t,n,r){function i(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function a(e){try{l(r.next(e))}catch(t){o(t)}}function s(e){try{l(r["throw"](e))}catch(t){o(t)}}function l(e){e.done?n(e.value):i(e.value).then(a,s)}l((r=r.apply(e,t||[])).next())}))}function d(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(e){return function(t){return l([e,t])}}function l(o){if(n)throw new TypeError("Generator is already executing.");while(a)try{if(n=1,r&&(i=2&o[0]?r["return"]:o[0]?r["throw"]||((i=r["return"])&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(i=a.trys,!(i=i.length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(s){o=[6,s],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}}var f=Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]};function h(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||f(t,e,n)}function p(e){var t="function"===typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function m(e,t){var n="function"===typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{while((void 0===t||t-- >0)&&!(r=o.next()).done)a.push(r.value)}catch(s){i={error:s}}finally{try{r&&!r.done&&(n=o["return"])&&n.call(o)}finally{if(i)throw i.error}}return a}function v(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(m(arguments[t]));return e}function g(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var o=arguments[t],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r}function y(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e}function _(e){return this instanceof _?(this.v=e,this):new _(e)}function x(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(e,t||[]),o=[];return r={},a("next"),a("throw"),a("return"),r[Symbol.asyncIterator]=function(){return this},r;function a(e){i[e]&&(r[e]=function(t){return new Promise((function(n,r){o.push([e,t,n,r])>1||s(e,t)}))})}function s(e,t){try{l(i[e](t))}catch(n){d(o[0][3],n)}}function l(e){e.value instanceof _?Promise.resolve(e.value.v).then(u,c):d(o[0][2],e)}function u(e){s("next",e)}function c(e){s("throw",e)}function d(e,t){e(t),o.shift(),o.length&&s(o[0][0],o[0][1])}}function b(e){var t,n;return t={},r("next"),r("throw",(function(e){throw e})),r("return"),t[Symbol.iterator]=function(){return this},t;function r(r,i){t[r]=e[r]?function(t){return(n=!n)?{value:_(e[r](t)),done:"return"===r}:i?i(t):t}:i}}function w(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e="function"===typeof p?p(e):e[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise((function(r,o){t=e[n](t),i(r,o,t.done,t.value)}))}}function i(e,t,n,r){Promise.resolve(r).then((function(t){e({value:t,done:n})}),t)}}function A(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var T=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e["default"]=t};function S(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&f(t,e,n);return T(t,e),t}function E(e){return e&&e.__esModule?e:{default:e}}function C(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)}function M(e,t,n){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,n),n}},function(e,t,n){"use strict";var r=n(0),i=r(n(1)),o=r(n(89)),a=r(n(4)),s=r(n(26)),l=r(n(17)),u=r(n(121)),c=r(n(27)),d=r(n(91)),f=r(n(70)),h=r(n(28)),p=r(n(57));(0,i["default"])(t,"__esModule",{value:!0}),t.DomElement=void 0;var m=n(2),v=n(6),g=[];function y(e){var t=document.createElement("div");t.innerHTML=e;var n=t.children;return v.toArray(n)}function _(e){return!!e&&(e instanceof HTMLCollection||e instanceof NodeList)}function x(e){var t=document.querySelectorAll(e);return v.toArray(t)}function b(e){var t=[],n=[];return t=(0,o["default"])(e)?e:e.split(";"),(0,a["default"])(t).call(t,(function(e){var t,r=(0,s["default"])(t=e.split(":")).call(t,(function(e){return(0,l["default"])(e).call(e)}));2===r.length&&n.push(r[0]+":"+r[1])})),n}var w=function(){function e(t){if(this.elems=[],this.length=this.elems.length,this.dataSource=new u["default"],t){if(t instanceof e)return t;var n=[],r=t instanceof Node?t.nodeType:-1;if(this.selector=t,1===r||9===r)n=[t];else if(_(t))n=v.toArray(t);else if(t instanceof Array)n=t;else if("string"===typeof t){var i,o=(0,l["default"])(i=t.replace("/\n/mg","")).call(i);n=0===(0,c["default"])(o).call(o,"<")?y(o):x(o)}var a=n.length;if(!a)return this;for(var s=0;s<a;s++)this.elems.push(n[s]);this.length=a}}return(0,i["default"])(e.prototype,"id",{get:function(){return this.elems[0].id},enumerable:!1,configurable:!0}),e.prototype.forEach=function(e){for(var t=0;t<this.length;t++){var n=this.elems[t],r=e.call(n,n,t);if(!1===r)break}return this},e.prototype.clone=function(e){var t;void 0===e&&(e=!1);var n=[];return(0,a["default"])(t=this.elems).call(t,(function(t){n.push(t.cloneNode(!!e))})),A(n)},e.prototype.get=function(e){void 0===e&&(e=0);var t=this.length;return e>=t&&(e%=t),A(this.elems[e])},e.prototype.first=function(){return this.get(0)},e.prototype.last=function(){var e=this.length;return this.get(e-1)},e.prototype.on=function(e,t,n){var r;return e?("function"===typeof t&&(n=t,t=""),(0,a["default"])(r=this).call(r,(function(r){if(t){var i=function(e){var r=e.target;r.matches(t)&&n.call(r,e)};r.addEventListener(e,i),g.push({elem:r,selector:t,fn:n,agentFn:i})}else r.addEventListener(e,n)}))):this},e.prototype.off=function(e,t,n){var r;return e?("function"===typeof t&&(n=t,t=""),(0,a["default"])(r=this).call(r,(function(r){if(t){for(var i=-1,o=0;o<g.length;o++){var a=g[o];if(a.selector===t&&a.fn===n&&a.elem===r){i=o;break}}if(-1!==i){var s=(0,d["default"])(g).call(g,i,1)[0].agentFn;r.removeEventListener(e,s)}}else r.removeEventListener(e,n)}))):this},e.prototype.attr=function(e,t){var n;return null==t?this.elems[0].getAttribute(e)||"":(0,a["default"])(n=this).call(n,(function(n){n.setAttribute(e,t)}))},e.prototype.removeAttr=function(e){var t;(0,a["default"])(t=this).call(t,(function(t){t.removeAttribute(e)}))},e.prototype.addClass=function(e){var t;return e?(0,a["default"])(t=this).call(t,(function(t){if(t.className){var n=t.className.split(/\s/);n=(0,f["default"])(n).call(n,(function(e){return!!(0,l["default"])(e).call(e)})),(0,c["default"])(n).call(n,e)<0&&n.push(e),t.className=n.join(" ")}else t.className=e})):this},e.prototype.removeClass=function(e){var t;return e?(0,a["default"])(t=this).call(t,(function(t){if(t.className){var n=t.className.split(/\s/);n=(0,f["default"])(n).call(n,(function(t){return t=(0,l["default"])(t).call(t),!(!t||t===e)})),t.className=n.join(" ")}})):this},e.prototype.hasClass=function(e){if(!e)return!1;var t=this.elems[0];if(!t.className)return!1;var n=t.className.split(/\s/);return(0,h["default"])(n).call(n,e)},e.prototype.css=function(e,t){var n,r;return r=""==t?"":e+":"+t+";",(0,a["default"])(n=this).call(n,(function(t){var n,i=(0,l["default"])(n=t.getAttribute("style")||"").call(n);if(i){var o=b(i);o=(0,s["default"])(o).call(o,(function(t){return 0===(0,c["default"])(t).call(t,e)?r:t})),""!=r&&(0,c["default"])(o).call(o,r)<0&&o.push(r),""==r&&(o=b(o)),t.setAttribute("style",o.join("; "))}else t.setAttribute("style",r)}))},e.prototype.getBoundingClientRect=function(){var e=this.elems[0];return e.getBoundingClientRect()},e.prototype.show=function(){return this.css("display","block")},e.prototype.hide=function(){return this.css("display","none")},e.prototype.children=function(){var e=this.elems[0];return e?A(e.children):null},e.prototype.childNodes=function(){var e=this.elems[0];return e?A(e.childNodes):null},e.prototype.replaceChildAll=function(e){var t=this.getNode(),n=this.elems[0];while(n.hasChildNodes())t.firstChild&&n.removeChild(t.firstChild);this.append(e)},e.prototype.append=function(e){var t;return(0,a["default"])(t=this).call(t,(function(t){(0,a["default"])(e).call(e,(function(e){t.appendChild(e)}))}))},e.prototype.remove=function(){var e;return(0,a["default"])(e=this).call(e,(function(e){if(e.remove)e.remove();else{var t=e.parentElement;t&&t.removeChild(e)}}))},e.prototype.isContain=function(e){var t=this.elems[0],n=e.elems[0];return t.contains(n)},e.prototype.getNodeName=function(){var e=this.elems[0];return e.nodeName},e.prototype.getNode=function(e){var t;return void 0===e&&(e=0),t=this.elems[e],t},e.prototype.find=function(e){var t=this.elems[0];return A(t.querySelectorAll(e))},e.prototype.text=function(e){var t;if(e)return(0,a["default"])(t=this).call(t,(function(t){t.innerHTML=e}));var n=this.elems[0];return n.innerHTML.replace(/<[^>]+>/g,(function(){return""}))},e.prototype.html=function(e){var t=this.elems[0];return e?(t.innerHTML=e,this):t.innerHTML},e.prototype.val=function(){var e,t=this.elems[0];return(0,l["default"])(e=t.value).call(e)},e.prototype.focus=function(){var e;return(0,a["default"])(e=this).call(e,(function(e){e.focus()}))},e.prototype.prev=function(){var e=this.elems[0];return A(e.previousElementSibling)},e.prototype.next=function(){var e=this.elems[0];return A(e.nextElementSibling)},e.prototype.getNextSibling=function(){var e=this.elems[0];return A(e.nextSibling)},e.prototype.parent=function(){var e=this.elems[0];return A(e.parentElement)},e.prototype.parentUntil=function(e,t){var n=t||this.elems[0];if("BODY"===n.nodeName)return null;var r=n.parentElement;return null===r?null:r.matches(e)?A(r):this.parentUntil(e,r)},e.prototype.parentUntilEditor=function(e,t,n){var r=n||this.elems[0];if(A(r).equal(t.$textContainerElem)||A(r).equal(t.$toolbarElem))return null;var i=r.parentElement;return null===i?null:i.matches(e)?A(i):this.parentUntilEditor(e,t,i)},e.prototype.equal=function(t){return t instanceof e?this.elems[0]===t.elems[0]:t instanceof HTMLElement&&this.elems[0]===t},e.prototype.insertBefore=function(e){var t,n=A(e),r=n.elems[0];return r?(0,a["default"])(t=this).call(t,(function(e){var t=r.parentNode;null===t||void 0===t||t.insertBefore(e,r)})):this},e.prototype.insertAfter=function(e){var t,n=A(e),r=n.elems[0],i=r&&r.nextSibling;return r?(0,a["default"])(t=this).call(t,(function(e){var t=r.parentNode;i?t.insertBefore(e,i):t.appendChild(e)})):this},e.prototype.data=function(e,t){if(null==t)return this.dataSource.get(e);this.dataSource.set(e,t)},e.prototype.getNodeTop=function(e){if(this.length<1)return this;var t=this.parent();return e.$textElem.equal(this)||e.$textElem.equal(t)?this:(t.prior=this,t.getNodeTop(e))},e.prototype.getOffsetData=function(){var e=this.elems[0];return{top:e.offsetTop,left:e.offsetLeft,width:e.offsetWidth,height:e.offsetHeight,parent:e.offsetParent}},e.prototype.scrollTop=function(e){var t=this.elems[0];t.scrollTo({top:e})},e}();function A(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return new((0,p["default"])(w).apply(w,m.__spreadArrays([void 0],e)))}t.DomElement=w,t["default"]=A},function(e,t,n){e.exports=n(180)},function(e,t,n){"use strict";var r=n(8),i=n(71).f,o=n(101),a=n(9),s=n(40),l=n(19),u=n(16),c=function(e){var t=function(t,n,r){if(this instanceof e){switch(arguments.length){case 0:return new e;case 1:return new e(t);case 2:return new e(t,n)}return new e(t,n,r)}return e.apply(this,arguments)};return t.prototype=e.prototype,t};e.exports=function(e,t){var n,d,f,h,p,m,v,g,y,_=e.target,x=e.global,b=e.stat,w=e.proto,A=x?r:b?r[_]:(r[_]||{}).prototype,T=x?a:a[_]||(a[_]={}),S=T.prototype;for(h in t)n=o(x?h:_+(b?".":"#")+h,e.forced),d=!n&&A&&u(A,h),m=T[h],d&&(e.noTargetGet?(y=i(A,h),v=y&&y.value):v=A[h]),p=d&&v?v:t[h],d&&typeof m===typeof p||(g=e.bind&&d?s(p,r):e.wrap&&d?c(p):w&&"function"==typeof p?s(Function.call,p):p,(e.sham||p&&p.sham||m&&m.sham)&&l(g,"sham",!0),T[h]=g,w&&(f=_+"Prototype",u(a,f)||l(a,f,{}),a[f][h]=p,e.real&&S&&!S[h]&&l(S,h,p)))}},function(e,t,n){"use strict";var r=n(0),i=r(n(92)),o=r(n(1)),a=r(n(256)),s=r(n(45)),l=r(n(46)),u=r(n(89)),c=r(n(26));(0,o["default"])(t,"__esModule",{value:!0}),t.hexToRgb=t.getRandomCode=t.toArray=t.deepClone=t.isFunction=t.debounce=t.throttle=t.arrForEach=t.forEach=t.replaceSpecialSymbol=t.replaceHtmlSymbol=t.getRandom=t.UA=void 0;var d=n(2),f=function(){function e(){this._ua=navigator.userAgent;var e=this._ua.match(/(Edge?)\/(\d+)/);this.isOldEdge=!!(e&&"Edge"==e[1]&&(0,a["default"])(e[2])<19),this.isFirefox=!(!/Firefox\/\d+/.test(this._ua)||/Seamonkey\/\d+/.test(this._ua))}return e.prototype.isIE=function(){return"ActiveXObject"in window},e.prototype.isWebkit=function(){return/webkit/i.test(this._ua)},e}();function h(e){var t;return void 0===e&&(e=""),e+(0,s["default"])(t=Math.random().toString()).call(t,2)}function p(e){return e.replace(/</gm,"&lt;").replace(/>/gm,"&gt;").replace(/"/gm,"&quot;").replace(/(\r\n|\r|\n)/g,"<br/>")}function m(e){return e.replace(/&lt;/gm,"<").replace(/&gt;/gm,">").replace(/&quot;/gm,'"')}function v(e,t){for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=t(n,e[n]);if(!1===r)break}}function g(e,t){var n,r,i,o=e.length||0;for(n=0;n<o;n++)if(r=e[n],i=t.call(e,r,n),!1===i)break}function y(e,t){void 0===t&&(t=200);var n=!1;return function(){for(var r=this,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];n||(n=!0,(0,l["default"])((function(){n=!1,e.call.apply(e,d.__spreadArrays([r],i))}),t))}}function _(e,t){void 0===t&&(t=200);var n=0;return function(){for(var r=this,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];n&&window.clearTimeout(n),n=(0,l["default"])((function(){n=0,e.call.apply(e,d.__spreadArrays([r],i))}),t)}}function x(e){return"function"===typeof e}function b(e){if("object"!==(0,i["default"])(e)||"function"==typeof e||null===e)return e;var t;for(var n in(0,u["default"])(e)&&(t=[]),(0,u["default"])(e)||(t={}),e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=b(e[n]));return t}function w(e){return(0,s["default"])(Array.prototype).call(e)}function A(){var e;return(0,s["default"])(e=Math.random().toString(36)).call(e,-5)}function T(e){var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);if(null==t)return null;var n=(0,c["default"])(t).call(t,(function(e){return(0,a["default"])(e,16)})),r=n[1],i=n[2],o=n[3];return"rgb("+r+", "+i+", "+o+")"}t.UA=new f,t.getRandom=h,t.replaceHtmlSymbol=p,t.replaceSpecialSymbol=m,t.forEach=v,t.arrForEach=g,t.throttle=y,t.debounce=_,t.isFunction=x,t.deepClone=b,t.toArray=w,t.getRandomCode=A,t.hexToRgb=T},function(e,t,n){"use strict";var r=n(0),i=r(n(1));function o(){}(0,i["default"])(t,"__esModule",{value:!0}),t.EMPTY_P_REGEX=t.EMPTY_P_LAST_REGEX=t.EMPTY_P=t.urlRegex=t.EMPTY_FN=void 0,t.EMPTY_FN=o,t.urlRegex=/(http|ftp|https):\/\/[\w\-_]+(\.[\w\-_]+)+([\w\-.,@?^=%&amp;:/~+#]*[\w\-@?^=%&amp;/~+#])?/g,t.EMPTY_P='<p data-we-empty-p=""><br></p>',t.EMPTY_P_LAST_REGEX=/<p data-we-empty-p=""><br\/?><\/p>$/gim,t.EMPTY_P_REGEX=/<p data-we-empty-p="">/gim},function(e,t,n){(function(t){var n=function(e){return e&&e.Math==Math&&e};e.exports=n("object"==typeof globalThis&&globalThis)||n("object"==typeof window&&window)||n("object"==typeof self&&self)||n("object"==typeof t&&t)||Function("return this")()}).call(this,n(145))},function(e,t){e.exports={}},function(e,t,n){var r=n(8),i=n(74),o=n(16),a=n(64),s=n(76),l=n(106),u=i("wks"),c=r.Symbol,d=l?c:c&&c.withoutSetter||a;e.exports=function(e){return o(u,e)||(s&&o(c,e)?u[e]=c[e]:u[e]=d("Symbol."+e)),u[e]}},function(e,t){e.exports=function(e){try{return!!e()}catch(t){return!0}}},function(e,t,n){var r=n(9),i=n(16),o=n(93),a=n(18).f;e.exports=function(e){var t=r.Symbol||(r.Symbol={});i(t,e)||a(t,e,{value:o.f(e)})}},function(e,t){e.exports=function(e){return"object"===typeof e?null!==e:"function"===typeof e}},function(e,t,n){var r=n(11);e.exports=!r((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},function(e,t,n){var r=n(9);e.exports=function(e){return r[e+"Prototype"]}},function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},function(e,t,n){e.exports=n(192)},function(e,t,n){var r=n(14),i=n(100),o=n(25),a=n(60),s=Object.defineProperty;t.f=r?s:function(e,t,n){if(o(e),t=a(t,!0),o(n),i)try{return s(e,t,n)}catch(r){}if("get"in n||"set"in n)throw TypeError("Accessors not supported");return"value"in n&&(e[t]=n.value),e}},function(e,t,n){var r=n(14),i=n(18),o=n(48);e.exports=r?function(e,t,n){return i.f(e,t,o(1,n))}:function(e,t,n){return e[t]=n,e}},function(e,t,n){"use strict";var r=function(){var e;return function(){return"undefined"===typeof e&&(e=Boolean(window&&document&&document.all&&!window.atob)),e}}(),i=function(){var e={};return function(t){if("undefined"===typeof e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(r){n=null}e[t]=n}return e[t]}}(),o=[];function a(e){for(var t=-1,n=0;n<o.length;n++)if(o[n].identifier===e){t=n;break}return t}function s(e,t){for(var n={},r=[],i=0;i<e.length;i++){var s=e[i],l=t.base?s[0]+t.base:s[0],u=n[l]||0,c="".concat(l," ").concat(u);n[l]=u+1;var d=a(c),f={css:s[1],media:s[2],sourceMap:s[3]};-1!==d?(o[d].references++,o[d].updater(f)):o.push({identifier:c,updater:m(f,t),references:1}),r.push(c)}return r}function l(e){var t=document.createElement("style"),r=e.attributes||{};if("undefined"===typeof r.nonce){var o=n.nc;o&&(r.nonce=o)}if(Object.keys(r).forEach((function(e){t.setAttribute(e,r[e])})),"function"===typeof e.insert)e.insert(t);else{var a=i(e.insert||"head");if(!a)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");a.appendChild(t)}return t}function u(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}var c=function(){var e=[];return function(t,n){return e[t]=n,e.filter(Boolean).join("\n")}}();function d(e,t,n,r){var i=n?"":r.media?"@media ".concat(r.media," {").concat(r.css,"}"):r.css;if(e.styleSheet)e.styleSheet.cssText=c(t,i);else{var o=document.createTextNode(i),a=e.childNodes;a[t]&&e.removeChild(a[t]),a.length?e.insertBefore(o,a[t]):e.appendChild(o)}}function f(e,t,n){var r=n.css,i=n.media,o=n.sourceMap;if(i?e.setAttribute("media",i):e.removeAttribute("media"),o&&"undefined"!==typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),e.styleSheet)e.styleSheet.cssText=r;else{while(e.firstChild)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(r))}}var h=null,p=0;function m(e,t){var n,r,i;if(t.singleton){var o=p++;n=h||(h=l(t)),r=d.bind(null,n,o,!1),i=d.bind(null,n,o,!0)}else n=l(t),r=f.bind(null,n,t),i=function(){u(n)};return r(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;r(e=t)}else i()}}e.exports=function(e,t){t=t||{},t.singleton||"boolean"===typeof t.singleton||(t.singleton=r()),e=e||[];var n=s(e,t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var r=0;r<n.length;r++){var i=n[r],l=a(i);o[l].references--}for(var u=s(e,t),c=0;c<n.length;c++){var d=n[c],f=a(d);0===o[f].references&&(o[f].updater(),o.splice(f,1))}n=u}}}},function(e,t,n){"use strict";function r(e,t){var n=e[1]||"",r=e[3];if(!r)return n;if(t&&"function"===typeof btoa){var o=i(r),a=r.sources.map((function(e){return"/*# sourceURL=".concat(r.sourceRoot||"").concat(e," */")}));return[n].concat(a).concat([o]).join("\n")}return[n].join("\n")}function i(e){var t=btoa(unescape(encodeURIComponent(JSON.stringify(e)))),n="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(t);return"/*# ".concat(n," */")}e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n=r(t,e);return t[2]?"@media ".concat(t[2]," {").concat(n,"}"):n})).join("")},t.i=function(e,n,r){"string"===typeof e&&(e=[[null,e,""]]);var i={};if(r)for(var o=0;o<this.length;o++){var a=this[o][0];null!=a&&(i[a]=!0)}for(var s=0;s<e.length;s++){var l=[].concat(e[s]);r&&i[l[0]]||(n&&(l[2]?l[2]="".concat(n," and ").concat(l[2]):l[2]=n),t.push(l))}},t}},function(e,t,n){var r=n(14),i=n(11),o=n(16),a=Object.defineProperty,s={},l=function(e){throw e};e.exports=function(e,t){if(o(s,e))return s[e];t||(t={});var n=[][e],u=!!o(t,"ACCESSORS")&&t.ACCESSORS,c=o(t,0)?t[0]:l,d=o(t,1)?t[1]:void 0;return s[e]=!!n&&!i((function(){if(u&&!r)return!0;var e={length:-1};u?a(e,1,{enumerable:!0,get:l}):e[1]=1,n.call(e,c,d)}))}},function(e,t,n){"use strict";var r=n(0),i=r(n(1));(0,i["default"])(t,"__esModule",{value:!0});var o=n(2),a=o.__importDefault(n(95)),s=function(e){function t(t,n){return e.call(this,t,n)||this}return o.__extends(t,e),t}(a["default"]);t["default"]=s},function(e,t,n){"use strict";var r=n(0),i=r(n(1)),o=r(n(4)),a=r(n(46));(0,i["default"])(t,"__esModule",{value:!0});var s=n(2),l=s.__importDefault(n(3)),u=s.__importDefault(n(95)),c=s.__importDefault(n(134)),d=function(e){function t(t,n,r){var i=e.call(this,t,n)||this;r.title=n.i18next.t("menus.dropListMenu."+r.title);var s,u="zh-CN"===n.config.lang?"":"w-e-drop-list-tl";""!==u&&"list"===r.type&&(0,o["default"])(s=r.list).call(s,(function(e){var t=e.$elem,n=l["default"](t.children());if(n.length>0){var r=null===n||void 0===n?void 0:n.getNodeName();r&&"I"===r&&t.addClass(u)}}));var d=new c["default"](i,r);return i.dropList=d,t.on("click",(function(){var e;null!=n.selection.getRange()&&(t.css("z-index",n.zIndex.get("menu")),(0,o["default"])(e=n.txt.eventHooks.dropListMenuHoverEvents).call(e,(function(e){return e()})),d.show())})).on("mouseleave",(function(){t.css("z-index","auto"),d.hideTimeoutId=(0,a["default"])((function(){d.hide()}))})),i}return s.__extends(t,e),t}(u["default"]);t["default"]=d},function(e,t,n){var r=n(13);e.exports=function(e){if(!r(e))throw TypeError(String(e)+" is not an object");return e}},function(e,t,n){e.exports=n(188)},function(e,t,n){e.exports=n(201)},function(e,t,n){e.exports=n(213)},function(e,t,n){e.exports=n(283)},function(e,t,n){var r=n(72),i=n(49);e.exports=function(e){return r(i(e))}},function(e,t,n){var r=n(49);e.exports=function(e){return Object(r(e))}},function(e,t,n){var r=n(40),i=n(72),o=n(31),a=n(35),s=n(88),l=[].push,u=function(e){var t=1==e,n=2==e,u=3==e,c=4==e,d=6==e,f=5==e||d;return function(h,p,m,v){for(var g,y,_=o(h),x=i(_),b=r(p,m,3),w=a(x.length),A=0,T=v||s,S=t?T(h,w):n?T(h,0):void 0;w>A;A++)if((f||A in x)&&(g=x[A],y=b(g,A,_),e))if(t)S[A]=y;else if(y)switch(e){case 3:return!0;case 5:return g;case 6:return A;case 2:l.call(S,g)}else if(c)return!1;return d?-1:u||c?c:S}};e.exports={forEach:u(0),map:u(1),filter:u(2),some:u(3),every:u(4),find:u(5),findIndex:u(6)}},function(e,t,n){"use strict";var r=n(0),i=r(n(1)),o=r(n(4)),a=r(n(29)),s=r(n(132));(0,i["default"])(t,"__esModule",{value:!0});var l=n(2),u=l.__importDefault(n(3)),c=n(7),d=function(){function e(t,n){this.menu=t,this.conf=n,this.$container=u["default"]('<div class="w-e-panel-container"></div>');var r=t.editor;r.txt.eventHooks.clickEvents.push(e.hideCurAllPanels),r.txt.eventHooks.toolbarClickEvents.push(e.hideCurAllPanels),r.txt.eventHooks.dropListMenuHoverEvents.push(e.hideCurAllPanels)}return e.prototype.create=function(){var t=this,n=this.menu;if(!e.createdMenus.has(n)){var r=this.conf,i=this.$container,s=r.width||300,d=n.editor.$toolbarElem.getBoundingClientRect(),f=n.$elem.getBoundingClientRect(),h=d.height+d.top-f.top,p=(d.width-s)/2+d.left-f.left,m=300;Math.abs(p)>m&&(p=f.left<document.documentElement.clientWidth/2?-f.width/2:-s+f.width/2),i.css("width",s+"px").css("margin-top",h+"px").css("margin-left",p+"px").css("z-index",n.editor.zIndex.get("panel"));var v=u["default"]('<i class="w-e-icon-close w-e-panel-close"></i>');i.append(v),v.on("click",(function(){t.remove()}));var g=u["default"]('<ul class="w-e-panel-tab-title"></ul>'),y=u["default"]('<div class="w-e-panel-tab-content"></div>');i.append(g).append(y);var _=r.height;_&&y.css("height",_+"px").css("overflow-y","auto");var x=r.tabs||[],b=[],w=[];(0,o["default"])(x).call(x,(function(e,t){if(e){var n=e.title||"",r=e.tpl||"",i=u["default"]('<li class="w-e-item">'+n+"</li>");g.append(i);var a=u["default"](r);y.append(a),b.push(i),w.push(a),0===t?(i.data("active",!0),i.addClass("w-e-active")):a.hide(),i.on("click",(function(){i.data("active")||((0,o["default"])(b).call(b,(function(e){e.data("active",!1),e.removeClass("w-e-active")})),(0,o["default"])(w).call(w,(function(e){e.hide()})),i.data("active",!0),i.addClass("w-e-active"),a.show())}))}})),i.on("click",(function(e){e.stopPropagation()})),n.$elem.append(i),r.setLinkValue&&r.setLinkValue(i,"text"),r.setLinkValue&&r.setLinkValue(i,"link"),(0,o["default"])(x).call(x,(function(e,n){if(e){var r=e.events||[];(0,o["default"])(r).call(r,(function(e){var r,i=e.selector,o=e.type,s=e.fn||c.EMPTY_FN,u=w[n],d=null!==(r=e.bindEnter)&&void 0!==r&&r,f=function(e){return l.__awaiter(t,void 0,void 0,(function(){var t;return l.__generator(this,(function(n){switch(n.label){case 0:return e.stopPropagation(),[4,s(e)];case 1:return t=n.sent(),t&&this.remove(),[2]}}))}))};(0,a["default"])(u).call(u,i).on(o,f),d&&"click"===o&&u.on("keyup",(function(e){13==e.keyCode&&f(e)}))}))}}));var A=(0,a["default"])(i).call(i,"input[type=text],textarea");A.length&&A.get(0).focus(),e.hideCurAllPanels(),n.setPanel(this),e.createdMenus.add(n)}},e.prototype.remove=function(){var t=this.menu,n=this.$container;n&&n.remove(),e.createdMenus["delete"](t)},e.hideCurAllPanels=function(){var t;0!==e.createdMenus.size&&(0,o["default"])(t=e.createdMenus).call(t,(function(e){var t=e.panel;t&&t.remove()}))},e.createdMenus=new s["default"],e}();t["default"]=d},function(e,t){var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}},function(e,t,n){var r=n(62),i=Math.min;e.exports=function(e){return e>0?i(r(e),9007199254740991):0}},function(e,t,n){var r=n(9),i=n(8),o=function(e){return"function"==typeof e?e:void 0};e.exports=function(e,t){return arguments.length<2?o(r[e])||o(i[e]):r[e]&&r[e][t]||i[e]&&i[e][t]}},function(e,t,n){var r=n(81),i=n(18).f,o=n(19),a=n(16),s=n(170),l=n(10),u=l("toStringTag");e.exports=function(e,t,n,l){if(e){var c=n?e:e.prototype;a(c,u)||i(c,u,{configurable:!0,value:t}),l&&!r&&o(c,"toString",s)}}},function(e,t,n){"use strict";var r=n(0),i=r(n(1));(0,i["default"])(t,"__esModule",{value:!0});var o=n(2),a=o.__importDefault(n(95)),s=function(e){function t(t,n){return e.call(this,t,n)||this}return o.__extends(t,e),t.prototype.setPanel=function(e){this.panel=e},t}(a["default"]);t["default"]=s},function(e,t,n){"use strict";var r=n(0),i=r(n(1)),o=r(n(4)),a=r(n(57));(0,i["default"])(t,"__esModule",{value:!0});var s=n(2),l=s.__importDefault(n(3)),u=function(){function e(e,t,n){this.editor=e,this.$targetElem=t,this.conf=n,this._show=!1,this._isInsertTextContainer=!1;var r=l["default"]("<div></div>");r.addClass("w-e-tooltip"),this.$container=r}return e.prototype.getPositionData=function(){var e=this.$container,t=0,n=0,r=20,i=document.documentElement.scrollTop,o=this.$targetElem.getBoundingClientRect(),a=this.editor.$textElem.getBoundingClientRect(),s=this.$targetElem.getOffsetData(),u=l["default"](s.parent),c=this.editor.$textElem.elems[0].scrollTop;if(this._isInsertTextContainer=u.equal(this.editor.$textContainerElem),this._isInsertTextContainer){var d=u.getBoundingClientRect().height,f=s.top,h=s.left,p=s.height,m=f-c;m>r+5?(t=m-r-15,e.addClass("w-e-tooltip-up")):m+p+r<d?(t=m+p+10,e.addClass("w-e-tooltip-down")):(t=(m>0?m:0)+r+10,e.addClass("w-e-tooltip-down")),n=h<0?0:h}else o.top<r||o.top-a.top<r?(t=o.bottom+i+5,e.addClass("w-e-tooltip-down")):(t=o.top+i-r-15,e.addClass("w-e-tooltip-up")),n=o.left<0?0:o.left;return{top:t,left:n}},e.prototype.appendMenus=function(){var e=this,t=this.conf,n=this.editor,r=this.$targetElem,i=this.$container;(0,o["default"])(t).call(t,(function(t,o){var a=t.$elem,s=l["default"]("<div></div>");s.addClass("w-e-tooltip-item-wrapper "),s.append(a),i.append(s),a.on("click",(function(i){i.preventDefault();var o=t.onClick(n,r);o&&e.remove()}))}))},e.prototype.create=function(){var e,t,n=this.editor,r=this.$container;this.appendMenus();var i=this.getPositionData(),o=i.top,s=i.left;r.css("top",o+"px"),r.css("left",s+"px"),r.css("z-index",n.zIndex.get("tooltip")),this._isInsertTextContainer?this.editor.$textContainerElem.append(r):l["default"]("body").append(r),this._show=!0,n.beforeDestroy((0,a["default"])(e=this.remove).call(e,this)),n.txt.eventHooks.onBlurEvents.push((0,a["default"])(t=this.remove).call(t,this))},e.prototype.remove=function(){this.$container.remove(),this._show=!1},(0,i["default"])(e.prototype,"isShow",{get:function(){return this._show},enumerable:!1,configurable:!0}),e}();t["default"]=u},function(e,t,n){var r=n(41);e.exports=function(e,t,n){if(r(e),void 0===t)return e;switch(n){case 0:return function(){return e.call(t)};case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,i){return e.call(t,n,r,i)}}return function(){return e.apply(t,arguments)}}},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(String(e)+" is not a function");return e}},function(e,t,n){var r,i,o,a=n(165),s=n(8),l=n(13),u=n(19),c=n(16),d=n(63),f=n(51),h=s.WeakMap,p=function(e){return o(e)?i(e):r(e,{})},m=function(e){return function(t){var n;if(!l(t)||(n=i(t)).type!==e)throw TypeError("Incompatible receiver, "+e+" required");return n}};if(a){var v=new h,g=v.get,y=v.has,_=v.set;r=function(e,t){return _.call(v,e,t),t},i=function(e){return g.call(v,e)||{}},o=function(e){return y.call(v,e)}}else{var x=d("state");f[x]=!0,r=function(e,t){return u(e,x,t),t},i=function(e){return c(e,x)?e[x]:{}},o=function(e){return c(e,x)}}e.exports={set:r,get:i,has:o,enforce:p,getterFor:m}},function(e,t){e.exports=!0},function(e,t){e.exports={}},function(e,t,n){e.exports=n(261)},function(e,t,n){e.exports=n(265)},function(e,t,n){"use strict";var r=n(0),i=r(n(1)),o=r(n(4));(0,i["default"])(t,"__esModule",{value:!0}),t.createElementFragment=t.createDocumentFragment=t.createElement=t.insertBefore=t.getEndPoint=t.getStartPoint=t.updateRange=t.filterSelectionNodes=void 0;var a=n(2),s=n(137),l=a.__importDefault(n(3));function u(e){var t=[];return(0,o["default"])(e).call(e,(function(e){var n=e.getNodeName();if(n!==s.ListType.OrderedList&&n!==s.ListType.UnorderedList)t.push(e);else if(e.prior)t.push(e.prior);else{var r=e.children();null===r||void 0===r||(0,o["default"])(r).call(r,(function(e){t.push(l["default"](e))}))}})),t}function c(e,t,n){var r=e.selection,i=document.createRange();t.length>1?(i.setStart(t.elems[0],0),i.setEnd(t.elems[t.length-1],t.elems[t.length-1].childNodes.length)):i.selectNodeContents(t.elems[0]),n&&i.collapse(!1),r.saveRange(i),r.restoreSelection()}function d(e){var t;return e.prior?e.prior:l["default"](null===(t=e.children())||void 0===t?void 0:t.elems[0])}function f(e){var t;return e.prior?e.prior:l["default"](null===(t=e.children())||void 0===t?void 0:t.last().elems[0])}function h(e,t,n){void 0===n&&(n=null),e.parent().elems[0].insertBefore(t,n)}function p(e){return document.createElement(e)}function m(){return document.createDocumentFragment()}function v(e,t,n){return void 0===n&&(n="li"),(0,o["default"])(e).call(e,(function(e){var r=p(n);r.innerHTML=e.html(),t.appendChild(r),e.remove()})),t}t.filterSelectionNodes=u,t.updateRange=c,t.getStartPoint=d,t.getEndPoint=f,t.insertBefore=h,t.createElement=p,t.createDocumentFragment=m,t.createElementFragment=v},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t){e.exports=function(e){if(void 0==e)throw TypeError("Can't call method on "+e);return e}},function(e,t,n){"use strict";var r=n(164).charAt,i=n(42),o=n(75),a="String Iterator",s=i.set,l=i.getterFor(a);o(String,"String",(function(e){s(this,{type:a,string:String(e),index:0})}),(function(){var e,t=l(this),n=t.string,i=t.index;return i>=n.length?{value:void 0,done:!0}:(e=r(n,i),t.index+=e.length,{value:e,done:!1})}))},function(e,t){e.exports={}},function(e,t,n){var r=n(107),i=n(80);e.exports=Object.keys||function(e){return r(e,i)}},function(e,t,n){var r=n(19);e.exports=function(e,t,n,i){i&&i.enumerable?e[t]=n:r(e,t,n)}},function(e,t,n){n(173);var r=n(174),i=n(8),o=n(65),a=n(19),s=n(44),l=n(10),u=l("toStringTag");for(var c in r){var d=i[c],f=d&&d.prototype;f&&o(f)!==u&&a(f,u,c),s[c]=s.Array}},function(e,t,n){var r=n(34);e.exports=Array.isArray||function(e){return"Array"==r(e)}},function(e,t,n){var r=n(11),i=n(10),o=n(86),a=i("species");e.exports=function(e){return o>=51||!r((function(){var t=[],n=t.constructor={};return n[a]=function(){return{foo:1}},1!==t[e](Boolean).foo}))}},function(e,t,n){e.exports=n(222)},function(e,t,n){"use strict";var r=n(0),i=r(n(1));(0,i["default"])(t,"__esModule",{value:!0}),t.ListHandle=void 0;var o=n(2),a=o.__importDefault(n(373)),s=function(){function e(e){this.options=e,this.selectionRangeElem=new a["default"]}return e}();t.ListHandle=s},function(e,t,n){"use strict";var r={}.propertyIsEnumerable,i=Object.getOwnPropertyDescriptor,o=i&&!r.call({1:2},1);t.f=o?function(e){var t=i(this,e);return!!t&&t.enumerable}:r},function(e,t,n){var r=n(13);e.exports=function(e,t){if(!r(e))return e;var n,i;if(t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;if("function"==typeof(n=e.valueOf)&&!r(i=n.call(e)))return i;if(!t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;throw TypeError("Can't convert object to primitive value")}},function(e,t){},function(e,t){var n=Math.ceil,r=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?r:n)(e)}},function(e,t,n){var r=n(74),i=n(64),o=r("keys");e.exports=function(e){return o[e]||(o[e]=i(e))}},function(e,t){var n=0,r=Math.random();e.exports=function(e){return"Symbol("+String(void 0===e?"":e)+")_"+(++n+r).toString(36)}},function(e,t,n){var r=n(81),i=n(34),o=n(10),a=o("toStringTag"),s="Arguments"==i(function(){return arguments}()),l=function(e,t){try{return e[t]}catch(n){}};e.exports=r?i:function(e){var t,n,r;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=l(t=Object(e),a))?n:s?i(t):"Object"==(r=i(t))&&"function"==typeof t.callee?"Arguments":r}},function(e,t,n){var r=n(25),i=n(112),o=n(35),a=n(40),s=n(113),l=n(114),u=function(e,t){this.stopped=e,this.result=t},c=e.exports=function(e,t,n,c,d){var f,h,p,m,v,g,y,_=a(t,n,c?2:1);if(d)f=e;else{if(h=s(e),"function"!=typeof h)throw TypeError("Target is not iterable");if(i(h)){for(p=0,m=o(e.length);m>p;p++)if(v=c?_(r(y=e[p])[0],y[1]):_(e[p]),v&&v instanceof u)return v;return new u(!1)}f=h.call(e)}g=f.next;while(!(y=g.call(f)).done)if(v=l(f,_,y.value,c),"object"==typeof v&&v&&v instanceof u)return v;return new u(!1)};c.stop=function(e){return new u(!0,e)}},function(e,t,n){"use strict";var r=n(11);e.exports=function(e,t){var n=[][e];return!!n&&r((function(){n.call(null,t||function(){throw 1},1)}))}},function(e,t){e.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},function(e,t,n){"use strict";var r=n(60),i=n(18),o=n(48);e.exports=function(e,t,n){var a=r(t);a in e?i.f(e,a,o(0,n)):e[a]=n}},function(e,t,n){e.exports=n(209)},function(e,t,n){var r=n(14),i=n(59),o=n(48),a=n(30),s=n(60),l=n(16),u=n(100),c=Object.getOwnPropertyDescriptor;t.f=r?c:function(e,t){if(e=a(e),t=s(t,!0),u)try{return c(e,t)}catch(n){}if(l(e,t))return o(!i.f.call(e,t),e[t])}},function(e,t,n){var r=n(11),i=n(34),o="".split;e.exports=r((function(){return!Object("z").propertyIsEnumerable(0)}))?function(e){return"String"==i(e)?o.call(e,""):Object(e)}:Object},function(e,t,n){var r=n(8),i=n(13),o=r.document,a=i(o)&&i(o.createElement);e.exports=function(e){return a?o.createElement(e):{}}},function(e,t,n){var r=n(43),i=n(103);(e.exports=function(e,t){return i[e]||(i[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.6.4",mode:r?"pure":"global",copyright:"© 2020 Denis Pushkarev (zloirock.ru)"})},function(e,t,n){"use strict";var r=n(5),i=n(167),o=n(105),a=n(171),s=n(37),l=n(19),u=n(53),c=n(10),d=n(43),f=n(44),h=n(104),p=h.IteratorPrototype,m=h.BUGGY_SAFARI_ITERATORS,v=c("iterator"),g="keys",y="values",_="entries",x=function(){return this};e.exports=function(e,t,n,c,h,b,w){i(n,t,c);var A,T,S,E=function(e){if(e===h&&D)return D;if(!m&&e in L)return L[e];switch(e){case g:return function(){return new n(this,e)};case y:return function(){return new n(this,e)};case _:return function(){return new n(this,e)}}return function(){return new n(this)}},C=t+" Iterator",M=!1,L=e.prototype,N=L[v]||L["@@iterator"]||h&&L[h],D=!m&&N||E(h),O="Array"==t&&L.entries||N;if(O&&(A=o(O.call(new e)),p!==Object.prototype&&A.next&&(d||o(A)===p||(a?a(A,p):"function"!=typeof A[v]&&l(A,v,x)),s(A,C,!0,!0),d&&(f[C]=x))),h==y&&N&&N.name!==y&&(M=!0,D=function(){return N.call(this)}),d&&!w||L[v]===D||l(L,v,D),f[t]=D,h)if(T={values:E(y),keys:b?D:E(g),entries:E(_)},w)for(S in T)(m||M||!(S in L))&&u(L,S,T[S]);else r({target:t,proto:!0,forced:m||M},T);return T}},function(e,t,n){var r=n(11);e.exports=!!Object.getOwnPropertySymbols&&!r((function(){return!String(Symbol())}))},function(e,t,n){var r,i=n(25),o=n(169),a=n(80),s=n(51),l=n(108),u=n(73),c=n(63),d=">",f="<",h="prototype",p="script",m=c("IE_PROTO"),v=function(){},g=function(e){return f+p+d+e+f+"/"+p+d},y=function(e){e.write(g("")),e.close();var t=e.parentWindow.Object;return e=null,t},_=function(){var e,t=u("iframe"),n="java"+p+":";return t.style.display="none",l.appendChild(t),t.src=String(n),e=t.contentWindow.document,e.open(),e.write(g("document.F=Object")),e.close(),e.F},x=function(){try{r=document.domain&&new ActiveXObject("htmlfile")}catch(t){}x=r?y(r):_();var e=a.length;while(e--)delete x[h][a[e]];return x()};s[m]=!0,e.exports=Object.create||function(e,t){var n;return null!==e?(v[h]=i(e),n=new v,v[h]=null,n[m]=e):n=x(),void 0===t?n:o(n,t)}},function(e,t,n){var r=n(30),i=n(35),o=n(79),a=function(e){return function(t,n,a){var s,l=r(t),u=i(l.length),c=o(a,u);if(e&&n!=n){while(u>c)if(s=l[c++],s!=s)return!0}else for(;u>c;c++)if((e||c in l)&&l[c]===n)return e||c||0;return!e&&-1}};e.exports={includes:a(!0),indexOf:a(!1)}},function(e,t,n){var r=n(62),i=Math.max,o=Math.min;e.exports=function(e,t){var n=r(e);return n<0?i(n+t,0):o(n,t)}},function(e,t){e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},function(e,t,n){var r=n(10),i=r("toStringTag"),o={};o[i]="z",e.exports="[object z]"===String(o)},function(e,t){e.exports=function(){}},function(e,t){e.exports=function(e,t,n){if(!(e instanceof t))throw TypeError("Incorrect "+(n?n+" ":"")+"invocation");return e}},function(e,t,n){var r=n(36);e.exports=r("navigator","userAgent")||""},function(e,t,n){"use strict";var r=n(41),i=function(e){var t,n;this.promise=new e((function(e,r){if(void 0!==t||void 0!==n)throw TypeError("Bad Promise constructor");t=e,n=r})),this.resolve=r(t),this.reject=r(n)};e.exports.f=function(e){return new i(e)}},function(e,t,n){var r,i,o=n(8),a=n(84),s=o.process,l=s&&s.versions,u=l&&l.v8;u?(r=u.split("."),i=r[0]+r[1]):a&&(r=a.match(/Edge\/(\d+)/),(!r||r[1]>=74)&&(r=a.match(/Chrome\/(\d+)/),r&&(i=r[1]))),e.exports=i&&+i},function(e,t,n){"use strict";var r=n(0),i=r(n(1)),o=r(n(4));(0,i["default"])(t,"__esModule",{value:!0});var a=n(2),s=a.__importDefault(n(3)),l=n(6),u=a.__importDefault(n(267)),c=a.__importDefault(n(280)),d=a.__importDefault(n(281)),f=a.__importDefault(n(282)),h=a.__importDefault(n(301)),p=a.__importStar(n(416)),m=a.__importDefault(n(417)),v=a.__importDefault(n(418)),g=a.__importDefault(n(419)),y=a.__importStar(n(420)),_=a.__importDefault(n(423)),x=a.__importDefault(n(424)),b=a.__importDefault(n(425)),w=a.__importDefault(n(427)),A=a.__importDefault(n(437)),T=a.__importDefault(n(440)),S=a.__importStar(n(441)),E=a.__importDefault(n(23)),C=a.__importDefault(n(134)),M=a.__importDefault(n(24)),L=a.__importDefault(n(33)),N=a.__importDefault(n(38)),D=a.__importDefault(n(39)),O=1,I=function(){function e(e,t){this.pluginsFunctionList={},this.beforeDestroyHooks=[],this.id="wangEditor-"+O++,this.toolbarSelector=e,this.textSelector=t,p.selectorValidator(this),this.config=l.deepClone(u["default"]),this.$toolbarElem=s["default"]("<div></div>"),this.$textContainerElem=s["default"]("<div></div>"),this.$textElem=s["default"]("<div></div>"),this.toolbarElemId="",this.textElemId="",this.isFocus=!1,this.isComposing=!1,this.isCompatibleMode=!1,this.selection=new c["default"](this),this.cmd=new d["default"](this),this.txt=new f["default"](this),this.menus=new h["default"](this),this.zIndex=new x["default"],this.change=new b["default"](this),this.history=new w["default"](this),this.onSelectionChange=new T["default"](this);var n=A["default"](this),r=n.disable,i=n.enable;this.disable=r,this.enable=i,this.isEnable=!0}return e.prototype.initSelection=function(e){m["default"](this,e)},e.prototype.create=function(){this.zIndex.init(this),this.isCompatibleMode=this.config.compatibleMode(),this.isCompatibleMode||(this.config.onchangeTimeout=30),g["default"](this),p["default"](this),this.txt.init(),this.menus.init(),y["default"](this),this.initSelection(!0),v["default"](this),this.change.observe(),this.history.observe(),S["default"](this)},e.prototype.beforeDestroy=function(e){return this.beforeDestroyHooks.push(e),this},e.prototype.destroy=function(){var e,t=this;(0,o["default"])(e=this.beforeDestroyHooks).call(e,(function(e){return e.call(t)})),this.$toolbarElem.remove(),this.$textContainerElem.remove()},e.prototype.fullScreen=function(){y.setFullScreen(this)},e.prototype.unFullScreen=function(){y.setUnFullScreen(this)},e.prototype.scrollToHead=function(e){_["default"](this,e)},e.registerMenu=function(t,n){n&&"function"===typeof n&&(e.globalCustomMenuConstructorList[t]=n)},e.prototype.registerPlugin=function(e,t){S.registerPlugin(e,t,this.pluginsFunctionList)},e.registerPlugin=function(t,n){S.registerPlugin(t,n,e.globalPluginsFunctionList)},e.$=s["default"],e.BtnMenu=E["default"],e.DropList=C["default"],e.DropListMenu=M["default"],e.Panel=L["default"],e.PanelMenu=N["default"],e.Tooltip=D["default"],e.globalCustomMenuConstructorList={},e.globalPluginsFunctionList={},e}();t["default"]=I},function(e,t,n){var r=n(13),i=n(55),o=n(10),a=o("species");e.exports=function(e,t){var n;return i(e)&&(n=e.constructor,"function"!=typeof n||n!==Array&&!i(n.prototype)?r(n)&&(n=n[a],null===n&&(n=void 0)):n=void 0),new(void 0===n?Array:n)(0===t?0:t)}},function(e,t,n){e.exports=n(185)},function(e,t,n){var r=n(49),i=n(68),o="["+i+"]",a=RegExp("^"+o+o+"*"),s=RegExp(o+o+"*$"),l=function(e){return function(t){var n=String(r(t));return 1&e&&(n=n.replace(a,"")),2&e&&(n=n.replace(s,"")),n}};e.exports={start:l(1),end:l(2),trim:l(3)}},function(e,t,n){e.exports=n(205)},function(e,t,n){var r=n(227),i=n(230);function o(t){return e.exports=o="function"===typeof i&&"symbol"===typeof r?function(e){return typeof e}:function(e){return e&&"function"===typeof i&&e.constructor===i&&e!==i.prototype?"symbol":typeof e},o(t)}e.exports=o},function(e,t,n){var r=n(10);t.f=r},function(e,t,n){e.exports=n(306)},function(e,t,n){"use strict";var r=n(0),i=r(n(1)),o=r(n(4));(0,i["default"])(t,"__esModule",{value:!0});var a=n(2),s=a.__importDefault(n(33)),l=function(){function e(e,t){var n=this;this.$elem=e,this.editor=t,this._active=!1,e.on("click",(function(e){var r;s["default"].hideCurAllPanels(),(0,o["default"])(r=t.txt.eventHooks.menuClickEvents).call(r,(function(e){return e()})),e.stopPropagation(),null!=t.selection.getRange()&&n.clickHandler(e)}))}return e.prototype.clickHandler=function(e){},e.prototype.active=function(){this._active=!0,this.$elem.addClass("w-e-active")},e.prototype.unActive=function(){this._active=!1,this.$elem.removeClass("w-e-active")},(0,i["default"])(e.prototype,"isActive",{get:function(){return this._active},enumerable:!1,configurable:!0}),e}();t["default"]=l},function(e,t,n){"use strict";var r=n(0),i=r(n(1)),o=r(n(28));function a(e){var n=e.elems[0];while(n&&(0,o["default"])(r=t.EXTRA_TAG).call(r,n.nodeName)){var r;if(n=n.parentElement,"A"===n.nodeName)return n}}function s(e){var t,n=e.selection.getSelectionContainerElem();if(!(null===(t=null===n||void 0===n?void 0:n.elems)||void 0===t?void 0:t.length))return!1;if("A"===n.getNodeName())return!0;var r=a(n);return!(!r||"A"!==r.nodeName)}(0,i["default"])(t,"__esModule",{value:!0}),t.getParentNodeA=t.EXTRA_TAG=void 0,t.EXTRA_TAG=["B","FONT","I","STRIKE"],t.getParentNodeA=a,t["default"]=s},function(e,t,n){"use strict";var r=n(0),i=r(n(1)),o=r(n(57)),a=r(n(4)),s=r(n(27));(0,i["default"])(t,"__esModule",{value:!0});var l=n(2),u=n(6),c=l.__importDefault(n(135)),d=l.__importDefault(n(136)),f=function(){function e(e){this.editor=e}return e.prototype.insertImg=function(e,t,n){var r=this.editor,i=r.config,o="validate.",a=function(e,t){return void 0===t&&(t=o),r.i18next.t(t+e)},s=e.replace(/</g,"&lt;").replace(/>/g,"&gt;");s=s.replace("'",'"');var l="";n&&(l=n.replace("'",'"'),l="data-href='"+encodeURIComponent(l)+"' ");var u="";t&&(u=t.replace(/</g,"&lt;").replace(/>/g,"&gt;"),u=u.replace("'",'"'),u="alt='"+u+"' "),r.cmd["do"]("insertHTML","<img src='"+s+"' "+u+l+'style="max-width:100%;" contenteditable="false"/>'),i.linkImgCallback(e,t,n);var c=document.createElement("img");c.onload=function(){c=null},c.onerror=function(){i.customAlert(a("插入图片错误"),"error","wangEditor: "+a("插入图片错误")+"，"+a("图片链接")+' "'+e+'"，'+a("下载链接失败")),c=null},c.onabort=function(){return c=null},c.src=e},e.prototype.uploadImg=function(e){var t=this;if(e.length){var n=this.editor,r=n.config,i="validate.",l=function(e){return n.i18next.t(i+e)},f=r.uploadImgServer,h=r.uploadImgShowBase64,p=r.uploadImgMaxSize,m=p/1024/1024,v=r.uploadImgMaxLength,g=r.uploadFileName,y=r.uploadImgParams,_=r.uploadImgParamsWithUrl,x=r.uploadImgHeaders,b=r.uploadImgHooks,w=r.uploadImgTimeout,A=r.withCredentials,T=r.customUploadImg;if(T||f||h){var S=[],E=[];if(u.arrForEach(e,(function(e){if(e){var t=e.name||e.type.replace("/","."),r=e.size;if(t&&r){var i=n.config.uploadImgAccept.join("|"),o=".("+i+")$",a=new RegExp(o,"i");!1!==a.test(t)?p<r?E.push("【"+t+"】"+l("大于")+" "+m+"M"):S.push(e):E.push("【"+t+"】"+l("不是图片"))}}})),E.length)r.customAlert(l("图片验证未通过")+": \n"+E.join("\n"),"warning");else if(0!==S.length)if(S.length>v)r.customAlert(l("一次最多上传")+v+l("张图片"),"warning");else if(T&&"function"===typeof T){var C;T(S,(0,o["default"])(C=this.insertImg).call(C,this))}else{var M=new FormData;if((0,a["default"])(S).call(S,(function(e,t){var n=g||e.name;S.length>1&&(n+=t+1),M.append(n,e)})),f){var L=f.split("#");f=L[0];var N=L[1]||"";(0,a["default"])(u).call(u,y,(function(e,t){_&&((0,s["default"])(f).call(f,"?")>0?f+="&":f+="?",f=f+e+"="+t),M.append(e,t)})),N&&(f+="#"+N);var D=c["default"](f,{timeout:w,formData:M,headers:x,withCredentials:!!A,beforeSend:function(e){if(b.before)return b.before(e,n,S)},onTimeout:function(e){r.customAlert(l("上传图片超时"),"error"),b.timeout&&b.timeout(e,n)},onProgress:function(e,t){var r=new d["default"](n);t.lengthComputable&&(e=t.loaded/t.total,r.show(e))},onError:function(e){r.customAlert(l("上传图片错误"),"error",l("上传图片错误")+"，"+l("服务器返回状态")+": "+e.status),b.error&&b.error(e,n)},onFail:function(e,t){r.customAlert(l("上传图片失败"),"error",l("上传图片返回结果错误")+"，"+l("返回结果")+": "+t),b.fail&&b.fail(e,n,t)},onSuccess:function(e,i){if(b.customInsert){var s;b.customInsert((0,o["default"])(s=t.insertImg).call(s,t),i,n)}else{if("0"!=i.errno)return r.customAlert(l("上传图片失败"),"error",l("上传图片返回结果错误")+"，"+l("返回结果")+" errno="+i.errno),void(b.fail&&b.fail(e,n,i));var u=i.data;(0,a["default"])(u).call(u,(function(e){"string"===typeof e?t.insertImg(e):t.insertImg(e.url,e.alt,e.href)})),b.success&&b.success(e,n,i)}}});"string"===typeof D&&r.customAlert(D,"error")}else h&&u.arrForEach(e,(function(e){var n=t,r=new FileReader;r.readAsDataURL(e),r.onload=function(){if(this.result){var e=this.result.toString();n.insertImg(e,e)}}}))}else r.customAlert(l("传入的文件不合法"),"warning")}}},e}();t["default"]=f},function(e,t,n){"use strict";var r=n(0),i=r(n(1)),o=r(n(410)),a=r(n(4)),s=r(n(45));function l(e){return!!e.length&&"w-e-todo"===e.attr("class")}function u(e){var t=e.selection.getSelectionRangeTopNodes();if(0!==t.length)return(0,o["default"])(t).call(t,(function(e){return l(e)}))}function c(e,t,n){var r;if(e.hasChildNodes()){var i=e.cloneNode(),o=!1;""===t.nodeValue&&(o=!0);var s=[];return(0,a["default"])(r=e.childNodes).call(r,(function(e){if(!d(e,t)&&o&&(i.appendChild(e.cloneNode(!0)),"BR"!==e.nodeName&&s.push(e)),d(e,t)){if(1===e.nodeType){var r=c(e,t,n);r&&""!==r.textContent&&(null===i||void 0===i||i.appendChild(r))}if(3===e.nodeType&&t.isEqualNode(e)){var a=f(e,n);i.textContent=a}o=!0}})),(0,a["default"])(s).call(s,(function(e){var t=e;t.remove()})),i}}function d(e,t){return 3===e.nodeType?e.nodeValue===t.nodeValue:e.contains(t)}function f(e,t,n){void 0===n&&(n=!0);var r=e.nodeValue,i=null===r||void 0===r?void 0:(0,s["default"])(r).call(r,0,t);if(r=null===r||void 0===r?void 0:(0,s["default"])(r).call(r,t),!n){var o=r;r=i,i=o}return e.nodeValue=i,r}(0,i["default"])(t,"__esModule",{value:!0}),t.dealTextNode=t.isAllTodo=t.isTodo=t.getCursorNextNode=void 0,t.isTodo=l,t.isAllTodo=u,t.getCursorNextNode=c,t.dealTextNode=f},function(e,t,n){"use strict";var r=n(0),i=r(n(1));(0,i["default"])(t,"__esModule",{value:!0});var o=n(430),a=function(){function e(e){this.maxSize=e,this.isRe=!1,this.data=new o.CeilStack(e),this.revokeData=new o.CeilStack(e)}return(0,i["default"])(e.prototype,"size",{get:function(){return[this.data.size,this.revokeData.size]},enumerable:!1,configurable:!0}),e.prototype.resetMaxSize=function(e){this.data.resetMax(e),this.revokeData.resetMax(e)},e.prototype.save=function(e){return this.isRe&&(this.revokeData.clear(),this.isRe=!1),this.data.instack(e),this},e.prototype.revoke=function(e){!this.isRe&&(this.isRe=!0);var t=this.data.outstack();return!!t&&(this.revokeData.instack(t),e(t),!0)},e.prototype.restore=function(e){!this.isRe&&(this.isRe=!0);var t=this.revokeData.outstack();return!!t&&(this.data.instack(t),e(t),!0)},e}();t["default"]=a},function(e,t,n){var r=n(14),i=n(11),o=n(73);e.exports=!r&&!i((function(){return 7!=Object.defineProperty(o("div"),"a",{get:function(){return 7}}).a}))},function(e,t,n){var r=n(11),i=/#|\.prototype\./,o=function(e,t){var n=s[a(e)];return n==u||n!=l&&("function"==typeof t?r(t):!!t)},a=o.normalize=function(e){return String(e).replace(i,".").toLowerCase()},s=o.data={},l=o.NATIVE="N",u=o.POLYFILL="P";e.exports=o},function(e,t,n){var r=n(103),i=Function.toString;"function"!=typeof r.inspectSource&&(r.inspectSource=function(e){return i.call(e)}),e.exports=r.inspectSource},function(e,t,n){var r=n(8),i=n(166),o="__core-js_shared__",a=r[o]||i(o,{});e.exports=a},function(e,t,n){"use strict";var r,i,o,a=n(105),s=n(19),l=n(16),u=n(10),c=n(43),d=u("iterator"),f=!1,h=function(){return this};[].keys&&(o=[].keys(),"next"in o?(i=a(a(o)),i!==Object.prototype&&(r=i)):f=!0),void 0==r&&(r={}),c||l(r,d)||s(r,d,h),e.exports={IteratorPrototype:r,BUGGY_SAFARI_ITERATORS:f}},function(e,t,n){var r=n(16),i=n(31),o=n(63),a=n(168),s=o("IE_PROTO"),l=Object.prototype;e.exports=a?Object.getPrototypeOf:function(e){return e=i(e),r(e,s)?e[s]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?l:null}},function(e,t,n){var r=n(76);e.exports=r&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},function(e,t,n){var r=n(16),i=n(30),o=n(78).indexOf,a=n(51);e.exports=function(e,t){var n,s=i(e),l=0,u=[];for(n in s)!r(a,n)&&r(s,n)&&u.push(n);while(t.length>l)r(s,n=t[l++])&&(~o(u,n)||u.push(n));return u}},function(e,t,n){var r=n(36);e.exports=r("document","documentElement")},function(e,t,n){var r=n(8);e.exports=r.Promise},function(e,t,n){var r=n(53);e.exports=function(e,t,n){for(var i in t)n&&n.unsafe&&e[i]?e[i]=t[i]:r(e,i,t[i],n);return e}},function(e,t,n){"use strict";var r=n(36),i=n(18),o=n(10),a=n(14),s=o("species");e.exports=function(e){var t=r(e),n=i.f;a&&t&&!t[s]&&n(t,s,{configurable:!0,get:function(){return this}})}},function(e,t,n){var r=n(10),i=n(44),o=r("iterator"),a=Array.prototype;e.exports=function(e){return void 0!==e&&(i.Array===e||a[o]===e)}},function(e,t,n){var r=n(65),i=n(44),o=n(10),a=o("iterator");e.exports=function(e){if(void 0!=e)return e[a]||e["@@iterator"]||i[r(e)]}},function(e,t,n){var r=n(25);e.exports=function(e,t,n,i){try{return i?t(r(n)[0],n[1]):t(n)}catch(a){var o=e["return"];throw void 0!==o&&r(o.call(e)),a}}},function(e,t,n){var r=n(10),i=r("iterator"),o=!1;try{var a=0,s={next:function(){return{done:!!a++}},return:function(){o=!0}};s[i]=function(){return this},Array.from(s,(function(){throw 2}))}catch(l){}e.exports=function(e,t){if(!t&&!o)return!1;var n=!1;try{var r={};r[i]=function(){return{next:function(){return{done:n=!0}}}},e(r)}catch(l){}return n}},function(e,t,n){var r=n(25),i=n(41),o=n(10),a=o("species");e.exports=function(e,t){var n,o=r(e).constructor;return void 0===o||void 0==(n=r(o)[a])?t:i(n)}},function(e,t,n){var r,i,o,a=n(8),s=n(11),l=n(34),u=n(40),c=n(108),d=n(73),f=n(118),h=a.location,p=a.setImmediate,m=a.clearImmediate,v=a.process,g=a.MessageChannel,y=a.Dispatch,_=0,x={},b="onreadystatechange",w=function(e){if(x.hasOwnProperty(e)){var t=x[e];delete x[e],t()}},A=function(e){return function(){w(e)}},T=function(e){w(e.data)},S=function(e){a.postMessage(e+"",h.protocol+"//"+h.host)};p&&m||(p=function(e){var t=[],n=1;while(arguments.length>n)t.push(arguments[n++]);return x[++_]=function(){("function"==typeof e?e:Function(e)).apply(void 0,t)},r(_),_},m=function(e){delete x[e]},"process"==l(v)?r=function(e){v.nextTick(A(e))}:y&&y.now?r=function(e){y.now(A(e))}:g&&!f?(i=new g,o=i.port2,i.port1.onmessage=T,r=u(o.postMessage,o,1)):!a.addEventListener||"function"!=typeof postMessage||a.importScripts||s(S)||"file:"===h.protocol?r=b in d("script")?function(e){c.appendChild(d("script"))[b]=function(){c.removeChild(this),w(e)}}:function(e){setTimeout(A(e),0)}:(r=S,a.addEventListener("message",T,!1))),e.exports={set:p,clear:m}},function(e,t,n){var r=n(84);e.exports=/(iphone|ipod|ipad).*applewebkit/i.test(r)},function(e,t,n){var r=n(25),i=n(13),o=n(85);e.exports=function(e,t){if(r(e),i(t)&&t.constructor===e)return t;var n=o.f(e),a=n.resolve;return a(t),n.promise}},function(e,t){e.exports=function(e){try{return{error:!1,value:e()}}catch(t){return{error:!0,value:t}}}},function(e,t,n){e.exports=n(197)},function(e,t,n){"use strict";var r=n(5),i=n(8),o=n(123),a=n(11),s=n(19),l=n(66),u=n(83),c=n(13),d=n(37),f=n(18).f,h=n(32).forEach,p=n(14),m=n(42),v=m.set,g=m.getterFor;e.exports=function(e,t,n){var m,y=-1!==e.indexOf("Map"),_=-1!==e.indexOf("Weak"),x=y?"set":"add",b=i[e],w=b&&b.prototype,A={};if(p&&"function"==typeof b&&(_||w.forEach&&!a((function(){(new b).entries().next()})))){m=t((function(t,n){v(u(t,m,e),{type:e,collection:new b}),void 0!=n&&l(n,t[x],t,y)}));var T=g(e);h(["add","clear","delete","forEach","get","has","set","keys","values","entries"],(function(e){var t="add"==e||"set"==e;!(e in w)||_&&"clear"==e||s(m.prototype,e,(function(n,r){var i=T(this).collection;if(!t&&_&&!c(n))return"get"==e&&void 0;var o=i[e](0===n?0:n,r);return t?this:o}))})),_||f(m.prototype,"size",{configurable:!0,get:function(){return T(this).collection.size}})}else m=n.getConstructor(t,e,y,x),o.REQUIRED=!0;return d(m,e,!1,!0),A[e]=m,r({global:!0,forced:!0},A),_||n.setStrong(m,e,y),m}},function(e,t,n){var r=n(51),i=n(13),o=n(16),a=n(18).f,s=n(64),l=n(200),u=s("meta"),c=0,d=Object.isExtensible||function(){return!0},f=function(e){a(e,u,{value:{objectID:"O"+ ++c,weakData:{}}})},h=function(e,t){if(!i(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!o(e,u)){if(!d(e))return"F";if(!t)return"E";f(e)}return e[u].objectID},p=function(e,t){if(!o(e,u)){if(!d(e))return!0;if(!t)return!1;f(e)}return e[u].weakData},m=function(e){return l&&v.REQUIRED&&d(e)&&!o(e,u)&&f(e),e},v=e.exports={REQUIRED:!1,fastKey:h,getWeakData:p,onFreeze:m};r[u]=!0},function(e,t,n){"use strict";var r=n(18).f,i=n(77),o=n(110),a=n(40),s=n(83),l=n(66),u=n(75),c=n(111),d=n(14),f=n(123).fastKey,h=n(42),p=h.set,m=h.getterFor;e.exports={getConstructor:function(e,t,n,u){var c=e((function(e,r){s(e,c,t),p(e,{type:t,index:i(null),first:void 0,last:void 0,size:0}),d||(e.size=0),void 0!=r&&l(r,e[u],e,n)})),h=m(t),v=function(e,t,n){var r,i,o=h(e),a=g(e,t);return a?a.value=n:(o.last=a={index:i=f(t,!0),key:t,value:n,previous:r=o.last,next:void 0,removed:!1},o.first||(o.first=a),r&&(r.next=a),d?o.size++:e.size++,"F"!==i&&(o.index[i]=a)),e},g=function(e,t){var n,r=h(e),i=f(t);if("F"!==i)return r.index[i];for(n=r.first;n;n=n.next)if(n.key==t)return n};return o(c.prototype,{clear:function(){var e=this,t=h(e),n=t.index,r=t.first;while(r)r.removed=!0,r.previous&&(r.previous=r.previous.next=void 0),delete n[r.index],r=r.next;t.first=t.last=void 0,d?t.size=0:e.size=0},delete:function(e){var t=this,n=h(t),r=g(t,e);if(r){var i=r.next,o=r.previous;delete n.index[r.index],r.removed=!0,o&&(o.next=i),i&&(i.previous=o),n.first==r&&(n.first=i),n.last==r&&(n.last=o),d?n.size--:t.size--}return!!r},forEach:function(e){var t,n=h(this),r=a(e,arguments.length>1?arguments[1]:void 0,3);while(t=t?t.next:n.first){r(t.value,t.key,this);while(t&&t.removed)t=t.previous}},has:function(e){return!!g(this,e)}}),o(c.prototype,n?{get:function(e){var t=g(this,e);return t&&t.value},set:function(e,t){return v(this,0===e?0:e,t)}}:{add:function(e){return v(this,e=0===e?0:e,e)}}),d&&r(c.prototype,"size",{get:function(){return h(this).size}}),c},setStrong:function(e,t,n){var r=t+" Iterator",i=m(t),o=m(r);u(e,t,(function(e,t){p(this,{type:r,target:e,state:i(e),kind:t,last:void 0})}),(function(){var e=o(this),t=e.kind,n=e.last;while(n&&n.removed)n=n.previous;return e.target&&(e.last=n=n?n.next:e.state.first)?"keys"==t?{value:n.key,done:!1}:"values"==t?{value:n.value,done:!1}:{value:[n.key,n.value],done:!1}:(e.target=void 0,{value:void 0,done:!0})}),n?"entries":"values",!n,!0),c(t)}}},function(e,t,n){var r=n(12);r("iterator")},function(e,t,n){var r=n(107),i=n(80),o=i.concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return r(e,o)}},function(e,t){t.f=Object.getOwnPropertySymbols},function(e,t,n){e.exports=n(268)},function(e,t,n){"use strict";var r=n(0),i=r(n(1));(0,i["default"])(t,"__esModule",{value:!0}),t["default"]={zIndex:1e4}},function(e,t,n){"use strict";var r=n(0),i=r(n(1));(0,i["default"])(t,"__esModule",{value:!0}),t["default"]={focus:!0,height:300,placeholder:"请输入正文",zIndexFullScreen:10002,showFullScreen:!0}},function(e,t,n){"use strict";var r=n(0),i=r(n(1)),o=r(n(4));(0,i["default"])(t,"__esModule",{value:!0}),t.getPasteImgs=t.getPasteHtml=t.getPasteText=void 0;var a=n(2),s=n(6),l=a.__importDefault(n(292));function u(e){var t=e.clipboardData,n="";return n=null==t?window.clipboardData&&window.clipboardData.getData("text"):t.getData("text/plain"),s.replaceHtmlSymbol(n)}function c(e,t,n){void 0===t&&(t=!0),void 0===n&&(n=!1);var r=e.clipboardData,i="";if(r&&(i=r.getData("text/html")),!i){var o=u(e);if(!o)return"";i="<p>"+o+"</p>"}return i=i.replace(/<(\d)/gm,(function(e,t){return"&lt;"+t})),i=i.replace(/<(\/?meta.*?)>/gim,""),i=l["default"](i,t,n),i}function d(e){var t,n=[],r=u(e);if(r)return n;var i=null===(t=e.clipboardData)||void 0===t?void 0:t.items;return i?((0,o["default"])(s).call(s,i,(function(e,t){var r=t.type;/image/i.test(r)&&n.push(t.getAsFile())})),n):n}t.getPasteText=u,t.getPasteHtml=c,t.getPasteImgs=d},function(e,t,n){e.exports=n(294)},function(e,t,n){e.exports=n(310)},function(e,t,n){"use strict";var r=n(0),i=r(n(1)),o=r(n(4)),a=r(n(46));(0,i["default"])(t,"__esModule",{value:!0});var s=n(2),l=s.__importDefault(n(3)),u=n(7),c=function(){function e(e,t){var n=this;this.hideTimeoutId=0,this.menu=e,this.conf=t;var r=l["default"]('<div class="w-e-droplist"></div>'),i=l["default"]("<p>"+t.title+"</p>");i.addClass("w-e-dp-title"),r.append(i);var s=t.list||[],c=t.type||"list",d=t.clickHandler||u.EMPTY_FN,f=l["default"]('<ul class="'+("list"===c?"w-e-list":"w-e-block")+'"></ul>');(0,o["default"])(s).call(s,(function(e){var t=e.$elem,r=e.value,i=l["default"]('<li class="w-e-item"></li>');t&&(i.append(t),f.append(i),i.on("click",(function(e){d(r),e.stopPropagation(),n.hideTimeoutId=(0,a["default"])((function(){n.hide()}))})))})),r.append(f),r.on("mouseleave",(function(){n.hideTimeoutId=(0,a["default"])((function(){n.hide()}))})),this.$container=r,this.rendered=!1,this._show=!1}return e.prototype.show=function(){this.hideTimeoutId&&clearTimeout(this.hideTimeoutId);var e=this.menu,t=e.$elem,n=this.$container;if(!this._show){if(this.rendered)n.show();else{var r=t.getBoundingClientRect().height||0,i=this.conf.width||100;n.css("margin-top",r+"px").css("width",i+"px"),t.append(n),this.rendered=!0}this._show=!0}},e.prototype.hide=function(){var e=this.$container;this._show&&(e.hide(),this._show=!1)},(0,i["default"])(e.prototype,"isShow",{get:function(){return this._show},enumerable:!1,configurable:!0}),e}();t["default"]=c},function(e,t,n){"use strict";var r=n(0),i=r(n(92)),o=r(n(1)),a=r(n(4));(0,o["default"])(t,"__esModule",{value:!0});var s=n(6);function l(e,t){var n=new XMLHttpRequest;if(n.open("POST",e),n.timeout=t.timeout||1e4,n.ontimeout=function(){console.error("wangEditor - 请求超时"),t.onTimeout&&t.onTimeout(n)},n.upload&&(n.upload.onprogress=function(e){var n=e.loaded/e.total;t.onProgress&&t.onProgress(n,e)}),t.headers&&(0,a["default"])(s).call(s,t.headers,(function(e,t){n.setRequestHeader(e,t)})),n.withCredentials=!!t.withCredentials,t.beforeSend){var r=t.beforeSend(n);if(r&&"object"===(0,i["default"])(r)&&r.prevent)return r.msg}return n.onreadystatechange=function(){if(4===n.readyState){var e=n.status;if(!(e<200)&&!(e>=300&&e<400)){if(e>=400)return console.error("wangEditor - XHR 报错，状态码 "+e),void(t.onError&&t.onError(n));var r,o=n.responseText;if("object"!==(0,i["default"])(o))try{r=JSON.parse(o)}catch(a){return console.error("wangEditor - 返回结果不是 JSON 格式",o),void(t.onFail&&t.onFail(n,o))}else r=o;t.onSuccess(n,r)}}},n.send(t.formData||null),n}t["default"]=l},function(e,t,n){"use strict";var r=n(0),i=r(n(1)),o=r(n(342)),a=r(n(46));(0,i["default"])(t,"__esModule",{value:!0});var s=n(2),l=s.__importDefault(n(3)),u=function(){function e(e){this.editor=e,this.$textContainer=e.$textContainerElem,this.$bar=l["default"]('<div class="w-e-progress"></div>'),this.isShow=!1,this.time=0,this.timeoutId=0}return e.prototype.show=function(e){var t=this;if(!this.isShow){this.isShow=!0;var n=this.$bar,r=this.$textContainer;r.append(n),(0,o["default"])()-this.time>100&&e<=1&&(n.css("width",100*e+"%"),this.time=(0,o["default"])());var i=this.timeoutId;i&&clearTimeout(i),this.timeoutId=(0,a["default"])((function(){t.hide()}),500)}},e.prototype.hide=function(){var e=this.$bar;e.remove(),this.isShow=!1,this.time=0,this.timeoutId=0},e}();t["default"]=u},function(e,t,n){"use strict";var r=n(0),i=r(n(1));(0,i["default"])(t,"__esModule",{value:!0}),t.ListType=void 0;var o,a=n(2),s=a.__importDefault(n(3)),l=a.__importDefault(n(24)),u=n(47),c=a.__importStar(n(371));(function(e){e["OrderedList"]="OL",e["UnorderedList"]="UL"})(o=t.ListType||(t.ListType={}));var d=function(e){function t(t){var n=this,r=s["default"]('<div class="w-e-menu" data-title="序列">\n                <i class="w-e-icon-list2"></i>\n            </div>'),i={width:130,title:"序列",type:"list",list:[{$elem:s["default"]('\n                        <p>\n                            <i class="w-e-icon-list2 w-e-drop-list-item"></i>\n                            '+t.i18next.t("menus.dropListMenu.list.无序列表")+"\n                        <p>"),value:o.UnorderedList},{$elem:s["default"]('<p>\n                            <i class="w-e-icon-list-numbered w-e-drop-list-item"></i>\n                            '+t.i18next.t("menus.dropListMenu.list.有序列表")+"\n                        <p>"),value:o.OrderedList}],clickHandler:function(e){n.command(e)}};return n=e.call(this,r,t,i)||this,n}return a.__extends(t,e),t.prototype.command=function(e){var t=this.editor,n=t.selection.getSelectionContainerElem();void 0!==n&&(this.handleSelectionRangeNodes(e),this.tryChangeActive())},t.prototype.validator=function(e,t,n){return!(!e.length||!t.length||n.equal(e)||n.equal(t))},t.prototype.handleSelectionRangeNodes=function(e){var t=this.editor,n=t.selection,r=e.toLowerCase(),i=n.getSelectionContainerElem(),o=n.getSelectionStartElem().getNodeTop(t),a=n.getSelectionEndElem().getNodeTop(t);if(this.validator(o,a,t.$textElem)){var s=n.getRange(),l=null===s||void 0===s?void 0:s.collapsed;t.$textElem.equal(i)||(i=i.getNodeTop(t));var d,f={editor:t,listType:e,listTarget:r,$selectionElem:i,$startElem:o,$endElem:a};d=this.isOrderElem(i)?c.ClassType.Wrap:this.isOrderElem(o)&&this.isOrderElem(a)?c.ClassType.Join:this.isOrderElem(o)?c.ClassType.StartJoin:this.isOrderElem(a)?c.ClassType.EndJoin:c.ClassType.Other;var h=new c["default"](c.createListHandle(d,f,s));u.updateRange(t,h.getSelectionRangeElem(),!!l)}},t.prototype.isOrderElem=function(e){var t=e.getNodeName();return t===o.OrderedList||t===o.UnorderedList},t.prototype.tryChangeActive=function(){},t}(l["default"]);t["default"]=d},function(e,t,n){e.exports=n(395)},function(e,t,n){"use strict";var r=n(0),i=r(n(1));function o(e){var t=e.selection.getSelectionContainerElem();return!!(null===t||void 0===t?void 0:t.length)&&!("CODE"!=t.getNodeName()&&"PRE"!=t.getNodeName()&&"CODE"!=t.parent().getNodeName()&&"PRE"!=t.parent().getNodeName()&&!/hljs/.test(t.parent().attr("class")))}(0,i["default"])(t,"__esModule",{value:!0}),t["default"]=o},function(e,t,n){"use strict";var r=n(0),i=r(n(1)),o=r(n(29));(0,i["default"])(t,"__esModule",{value:!0}),t.todo=void 0;var a=n(2),s=a.__importDefault(n(3)),l=function(){function e(e){var t;this.template='<ul class="w-e-todo"><li><span contenteditable="false"><input type="checkbox"></span></li></ul>',this.checked=!1,this.$todo=s["default"](this.template),this.$child=null===(t=null===e||void 0===e?void 0:e.childNodes())||void 0===t?void 0:t.clone(!0)}return e.prototype.init=function(){var e=this.$child,t=this.getInputContainer();e&&e.insertAfter(t)},e.prototype.getInput=function(){var e=this.$todo,t=(0,o["default"])(e).call(e,"input");return t},e.prototype.getInputContainer=function(){var e=this.getInput().parent();return e},e.prototype.getTodo=function(){return this.$todo},e}();function u(e){var t=new l(e);return t.init(),t}t.todo=l,t["default"]=u},function(e,t,n){"use strict";var r=n(0),i=r(n(1));(0,i["default"])(t,"__esModule",{value:!0});var o=n(2);n(146),n(148),n(152),n(154),n(156),n(158),n(160);var a=o.__importDefault(n(87));o.__exportStar(n(442),t);try{document}catch(s){throw new Error("请在浏览器环境下运行")}t["default"]=a["default"]},function(e,t,n){var r=n(143);e.exports=r},function(e,t,n){n(144);var r=n(9),i=r.Object,o=e.exports=function(e,t,n){return i.defineProperty(e,t,n)};i.defineProperty.sham&&(o.sham=!0)},function(e,t,n){var r=n(5),i=n(14),o=n(18);r({target:"Object",stat:!0,forced:!i,sham:!i},{defineProperty:o.f})},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(r){"object"===typeof window&&(n=window)}e.exports=n},function(e,t,n){var r=n(20),i=n(147);i=i.__esModule?i.default:i,"string"===typeof i&&(i=[[e.i,i,""]]);var o={insert:"head",singleton:!1};r(i,o);e.exports=i.locals||{}},function(e,t,n){var r=n(21);t=r(!1),t.push([e.i,'.w-e-toolbar,\n.w-e-text-container,\n.w-e-menu-panel {\n  padding: 0;\n  margin: 0;\n  box-sizing: border-box;\n  background-color: #fff;\n  /*表情菜单样式*/\n  /*分割线样式*/\n}\n.w-e-toolbar h1,\n.w-e-text-container h1,\n.w-e-menu-panel h1 {\n  font-size: 32px !important;\n}\n.w-e-toolbar h2,\n.w-e-text-container h2,\n.w-e-menu-panel h2 {\n  font-size: 24px !important;\n}\n.w-e-toolbar h3,\n.w-e-text-container h3,\n.w-e-menu-panel h3 {\n  font-size: 18.72px !important;\n}\n.w-e-toolbar h4,\n.w-e-text-container h4,\n.w-e-menu-panel h4 {\n  font-size: 16px !important;\n}\n.w-e-toolbar h5,\n.w-e-text-container h5,\n.w-e-menu-panel h5 {\n  font-size: 13.28px !important;\n}\n.w-e-toolbar p,\n.w-e-text-container p,\n.w-e-menu-panel p {\n  font-size: 16px !important;\n}\n.w-e-toolbar .eleImg,\n.w-e-text-container .eleImg,\n.w-e-menu-panel .eleImg {\n  cursor: pointer;\n  display: inline-block;\n  font-size: 18px;\n  padding: 0 3px;\n}\n.w-e-toolbar *,\n.w-e-text-container *,\n.w-e-menu-panel * {\n  padding: 0;\n  margin: 0;\n  box-sizing: border-box;\n}\n.w-e-toolbar hr,\n.w-e-text-container hr,\n.w-e-menu-panel hr {\n  cursor: pointer;\n  display: block;\n  height: 0px;\n  border: 0;\n  border-top: 3px solid #ccc;\n  margin: 20px 0;\n}\n.w-e-clear-fix:after {\n  content: "";\n  display: table;\n  clear: both;\n}\n.w-e-drop-list-item {\n  position: relative;\n  top: 1px;\n  padding-right: 7px;\n  color: #333 !important;\n}\n.w-e-drop-list-tl {\n  padding-left: 10px;\n  text-align: left;\n}\n',""]),e.exports=t},function(e,t,n){var r=n(20),i=n(149);i=i.__esModule?i.default:i,"string"===typeof i&&(i=[[e.i,i,""]]);var o={insert:"head",singleton:!1};r(i,o);e.exports=i.locals||{}},function(e,t,n){var r=n(21),i=n(150),o=n(151);t=r(!1);var a=i(o);t.push([e.i,"@font-face {\n  font-family: 'w-e-icon';\n  src: url("+a+') format(\'truetype\');\n  font-weight: normal;\n  font-style: normal;\n}\n[class^="w-e-icon-"],\n[class*=" w-e-icon-"] {\n  /* use !important to prevent issues with browser extensions that change fonts */\n  font-family: \'w-e-icon\' !important;\n  speak: none;\n  font-style: normal;\n  font-weight: normal;\n  font-variant: normal;\n  text-transform: none;\n  line-height: 1;\n  /* Better Font Rendering =========== */\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n.w-e-icon-close:before {\n  content: "\\f00d";\n}\n.w-e-icon-upload2:before {\n  content: "\\e9c6";\n}\n.w-e-icon-trash-o:before {\n  content: "\\f014";\n}\n.w-e-icon-header:before {\n  content: "\\f1dc";\n}\n.w-e-icon-pencil2:before {\n  content: "\\e906";\n}\n.w-e-icon-paint-brush:before {\n  content: "\\f1fc";\n}\n.w-e-icon-image:before {\n  content: "\\e90d";\n}\n.w-e-icon-play:before {\n  content: "\\e912";\n}\n.w-e-icon-location:before {\n  content: "\\e947";\n}\n.w-e-icon-undo:before {\n  content: "\\e965";\n}\n.w-e-icon-redo:before {\n  content: "\\e966";\n}\n.w-e-icon-quotes-left:before {\n  content: "\\e977";\n}\n.w-e-icon-list-numbered:before {\n  content: "\\e9b9";\n}\n.w-e-icon-list2:before {\n  content: "\\e9bb";\n}\n.w-e-icon-link:before {\n  content: "\\e9cb";\n}\n.w-e-icon-happy:before {\n  content: "\\e9df";\n}\n.w-e-icon-bold:before {\n  content: "\\ea62";\n}\n.w-e-icon-underline:before {\n  content: "\\ea63";\n}\n.w-e-icon-italic:before {\n  content: "\\ea64";\n}\n.w-e-icon-strikethrough:before {\n  content: "\\ea65";\n}\n.w-e-icon-table2:before {\n  content: "\\ea71";\n}\n.w-e-icon-paragraph-left:before {\n  content: "\\ea77";\n}\n.w-e-icon-paragraph-center:before {\n  content: "\\ea78";\n}\n.w-e-icon-paragraph-right:before {\n  content: "\\ea79";\n}\n.w-e-icon-paragraph-justify:before {\n  content: "\\ea7a";\n}\n.w-e-icon-terminal:before {\n  content: "\\f120";\n}\n.w-e-icon-page-break:before {\n  content: "\\ea68";\n}\n.w-e-icon-cancel-circle:before {\n  content: "\\ea0d";\n}\n.w-e-icon-font:before {\n  content: "\\ea5c";\n}\n.w-e-icon-text-heigh:before {\n  content: "\\ea5f";\n}\n.w-e-icon-paint-format:before {\n  content: "\\e90c";\n}\n.w-e-icon-indent-increase:before {\n  content: "\\ea7b";\n}\n.w-e-icon-indent-decrease:before {\n  content: "\\ea7c";\n}\n.w-e-icon-row-height:before {\n  content: "\\e9be";\n}\n.w-e-icon-fullscreen_exit:before {\n  content: "\\e900";\n}\n.w-e-icon-fullscreen:before {\n  content: "\\e901";\n}\n.w-e-icon-split-line:before {\n  content: "\\ea0b";\n}\n.w-e-icon-checkbox-checked:before {\n  content: "\\ea52";\n}\n',""]),e.exports=t},function(e,t,n){"use strict";e.exports=function(e,t){return t||(t={}),e=e&&e.__esModule?e.default:e,"string"!==typeof e?e:(/^['"].*['"]$/.test(e)&&(e=e.slice(1,-1)),t.hash&&(e+=t.hash),/["'() \t\n]/.test(e)||t.needQuotes?'"'.concat(e.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):e)}},function(e,t,n){"use strict";n.r(t),t["default"]="data:font/woff;base64,d09GRgABAAAAABskAAsAAAAAGtgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABPUy8yAAABCAAAAGAAAABgDxIPFWNtYXAAAAFoAAABHAAAARz2mfAgZ2FzcAAAAoQAAAAIAAAACAAAABBnbHlmAAACjAAAFXwAABV8IH7+mGhlYWQAABgIAAAANgAAADYb6gumaGhlYQAAGEAAAAAkAAAAJAkjBWlobXR4AAAYZAAAAKQAAACkmYcEbmxvY2EAABkIAAAAVAAAAFReAmKYbWF4cAAAGVwAAAAgAAAAIAA0ALZuYW1lAAAZfAAAAYYAAAGGmUoJ+3Bvc3QAABsEAAAAIAAAACAAAwAAAAMD7wGQAAUAAAKZAswAAACPApkCzAAAAesAMwEJAAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAAAAAAAAAAAAAQAAA8fwDwP/AAEADwABAAAAAAQAAAAAAAAAAAAAAIAAAAAAAAwAAAAMAAAAcAAEAAwAAABwAAwABAAAAHAAEAQAAAAA8ACAABAAcAAEAIOkB6QbpDekS6UfpZul36bnpu+m+6cbpy+nf6gvqDepS6lzqX+pl6nHqfPAN8BTxIPHc8fz//f//AAAAAAAg6QDpBukM6RLpR+ll6Xfpuem76b7pxunL6d/qC+oN6lLqXOpf6mLqcep38A3wFPEg8dzx/P/9//8AAf/jFwQXABb7FvcWwxamFpYWVRZUFlIWSxZHFjQWCRYIFcQVuxW5FbcVrBWnEBcQEQ8GDksOLAADAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAB//8ADwABAAAAAAAAAAAAAgAANzkBAAAAAAEAAAAAAAAAAAACAAA3OQEAAAAAAQAAAAAAAAAAAAIAADc5AQAAAAAEAEEAAQO/A38ABQALABEAFwAAATMVIREzAxEhFSMVATUzESE1ETUhESM1Av/A/sJ+fgE+wP4Cfv7CAT5+Ar9+AT78ggE+fsACvsD+wn7+An7+wsAAAAAABABBAAEDvwN/AAUACwARABcAAAEhESM1IxM1MxEhNQERIRUjFREVMxUhEQKBAT5+wMB+/sL9wAE+wMD+wgN//sLA/X7A/sJ+AcIBPn7A/v7AfgE+AAAAAAIAAP/ABAADwAAEABMAAAE3AScBAy4BJxM3ASMBAyUBNQEHAYCAAcBA/kCfFzsyY4ABgMD+gMACgAGA/oBOAUBAAcBA/kD+nTI7FwERTgGA/oD9gMABgMD+gIAAAgAA/8AEAAOAACkALQAAAREjNTQmIyEiBh0BFBYzITI2PQEzESEVIyIGFREUFjsBMjY1ETQmKwE1ASE1IQQAwCYa/UAaJiYaAsAaJoD9wCANExMNgA0TEw0gAUD9QALAAYABgEAaJiYawBomJhpA/wCAEw3+wA0TEw0BQA0TQAGAQAAABAAAAAAEAAOAABAAIQAtADQAAAE4ATEROAExITgBMRE4ATEhNSEiBhURFBYzITI2NRE0JiMHFAYjIiY1NDYzMhYTITUTATM3A8D8gAOA/IAaJiYaA4AaJiYagDgoKDg4KCg4QP0A4AEAQOADQP0AAwBAJhr9ABomJhoDABom4Cg4OCgoODj9uIABgP7AwAAAAgAAAEAEAANAADgAPAAAASYnLgEnJiMiBw4BBwYHBgcOAQcGFRQXHgEXFhcWFx4BFxYzMjc+ATc2NzY3PgE3NjU0Jy4BJyYnARENAQPVNjg5djw9Pz89PHY5ODYLBwgLAwMDAwsIBws2ODl2PD0/Pz08djk4NgsHCAsDAwMDCwgHC/2rAUD+wAMgCAYGCAICAgIIBgYIKSoqWS0uLy8uLVkqKikIBgYIAgICAggGBggpKipZLS4vLy4tWSoqKf3gAYDAwAAAAAACAMD/wANAA8AAGwAnAAABIgcOAQcGFRQXHgEXFjEwNz4BNzY1NCcuAScmAyImNTQ2MzIWFRQGAgBCOzpXGRkyMngyMjIyeDIyGRlXOjtCUHBwUFBwcAPAGRlXOjtCeH19zEFBQUHMfX14Qjs6VxkZ/gBwUFBwcFBQcAAAAQAAAAAEAAOAACsAAAEiBw4BBwYHJxEhJz4BMzIXHgEXFhUUBw4BBwYHFzY3PgE3NjU0Jy4BJyYjAgA1MjJcKSkjlgGAkDWLUFBFRmkeHgkJIhgYHlUoICAtDAwoKIteXWoDgAoLJxscI5b+gJA0PB4eaUZFUCsoKUkgIRpgIysrYjY2OWpdXosoKAABAAAAAAQAA4AAKgAAExQXHgEXFhc3JicuAScmNTQ3PgE3NjMyFhcHIREHJicuAScmIyIHDgEHBgAMDC0gIChVHhgYIgkJHh5pRkVQUIs1kAGAliMpKVwyMjVqXV6LKCgBgDk2NmIrKyNgGiEgSSkoK1BFRmkeHjw0kAGAliMcGycLCigoi15dAAAAAAIAAABABAEDAAAmAE0AABMyFx4BFxYVFAcOAQcGIyInLgEnJjUnNDc+ATc2MxUiBgcOAQc+ASEyFx4BFxYVFAcOAQcGIyInLgEnJjUnNDc+ATc2MxUiBgcOAQc+AeEuKSk9ERISET0pKS4uKSk9ERIBIyN6UlFdQHUtCRAHCBICSS4pKT0REhIRPSkpLi4pKT0REgEjI3pSUV1AdS0JEAcIEgIAEhE9KSkuLikpPRESEhE9KSkuIF1RUnojI4AwLggTCgIBEhE9KSkuLikpPRESEhE9KSkuIF1RUnojI4AwLggTCgIBAAAGAED/wAQAA8AAAwAHAAsAEQAdACkAACUhFSERIRUhESEVIScRIzUjNRMVMxUjNTc1IzUzFRURIzUzNSM1MzUjNQGAAoD9gAKA/YACgP2AwEBAQIDAgIDAwICAgICAgAIAgAIAgMD/AMBA/fIyQJI8MkCS7v7AQEBAQEAABgAA/8AEAAPAAAMABwALABcAIwAvAAABIRUhESEVIREhFSEBNDYzMhYVFAYjIiYRNDYzMhYVFAYjIiYRNDYzMhYVFAYjIiYBgAKA/YACgP2AAoD9gP6ASzU1S0s1NUtLNTVLSzU1S0s1NUtLNTVLA4CA/wCA/wCAA0A1S0s1NUtL/rU1S0s1NUtL/rU1S0s1NUtLAAUAAABABWADAAADAAcACwAOABEAABMhFSEVIRUhFSEVIQEXNzUnBwADgPyAA4D8gAOA/IAD4MDAwMADAMBAwEDAAUDAwEDAwAAAAAADAAAAAAQAA6AAAwANABQAADchFSElFSE1EyEVITUhJQkBIxEjEQAEAPwABAD8AIABAAEAAQD9YAEgASDggEBAwEBAAQCAgMABIP7g/wABAAAAAAACAB7/zAPiA7QAMwBkAAABIiYnJicmNDc2PwE+ATMyFhcWFxYUBwYPAQYiJyY0PwE2NCcuASMiBg8BBhQXFhQHDgEjAyImJyYnJjQ3Nj8BNjIXFhQPAQYUFx4BMzI2PwE2NCcmNDc2MhcWFxYUBwYPAQ4BIwG4ChMIIxISEhIjwCNZMTFZIyMSEhISI1gPLA8PD1gpKRQzHBwzFMApKQ8PCBMKuDFZIyMSEhISI1gPLA8PD1gpKRQzHBwzFMApKQ8PDysQIxISEhIjwCNZMQFECAckLS1eLS0kwCIlJSIkLS1eLS0kVxAQDysPWCl0KRQVFRTAKXQpDysQBwj+iCUiJC0tXi0tJFcQEA8rD1gpdCkUFRUUwCl0KQ8rEA8PJC0tXi0tJMAiJQAAAAAFAAD/wAQAA8AAGwA3AFMAXwBrAAAFMjc+ATc2NTQnLgEnJiMiBw4BBwYVFBceARcWEzIXHgEXFhUUBw4BBwYjIicuAScmNTQ3PgE3NhMyNz4BNzY3BgcOAQcGIyInLgEnJicWFx4BFxYnNDYzMhYVFAYjIiYlNDYzMhYVFAYjIiYCAGpdXosoKCgoi15dampdXosoKCgoi15dalZMTHEgISEgcUxMVlZMTHEgISEgcUxMVisrKlEmJiMFHBtWODc/Pzc4VhscBSMmJlEqK9UlGxslJRsbJQGAJRsbJSUbGyVAKCiLXl1qal1eiygoKCiLXl1qal1eiygoA6AhIHFMTFZWTExxICEhIHFMTFZWTExxICH+CQYGFRAQFEM6OlYYGRkYVjo6QxQQEBUGBvcoODgoKDg4KCg4OCgoODgAAAEAAAFABAACQAAPAAATFRQWMyEyNj0BNCYjISIGABMNA8ANExMN/EANEwIgwA0TEw3ADRMTAAAAAwAA/8AEAAPAABsANwBDAAABIgcOAQcGFRQXHgEXFjMyNz4BNzY1NCcuAScmAyInLgEnJjU0Nz4BNzYzMhceARcWFRQHDgEHBhMHJwcXBxc3FzcnNwIAal1eiygoKCiLXl1qal1eiygoKCiLXl1qVkxMcSAhISBxTExWVkxMcSAhISBxTExKoKBgoKBgoKBgoKADwCgoi15dampdXosoKCgoi15dampdXosoKPxgISBxTExWVkxMcSAhISBxTExWVkxMcSAhAqCgoGCgoGCgoGCgoAACAAD/wAQAA8AADwAVAAABISIGFREUFjMhMjY1ETQmASc3FwEXA4D9ADVLSzUDADVLS/4L7VqTATNaA8BLNf0ANUtLNQMANUv85e5akgEyWgAAAAABAGX/wAObA8AAKQAAASImIyIHDgEHBhUUFjMuATU0NjcwBwYCBwYHFSETMzcjNx4BMzI2Nw4BAyBEaEZxU1RtGhtJSAYNZUoQEEs8PFkBPWzGLNc0LVUmLlAYHT0DsBAeHWE+P0FNOwsmN5lvA31+/sWPkCMZAgCA9gkPN2sJBwAAAAACAAAAAAQAA4AACQAXAAAlMwcnMxEjNxcjJREnIxEzFSE1MxEjBxEDgICgoICAoKCA/wBAwID+gIDAQMDAwAIAwMDA/wCA/UBAQALAgAEAAAMAwAAAA0ADgAAWAB8AKAAAAT4BNTQnLgEnJiMhESEyNz4BNzY1NCYBMzIWFRQGKwETIxEzMhYVFAYCxBwgFBRGLi81/sABgDUvLkYUFET+hGUqPDwpZp+fnyw+PgHbIlQvNS8uRhQU/IAUFEYuLzVGdAFGSzU1S/6AAQBLNTVLAAAAAAIAwAAAA0ADgAAfACMAAAEzERQHDgEHBiMiJy4BJyY1ETMRFBYXHgEzMjY3PgE1ASEVIQLAgBkZVzo7QkI7OlcZGYAbGBxJKChJHBgb/gACgP2AA4D+YDw0NU4WFxcWTjU0PAGg/mAeOBcYGxsYFzge/qCAAAAAAAEAgAAAA4ADgAALAAABFSMBMxUhNTMBIzUDgID+wID+QIABQIADgED9AEBAAwBAAAEAAAAABAADgAA9AAABFSMeARUUBgcOASMiJicuATUzFBYzMjY1NCYjITUhLgEnLgE1NDY3PgEzMhYXHgEVIzQmIyIGFRQWMzIWFwQA6xUWNTAscT4+cSwwNYByTk5yck7+AAEsAgQBMDU1MCxxPj5xLDA1gHJOTnJyTjtuKwHAQB1BIjViJCEkJCEkYjU0TEw0NExAAQMBJGI1NWIkISQkISRiNTRMTDQ0TCEfAAAACgAAAAAEAAOAAAMABwALAA8AEwAXABsAHwAjACcAABMRIREBNSEVHQEhNQEVITUjFSE1ESEVISUhFSERNSEVASEVISE1IRUABAD9gAEA/wABAP8AQP8AAQD/AAKAAQD/AAEA/IABAP8AAoABAAOA/IADgP3AwMBAwMACAMDAwMD/AMDAwAEAwMD+wMDAwAAABQAAAAAEAAOAAAMABwALAA8AEwAAEyEVIRUhFSERIRUhESEVIREhFSEABAD8AAKA/YACgP2ABAD8AAQA/AADgIBAgP8AgAFAgP8AgAAAAAAFAAAAAAQAA4AAAwAHAAsADwATAAATIRUhFyEVIREhFSEDIRUhESEVIQAEAPwAwAKA/YACgP2AwAQA/AAEAPwAA4CAQID/AIABQID/AIAAAAUAAAAABAADgAADAAcACwAPABMAABMhFSEFIRUhESEVIQEhFSERIRUhAAQA/AABgAKA/YACgP2A/oAEAPwABAD8AAOAgECA/wCAAUCA/wCAAAAAAAUAAAAABAADgAADAAcACwAPABMAABMhFSEVIRUhFSEVIRUhFSEVIRUhAAQA/AAEAPwABAD8AAQA/AAEAPwAA4CAQIBAgECAQIAAAAAGAAAAAAQAA4AAAwAHAAsADwATABYAABMhFSEFIRUhFSEVIRUhFSEFIRUhGQEFAAQA/AABgAKA/YACgP2AAoD9gP6ABAD8AAEAA4CAQIBAgECAQIABAAGAwAAAAAYAAAAABAADgAADAAcACwAPABMAFgAAEyEVIQUhFSEVIRUhFSEVIQUhFSEBESUABAD8AAGAAoD9gAKA/YACgP2A/oAEAPwAAQD/AAOAgECAQIBAgECAAoD+gMAAAQA/AD8C5gLmACwAACUUDwEGIyIvAQcGIyIvASY1ND8BJyY1ND8BNjMyHwE3NjMyHwEWFRQPARcWFQLmEE4QFxcQqKgQFxYQThAQqKgQEE4QFhcQqKgQFxcQThAQqKgQwxYQThAQqKgQEE4QFhcQqKgQFxcQThAQqKgQEE4QFxcQqKgQFwAAAAYAAAAAAyUDbgAUACgAPABNAFUAggAAAREUBwYrASInJjURNDc2OwEyFxYVMxEUBwYrASInJjURNDc2OwEyFxYXERQHBisBIicmNRE0NzY7ATIXFhMRIREUFxYXFjMhMjc2NzY1ASEnJicjBgcFFRQHBisBERQHBiMhIicmNREjIicmPQE0NzY7ATc2NzY7ATIXFh8BMzIXFhUBJQYFCCQIBQYGBQgkCAUGkgUFCCUIBQUFBQglCAUFkgUFCCUIBQUFBQglCAUFSf4ABAQFBAIB2wIEBAQE/oABABsEBrUGBAH3BgUINxobJv4lJhsbNwgFBQUFCLEoCBcWF7cXFhYJKLAIBQYCEv63CAUFBQUIAUkIBQYGBQj+twgFBQUFCAFJCAUGBgUI/rcIBQUFBQgBSQgFBgYF/lsCHf3jDQsKBQUFBQoLDQJmQwUCAgVVJAgGBf3jMCIjISIvAiAFBggkCAUFYBUPDw8PFWAFBQgAAgAHAEkDtwKvABoALgAACQEGIyIvASY1ND8BJyY1ND8BNjMyFwEWFRQHARUUBwYjISInJj0BNDc2MyEyFxYBTv72BgcIBR0GBuHhBgYdBQgHBgEKBgYCaQUFCP3bCAUFBQUIAiUIBQUBhf72BgYcBggHBuDhBgcHBh0FBf71BQgHBv77JQgFBQUFCCUIBQUFBQAAAAEAIwAAA90DbgCzAAAlIicmIyIHBiMiJyY1NDc2NzY3Njc2PQE0JyYjISIHBh0BFBcWFxYzFhcWFRQHBiMiJyYjIgcGIyInJjU0NzY3Njc2NzY9ARE0NTQ1NCc0JyYnJicmJyYnJiMiJyY1NDc2MzIXFjMyNzYzMhcWFRQHBiMGBwYHBh0BFBcWMyEyNzY9ATQnJicmJyY1NDc2MzIXFjMyNzYzMhcWFRQHBgciBwYHBhURFBcWFxYXMhcWFRQHBiMDwRkzMhoZMjMZDQgHCQoNDBEQChIBBxX+fhYHARUJEhMODgwLBwcOGzU1GhgxMRgNBwcJCQsMEA8JEgECAQIDBAQFCBIRDQ0KCwcHDho1NRoYMDEYDgcHCQoMDRAQCBQBBw8BkA4HARQKFxcPDgcHDhkzMhkZMTEZDgcHCgoNDRARCBQUCRERDg0KCwcHDgACAgICDAsPEQkJAQEDAwUMROAMBQMDBQzUUQ0GAQIBCAgSDwwNAgICAgwMDhEICQECAwMFDUUhAdACDQ0ICA4OCgoLCwcHAwYBAQgIEg8MDQICAgINDA8RCAgBAgEGDFC2DAcBAQcMtlAMBgEBBgcWDwwNAgICAg0MDxEICAEBAgYNT/3mRAwGAgIBCQgRDwwNAAACAAD/twP/A7cAEwA5AAABMhcWFRQHAgcGIyInJjU0NwE2MwEWFxYfARYHBiMiJyYnJicmNRYXFhcWFxYzMjc2NzY3Njc2NzY3A5soHh4avkw3RUg0NDUBbSEp/fgXJicvAQJMTHtHNjYhIRARBBMUEBASEQkXCA8SExUVHR0eHikDtxsaKCQz/plGNDU0SUkwAUsf/bErHx8NKHpNTBobLi86OkQDDw4LCwoKFiUbGhERCgsEBAIAAQAAAAAAAIWwaoFfDzz1AAsEAAAAAADbteOZAAAAANu145kAAP+3BWADwAAAAAgAAgAAAAAAAAABAAADwP/AAAAFgAAA//8FYAABAAAAAAAAAAAAAAAAAAAAKQQAAAAAAAAAAAAAAAIAAAAEAABBBAAAQQQAAAAEAAAABAAAAAQAAAAEAADABAAAAAQAAAAEAAAABAAAQAQAAAAFgAAABAAAAAQAAB4EAAAABAAAAAQAAAAEAAAABAAAZQQAAAAEAADABAAAwAQAAIAEAAAABAAAAAQAAAAEAAAABAAAAAQAAAAEAAAABAAAAAMlAD8DJQAAA74ABwQAACMD/wAAAAAAAAAKABQAHgBKAHYApADmAS4BkgHQAhYCXALQAw4DWAN+A6gEPgTeBPoFZAWOBdAF+AY6BnYGjgbmBy4HVgd+B6gHzgf8CCoIbgkmCXAKYgq+AAEAAAApALQACgAAAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAAOAK4AAQAAAAAAAQAHAAAAAQAAAAAAAgAHAGAAAQAAAAAAAwAHADYAAQAAAAAABAAHAHUAAQAAAAAABQALABUAAQAAAAAABgAHAEsAAQAAAAAACgAaAIoAAwABBAkAAQAOAAcAAwABBAkAAgAOAGcAAwABBAkAAwAOAD0AAwABBAkABAAOAHwAAwABBAkABQAWACAAAwABBAkABgAOAFIAAwABBAkACgA0AKRpY29tb29uAGkAYwBvAG0AbwBvAG5WZXJzaW9uIDEuMABWAGUAcgBzAGkAbwBuACAAMQAuADBpY29tb29uAGkAYwBvAG0AbwBvAG5pY29tb29uAGkAYwBvAG0AbwBvAG5SZWd1bGFyAFIAZQBnAHUAbABhAHJpY29tb29uAGkAYwBvAG0AbwBvAG5Gb250IGdlbmVyYXRlZCBieSBJY29Nb29uLgBGAG8AbgB0ACAAZwBlAG4AZQByAGEAdABlAGQAIABiAHkAIABJAGMAbwBNAG8AbwBuAC4AAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"},function(e,t,n){var r=n(20),i=n(153);i=i.__esModule?i.default:i,"string"===typeof i&&(i=[[e.i,i,""]]);var o={insert:"head",singleton:!1};r(i,o);e.exports=i.locals||{}},function(e,t,n){var r=n(21);t=r(!1),t.push([e.i,'.w-e-toolbar {\n  display: flex;\n  padding: 0 6px;\n  flex-wrap: wrap;\n  position: relative;\n  /* 单个菜单 */\n}\n.w-e-toolbar .w-e-menu {\n  position: relative;\n  display: flex;\n  width: 40px;\n  height: 40px;\n  align-items: center;\n  justify-content: center;\n  text-align: center;\n  cursor: pointer;\n}\n.w-e-toolbar .w-e-menu i {\n  color: #999;\n}\n.w-e-toolbar .w-e-menu:hover {\n  background-color: #F6F6F6;\n}\n.w-e-toolbar .w-e-menu:hover i {\n  color: #333;\n}\n.w-e-toolbar .w-e-active i {\n  color: #1e88e5;\n}\n.w-e-toolbar .w-e-active:hover i {\n  color: #1e88e5;\n}\n.w-e-menu-tooltip {\n  position: absolute;\n  display: flex;\n  color: #f1f1f1;\n  background-color: rgba(0, 0, 0, 0.75);\n  box-shadow: 0 2px 8px 0 rgba(0, 0, 0, 0.15);\n  border-radius: 4px;\n  padding: 4px 5px 6px;\n  justify-content: center;\n  align-items: center;\n}\n.w-e-menu-tooltip-up::after {\n  content: "";\n  position: absolute;\n  top: 100%;\n  left: 50%;\n  margin-left: -5px;\n  border: 5px solid rgba(0, 0, 0, 0);\n  border-top-color: rgba(0, 0, 0, 0.73);\n}\n.w-e-menu-tooltip-down::after {\n  content: "";\n  position: absolute;\n  bottom: 100%;\n  left: 50%;\n  margin-left: -5px;\n  border: 5px solid rgba(0, 0, 0, 0);\n  border-bottom-color: rgba(0, 0, 0, 0.73);\n}\n.w-e-menu-tooltip-item-wrapper {\n  font-size: 14px;\n  margin: 0 5px;\n}\n',""]),e.exports=t},function(e,t,n){var r=n(20),i=n(155);i=i.__esModule?i.default:i,"string"===typeof i&&(i=[[e.i,i,""]]);var o={insert:"head",singleton:!1};r(i,o);e.exports=i.locals||{}},function(e,t,n){var r=n(21);t=r(!1),t.push([e.i,'.w-e-text-container {\n  position: relative;\n  height: 100%;\n}\n.w-e-text-container .w-e-progress {\n  position: absolute;\n  background-color: #1e88e5;\n  top: 0;\n  left: 0;\n  height: 1px;\n}\n.w-e-text-container .placeholder {\n  color: #D4D4D4;\n  position: absolute;\n  font-size: 11pt;\n  line-height: 22px;\n  left: 10px;\n  top: 10px;\n  -webkit-user-select: none;\n     -moz-user-select: none;\n      -ms-user-select: none;\n          user-select: none;\n  z-index: -1;\n}\n.w-e-text {\n  padding: 0 10px;\n  overflow-y: auto;\n}\n.w-e-text p,\n.w-e-text h1,\n.w-e-text h2,\n.w-e-text h3,\n.w-e-text h4,\n.w-e-text h5,\n.w-e-text table,\n.w-e-text pre {\n  margin: 10px 0;\n  line-height: 1.5;\n}\n.w-e-text ul,\n.w-e-text ol {\n  margin: 10px 0 10px 20px;\n}\n.w-e-text blockquote {\n  display: block;\n  border-left: 8px solid #d0e5f2;\n  padding: 5px 10px;\n  margin: 10px 0;\n  line-height: 1.4;\n  font-size: 100%;\n  background-color: #f1f1f1;\n}\n.w-e-text code {\n  display: inline-block;\n  background-color: #f1f1f1;\n  border-radius: 3px;\n  padding: 3px 5px;\n  margin: 0 3px;\n}\n.w-e-text pre code {\n  display: block;\n}\n.w-e-text table {\n  border-top: 1px solid #ccc;\n  border-left: 1px solid #ccc;\n}\n.w-e-text table td,\n.w-e-text table th {\n  border-bottom: 1px solid #ccc;\n  border-right: 1px solid #ccc;\n  padding: 3px 5px;\n  min-height: 30px;\n  height: 30px;\n}\n.w-e-text table th {\n  border-bottom: 2px solid #ccc;\n  text-align: center;\n  background-color: #f1f1f1;\n}\n.w-e-text:focus {\n  outline: none;\n}\n.w-e-text img {\n  cursor: pointer;\n}\n.w-e-text img:hover {\n  box-shadow: 0 0 5px #333;\n}\n.w-e-text .w-e-todo {\n  margin: 0 0 0 20px;\n}\n.w-e-text .w-e-todo li {\n  list-style: none;\n  font-size: 1em;\n}\n.w-e-text .w-e-todo li span:nth-child(1) {\n  position: relative;\n  left: -18px;\n}\n.w-e-text .w-e-todo li span:nth-child(1) input {\n  position: absolute;\n  margin-right: 3px;\n}\n.w-e-text .w-e-todo li span:nth-child(1) input[type=checkbox] {\n  top: 50%;\n  margin-top: -6px;\n}\n.w-e-tooltip {\n  position: absolute;\n  display: flex;\n  color: #f1f1f1;\n  background-color: rgba(0, 0, 0, 0.75);\n  box-shadow: 0 2px 8px 0 rgba(0, 0, 0, 0.15);\n  border-radius: 4px;\n  padding: 4px 5px 6px;\n  justify-content: center;\n  align-items: center;\n}\n.w-e-tooltip-up::after {\n  content: "";\n  position: absolute;\n  top: 100%;\n  left: 50%;\n  margin-left: -5px;\n  border: 5px solid rgba(0, 0, 0, 0);\n  border-top-color: rgba(0, 0, 0, 0.73);\n}\n.w-e-tooltip-down::after {\n  content: "";\n  position: absolute;\n  bottom: 100%;\n  left: 50%;\n  margin-left: -5px;\n  border: 5px solid rgba(0, 0, 0, 0);\n  border-bottom-color: rgba(0, 0, 0, 0.73);\n}\n.w-e-tooltip-item-wrapper {\n  cursor: pointer;\n  font-size: 14px;\n  margin: 0 5px;\n}\n.w-e-tooltip-item-wrapper:hover {\n  color: #ccc;\n  text-decoration: underline;\n}\n',""]),e.exports=t},function(e,t,n){var r=n(20),i=n(157);i=i.__esModule?i.default:i,"string"===typeof i&&(i=[[e.i,i,""]]);var o={insert:"head",singleton:!1};r(i,o);e.exports=i.locals||{}},function(e,t,n){var r=n(21);t=r(!1),t.push([e.i,'.w-e-menu .w-e-panel-container {\n  position: absolute;\n  top: 0;\n  left: 50%;\n  border: 1px solid #ccc;\n  border-top: 0;\n  box-shadow: 1px 1px 2px #ccc;\n  color: #333;\n  background-color: #fff;\n  text-align: left;\n  /* 为 emotion panel 定制的样式 */\n  /* 上传图片、上传视频的 panel 定制样式 */\n}\n.w-e-menu .w-e-panel-container .w-e-panel-close {\n  position: absolute;\n  right: 0;\n  top: 0;\n  padding: 5px;\n  margin: 2px 5px 0 0;\n  cursor: pointer;\n  color: #999;\n}\n.w-e-menu .w-e-panel-container .w-e-panel-close:hover {\n  color: #333;\n}\n.w-e-menu .w-e-panel-container .w-e-panel-tab-title {\n  list-style: none;\n  display: flex;\n  font-size: 14px;\n  margin: 2px 10px 0 10px;\n  border-bottom: 1px solid #f1f1f1;\n}\n.w-e-menu .w-e-panel-container .w-e-panel-tab-title .w-e-item {\n  padding: 3px 5px;\n  color: #999;\n  cursor: pointer;\n  margin: 0 3px;\n  position: relative;\n  top: 1px;\n}\n.w-e-menu .w-e-panel-container .w-e-panel-tab-title .w-e-active {\n  color: #333;\n  border-bottom: 1px solid #333;\n  cursor: default;\n  font-weight: 700;\n}\n.w-e-menu .w-e-panel-container .w-e-panel-tab-content {\n  padding: 10px 15px 10px 15px;\n  font-size: 16px;\n  /* 输入框的样式 */\n  /* 按钮的样式 */\n}\n.w-e-menu .w-e-panel-container .w-e-panel-tab-content input:focus,\n.w-e-menu .w-e-panel-container .w-e-panel-tab-content textarea:focus,\n.w-e-menu .w-e-panel-container .w-e-panel-tab-content button:focus {\n  outline: none;\n}\n.w-e-menu .w-e-panel-container .w-e-panel-tab-content textarea {\n  width: 100%;\n  border: 1px solid #ccc;\n  padding: 5px;\n  margin-top: 10px;\n}\n.w-e-menu .w-e-panel-container .w-e-panel-tab-content textarea:focus {\n  border-color: #1e88e5;\n}\n.w-e-menu .w-e-panel-container .w-e-panel-tab-content input[type=text] {\n  border: none;\n  border-bottom: 1px solid #ccc;\n  font-size: 14px;\n  height: 20px;\n  color: #333;\n  text-align: left;\n}\n.w-e-menu .w-e-panel-container .w-e-panel-tab-content input[type=text].small {\n  width: 30px;\n  text-align: center;\n}\n.w-e-menu .w-e-panel-container .w-e-panel-tab-content input[type=text].block {\n  display: block;\n  width: 100%;\n  margin: 10px 0;\n}\n.w-e-menu .w-e-panel-container .w-e-panel-tab-content input[type=text]:focus {\n  border-bottom: 2px solid #1e88e5;\n}\n.w-e-menu .w-e-panel-container .w-e-panel-tab-content .w-e-button-container button {\n  font-size: 14px;\n  color: #1e88e5;\n  border: none;\n  padding: 5px 10px;\n  background-color: #fff;\n  cursor: pointer;\n  border-radius: 3px;\n}\n.w-e-menu .w-e-panel-container .w-e-panel-tab-content .w-e-button-container button.left {\n  float: left;\n  margin-right: 10px;\n}\n.w-e-menu .w-e-panel-container .w-e-panel-tab-content .w-e-button-container button.right {\n  float: right;\n  margin-left: 10px;\n}\n.w-e-menu .w-e-panel-container .w-e-panel-tab-content .w-e-button-container button.gray {\n  color: #999;\n}\n.w-e-menu .w-e-panel-container .w-e-panel-tab-content .w-e-button-container button.red {\n  color: #c24f4a;\n}\n.w-e-menu .w-e-panel-container .w-e-panel-tab-content .w-e-button-container button:hover {\n  background-color: #f1f1f1;\n}\n.w-e-menu .w-e-panel-container .w-e-panel-tab-content .w-e-button-container:after {\n  content: "";\n  display: table;\n  clear: both;\n}\n.w-e-menu .w-e-panel-container .w-e-emoticon-container .w-e-item {\n  cursor: pointer;\n  font-size: 18px;\n  padding: 0 3px;\n  display: inline-block;\n}\n.w-e-menu .w-e-panel-container .w-e-up-img-container,\n.w-e-menu .w-e-panel-container .w-e-up-video-container {\n  text-align: center;\n}\n.w-e-menu .w-e-panel-container .w-e-up-img-container .w-e-up-btn,\n.w-e-menu .w-e-panel-container .w-e-up-video-container .w-e-up-btn {\n  display: inline-block;\n  color: #999;\n  cursor: pointer;\n  font-size: 60px;\n  line-height: 1;\n}\n.w-e-menu .w-e-panel-container .w-e-up-img-container .w-e-up-btn:hover,\n.w-e-menu .w-e-panel-container .w-e-up-video-container .w-e-up-btn:hover {\n  color: #333;\n}\n',""]),e.exports=t},function(e,t,n){var r=n(20),i=n(159);i=i.__esModule?i.default:i,"string"===typeof i&&(i=[[e.i,i,""]]);var o={insert:"head",singleton:!1};r(i,o);e.exports=i.locals||{}},function(e,t,n){var r=n(21);t=r(!1),t.push([e.i,".w-e-toolbar .w-e-droplist {\n  position: absolute;\n  left: 0;\n  top: 0;\n  background-color: #fff;\n  border: 1px solid #f1f1f1;\n  border-right-color: #ccc;\n  border-bottom-color: #ccc;\n}\n.w-e-toolbar .w-e-droplist .w-e-dp-title {\n  text-align: center;\n  color: #999;\n  line-height: 2;\n  border-bottom: 1px solid #f1f1f1;\n  font-size: 13px;\n}\n.w-e-toolbar .w-e-droplist ul.w-e-list {\n  list-style: none;\n  line-height: 1;\n}\n.w-e-toolbar .w-e-droplist ul.w-e-list li.w-e-item {\n  color: #333;\n  padding: 5px 0;\n}\n.w-e-toolbar .w-e-droplist ul.w-e-list li.w-e-item:hover {\n  background-color: #f1f1f1;\n}\n.w-e-toolbar .w-e-droplist ul.w-e-block {\n  list-style: none;\n  text-align: left;\n  padding: 5px;\n}\n.w-e-toolbar .w-e-droplist ul.w-e-block li.w-e-item {\n  display: inline-block;\n  padding: 3px 5px;\n}\n.w-e-toolbar .w-e-droplist ul.w-e-block li.w-e-item:hover {\n  background-color: #f1f1f1;\n}\n",""]),e.exports=t},function(e,t,n){"use strict";var r=n(0),i=r(n(161));Element.prototype.matches||(Element.prototype.matches=function(e){var t=this.ownerDocument.querySelectorAll(e),n=t.length;for(n;n>=0;n--)if(t.item(n)===this)break;return n>-1}),i["default"]||(window.Promise=i["default"])},function(e,t,n){e.exports=n(162)},function(e,t,n){var r=n(163);e.exports=r},function(e,t,n){n(61),n(50),n(54),n(175),n(178),n(179);var r=n(9);e.exports=r.Promise},function(e,t,n){var r=n(62),i=n(49),o=function(e){return function(t,n){var o,a,s=String(i(t)),l=r(n),u=s.length;return l<0||l>=u?e?"":void 0:(o=s.charCodeAt(l),o<55296||o>56319||l+1===u||(a=s.charCodeAt(l+1))<56320||a>57343?e?s.charAt(l):o:e?s.slice(l,l+2):a-56320+(o-55296<<10)+65536)}};e.exports={codeAt:o(!1),charAt:o(!0)}},function(e,t,n){var r=n(8),i=n(102),o=r.WeakMap;e.exports="function"===typeof o&&/native code/.test(i(o))},function(e,t,n){var r=n(8),i=n(19);e.exports=function(e,t){try{i(r,e,t)}catch(n){r[e]=t}return t}},function(e,t,n){"use strict";var r=n(104).IteratorPrototype,i=n(77),o=n(48),a=n(37),s=n(44),l=function(){return this};e.exports=function(e,t,n){var u=t+" Iterator";return e.prototype=i(r,{next:o(1,n)}),a(e,u,!1,!0),s[u]=l,e}},function(e,t,n){var r=n(11);e.exports=!r((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}))},function(e,t,n){var r=n(14),i=n(18),o=n(25),a=n(52);e.exports=r?Object.defineProperties:function(e,t){o(e);var n,r=a(t),s=r.length,l=0;while(s>l)i.f(e,n=r[l++],t[n]);return e}},function(e,t,n){"use strict";var r=n(81),i=n(65);e.exports=r?{}.toString:function(){return"[object "+i(this)+"]"}},function(e,t,n){var r=n(25),i=n(172);e.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,n={};try{e=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set,e.call(n,[]),t=n instanceof Array}catch(o){}return function(n,o){return r(n),i(o),t?e.call(n,o):n.__proto__=o,n}}():void 0)},function(e,t,n){var r=n(13);e.exports=function(e){if(!r(e)&&null!==e)throw TypeError("Can't set "+String(e)+" as a prototype");return e}},function(e,t,n){"use strict";var r=n(30),i=n(82),o=n(44),a=n(42),s=n(75),l="Array Iterator",u=a.set,c=a.getterFor(l);e.exports=s(Array,"Array",(function(e,t){u(this,{type:l,target:r(e),index:0,kind:t})}),(function(){var e=c(this),t=e.target,n=e.kind,r=e.index++;return!t||r>=t.length?(e.target=void 0,{value:void 0,done:!0}):"keys"==n?{value:r,done:!1}:"values"==n?{value:t[r],done:!1}:{value:[r,t[r]],done:!1}}),"values"),o.Arguments=o.Array,i("keys"),i("values"),i("entries")},function(e,t){e.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},function(e,t,n){"use strict";var r,i,o,a,s=n(5),l=n(43),u=n(8),c=n(36),d=n(109),f=n(53),h=n(110),p=n(37),m=n(111),v=n(13),g=n(41),y=n(83),_=n(34),x=n(102),b=n(66),w=n(115),A=n(116),T=n(117).set,S=n(176),E=n(119),C=n(177),M=n(85),L=n(120),N=n(42),D=n(101),O=n(10),I=n(86),R=O("species"),P="Promise",k=N.get,B=N.set,F=N.getterFor(P),z=d,H=u.TypeError,U=u.document,G=u.process,V=c("fetch"),j=M.f,W=j,X="process"==_(G),Y=!!(U&&U.createEvent&&u.dispatchEvent),q="unhandledrejection",Q="rejectionhandled",$=0,K=1,Z=2,J=1,ee=2,te=D(P,(function(){var e=x(z)!==String(z);if(!e){if(66===I)return!0;if(!X&&"function"!=typeof PromiseRejectionEvent)return!0}if(l&&!z.prototype["finally"])return!0;if(I>=51&&/native code/.test(z))return!1;var t=z.resolve(1),n=function(e){e((function(){}),(function(){}))},r=t.constructor={};return r[R]=n,!(t.then((function(){}))instanceof n)})),ne=te||!w((function(e){z.all(e)["catch"]((function(){}))})),re=function(e){var t;return!(!v(e)||"function"!=typeof(t=e.then))&&t},ie=function(e,t,n){if(!t.notified){t.notified=!0;var r=t.reactions;S((function(){var i=t.value,o=t.state==K,a=0;while(r.length>a){var s,l,u,c=r[a++],d=o?c.ok:c.fail,f=c.resolve,h=c.reject,p=c.domain;try{d?(o||(t.rejection===ee&&le(e,t),t.rejection=J),!0===d?s=i:(p&&p.enter(),s=d(i),p&&(p.exit(),u=!0)),s===c.promise?h(H("Promise-chain cycle")):(l=re(s))?l.call(s,f,h):f(s)):h(i)}catch(m){p&&!u&&p.exit(),h(m)}}t.reactions=[],t.notified=!1,n&&!t.rejection&&ae(e,t)}))}},oe=function(e,t,n){var r,i;Y?(r=U.createEvent("Event"),r.promise=t,r.reason=n,r.initEvent(e,!1,!0),u.dispatchEvent(r)):r={promise:t,reason:n},(i=u["on"+e])?i(r):e===q&&C("Unhandled promise rejection",n)},ae=function(e,t){T.call(u,(function(){var n,r=t.value,i=se(t);if(i&&(n=L((function(){X?G.emit("unhandledRejection",r,e):oe(q,e,r)})),t.rejection=X||se(t)?ee:J,n.error))throw n.value}))},se=function(e){return e.rejection!==J&&!e.parent},le=function(e,t){T.call(u,(function(){X?G.emit("rejectionHandled",e):oe(Q,e,t.value)}))},ue=function(e,t,n,r){return function(i){e(t,n,i,r)}},ce=function(e,t,n,r){t.done||(t.done=!0,r&&(t=r),t.value=n,t.state=Z,ie(e,t,!0))},de=function(e,t,n,r){if(!t.done){t.done=!0,r&&(t=r);try{if(e===n)throw H("Promise can't be resolved itself");var i=re(n);i?S((function(){var r={done:!1};try{i.call(n,ue(de,e,r,t),ue(ce,e,r,t))}catch(o){ce(e,r,o,t)}})):(t.value=n,t.state=K,ie(e,t,!1))}catch(o){ce(e,{done:!1},o,t)}}};te&&(z=function(e){y(this,z,P),g(e),r.call(this);var t=k(this);try{e(ue(de,this,t),ue(ce,this,t))}catch(n){ce(this,t,n)}},r=function(e){B(this,{type:P,done:!1,notified:!1,parent:!1,reactions:[],rejection:!1,state:$,value:void 0})},r.prototype=h(z.prototype,{then:function(e,t){var n=F(this),r=j(A(this,z));return r.ok="function"!=typeof e||e,r.fail="function"==typeof t&&t,r.domain=X?G.domain:void 0,n.parent=!0,n.reactions.push(r),n.state!=$&&ie(this,n,!1),r.promise},catch:function(e){return this.then(void 0,e)}}),i=function(){var e=new r,t=k(e);this.promise=e,this.resolve=ue(de,e,t),this.reject=ue(ce,e,t)},M.f=j=function(e){return e===z||e===o?new i(e):W(e)},l||"function"!=typeof d||(a=d.prototype.then,f(d.prototype,"then",(function(e,t){var n=this;return new z((function(e,t){a.call(n,e,t)})).then(e,t)}),{unsafe:!0}),"function"==typeof V&&s({global:!0,enumerable:!0,forced:!0},{fetch:function(e){return E(z,V.apply(u,arguments))}}))),s({global:!0,wrap:!0,forced:te},{Promise:z}),p(z,P,!1,!0),m(P),o=c(P),s({target:P,stat:!0,forced:te},{reject:function(e){var t=j(this);return t.reject.call(void 0,e),t.promise}}),s({target:P,stat:!0,forced:l||te},{resolve:function(e){return E(l&&this===o?z:this,e)}}),s({target:P,stat:!0,forced:ne},{all:function(e){var t=this,n=j(t),r=n.resolve,i=n.reject,o=L((function(){var n=g(t.resolve),o=[],a=0,s=1;b(e,(function(e){var l=a++,u=!1;o.push(void 0),s++,n.call(t,e).then((function(e){u||(u=!0,o[l]=e,--s||r(o))}),i)})),--s||r(o)}));return o.error&&i(o.value),n.promise},race:function(e){var t=this,n=j(t),r=n.reject,i=L((function(){var i=g(t.resolve);b(e,(function(e){i.call(t,e).then(n.resolve,r)}))}));return i.error&&r(i.value),n.promise}})},function(e,t,n){var r,i,o,a,s,l,u,c,d=n(8),f=n(71).f,h=n(34),p=n(117).set,m=n(118),v=d.MutationObserver||d.WebKitMutationObserver,g=d.process,y=d.Promise,_="process"==h(g),x=f(d,"queueMicrotask"),b=x&&x.value;b||(r=function(){var e,t;_&&(e=g.domain)&&e.exit();while(i){t=i.fn,i=i.next;try{t()}catch(n){throw i?a():o=void 0,n}}o=void 0,e&&e.enter()},_?a=function(){g.nextTick(r)}:v&&!m?(s=!0,l=document.createTextNode(""),new v(r).observe(l,{characterData:!0}),a=function(){l.data=s=!s}):y&&y.resolve?(u=y.resolve(void 0),c=u.then,a=function(){c.call(u,r)}):a=function(){p.call(d,r)}),e.exports=b||function(e){var t={fn:e,next:void 0};o&&(o.next=t),i||(i=t,a()),o=t}},function(e,t,n){var r=n(8);e.exports=function(e,t){var n=r.console;n&&n.error&&(1===arguments.length?n.error(e):n.error(e,t))}},function(e,t,n){"use strict";var r=n(5),i=n(41),o=n(85),a=n(120),s=n(66);r({target:"Promise",stat:!0},{allSettled:function(e){var t=this,n=o.f(t),r=n.resolve,l=n.reject,u=a((function(){var n=i(t.resolve),o=[],a=0,l=1;s(e,(function(e){var i=a++,s=!1;o.push(void 0),l++,n.call(t,e).then((function(e){s||(s=!0,o[i]={status:"fulfilled",value:e},--l||r(o))}),(function(e){s||(s=!0,o[i]={status:"rejected",reason:e},--l||r(o))}))})),--l||r(o)}));return u.error&&l(u.value),n.promise}})},function(e,t,n){"use strict";var r=n(5),i=n(43),o=n(109),a=n(11),s=n(36),l=n(116),u=n(119),c=n(53),d=!!o&&a((function(){o.prototype["finally"].call({then:function(){}},(function(){}))}));r({target:"Promise",proto:!0,real:!0,forced:d},{finally:function(e){var t=l(this,s("Promise")),n="function"==typeof e;return this.then(n?function(n){return u(t,e()).then((function(){return n}))}:e,n?function(n){return u(t,e()).then((function(){throw n}))}:e)}}),i||"function"!=typeof o||o.prototype["finally"]||c(o.prototype,"finally",s("Promise").prototype["finally"])},function(e,t,n){n(54);var r=n(181),i=n(65),o=Array.prototype,a={DOMTokenList:!0,NodeList:!0};e.exports=function(e){var t=e.forEach;return e===o||e instanceof Array&&t===o.forEach||a.hasOwnProperty(i(e))?r:t}},function(e,t,n){var r=n(182);e.exports=r},function(e,t,n){n(183);var r=n(15);e.exports=r("Array").forEach},function(e,t,n){"use strict";var r=n(5),i=n(184);r({target:"Array",proto:!0,forced:[].forEach!=i},{forEach:i})},function(e,t,n){"use strict";var r=n(32).forEach,i=n(67),o=n(22),a=i("forEach"),s=o("forEach");e.exports=a&&s?[].forEach:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}},function(e,t,n){var r=n(186);e.exports=r},function(e,t,n){n(187);var r=n(9);e.exports=r.Array.isArray},function(e,t,n){var r=n(5),i=n(55);r({target:"Array",stat:!0},{isArray:i})},function(e,t,n){var r=n(189);e.exports=r},function(e,t,n){var r=n(190),i=Array.prototype;e.exports=function(e){var t=e.map;return e===i||e instanceof Array&&t===i.map?r:t}},function(e,t,n){n(191);var r=n(15);e.exports=r("Array").map},function(e,t,n){"use strict";var r=n(5),i=n(32).map,o=n(56),a=n(22),s=o("map"),l=a("map");r({target:"Array",proto:!0,forced:!s||!l},{map:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}})},function(e,t,n){var r=n(193);e.exports=r},function(e,t,n){var r=n(194),i=String.prototype;e.exports=function(e){var t=e.trim;return"string"===typeof e||e===i||e instanceof String&&t===i.trim?r:t}},function(e,t,n){n(195);var r=n(15);e.exports=r("String").trim},function(e,t,n){"use strict";var r=n(5),i=n(90).trim,o=n(196);r({target:"String",proto:!0,forced:o("trim")},{trim:function(){return i(this)}})},function(e,t,n){var r=n(11),i=n(68),o="​᠎";e.exports=function(e){return r((function(){return!!i[e]()||o[e]()!=o||i[e].name!==e}))}},function(e,t,n){var r=n(198);e.exports=r},function(e,t,n){n(199),n(61),n(50),n(54);var r=n(9);e.exports=r.Map},function(e,t,n){"use strict";var r=n(122),i=n(124);e.exports=r("Map",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),i)},function(e,t,n){var r=n(11);e.exports=!r((function(){return Object.isExtensible(Object.preventExtensions({}))}))},function(e,t,n){var r=n(202);e.exports=r},function(e,t,n){var r=n(203),i=Array.prototype;e.exports=function(e){var t=e.indexOf;return e===i||e instanceof Array&&t===i.indexOf?r:t}},function(e,t,n){n(204);var r=n(15);e.exports=r("Array").indexOf},function(e,t,n){"use strict";var r=n(5),i=n(78).indexOf,o=n(67),a=n(22),s=[].indexOf,l=!!s&&1/[1].indexOf(1,-0)<0,u=o("indexOf"),c=a("indexOf",{ACCESSORS:!0,1:0});r({target:"Array",proto:!0,forced:l||!u||!c},{indexOf:function(e){return l?s.apply(this,arguments)||0:i(this,e,arguments.length>1?arguments[1]:void 0)}})},function(e,t,n){var r=n(206);e.exports=r},function(e,t,n){var r=n(207),i=Array.prototype;e.exports=function(e){var t=e.splice;return e===i||e instanceof Array&&t===i.splice?r:t}},function(e,t,n){n(208);var r=n(15);e.exports=r("Array").splice},function(e,t,n){"use strict";var r=n(5),i=n(79),o=n(62),a=n(35),s=n(31),l=n(88),u=n(69),c=n(56),d=n(22),f=c("splice"),h=d("splice",{ACCESSORS:!0,0:0,1:2}),p=Math.max,m=Math.min,v=9007199254740991,g="Maximum allowed length exceeded";r({target:"Array",proto:!0,forced:!f||!h},{splice:function(e,t){var n,r,c,d,f,h,y=s(this),_=a(y.length),x=i(e,_),b=arguments.length;if(0===b?n=r=0:1===b?(n=0,r=_-x):(n=b-2,r=m(p(o(t),0),_-x)),_+n-r>v)throw TypeError(g);for(c=l(y,r),d=0;d<r;d++)f=x+d,f in y&&u(c,d,y[f]);if(c.length=r,n<r){for(d=x;d<_-r;d++)f=d+r,h=d+n,f in y?y[h]=y[f]:delete y[h];for(d=_;d>_-r+n;d--)delete y[d-1]}else if(n>r)for(d=_-r;d>x;d--)f=d+r-1,h=d+n-1,f in y?y[h]=y[f]:delete y[h];for(d=0;d<n;d++)y[d+x]=arguments[d+2];return y.length=_-r+n,c}})},function(e,t,n){var r=n(210);e.exports=r},function(e,t,n){var r=n(211),i=Array.prototype;e.exports=function(e){var t=e.filter;return e===i||e instanceof Array&&t===i.filter?r:t}},function(e,t,n){n(212);var r=n(15);e.exports=r("Array").filter},function(e,t,n){"use strict";var r=n(5),i=n(32).filter,o=n(56),a=n(22),s=o("filter"),l=a("filter");r({target:"Array",proto:!0,forced:!s||!l},{filter:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}})},function(e,t,n){var r=n(214);e.exports=r},function(e,t,n){var r=n(215),i=n(217),o=Array.prototype,a=String.prototype;e.exports=function(e){var t=e.includes;return e===o||e instanceof Array&&t===o.includes?r:"string"===typeof e||e===a||e instanceof String&&t===a.includes?i:t}},function(e,t,n){n(216);var r=n(15);e.exports=r("Array").includes},function(e,t,n){"use strict";var r=n(5),i=n(78).includes,o=n(82),a=n(22),s=a("indexOf",{ACCESSORS:!0,1:0});r({target:"Array",proto:!0,forced:!s},{includes:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),o("includes")},function(e,t,n){n(218);var r=n(15);e.exports=r("String").includes},function(e,t,n){"use strict";var r=n(5),i=n(219),o=n(49),a=n(221);r({target:"String",proto:!0,forced:!a("includes")},{includes:function(e){return!!~String(o(this)).indexOf(i(e),arguments.length>1?arguments[1]:void 0)}})},function(e,t,n){var r=n(220);e.exports=function(e){if(r(e))throw TypeError("The method doesn't accept regular expressions");return e}},function(e,t,n){var r=n(13),i=n(34),o=n(10),a=o("match");e.exports=function(e){var t;return r(e)&&(void 0!==(t=e[a])?!!t:"RegExp"==i(e))}},function(e,t,n){var r=n(10),i=r("match");e.exports=function(e){var t=/./;try{"/./"[e](t)}catch(n){try{return t[i]=!1,"/./"[e](t)}catch(r){}}return!1}},function(e,t,n){var r=n(223);e.exports=r},function(e,t,n){var r=n(224),i=Function.prototype;e.exports=function(e){var t=e.bind;return e===i||e instanceof Function&&t===i.bind?r:t}},function(e,t,n){n(225);var r=n(15);e.exports=r("Function").bind},function(e,t,n){var r=n(5),i=n(226);r({target:"Function",proto:!0},{bind:i})},function(e,t,n){"use strict";var r=n(41),i=n(13),o=[].slice,a={},s=function(e,t,n){if(!(t in a)){for(var r=[],i=0;i<t;i++)r[i]="a["+i+"]";a[t]=Function("C,a","return new C("+r.join(",")+")")}return a[t](e,n)};e.exports=Function.bind||function(e){var t=r(this),n=o.call(arguments,1),a=function(){var r=n.concat(o.call(arguments));return this instanceof a?s(t,r.length,r):t.apply(e,r)};return i(t.prototype)&&(a.prototype=t.prototype),a}},function(e,t,n){e.exports=n(228)},function(e,t,n){var r=n(229);e.exports=r},function(e,t,n){n(125),n(50),n(54);var r=n(93);e.exports=r.f("iterator")},function(e,t,n){e.exports=n(231)},function(e,t,n){var r=n(232);n(251),n(252),n(253),n(254),n(255),e.exports=r},function(e,t,n){n(233),n(61),n(234),n(236),n(237),n(238),n(239),n(125),n(240),n(241),n(242),n(243),n(244),n(245),n(246),n(247),n(248),n(249),n(250);var r=n(9);e.exports=r.Symbol},function(e,t,n){"use strict";var r=n(5),i=n(11),o=n(55),a=n(13),s=n(31),l=n(35),u=n(69),c=n(88),d=n(56),f=n(10),h=n(86),p=f("isConcatSpreadable"),m=9007199254740991,v="Maximum allowed index exceeded",g=h>=51||!i((function(){var e=[];return e[p]=!1,e.concat()[0]!==e})),y=d("concat"),_=function(e){if(!a(e))return!1;var t=e[p];return void 0!==t?!!t:o(e)},x=!g||!y;r({target:"Array",proto:!0,forced:x},{concat:function(e){var t,n,r,i,o,a=s(this),d=c(a,0),f=0;for(t=-1,r=arguments.length;t<r;t++)if(o=-1===t?a:arguments[t],_(o)){if(i=l(o.length),f+i>m)throw TypeError(v);for(n=0;n<i;n++,f++)n in o&&u(d,f,o[n])}else{if(f>=m)throw TypeError(v);u(d,f++,o)}return d.length=f,d}})},function(e,t,n){"use strict";var r=n(5),i=n(8),o=n(36),a=n(43),s=n(14),l=n(76),u=n(106),c=n(11),d=n(16),f=n(55),h=n(13),p=n(25),m=n(31),v=n(30),g=n(60),y=n(48),_=n(77),x=n(52),b=n(126),w=n(235),A=n(127),T=n(71),S=n(18),E=n(59),C=n(19),M=n(53),L=n(74),N=n(63),D=n(51),O=n(64),I=n(10),R=n(93),P=n(12),k=n(37),B=n(42),F=n(32).forEach,z=N("hidden"),H="Symbol",U="prototype",G=I("toPrimitive"),V=B.set,j=B.getterFor(H),W=Object[U],X=i.Symbol,Y=o("JSON","stringify"),q=T.f,Q=S.f,$=w.f,K=E.f,Z=L("symbols"),J=L("op-symbols"),ee=L("string-to-symbol-registry"),te=L("symbol-to-string-registry"),ne=L("wks"),re=i.QObject,ie=!re||!re[U]||!re[U].findChild,oe=s&&c((function(){return 7!=_(Q({},"a",{get:function(){return Q(this,"a",{value:7}).a}})).a}))?function(e,t,n){var r=q(W,t);r&&delete W[t],Q(e,t,n),r&&e!==W&&Q(W,t,r)}:Q,ae=function(e,t){var n=Z[e]=_(X[U]);return V(n,{type:H,tag:e,description:t}),s||(n.description=t),n},se=u?function(e){return"symbol"==typeof e}:function(e){return Object(e)instanceof X},le=function(e,t,n){e===W&&le(J,t,n),p(e);var r=g(t,!0);return p(n),d(Z,r)?(n.enumerable?(d(e,z)&&e[z][r]&&(e[z][r]=!1),n=_(n,{enumerable:y(0,!1)})):(d(e,z)||Q(e,z,y(1,{})),e[z][r]=!0),oe(e,r,n)):Q(e,r,n)},ue=function(e,t){p(e);var n=v(t),r=x(n).concat(pe(n));return F(r,(function(t){s&&!de.call(n,t)||le(e,t,n[t])})),e},ce=function(e,t){return void 0===t?_(e):ue(_(e),t)},de=function(e){var t=g(e,!0),n=K.call(this,t);return!(this===W&&d(Z,t)&&!d(J,t))&&(!(n||!d(this,t)||!d(Z,t)||d(this,z)&&this[z][t])||n)},fe=function(e,t){var n=v(e),r=g(t,!0);if(n!==W||!d(Z,r)||d(J,r)){var i=q(n,r);return!i||!d(Z,r)||d(n,z)&&n[z][r]||(i.enumerable=!0),i}},he=function(e){var t=$(v(e)),n=[];return F(t,(function(e){d(Z,e)||d(D,e)||n.push(e)})),n},pe=function(e){var t=e===W,n=$(t?J:v(e)),r=[];return F(n,(function(e){!d(Z,e)||t&&!d(W,e)||r.push(Z[e])})),r};if(l||(X=function(){if(this instanceof X)throw TypeError("Symbol is not a constructor");var e=arguments.length&&void 0!==arguments[0]?String(arguments[0]):void 0,t=O(e),n=function(e){this===W&&n.call(J,e),d(this,z)&&d(this[z],t)&&(this[z][t]=!1),oe(this,t,y(1,e))};return s&&ie&&oe(W,t,{configurable:!0,set:n}),ae(t,e)},M(X[U],"toString",(function(){return j(this).tag})),M(X,"withoutSetter",(function(e){return ae(O(e),e)})),E.f=de,S.f=le,T.f=fe,b.f=w.f=he,A.f=pe,R.f=function(e){return ae(I(e),e)},s&&(Q(X[U],"description",{configurable:!0,get:function(){return j(this).description}}),a||M(W,"propertyIsEnumerable",de,{unsafe:!0}))),r({global:!0,wrap:!0,forced:!l,sham:!l},{Symbol:X}),F(x(ne),(function(e){P(e)})),r({target:H,stat:!0,forced:!l},{for:function(e){var t=String(e);if(d(ee,t))return ee[t];var n=X(t);return ee[t]=n,te[n]=t,n},keyFor:function(e){if(!se(e))throw TypeError(e+" is not a symbol");if(d(te,e))return te[e]},useSetter:function(){ie=!0},useSimple:function(){ie=!1}}),r({target:"Object",stat:!0,forced:!l,sham:!s},{create:ce,defineProperty:le,defineProperties:ue,getOwnPropertyDescriptor:fe}),r({target:"Object",stat:!0,forced:!l},{getOwnPropertyNames:he,getOwnPropertySymbols:pe}),r({target:"Object",stat:!0,forced:c((function(){A.f(1)}))},{getOwnPropertySymbols:function(e){return A.f(m(e))}}),Y){var me=!l||c((function(){var e=X();return"[null]"!=Y([e])||"{}"!=Y({a:e})||"{}"!=Y(Object(e))}));r({target:"JSON",stat:!0,forced:me},{stringify:function(e,t,n){var r,i=[e],o=1;while(arguments.length>o)i.push(arguments[o++]);if(r=t,(h(t)||void 0!==e)&&!se(e))return f(t)||(t=function(e,t){if("function"==typeof r&&(t=r.call(this,e,t)),!se(t))return t}),i[1]=t,Y.apply(null,i)}})}X[U][G]||C(X[U],G,X[U].valueOf),k(X,H),D[z]=!0},function(e,t,n){var r=n(30),i=n(126).f,o={}.toString,a="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],s=function(e){try{return i(e)}catch(t){return a.slice()}};e.exports.f=function(e){return a&&"[object Window]"==o.call(e)?s(e):i(r(e))}},function(e,t,n){var r=n(12);r("asyncIterator")},function(e,t){},function(e,t,n){var r=n(12);r("hasInstance")},function(e,t,n){var r=n(12);r("isConcatSpreadable")},function(e,t,n){var r=n(12);r("match")},function(e,t,n){var r=n(12);r("matchAll")},function(e,t,n){var r=n(12);r("replace")},function(e,t,n){var r=n(12);r("search")},function(e,t,n){var r=n(12);r("species")},function(e,t,n){var r=n(12);r("split")},function(e,t,n){var r=n(12);r("toPrimitive")},function(e,t,n){var r=n(12);r("toStringTag")},function(e,t,n){var r=n(12);r("unscopables")},function(e,t,n){var r=n(37);r(Math,"Math",!0)},function(e,t,n){var r=n(8),i=n(37);i(r.JSON,"JSON",!0)},function(e,t,n){var r=n(12);r("asyncDispose")},function(e,t,n){var r=n(12);r("dispose")},function(e,t,n){var r=n(12);r("observable")},function(e,t,n){var r=n(12);r("patternMatch")},function(e,t,n){var r=n(12);r("replaceAll")},function(e,t,n){e.exports=n(257)},function(e,t,n){var r=n(258);e.exports=r},function(e,t,n){n(259);var r=n(9);e.exports=r.parseInt},function(e,t,n){var r=n(5),i=n(260);r({global:!0,forced:parseInt!=i},{parseInt:i})},function(e,t,n){var r=n(8),i=n(90).trim,o=n(68),a=r.parseInt,s=/^[+-]?0[Xx]/,l=8!==a(o+"08")||22!==a(o+"0x16");e.exports=l?function(e,t){var n=i(String(e));return a(n,t>>>0||(s.test(n)?16:10))}:a},function(e,t,n){var r=n(262);e.exports=r},function(e,t,n){var r=n(263),i=Array.prototype;e.exports=function(e){var t=e.slice;return e===i||e instanceof Array&&t===i.slice?r:t}},function(e,t,n){n(264);var r=n(15);e.exports=r("Array").slice},function(e,t,n){"use strict";var r=n(5),i=n(13),o=n(55),a=n(79),s=n(35),l=n(30),u=n(69),c=n(10),d=n(56),f=n(22),h=d("slice"),p=f("slice",{ACCESSORS:!0,0:0,1:2}),m=c("species"),v=[].slice,g=Math.max;r({target:"Array",proto:!0,forced:!h||!p},{slice:function(e,t){var n,r,c,d=l(this),f=s(d.length),h=a(e,f),p=a(void 0===t?f:t,f);if(o(d)&&(n=d.constructor,"function"!=typeof n||n!==Array&&!o(n.prototype)?i(n)&&(n=n[m],null===n&&(n=void 0)):n=void 0,n===Array||void 0===n))return v.call(d,h,p);for(r=new(void 0===n?Array:n)(g(p-h,0)),c=0;h<p;h++,c++)h in d&&u(r,c,d[h]);return r.length=c,r}})},function(e,t,n){n(266);var r=n(9);e.exports=r.setTimeout},function(e,t,n){var r=n(5),i=n(8),o=n(84),a=[].slice,s=/MSIE .\./.test(o),l=function(e){return function(t,n){var r=arguments.length>2,i=r?a.call(arguments,2):void 0;return e(r?function(){("function"==typeof t?t:Function(t)).apply(this,i)}:t,n)}};r({global:!0,bind:!0,forced:s},{setTimeout:l(i.setTimeout),setInterval:l(i.setInterval)})},function(e,t,n){"use strict";var r=n(0),i=r(n(1)),o=r(n(128));(0,i["default"])(t,"__esModule",{value:!0});var a=n(2),s=a.__importDefault(n(272)),l=a.__importDefault(n(273)),u=a.__importDefault(n(129)),c=a.__importDefault(n(274)),d=a.__importDefault(n(275)),f=a.__importDefault(n(276)),h=a.__importDefault(n(130)),p=a.__importDefault(n(277)),m=a.__importDefault(n(278)),v=a.__importDefault(n(279)),g=(0,o["default"])({},s["default"],l["default"],u["default"],d["default"],c["default"],f["default"],h["default"],p["default"],m["default"],v["default"],{linkCheck:function(e,t){return!0}});t["default"]=g},function(e,t,n){var r=n(269);e.exports=r},function(e,t,n){n(270);var r=n(9);e.exports=r.Object.assign},function(e,t,n){var r=n(5),i=n(271);r({target:"Object",stat:!0,forced:Object.assign!==i},{assign:i})},function(e,t,n){"use strict";var r=n(14),i=n(11),o=n(52),a=n(127),s=n(59),l=n(31),u=n(72),c=Object.assign,d=Object.defineProperty;e.exports=!c||i((function(){if(r&&1!==c({b:1},c(d({},"a",{enumerable:!0,get:function(){d(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var e={},t={},n=Symbol(),i="abcdefghijklmnopqrst";return e[n]=7,i.split("").forEach((function(e){t[e]=e})),7!=c({},e)[n]||o(c({},t)).join("")!=i}))?function(e,t){var n=l(e),i=arguments.length,c=1,d=a.f,f=s.f;while(i>c){var h,p=u(arguments[c++]),m=d?o(p).concat(d(p)):o(p),v=m.length,g=0;while(v>g)h=m[g++],r&&!f.call(p,h)||(n[h]=p[h])}return n}:c},function(e,t,n){"use strict";var r=n(0),i=r(n(1));(0,i["default"])(t,"__esModule",{value:!0}),t["default"]={menus:["head","bold","fontSize","fontName","italic","underline","strikeThrough","indent","lineHeight","foreColor","backColor","link","list","todo","justify","quote","emoticon","image","video","table","code","splitLine","undo","redo"],fontNames:["黑体","仿宋","楷体","标楷体","华文仿宋","华文楷体","宋体","微软雅黑","Arial","Tahoma","Verdana","Times New Roman","Courier New"],fontSizes:{"x-small":{name:"10px",value:"1"},small:{name:"13px",value:"2"},normal:{name:"16px",value:"3"},large:{name:"18px",value:"4"},"x-large":{name:"24px",value:"5"},"xx-large":{name:"32px",value:"6"},"xxx-large":{name:"48px",value:"7"}},colors:["#000000","#ffffff","#eeece0","#1c487f","#4d80bf","#c24f4a","#8baa4a","#7b5ba1","#46acc8","#f9963b"],languageType:["Bash","C","C#","C++","CSS","Java","JavaScript","JSON","TypeScript","Plain text","Html","XML","SQL","Go","Kotlin","Lua","Markdown","PHP","Python","Shell Session","Ruby"],languageTab:"　　　　",emotions:[{title:"表情",type:"emoji",content:"😀 😃 😄 😁 😆 😅 😂 🤣 😊 😇 🙂 🙃 😉 😌 😍 😘 😗 😙 😚 😋 😛 😝 😜 🤓 😎 😏 😒 😞 😔 😟 😕 🙁 😣 😖 😫 😩 😢 😭 😤 😠 😡 😳 😱 😨 🤗 🤔 😶 😑 😬 🙄 😯 😴 😷 🤑 😈 🤡 💩 👻 💀 👀 👣".split(/\s/)},{title:"手势",type:"emoji",content:"👐 🙌 👏 🤝 👍 👎 👊 ✊ 🤛 🤜 🤞 ✌️ 🤘 👌 👈 👉 👆 👇 ☝️ ✋ 🤚 🖐 🖖 👋 🤙 💪 🖕 ✍️ 🙏".split(/\s/)}],lineHeights:["1","1.15","1.6","2","2.5","3"],undoLimit:20,indentation:"2em",showMenuTooltips:!0,menuTooltipPosition:"up"}},function(e,t,n){"use strict";var r=n(0),i=r(n(1));(0,i["default"])(t,"__esModule",{value:!0});var o=n(7);function a(e,t,n){window.alert(e),n&&console.error("wangEditor: "+n)}t["default"]={onchangeTimeout:200,onchange:null,onfocus:o.EMPTY_FN,onblur:o.EMPTY_FN,onCatalogChange:null,customAlert:a}},function(e,t,n){"use strict";var r=n(0),i=r(n(1));(0,i["default"])(t,"__esModule",{value:!0}),t["default"]={pasteFilterStyle:!0,pasteIgnoreImg:!1,pasteTextHandle:function(e){return e}}},function(e,t,n){"use strict";var r=n(0),i=r(n(1));(0,i["default"])(t,"__esModule",{value:!0}),t["default"]={styleWithCSS:!1}},function(e,t,n){"use strict";var r=n(0),i=r(n(1));(0,i["default"])(t,"__esModule",{value:!0});var o=n(7);t["default"]={linkImgCheck:function(e,t,n){return!0},showLinkImg:!0,showLinkImgAlt:!0,showLinkImgHref:!0,linkImgCallback:o.EMPTY_FN,uploadImgAccept:["jpg","jpeg","png","gif","bmp"],uploadImgServer:"",uploadImgShowBase64:!1,uploadImgMaxSize:5242880,uploadImgMaxLength:100,uploadFileName:"",uploadImgParams:{},uploadImgParamsWithUrl:!1,uploadImgHeaders:{},uploadImgHooks:{},uploadImgTimeout:1e4,withCredentials:!1,customUploadImg:null,uploadImgFromMedia:null}},function(e,t,n){"use strict";var r=n(0),i=r(n(1));(0,i["default"])(t,"__esModule",{value:!0}),t["default"]={lang:"zh-CN",languages:{"zh-CN":{wangEditor:{"重置":"重置","插入":"插入","默认":"默认","创建":"创建","修改":"修改","如":"如","请输入正文":"请输入正文",menus:{title:{"标题":"标题","加粗":"加粗","字号":"字号","字体":"字体","斜体":"斜体","下划线":"下划线","删除线":"删除线","缩进":"缩进","行高":"行高","文字颜色":"文字颜色","背景色":"背景色","链接":"链接","序列":"序列","对齐":"对齐","引用":"引用","表情":"表情","图片":"图片","视频":"视频","表格":"表格","代码":"代码","分割线":"分割线","恢复":"恢复","撤销":"撤销","全屏":"全屏","取消全屏":"取消全屏","待办事项":"待办事项"},dropListMenu:{"设置标题":"设置标题","背景颜色":"背景颜色","文字颜色":"文字颜色","设置字号":"设置字号","设置字体":"设置字体","设置缩进":"设置缩进","对齐方式":"对齐方式","设置行高":"设置行高","序列":"序列",head:{"正文":"正文"},indent:{"增加缩进":"增加缩进","减少缩进":"减少缩进"},justify:{"靠左":"靠左","居中":"居中","靠右":"靠右","两端":"两端"},list:{"无序列表":"无序列表","有序列表":"有序列表"}},panelMenus:{emoticon:{"默认":"默认","新浪":"新浪",emoji:"emoji","手势":"手势"},image:{"上传图片":"上传图片","网络图片":"网络图片","图片地址":"图片地址","图片文字说明":"图片文字说明","跳转链接":"跳转链接"},link:{"链接":"链接","链接文字":"链接文字","取消链接":"取消链接","查看链接":"查看链接"},video:{"插入视频":"插入视频","上传视频":"上传视频"},table:{"行":"行","列":"列","的":"的","表格":"表格","添加行":"添加行","删除行":"删除行","添加列":"添加列","删除列":"删除列","设置表头":"设置表头","取消表头":"取消表头","插入表格":"插入表格","删除表格":"删除表格"},code:{"删除代码":"删除代码","修改代码":"修改代码","插入代码":"插入代码"}}},validate:{"张图片":"张图片","大于":"大于","图片链接":"图片链接","不是图片":"不是图片","返回结果":"返回结果","上传图片超时":"上传图片超时","上传图片错误":"上传图片错误","上传图片失败":"上传图片失败","插入图片错误":"插入图片错误","一次最多上传":"一次最多上传","下载链接失败":"下载链接失败","图片验证未通过":"图片验证未通过","服务器返回状态":"服务器返回状态","上传图片返回结果错误":"上传图片返回结果错误","请替换为支持的图片类型":"请替换为支持的图片类型","您插入的网络图片无法识别":"您插入的网络图片无法识别","您刚才插入的图片链接未通过编辑器校验":"您刚才插入的图片链接未通过编辑器校验","插入视频错误":"插入视频错误","视频链接":"视频链接","不是视频":"不是视频","视频验证未通过":"视频验证未通过","个视频":"个视频","上传视频超时":"上传视频超时","上传视频错误":"上传视频错误","上传视频失败":"上传视频失败","上传视频返回结果错误":"上传视频返回结果错误"}}},en:{wangEditor:{"重置":"reset","插入":"insert","默认":"default","创建":"create","修改":"edit","如":"like","请输入正文":"please enter the text",menus:{title:{"标题":"head","加粗":"bold","字号":"font size","字体":"font family","斜体":"italic","下划线":"underline","删除线":"strikethrough","缩进":"indent","行高":"line heihgt","文字颜色":"font color","背景色":"background","链接":"link","序列":"numbered list","对齐":"align","引用":"quote","表情":"emoticons","图片":"image","视频":"media","表格":"table","代码":"code","分割线":"split line","恢复":"redo","撤销":"undo","全屏":"fullscreen","取消全屏":"cancel fullscreen","待办事项":"todo"},dropListMenu:{"设置标题":"title","背景颜色":"background","文字颜色":"font color","设置字号":"font size","设置字体":"font family","设置缩进":"indent","对齐方式":"align","设置行高":"line heihgt","序列":"list",head:{"正文":"text"},indent:{"增加缩进":"indent","减少缩进":"outdent"},justify:{"靠左":"left","居中":"center","靠右":"right","两端":"justify"},list:{"无序列表":"unordered","有序列表":"ordered"}},panelMenus:{emoticon:{"表情":"emoji","手势":"gesture"},image:{"上传图片":"upload image","网络图片":"network image","图片地址":"image link","图片文字说明":"image alt","跳转链接":"hyperlink"},link:{"链接":"link","链接文字":"link text","取消链接":"unlink","查看链接":"view links"},video:{"插入视频":"insert video","上传视频":"upload local video"},table:{"行":"rows","列":"columns","的":" ","表格":"table","添加行":"insert row","删除行":"delete row","添加列":"insert column","删除列":"delete column","设置表头":"set header","取消表头":"cancel header","插入表格":"insert table","删除表格":"delete table"},code:{"删除代码":"delete code","修改代码":"edit code","插入代码":"insert code"}}},validate:{"张图片":"images","大于":"greater than","图片链接":"image link","不是图片":"is not image","返回结果":"return results","上传图片超时":"upload image timeout","上传图片错误":"upload image error","上传图片失败":"upload image failed","插入图片错误":"insert image error","一次最多上传":"once most at upload","下载链接失败":"download link failed","图片验证未通过":"image validate failed","服务器返回状态":"server return status","上传图片返回结果错误":"upload image return results error","请替换为支持的图片类型":"please replace with a supported image type","您插入的网络图片无法识别":"the network picture you inserted is not recognized","您刚才插入的图片链接未通过编辑器校验":"the image link you just inserted did not pass the editor verification","插入视频错误":"insert video error","视频链接":"video link","不是视频":"is not video","视频验证未通过":"video validate failed","个视频":"videos","上传视频超时":"upload video timeout","上传视频错误":"upload video error","上传视频失败":"upload video failed","上传视频返回结果错误":"upload video return results error"}}}}}},function(e,t,n){"use strict";var r=n(0),i=r(n(1));(0,i["default"])(t,"__esModule",{value:!0});var o=n(6);function a(){return!(!o.UA.isIE()&&!o.UA.isOldEdge)}t["default"]={compatibleMode:a,historyMaxSize:30}},function(e,t,n){"use strict";var r=n(0),i=r(n(1));(0,i["default"])(t,"__esModule",{value:!0});var o=n(7);t["default"]={onlineVideoCheck:function(e){return!0},onlineVideoCallback:o.EMPTY_FN,showLinkVideo:!0,uploadVideoAccept:["mp4"],uploadVideoServer:"",uploadVideoMaxSize:1073741824,uploadVideoName:"",uploadVideoParams:{},uploadVideoParamsWithUrl:!1,uploadVideoHeaders:{},uploadVideoHooks:{},uploadVideoTimeout:72e5,withVideoCredentials:!1,customUploadVideo:null,customInsertVideo:null}},function(e,t,n){"use strict";var r=n(0),i=r(n(1)),o=r(n(17));(0,i["default"])(t,"__esModule",{value:!0});var a=n(2),s=a.__importDefault(n(3)),l=n(6),u=n(7),c=function(){function e(e){this._currentRange=null,this.editor=e}return e.prototype.getRange=function(){return this._currentRange},e.prototype.saveRange=function(e){if(e)this._currentRange=e;else{var t=window.getSelection();if(0!==t.rangeCount){var n=t.getRangeAt(0),r=this.getSelectionContainerElem(n);if((null===r||void 0===r?void 0:r.length)&&"false"!==r.attr("contenteditable")&&!r.parentUntil("[contenteditable=false]")){var i=this.editor,a=i.$textElem;if(a.isContain(r)){var s;if(a.elems[0]===r.elems[0])if((0,o["default"])(s=a.html()).call(s)===u.EMPTY_P){var l=a.children(),c=null===l||void 0===l?void 0:l.last();i.selection.createRangeByElem(c,!0,!0),i.selection.restoreSelection()}this._currentRange=n}}}}},e.prototype.collapseRange=function(e){void 0===e&&(e=!1);var t=this._currentRange;t&&t.collapse(e)},e.prototype.getSelectionText=function(){var e=this._currentRange;return e?e.toString():""},e.prototype.getSelectionContainerElem=function(e){var t,n;if(t=e||this._currentRange,t)return n=t.commonAncestorContainer,s["default"](1===n.nodeType?n:n.parentNode)},e.prototype.getSelectionStartElem=function(e){var t,n;if(t=e||this._currentRange,t)return n=t.startContainer,s["default"](1===n.nodeType?n:n.parentNode)},e.prototype.getSelectionEndElem=function(e){var t,n;if(t=e||this._currentRange,t)return n=t.endContainer,s["default"](1===n.nodeType?n:n.parentNode)},e.prototype.isSelectionEmpty=function(){var e=this._currentRange;return!(!e||!e.startContainer||e.startContainer!==e.endContainer||e.startOffset!==e.endOffset)},e.prototype.restoreSelection=function(){var e=window.getSelection(),t=this._currentRange;e&&t&&(e.removeAllRanges(),e.addRange(t))},e.prototype.createEmptyRange=function(){var e,t=this.editor,n=this.getRange();if(n&&this.isSelectionEmpty())try{l.UA.isWebkit()?(t.cmd["do"]("insertHTML","&#8203;"),n.setEnd(n.endContainer,n.endOffset+1),this.saveRange(n)):(e=s["default"]("<strong>&#8203;</strong>"),t.cmd["do"]("insertElem",e),this.createRangeByElem(e,!0))}catch(r){}},e.prototype.createRangeByElems=function(e,t){var n=window.getSelection?window.getSelection():document.getSelection();null===n||void 0===n||n.removeAllRanges();var r=document.createRange();r.setStart(e,0),r.setEnd(t,t.childNodes.length||1),this.saveRange(r),this.restoreSelection()},e.prototype.createRangeByElem=function(e,t,n){if(e.length){var r=e.elems[0],i=document.createRange();n?i.selectNodeContents(r):i.selectNode(r),null!=t&&(i.collapse(t),t||(this.saveRange(i),this.editor.selection.moveCursor(r))),this.saveRange(i)}},e.prototype.getSelectionRangeTopNodes=function(){var e,t,n,r=null===(e=this.getSelectionStartElem())||void 0===e?void 0:e.getNodeTop(this.editor),i=null===(t=this.getSelectionEndElem())||void 0===t?void 0:t.getNodeTop(this.editor);return n=this.recordSelectionNodes(s["default"](r),s["default"](i)),n},e.prototype.moveCursor=function(e,t){var n,r=this.getRange(),i=3===e.nodeType?null===(n=e.nodeValue)||void 0===n?void 0:n.length:e.childNodes.length;(l.UA.isFirefox||l.UA.isIE())&&0!==i&&(3!==e.nodeType&&"BR"!==e.childNodes[i-1].nodeName||(i-=1));var o=null!==t&&void 0!==t?t:i;r&&e&&(r.setStart(e,o),r.setEnd(e,o),this.restoreSelection())},e.prototype.getCursorPos=function(){var e=window.getSelection();return null===e||void 0===e?void 0:e.anchorOffset},e.prototype.clearWindowSelectionRange=function(){var e=window.getSelection();e&&e.removeAllRanges()},e.prototype.recordSelectionNodes=function(e,t){var n=[],r=!0;try{var i=e,o=this.editor.$textElem;while(r){var a=null===i||void 0===i?void 0:i.getNodeTop(this.editor);"BODY"===a.getNodeName()&&(r=!1),a.length>0&&(n.push(s["default"](i)),(null===t||void 0===t?void 0:t.equal(a))||o.equal(a)?r=!1:i=a.getNextSibling())}}catch(l){r=!1}return n},e.prototype.setRangeToElem=function(e){var t=this.getRange();null===t||void 0===t||t.setStart(e,0),null===t||void 0===t||t.setEnd(e,0)},e}();t["default"]=c},function(e,t,n){"use strict";var r=n(0),i=r(n(1));(0,i["default"])(t,"__esModule",{value:!0});var o=n(2),a=o.__importDefault(n(3)),s=function(){function e(e){this.editor=e}return e.prototype["do"]=function(e,t){var n=this.editor;n.config.styleWithCSS&&document.execCommand("styleWithCSS",!1,"true");var r=n.selection;if(r.getRange()){switch(r.restoreSelection(),e){case"insertHTML":this.insertHTML(t);break;case"insertElem":this.insertElem(t);break;default:this.execCommand(e,t);break}n.menus.changeActive(),r.saveRange(),r.restoreSelection()}},e.prototype.insertHTML=function(e){var t=this.editor,n=t.selection.getRange();if(null!=n)if(this.queryCommandSupported("insertHTML"))this.execCommand("insertHTML",e);else if(n.insertNode){if(n.deleteContents(),a["default"](e).elems.length>0)n.insertNode(a["default"](e).elems[0]);else{var r=document.createElement("p");r.appendChild(document.createTextNode(e)),n.insertNode(r)}t.selection.collapseRange()}},e.prototype.insertElem=function(e){var t=this.editor,n=t.selection.getRange();null!=n&&n.insertNode&&(n.deleteContents(),n.insertNode(e.elems[0]))},e.prototype.execCommand=function(e,t){document.execCommand(e,!1,t)},e.prototype.queryCommandValue=function(e){return document.queryCommandValue(e)},e.prototype.queryCommandState=function(e){return document.queryCommandState(e)},e.prototype.queryCommandSupported=function(e){return document.queryCommandSupported(e)},e}();t["default"]=s},function(e,t,n){"use strict";var r=n(0),i=r(n(1)),o=r(n(29)),a=r(n(4)),s=r(n(17)),l=r(n(27)),u=r(n(46));(0,i["default"])(t,"__esModule",{value:!0});var c=n(2),d=c.__importDefault(n(3)),f=c.__importDefault(n(287)),h=n(6),p=c.__importDefault(n(299)),m=c.__importDefault(n(300)),v=n(7),g=function(){function e(e){this.editor=e,this.eventHooks={onBlurEvents:[],changeEvents:[],dropEvents:[],clickEvents:[],keydownEvents:[],keyupEvents:[],tabUpEvents:[],tabDownEvents:[],enterUpEvents:[],enterDownEvents:[],deleteUpEvents:[],deleteDownEvents:[],pasteEvents:[],linkClickEvents:[],codeClickEvents:[],textScrollEvents:[],toolbarClickEvents:[],imgClickEvents:[],imgDragBarMouseDownEvents:[],tableClickEvents:[],menuClickEvents:[],dropListMenuHoverEvents:[],splitLineEvents:[],videoClickEvents:[]}}return e.prototype.init=function(){this._saveRange(),this._bindEventHooks(),f["default"](this)},e.prototype.togglePlaceholder=function(){var e,t=this.html(),n=(0,o["default"])(e=this.editor.$textContainerElem).call(e,".placeholder");n.hide(),this.editor.isComposing||t&&" "!==t||n.show()},e.prototype.clear=function(){this.html(v.EMPTY_P)},e.prototype.html=function(e){var t=this.editor,n=t.$textElem;if(null==e){var r=n.html();r=r.replace(/\u200b/gm,""),r=r.replace(/<p><\/p>/gim,""),r=r.replace(v.EMPTY_P_LAST_REGEX,""),r=r.replace(v.EMPTY_P_REGEX,"<p>");var i=r.match(/<(img|br|hr|input)[^>]*>/gi);return null!==i&&(0,a["default"])(i).call(i,(function(e){e.match(/\/>/)||(r=r.replace(e,e.substring(0,e.length-1)+"/>"))})),r}e=(0,s["default"])(e).call(e),""===e&&(e=v.EMPTY_P),0!==(0,l["default"])(e).call(e,"<")&&(e="<p>"+e+"</p>"),n.html(e),t.initSelection()},e.prototype.setJSON=function(e){var t=m["default"](e).children(),n=this.editor,r=n.$textElem;t&&r.replaceChildAll(t)},e.prototype.getJSON=function(){var e=this.editor,t=e.$textElem;return p["default"](t)},e.prototype.text=function(e){var t=this.editor,n=t.$textElem;if(null==e){var r=n.text();return r=r.replace(/\u200b/gm,""),r}n.text("<p>"+e+"</p>"),t.initSelection()},e.prototype.append=function(e){var t=this.editor;0!==(0,l["default"])(e).call(e,"<")&&(e="<p>"+e+"</p>"),this.html(this.html()+e),t.initSelection()},e.prototype._saveRange=function(){var e=this.editor,t=e.$textElem,n=d["default"](document);function r(){e.selection.saveRange(),e.menus.changeActive()}function i(){r(),t.off("click",i)}function o(){r(),n.off("mouseup",o)}function a(){n.on("mouseup",o),t.off("mouseleave",a)}t.on("keyup",r),t.on("click",i),t.on("mousedown",(function(){t.on("mouseleave",a)})),t.on("mouseup",(function(n){t.off("mouseleave",a),(0,u["default"])((function(){var t=e.selection,n=t.getRange();null!==n&&r()}),0)}))},e.prototype._bindEventHooks=function(){var e=this.editor,t=e.$textElem,n=this.eventHooks;function r(e){e.preventDefault()}t.on("click",(function(e){var t=n.clickEvents;(0,a["default"])(t).call(t,(function(t){return t(e)}))})),t.on("keyup",(function(e){if(13===e.keyCode){var t=n.enterUpEvents;(0,a["default"])(t).call(t,(function(t){return t(e)}))}})),t.on("keyup",(function(e){var t=n.keyupEvents;(0,a["default"])(t).call(t,(function(t){return t(e)}))})),t.on("keydown",(function(e){var t=n.keydownEvents;(0,a["default"])(t).call(t,(function(t){return t(e)}))})),t.on("keyup",(function(e){if(8===e.keyCode||46===e.keyCode){var t=n.deleteUpEvents;(0,a["default"])(t).call(t,(function(t){return t(e)}))}})),t.on("keydown",(function(e){if(8===e.keyCode||46===e.keyCode){var t=n.deleteDownEvents;(0,a["default"])(t).call(t,(function(t){return t(e)}))}})),t.on("paste",(function(e){if(!h.UA.isIE()){e.preventDefault();var t=n.pasteEvents;(0,a["default"])(t).call(t,(function(t){return t(e)}))}})),t.on("keydown",(function(t){(e.isFocus||e.isCompatibleMode)&&(t.ctrlKey||t.metaKey)&&90===t.keyCode&&(t.preventDefault(),t.shiftKey?e.history.restore():e.history.revoke())})),t.on("keyup",(function(e){if(9===e.keyCode){e.preventDefault();var t=n.tabUpEvents;(0,a["default"])(t).call(t,(function(t){return t(e)}))}})),t.on("keydown",(function(e){if(9===e.keyCode){e.preventDefault();var t=n.tabDownEvents;(0,a["default"])(t).call(t,(function(t){return t(e)}))}})),t.on("scroll",h.throttle((function(e){var t=n.textScrollEvents;(0,a["default"])(t).call(t,(function(t){return t(e)}))}),100)),d["default"](document).on("dragleave",r).on("drop",r).on("dragenter",r).on("dragover",r),e.beforeDestroy((function(){d["default"](document).off("dragleave",r).off("drop",r).off("dragenter",r).off("dragover",r)})),t.on("drop",(function(e){e.preventDefault();var t=n.dropEvents;(0,a["default"])(t).call(t,(function(t){return t(e)}))})),t.on("click",(function(e){var t=null,r=e.target,i=d["default"](r);if("A"===i.getNodeName())t=i;else{var o=i.parentUntil("a");null!=o&&(t=o)}if(t){var s=n.linkClickEvents;(0,a["default"])(s).call(s,(function(e){return e(t)}))}})),t.on("click",(function(e){var t=null,r=e.target,i=d["default"](r);if("IMG"!==i.getNodeName()||i.elems[0].getAttribute("data-emoji")||(e.stopPropagation(),t=i),t){var o=n.imgClickEvents;(0,a["default"])(o).call(o,(function(e){return e(t)}))}})),t.on("click",(function(e){var t=null,r=e.target,i=d["default"](r);if("PRE"===i.getNodeName())t=i;else{var o=i.parentUntil("pre");null!==o&&(t=o)}if(t){var s=n.codeClickEvents;(0,a["default"])(s).call(s,(function(e){return e(t)}))}})),t.on("click",(function(t){var r=null,i=t.target,o=d["default"](i);if("HR"===o.getNodeName()&&(r=o),r){e.selection.createRangeByElem(r),e.selection.restoreSelection();var s=n.splitLineEvents;(0,a["default"])(s).call(s,(function(e){return e(r)}))}})),e.$toolbarElem.on("click",(function(e){var t=n.toolbarClickEvents;(0,a["default"])(t).call(t,(function(t){return t(e)}))})),e.$textContainerElem.on("mousedown",(function(e){var t=e.target,r=d["default"](t);if(r.hasClass("w-e-img-drag-rb")){var i=n.imgDragBarMouseDownEvents;(0,a["default"])(i).call(i,(function(e){return e()}))}})),t.on("click",(function(t){var r=null,i=t.target;if(r=d["default"](i).parentUntilEditor("TABLE",e,i),r){var o=n.tableClickEvents;(0,a["default"])(o).call(o,(function(e){return e(r,t)}))}})),t.on("keydown",(function(e){if(13===e.keyCode){var t=n.enterDownEvents;(0,a["default"])(t).call(t,(function(t){return t(e)}))}})),t.on("click",(function(e){var t=null,r=e.target,i=d["default"](r);if("VIDEO"===i.getNodeName()&&(e.stopPropagation(),t=i),t){var o=n.videoClickEvents;(0,a["default"])(o).call(o,(function(e){return e(t)}))}}))},e}();t["default"]=g},function(e,t,n){var r=n(284);e.exports=r},function(e,t,n){var r=n(285),i=Array.prototype;e.exports=function(e){var t=e.find;return e===i||e instanceof Array&&t===i.find?r:t}},function(e,t,n){n(286);var r=n(15);e.exports=r("Array").find},function(e,t,n){"use strict";var r=n(5),i=n(32).find,o=n(82),a=n(22),s="find",l=!0,u=a(s);s in[]&&Array(1)[s]((function(){l=!1})),r({target:"Array",proto:!0,forced:l||!u},{find:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),o(s)},function(e,t,n){"use strict";var r=n(0),i=r(n(1));(0,i["default"])(t,"__esModule",{value:!0});var o=n(2),a=o.__importDefault(n(288)),s=o.__importStar(n(289)),l=o.__importDefault(n(290)),u=o.__importDefault(n(291)),c=o.__importDefault(n(298));function d(e){var t=e.editor,n=e.eventHooks;a["default"](t,n.enterUpEvents,n.enterDownEvents),s["default"](t,n.deleteUpEvents,n.deleteDownEvents),s.cutToKeepP(t,n.keyupEvents),l["default"](t,n.tabDownEvents),u["default"](t,n.pasteEvents),c["default"](t,n.imgClickEvents)}t["default"]=d},function(e,t,n){"use strict";var r=n(0),i=r(n(1)),o=r(n(27));(0,i["default"])(t,"__esModule",{value:!0});var a=n(2),s=n(7),l=a.__importDefault(n(3));function u(e,t,n){function r(t){var n,r=l["default"](s.EMPTY_P);r.insertBefore(t),(0,o["default"])(n=t.html()).call(n,"<img")>=0?r.remove():(e.selection.createRangeByElem(r,!0,!0),e.selection.restoreSelection(),t.remove())}function i(){var t=e.$textElem,n=e.selection.getSelectionContainerElem(),i=n.parent();if("<code><br></code>"!==i.html())if("FONT"!==n.getNodeName()||""!==n.text()||"monospace"!==n.attr("face")){if(i.equal(t)){var o=n.getNodeName();"P"===o&&null===n.attr("data-we-empty-p")||n.text()||r(n)}}else r(i);else r(i)}function a(t){var n;e.selection.saveRange(null===(n=getSelection())||void 0===n?void 0:n.getRangeAt(0));var r=e.selection.getSelectionContainerElem();r.id===e.textElemId&&(t.preventDefault(),e.cmd["do"]("insertHTML","<p><br></p>"))}t.push(i),n.push(a)}t["default"]=u},function(e,t,n){"use strict";var r=n(0),i=r(n(1)),o=r(n(17)),a=r(n(28));(0,i["default"])(t,"__esModule",{value:!0}),t.cutToKeepP=void 0;var s=n(2),l=n(7),u=s.__importDefault(n(3));function c(e,t,n){function r(){var t=e.$textElem,n=e.$textElem.html(),r=e.$textElem.text(),i=(0,o["default"])(n).call(n),s=["<p><br></p>","<br>",'<p data-we-empty-p=""></p>',l.EMPTY_P];if(/^\s*$/.test(r)&&(!i||(0,a["default"])(s).call(s,i))){t.html(l.EMPTY_P);var u=t.getNode();e.selection.createRangeByElems(u.childNodes[0],u.childNodes[0]);var c=e.selection.getSelectionContainerElem();e.selection.restoreSelection(),e.selection.moveCursor(c.getNode(),0)}}function i(t){var n,r=e.$textElem,i=(0,o["default"])(n=r.html().toLowerCase()).call(n);i!==l.EMPTY_P||t.preventDefault()}t.push(r),n.push(i)}function d(e,t){function n(t){var n;if(88===t.keyCode){var r=e.$textElem,i=(0,o["default"])(n=r.html().toLowerCase()).call(n);if(!i||"<br>"===i){var a=u["default"](l.EMPTY_P);r.html(" "),r.append(a),e.selection.createRangeByElem(a,!1,!0),e.selection.restoreSelection(),e.selection.moveCursor(a.getNode(),0)}}}t.push(n)}t.cutToKeepP=d,t["default"]=c},function(e,t,n){"use strict";var r=n(0),i=r(n(1));function o(e,t){function n(){if(e.cmd.queryCommandSupported("insertHTML")){var t=e.selection.getSelectionContainerElem();if(t){var n=t.parent(),r=t.getNodeName(),i=n.getNodeName();"CODE"==r||"CODE"===i||"PRE"===i||/hljs/.test(i)?e.cmd["do"]("insertHTML",e.config.languageTab):e.cmd["do"]("insertHTML","&nbsp;&nbsp;&nbsp;&nbsp;")}}}t.push(n)}(0,i["default"])(t,"__esModule",{value:!0}),t["default"]=o},function(e,t,n){"use strict";var r=n(0),i=r(n(1)),o=r(n(17)),a=r(n(4));(0,i["default"])(t,"__esModule",{value:!0});var s=n(131),l=n(6),u=n(7);function c(e){var t,n=(0,o["default"])(t=e.replace(/<div>/gim,"<p>").replace(/<\/div>/gim,"</p>")).call(t),r=document.createElement("div");return r.innerHTML=n,r.innerHTML.replace(/<p><\/p>/gim,"")}function d(e){var t=e.replace(/<br>|<br\/>/gm,"\n").replace(/<[^>]+>/gm,"");return t}function f(e){var t;if(""===e)return!1;var n=document.createElement("div");return n.innerHTML=e,"P"===(null===(t=n.firstChild)||void 0===t?void 0:t.nodeName)}function h(e){if(!(null===e||void 0===e?void 0:e.length))return!1;var t=e.elems[0];return"P"===t.nodeName&&"<br>"===t.innerHTML}function p(e,t){function n(t){var n=e.config,r=n.pasteFilterStyle,i=n.pasteIgnoreImg,o=n.pasteTextHandle,p=s.getPasteHtml(t,r,i),m=s.getPasteText(t);m=m.replace(/\n/gm,"<br>");var v=e.selection.getSelectionContainerElem();if(v){var g=null===v||void 0===v?void 0:v.getNodeName(),y=null===v||void 0===v?void 0:v.getNodeTop(e),_="";if(y.elems[0]&&(_=null===y||void 0===y?void 0:y.getNodeName()),"CODE"===g||"PRE"===_)return o&&l.isFunction(o)&&(m=""+(o(m)||"")),void e.cmd["do"]("insertHTML",d(m));if(u.urlRegex.test(m)&&r){o&&l.isFunction(o)&&(m=""+(o(m)||""));var x=m.replace(u.urlRegex,(function(e){return'<a href="'+e+'" target="_blank">'+e+"</a>"})),b=e.selection.getRange(),w=document.createElement("div"),A=document.createDocumentFragment();if(w.innerHTML=x,null==b)return;while(w.childNodes.length)A.append(w.childNodes[0]);var T=A.querySelectorAll("a");return(0,a["default"])(T).call(T,(function(e){e.innerText=e.href})),b.insertNode&&(b.deleteContents(),b.insertNode(A)),void e.selection.clearWindowSelectionRange()}if(p)try{o&&l.isFunction(o)&&(p=""+(o(p)||""));var S=/[\.\#\@]?\w+[ ]+\{[^}]*\}/.test(p);if(S&&r)e.cmd["do"]("insertHTML",""+c(m));else{var E=c(p);if(f(E)){var C=e.$textElem;if(e.cmd["do"]("insertHTML",E),C.equal(v))return void e.selection.createEmptyRange();h(y)&&y.remove()}else e.cmd["do"]("insertHTML",E)}}catch(M){o&&l.isFunction(o)&&(m=""+(o(m)||"")),e.cmd["do"]("insertHTML",""+c(m))}}}t.push(n)}t["default"]=p},function(e,t,n){"use strict";var r=n(0),i=r(n(1)),o=r(n(17)),a=r(n(4)),s=r(n(28));(0,i["default"])(t,"__esModule",{value:!0});var l=n(2),u=n(293),c=l.__importDefault(n(297));function d(e){var t=/<span>.*?<\/span>/gi,n=/<span>(.*?)<\/span>/;return e.replace(t,(function(e){var t=e.match(n);return null==t?"":t[1]}))}function f(e,t){var n;return e=(0,o["default"])(n=e.toLowerCase()).call(n),!!u.IGNORE_TAGS.has(e)||!(!t||"img"!==e)}function h(e,t){var n="";n="<"+e;var r=[];(0,a["default"])(t).call(t,(function(e){r.push(e.name+'="'+e.value+'"')})),r.length>0&&(n=n+" "+r.join(" "));var i=u.EMPTY_TAGS.has(e);return n=n+(i?"/":"")+">",n}function p(e){return"</"+e+">"}function m(e,t,n){void 0===t&&(t=!0),void 0===n&&(n=!1);var r=[],i="";function l(e){e=(0,o["default"])(e).call(e),e&&(u.EMPTY_TAGS.has(e)||(i=e))}function m(){i=""}var v=new c["default"];v.parse(e,{startElement:function(e,i){if(l(e),!f(e,n)){var o=u.NECESSARY_ATTRS.get(e)||[],c=[];(0,a["default"])(i).call(i,(function(e){var n=e.name;"style"!==n?!1!==(0,s["default"])(o).call(o,n)&&c.push(e):t||c.push(e)}));var d=h(e,c);r.push(d)}},characters:function(e){e&&(f(i,n)||r.push(e))},endElement:function(e){if(!f(e,n)){var t=p(e);r.push(t),m()}},comment:function(e){l(e)}});var g=r.join("");return g=d(g),g}t["default"]=m},function(e,t,n){"use strict";var r=n(0),i=r(n(1)),o=r(n(132)),a=r(n(121));(0,i["default"])(t,"__esModule",{value:!0}),t.TOP_LEVEL_TAGS=t.EMPTY_TAGS=t.NECESSARY_ATTRS=t.IGNORE_TAGS=void 0,t.IGNORE_TAGS=new o["default"](["doctype","!doctype","html","head","meta","body","script","style","link","frame","iframe","title","svg","center","o:p"]),t.NECESSARY_ATTRS=new a["default"]([["img",["src","alt"]],["a",["href","target"]],["td",["colspan","rowspan"]],["th",["colspan","rowspan"]]]),t.EMPTY_TAGS=new o["default"](["area","base","basefont","br","col","hr","img","input","isindex","embed"]),t.TOP_LEVEL_TAGS=new o["default"](["h1","h2","h3","h4","h5","p","ul","ol","table","blockquote","pre","hr","form"])},function(e,t,n){var r=n(295);e.exports=r},function(e,t,n){n(296),n(61),n(50),n(54);var r=n(9);e.exports=r.Set},function(e,t,n){"use strict";var r=n(122),i=n(124);e.exports=r("Set",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),i)},function(e,t){function n(){}n.prototype={handler:null,startTagRe:/^<([^>\s\/]+)((\s+[^=>\s]+(\s*=\s*((\"[^"]*\")|(\'[^']*\')|[^>\s]+))?)*)\s*\/?\s*>/m,endTagRe:/^<\/([^>\s]+)[^>]*>/m,attrRe:/([^=\s]+)(\s*=\s*((\"([^"]*)\")|(\'([^']*)\')|[^>\s]+))?/gm,parse:function(e,t){t&&(this.contentHandler=t);var n,r,i,o=!1,a=this;while(e.length>0)"\x3c!--"==e.substring(0,4)?(i=e.indexOf("--\x3e"),-1!=i?(this.contentHandler.comment(e.substring(4,i)),e=e.substring(i+3),o=!1):o=!0):"</"==e.substring(0,2)?this.endTagRe.test(e)?(RegExp.leftContext,n=RegExp.lastMatch,r=RegExp.rightContext,n.replace(this.endTagRe,(function(){return a.parseEndTag.apply(a,arguments)})),e=r,o=!1):o=!0:"<"==e.charAt(0)&&(this.startTagRe.test(e)?(RegExp.leftContext,n=RegExp.lastMatch,r=RegExp.rightContext,n.replace(this.startTagRe,(function(){return a.parseStartTag.apply(a,arguments)})),e=r,o=!1):o=!0),o&&(i=e.indexOf("<"),-1==i?(this.contentHandler.characters(e),e=""):(this.contentHandler.characters(e.substring(0,i)),e=e.substring(i))),o=!0},parseStartTag:function(e,t,n){var r=this.parseAttributes(t,n);this.contentHandler.startElement(t,r)},parseEndTag:function(e,t){this.contentHandler.endElement(t)},parseAttributes:function(e,t){var n=this,r=[];return t.replace(this.attrRe,(function(t,i,o,a,s,l,u,c){r.push(n.parseAttribute(e,t,i,o,a,s,l,u,c))})),r},parseAttribute:function(e,t,n){var r="";arguments[7]?r=arguments[8]:arguments[5]?r=arguments[6]:arguments[3]&&(r=arguments[4]);var i=!r&&!arguments[3];return{name:n,value:i?null:r}}},e.exports=n},function(e,t,n){"use strict";var r=n(0),i=r(n(1));function o(e,t){function n(t){e.selection.createRangeByElem(t),e.selection.restoreSelection()}t.push(n)}(0,i["default"])(t,"__esModule",{value:!0}),t["default"]=o},function(e,t,n){"use strict";var r=n(0),i=r(n(1)),o=r(n(4));(0,i["default"])(t,"__esModule",{value:!0});var a=n(2),s=n(6),l=a.__importDefault(n(3));function u(e){var t=[],n=e.childNodes()||[];return(0,o["default"])(n).call(n,(function(e){var n,r=e.nodeType;if(3===r&&(n=e.textContent||"",n=s.replaceHtmlSymbol(n)),1===r){n={},n=n,n.tag=e.nodeName.toLowerCase();for(var i=[],o=e.attributes,a=o.length||0,c=0;c<a;c++){var d=o[c];i.push({name:d.name,value:d.value})}n.attrs=i,n.children=u(l["default"](e))}n&&t.push(n)})),t}t["default"]=u},function(e,t,n){"use strict";var r=n(0),i=r(n(92)),o=r(n(1)),a=r(n(4));(0,o["default"])(t,"__esModule",{value:!0});var s=n(2),l=s.__importDefault(n(3));function u(e,t){void 0===t&&(t=document.createElement("div"));var n=t;return(0,a["default"])(e).call(e,(function(e){var t,r;("string"===typeof e&&(t=document.createTextNode(e)),"object"===(0,i["default"])(e))&&(t=document.createElement(e.tag),(0,a["default"])(r=e.attrs).call(r,(function(e){l["default"](t).attr(e.name,e.value)})),e.children&&e.children.length>0&&u(e.children,t.getRootNode()));t&&n.appendChild(t)})),l["default"](n)}t["default"]=u},function(e,t,n){"use strict";var r=n(0),i=r(n(1)),o=r(n(89)),a=r(n(70)),s=r(n(28)),l=r(n(302)),u=r(n(4)),c=r(n(94)),d=r(n(133)),f=r(n(46)),h=r(n(57));(0,i["default"])(t,"__esModule",{value:!0});var p=n(2),m=p.__importDefault(n(87)),v=p.__importDefault(n(314)),g=p.__importDefault(n(3)),y=function(){function e(e){this.editor=e,this.menuList=[],this.constructorList=v["default"]}return e.prototype.extend=function(e,t){t&&"function"===typeof t&&(this.constructorList[e]=t)},e.prototype.init=function(){var e,t,n=this,r=this.editor.config,i=r.excludeMenus;!1===(0,o["default"])(i)&&(i=[]),r.menus=(0,a["default"])(e=r.menus).call(e,(function(e){return!1===(0,s["default"])(i).call(i,e)}));var d=(0,l["default"])(m["default"].globalCustomMenuConstructorList);d=(0,a["default"])(d).call(d,(function(e){return(0,s["default"])(i).call(i,e)})),(0,u["default"])(d).call(d,(function(e){delete m["default"].globalCustomMenuConstructorList[e]})),(0,u["default"])(t=r.menus).call(t,(function(e){var t=n.constructorList[e];n._initMenuList(e,t)}));for(var f=0,h=(0,c["default"])(m["default"].globalCustomMenuConstructorList);f<h.length;f++){var p=h[f],v=p[0],g=p[1],y=g;this._initMenuList(v,y)}this._addToToolbar(),r.showMenuTooltips&&this._bindMenuTooltips()},e.prototype._initMenuList=function(e,t){var n;if(null!=t&&"function"===typeof t)if((0,d["default"])(n=this.menuList).call(n,(function(t){return t.key===e})))console.warn("菜单名称重复:"+e);else{var r=new t(this.editor);r.key=e,this.menuList.push(r)}},e.prototype._bindMenuTooltips=function(){var e=this.editor,t=e.$toolbarElem,n=e.config,r=n.menuTooltipPosition,i=g["default"]('<div class="w-e-menu-tooltip w-e-menu-tooltip-'+r+'">\n            <div class="w-e-menu-tooltip-item-wrapper">\n              <div></div>\n            </div>\n          </div>');i.css("visibility","hidden"),t.append(i),i.css("z-index",e.zIndex.get("tooltip"));var o=0;function a(){o&&clearTimeout(o)}function s(){a(),i.css("visibility","hidden")}t.on("mouseover",(function(n){var l,u,c=n.target,d=g["default"](c);if(d.isContain(t))s();else{if(null!=d.parentUntil(".w-e-droplist"))s();else if(d.attr("data-title"))l=d.attr("data-title"),u=d;else{var h=d.parentUntil(".w-e-menu");null!=h&&(l=h.attr("data-title"),u=h)}if(l&&u){a();var p=u.getOffsetData();i.text(e.i18next.t("menus.title."+l));var m=i.getOffsetData(),v=p.left+p.width/2-m.width/2;i.css("left",v+"px"),"up"===r?i.css("top",p.top-m.height-8+"px"):"down"===r&&i.css("top",p.top+p.height+8+"px"),o=(0,f["default"])((function(){i.css("visibility","visible")}),200)}else s()}})).on("mouseleave",(function(){s()}))},e.prototype._addToToolbar=function(){var e,t=this.editor,n=t.$toolbarElem;(0,u["default"])(e=this.menuList).call(e,(function(e){var t=e.$elem;t&&n.append(t)}))},e.prototype.menuFind=function(e){for(var t=this.menuList,n=0,r=t.length;n<r;n++)if(t[n].key===e)return t[n];return t[0]},e.prototype.changeActive=function(){var e;(0,u["default"])(e=this.menuList).call(e,(function(e){var t;(0,f["default"])((0,h["default"])(t=e.tryChangeActive).call(t,e),100)}))},e}();t["default"]=y},function(e,t,n){e.exports=n(303)},function(e,t,n){var r=n(304);e.exports=r},function(e,t,n){n(305);var r=n(9);e.exports=r.Object.keys},function(e,t,n){var r=n(5),i=n(31),o=n(52),a=n(11),s=a((function(){o(1)}));r({target:"Object",stat:!0,forced:s},{keys:function(e){return o(i(e))}})},function(e,t,n){var r=n(307);e.exports=r},function(e,t,n){n(308);var r=n(9);e.exports=r.Object.entries},function(e,t,n){var r=n(5),i=n(309).entries;r({target:"Object",stat:!0},{entries:function(e){return i(e)}})},function(e,t,n){var r=n(14),i=n(52),o=n(30),a=n(59).f,s=function(e){return function(t){var n,s=o(t),l=i(s),u=l.length,c=0,d=[];while(u>c)n=l[c++],r&&!a.call(s,n)||d.push(e?[n,s[n]]:s[n]);return d}};e.exports={entries:s(!0),values:s(!1)}},function(e,t,n){var r=n(311);e.exports=r},function(e,t,n){var r=n(312),i=Array.prototype;e.exports=function(e){var t=e.some;return e===i||e instanceof Array&&t===i.some?r:t}},function(e,t,n){n(313);var r=n(15);e.exports=r("Array").some},function(e,t,n){"use strict";var r=n(5),i=n(32).some,o=n(67),a=n(22),s=o("some"),l=a("some");r({target:"Array",proto:!0,forced:!s||!l},{some:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}})},function(e,t,n){"use strict";var r=n(0),i=r(n(1));(0,i["default"])(t,"__esModule",{value:!0});var o=n(2),a=o.__importDefault(n(315)),s=o.__importDefault(n(316)),l=o.__importDefault(n(321)),u=o.__importDefault(n(326)),c=o.__importDefault(n(327)),d=o.__importDefault(n(328)),f=o.__importDefault(n(329)),h=o.__importDefault(n(331)),p=o.__importDefault(n(333)),m=o.__importDefault(n(334)),v=o.__importDefault(n(337)),g=o.__importDefault(n(338)),y=o.__importDefault(n(339)),_=o.__importDefault(n(350)),x=o.__importDefault(n(365)),b=o.__importDefault(n(369)),w=o.__importDefault(n(137)),A=o.__importDefault(n(378)),T=o.__importDefault(n(380)),S=o.__importDefault(n(381)),E=o.__importDefault(n(382)),C=o.__importDefault(n(401)),M=o.__importDefault(n(406)),L=o.__importDefault(n(409));t["default"]={bold:a["default"],head:s["default"],italic:u["default"],link:l["default"],underline:c["default"],strikeThrough:d["default"],fontName:f["default"],fontSize:h["default"],justify:p["default"],quote:m["default"],backColor:v["default"],foreColor:g["default"],video:y["default"],image:_["default"],indent:x["default"],emoticon:b["default"],list:w["default"],lineHeight:A["default"],undo:T["default"],redo:S["default"],table:E["default"],code:C["default"],splitLine:M["default"],todo:L["default"]}},function(e,t,n){"use strict";var r=n(0),i=r(n(1));(0,i["default"])(t,"__esModule",{value:!0});var o=n(2),a=o.__importDefault(n(23)),s=o.__importDefault(n(3)),l=function(e){function t(t){var n=this,r=s["default"]('<div class="w-e-menu" data-title="加粗">\n                <i class="w-e-icon-bold"></i>\n            </div>');return n=e.call(this,r,t)||this,n}return o.__extends(t,e),t.prototype.clickHandler=function(){var e=this.editor,t=e.selection.isSelectionEmpty();t&&e.selection.createEmptyRange(),e.cmd["do"]("bold"),t&&(e.selection.collapseRange(),e.selection.restoreSelection())},t.prototype.tryChangeActive=function(){var e=this.editor;e.cmd.queryCommandState("bold")?this.active():this.unActive()},t}(a["default"]);t["default"]=l},function(e,t,n){"use strict";var r=n(0),i=r(n(1)),o=r(n(27)),a=r(n(29)),s=r(n(4)),l=r(n(317)),u=r(n(28));(0,i["default"])(t,"__esModule",{value:!0});var c=n(2),d=c.__importDefault(n(24)),f=c.__importDefault(n(3)),h=n(6),p=n(7),m=function(e){function t(t){var n=this,r=f["default"]('<div class="w-e-menu" data-title="标题"><i class="w-e-icon-header"></i></div>'),i={width:100,title:"设置标题",type:"list",list:[{$elem:f["default"]("<h1>H1</h1>"),value:"<h1>"},{$elem:f["default"]("<h2>H2</h2>"),value:"<h2>"},{$elem:f["default"]("<h3>H3</h3>"),value:"<h3>"},{$elem:f["default"]("<h4>H4</h4>"),value:"<h4>"},{$elem:f["default"]("<h5>H5</h5>"),value:"<h5>"},{$elem:f["default"]("<p>"+t.i18next.t("menus.dropListMenu.head.正文")+"</p>"),value:"<p>"}],clickHandler:function(e){n.command(e)}};n=e.call(this,r,t,i)||this;var o=t.config.onCatalogChange;return o&&(n.oldCatalogs=[],n.addListenerCatalog(),n.getCatalogs()),n}return c.__extends(t,e),t.prototype.command=function(e){var t=this.editor,n=t.selection.getSelectionContainerElem();if(n&&t.$textElem.equal(n))this.setMultilineHead(e);else{var r;if((0,o["default"])(r=["OL","UL","LI","TABLE","TH","TR","CODE","HR"]).call(r,f["default"](n).getNodeName())>-1)return;t.cmd["do"]("formatBlock",e)}"<p>"!==e&&this.addUidForSelectionElem()},t.prototype.addUidForSelectionElem=function(){var e=this.editor,t=e.selection.getSelectionContainerElem(),n=h.getRandomCode();f["default"](t).attr("id",n)},t.prototype.addListenerCatalog=function(){var e=this,t=this.editor;t.txt.eventHooks.changeEvents.push((function(){e.getCatalogs()}))},t.prototype.getCatalogs=function(){var e=this.editor,t=this.editor.$textElem,n=e.config.onCatalogChange,r=(0,a["default"])(t).call(t,"h1,h2,h3,h4,h5"),i=[];(0,s["default"])(r).call(r,(function(e,t){var n=f["default"](e),r=n.attr("id"),o=n.getNodeName(),a=n.text();r||(r=h.getRandomCode(),n.attr("id",r)),a&&i.push({tag:o,id:r,text:a})})),(0,l["default"])(this.oldCatalogs)!==(0,l["default"])(i)&&(this.oldCatalogs=i,n&&n(i))},t.prototype.setMultilineHead=function(e){var t,n,r=this,i=this.editor,o=i.selection,a=null===(t=o.getSelectionContainerElem())||void 0===t?void 0:t.elems[0],l=["IMG","VIDEO","TABLE","TH","TR","UL","OL","PRE","HR","BLOCKQUOTE"],u=f["default"](o.getSelectionStartElem()),c=f["default"](o.getSelectionEndElem());c.elems[0].outerHTML!==f["default"](p.EMPTY_P).elems[0].outerHTML||c.elems[0].nextSibling||(c=c.prev());var d=[];d.push(u.getNodeTop(i));var h=[],m=null===(n=o.getRange())||void 0===n?void 0:n.commonAncestorContainer.childNodes;null===m||void 0===m||(0,s["default"])(m).call(m,(function(e,t){e===d[0].getNode()&&h.push(t),e===c.getNodeTop(i).getNode()&&h.push(t)}));var v=0;while(d[v].getNode()!==c.getNodeTop(i).getNode()){if(!d[v].elems[0])return;var g=f["default"](d[v].next().getNode());d.push(g),v++}null===d||void 0===d||(0,s["default"])(d).call(d,(function(t,n){if(!r.hasTag(t,l)){var i=f["default"](e),o=t.parent().getNode();i.html(""+t.html()),o.insertBefore(i.getNode(),t.getNode()),t.remove()}})),o.createRangeByElems(a.children[h[0]],a.children[h[1]])},t.prototype.hasTag=function(e,t){var n,r=this;if(!e)return!1;if((0,u["default"])(t).call(t,null===e||void 0===e?void 0:e.getNodeName()))return!0;var i=!1;return null===(n=e.children())||void 0===n||(0,s["default"])(n).call(n,(function(e){i=r.hasTag(f["default"](e),t)})),i},t.prototype.tryChangeActive=function(){var e=this.editor,t=/^h/i,n=e.cmd.queryCommandValue("formatBlock");t.test(n)?this.active():this.unActive()},t}(d["default"]);t["default"]=m},function(e,t,n){e.exports=n(318)},function(e,t,n){var r=n(319);e.exports=r},function(e,t,n){n(320);var r=n(9);r.JSON||(r.JSON={stringify:JSON.stringify}),e.exports=function(e,t,n){return r.JSON.stringify.apply(null,arguments)}},function(e,t,n){var r=n(5),i=n(36),o=n(11),a=i("JSON","stringify"),s=/[\uD800-\uDFFF]/g,l=/^[\uD800-\uDBFF]$/,u=/^[\uDC00-\uDFFF]$/,c=function(e,t,n){var r=n.charAt(t-1),i=n.charAt(t+1);return l.test(e)&&!u.test(i)||u.test(e)&&!l.test(r)?"\\u"+e.charCodeAt(0).toString(16):e},d=o((function(){return'"\\udf06\\ud834"'!==a("\udf06\ud834")||'"\\udead"'!==a("\udead")}));a&&r({target:"JSON",stat:!0,forced:d},{stringify:function(e,t,n){var r=a.apply(null,arguments);return"string"==typeof r?r.replace(s,c):r}})},function(e,t,n){"use strict";var r=n(0),i=r(n(1)),o=r(n(17));(0,i["default"])(t,"__esModule",{value:!0});var a=n(2),s=a.__importDefault(n(38)),l=a.__importDefault(n(3)),u=a.__importDefault(n(322)),c=a.__importStar(n(96)),d=a.__importDefault(n(33)),f=a.__importDefault(n(324)),h=n(7),p=function(e){function t(t){var n=this,r=l["default"]('<div class="w-e-menu" data-title="链接"><i class="w-e-icon-link"></i></div>');return n=e.call(this,r,t)||this,f["default"](t),n}return a.__extends(t,e),t.prototype.clickHandler=function(){var e,t=this.editor,n=t.selection.getSelectionContainerElem(),r=t.$textElem,i=r.html(),a=(0,o["default"])(i).call(i);if(a===h.EMPTY_P){var s=r.children();t.selection.createRangeByElem(s,!0,!0),n=t.selection.getSelectionContainerElem()}if(!n||!t.$textElem.equal(n))if(this.isActive){var u="",d="";if(e=t.selection.getSelectionContainerElem(),!e)return;if("A"!==e.getNodeName()){var f=c.getParentNodeA(e);e=l["default"](f)}u=e.elems[0].innerText,d=e.attr("href"),this.createPanel(u,d)}else t.selection.isSelectionEmpty()?this.createPanel("",""):this.createPanel(t.selection.getSelectionText(),"")},t.prototype.createPanel=function(e,t){var n=u["default"](this.editor,e,t),r=new d["default"](this,n);r.create()},t.prototype.tryChangeActive=function(){var e=this.editor;c["default"](e)?this.active():this.unActive()},t}(s["default"]);t["default"]=p},function(e,t,n){"use strict";var r=n(0),i=r(n(1)),o=r(n(28)),a=r(n(17)),s=r(n(29));(0,i["default"])(t,"__esModule",{value:!0});var l=n(2),u=n(6),c=l.__importDefault(n(3)),d=l.__importStar(n(96)),f=n(323);function h(e,t,n){var r,i=u.getRandom("input-link"),l=u.getRandom("input-text"),h=u.getRandom("btn-ok"),p=u.getRandom("btn-del"),m=d["default"](e)?"inline-block":"none";function v(){if(d["default"](e)){var t=e.selection.getSelectionContainerElem();t&&(e.selection.createRangeByElem(t),e.selection.restoreSelection(),r=t)}}function g(t,n){var r=t.replace(/</g,"&lt;").replace(/>/g,"&gt;"),i=c["default"]('<a target="_blank">'+r+"</a>"),o=i.elems[0];o.innerText=t,o.href=n,d["default"](e)?(v(),e.cmd["do"]("insertElem",i)):e.cmd["do"]("insertElem",i)}function y(){if(d["default"](e))if(v(),"A"===r.getNodeName()){var t,n=r.elems[0],i=n.parentElement;i&&(0,o["default"])(t=d.EXTRA_TAG).call(t,i.nodeName)?i.innerHTML=n.innerHTML:e.cmd["do"]("insertHTML","<span>"+n.innerHTML+"</span>")}else{var a=d.getParentNodeA(r),s=a.innerHTML;e.cmd["do"]("insertHTML","<span>"+s+"</span>")}}function _(t,n){var r=e.config.linkCheck(t,n);if(void 0===r);else{if(!0===r)return!0;e.config.customAlert(r,"warning")}return!1}var x={width:300,height:0,tabs:[{title:e.i18next.t("menus.panelMenus.link.链接"),tpl:'<div>\n                        <input\n                            id="'+l+'"\n                            type="text"\n                            class="block"\n                            placeholder="'+e.i18next.t("menus.panelMenus.link.链接文字")+'"/>\n                        </td>\n                        <input\n                            id="'+i+'"\n                            type="text"\n                            class="block"\n                            placeholder="'+e.i18next.t("如")+' https://..."/>\n                        </td>\n                        <div class="w-e-button-container">\n                            <button type="button" id="'+h+'" class="right">\n                                '+e.i18next.t("插入")+'\n                            </button>\n                            <button type="button" id="'+p+'" class="gray right" style="display:'+m+'">\n                                '+e.i18next.t("menus.panelMenus.link.取消链接")+"\n                            </button>\n                        </div>\n                    </div>",events:[{selector:"#"+h,type:"click",fn:function(){var t,n,r,s,u,h=e.selection.getSelectionContainerElem(),p=null===h||void 0===h?void 0:h.elems[0];e.selection.restoreSelection();var m=e.selection.getSelectionRangeTopNodes()[0].getNode(),v=window.getSelection(),y=c["default"]("#"+i),x=c["default"]("#"+l),b=(0,a["default"])(t=y.val()).call(t),w=(0,a["default"])(n=x.val()).call(n),A="";v&&!(null===v||void 0===v?void 0:v.isCollapsed)&&(A=null===(s=f.insertHtml(v,m))||void 0===s?void 0:(0,a["default"])(s).call(s));var T=null===A||void 0===A?void 0:A.replace(/<.*?>/g,""),S=null!==(u=null===T||void 0===T?void 0:T.length)&&void 0!==u?u:0;if(S<=w.length){var E=w.substring(0,S),C=w.substring(S);T===E&&(w=T+C)}if(b&&(w||(w=b),_(w,b))){if("A"===(null===p||void 0===p?void 0:p.nodeName))return p.setAttribute("href",b),p.innerText=w,!0;if("A"!==(null===p||void 0===p?void 0:p.nodeName)&&(0,o["default"])(r=d.EXTRA_TAG).call(r,p.nodeName)){var M=d.getParentNodeA(h);if(M)return M.setAttribute("href",b),p.innerText=w,!0}return g(w,b),!0}},bindEnter:!0},{selector:"#"+p,type:"click",fn:function(){return y(),!0}}]}],setLinkValue:function(e,r){var o,a="",u="";"text"===r&&(a="#"+l,u=t),"link"===r&&(a="#"+i,u=n),o=(0,s["default"])(e).call(e,a).elems[0],o.value=u}};return x}t["default"]=h},function(e,t,n){"use strict";var r=n(0),i=r(n(1)),o=r(n(4));function a(e,t){var n=e,r=e;do{if(n.textContent===t)break;r=n,n.parentNode&&(n=null===n||void 0===n?void 0:n.parentNode)}while("P"!==(null===n||void 0===n?void 0:n.nodeName));return r}function s(e,t){var n=e.nodeName,r="";if(3===e.nodeType||/^(h|H)[1-6]$/.test(n))return t;if(1===e.nodeType){var i=e.getAttribute("style"),o=e.getAttribute("face"),a=e.getAttribute("color");i&&(r=r+' style="'+i+'"'),o&&(r=r+' face="'+o+'"'),a&&(r=r+' color="'+a+'"')}return n=n.toLowerCase(),"<"+n+r+">"+t+"</"+n+">"}function l(e,t,n,r){var i,o=null===(i=t.textContent)||void 0===i?void 0:i.substring(n,r),a=t,l="";do{l=s(a,null!==o&&void 0!==o?o:""),o=l,a=null===a||void 0===a?void 0:a.parentElement}while(a&&a.textContent!==e);return l}function u(e,t){var n,r,i,o,u,f=e.anchorNode,h=e.focusNode,p=e.anchorOffset,m=e.focusOffset,v=null!==(n=t.textContent)&&void 0!==n?n:"",g=c(t),y="",_="",x="",b="",w=f,A=h,T=f;if(null===f||void 0===f?void 0:f.isEqualNode(null!==h&&void 0!==h?h:null)){var S=l(v,f,p,m);return S=d(g,S),S}f&&(_=l(v,f,null!==p&&void 0!==p?p:0)),h&&(b=l(v,h,0,m)),f&&(w=a(f,v)),h&&(A=a(h,v)),T=null!==(r=null===w||void 0===w?void 0:w.nextSibling)&&void 0!==r?r:f;while(!(null===T||void 0===T?void 0:T.isEqualNode(null!==A&&void 0!==A?A:null))){var E=null===T||void 0===T?void 0:T.nodeName;if("#text"===E)x+=null===T||void 0===T?void 0:T.textContent;else{var C=null===(o=null===(i=null===T||void 0===T?void 0:T.firstChild)||void 0===i?void 0:i.parentElement)||void 0===o?void 0:o.innerHTML;T&&(x+=s(T,null!==C&&void 0!==C?C:""))}var M=null!==(u=null===T||void 0===T?void 0:T.nextSibling)&&void 0!==u?u:T;if(M===T)break;T=M}return y=""+_+x+b,y=d(g,y),y}function c(e){var t,n=null!==(t=e.textContent)&&void 0!==t?t:"",r=[];while((null===e||void 0===e?void 0:e.textContent)===n)"P"!==e.nodeName&&"TABLE"!==e.nodeName&&r.push(e),e=e.childNodes[0];return r}function d(e,t){return(0,o["default"])(e).call(e,(function(e){t=s(e,t)})),t}(0,i["default"])(t,"__esModule",{value:!0}),t.insertHtml=t.createPartHtml=t.makeHtmlString=t.getTopNode=void 0,t.getTopNode=a,t.makeHtmlString=s,t.createPartHtml=l,t.insertHtml=u},function(e,t,n){"use strict";var r=n(0),i=r(n(1));(0,i["default"])(t,"__esModule",{value:!0});var o=n(2),a=o.__importDefault(n(325));function s(e){a["default"](e)}t["default"]=s},function(e,t,n){"use strict";var r=n(0),i=r(n(1)),o=r(n(28));(0,i["default"])(t,"__esModule",{value:!0});var a=n(2),s=a.__importDefault(n(3)),l=a.__importDefault(n(39)),u=n(96);function c(e){var t;function n(n){var r=[{$elem:s["default"]("<span>"+e.i18next.t("menus.panelMenus.link.查看链接")+"</span>"),onClick:function(e,t){var n=t.attr("href");return window.open(n,"_target"),!0}},{$elem:s["default"]("<span>"+e.i18next.t("menus.panelMenus.link.取消链接")+"</span>"),onClick:function(e,t){var n,r;e.selection.createRangeByElem(t),e.selection.restoreSelection();var i=t.childNodes();if("IMG"===(null===i||void 0===i?void 0:i.getNodeName())){var a=null===(r=null===(n=e.selection.getSelectionContainerElem())||void 0===n?void 0:n.children())||void 0===r?void 0:r.elems[0].children[0];e.cmd["do"]("insertHTML","<img \n                                src="+(null===a||void 0===a?void 0:a.getAttribute("src"))+" \n                                style="+(null===a||void 0===a?void 0:a.getAttribute("style"))+">")}else{var s,l=t.elems[0],c=l.innerHTML,d=l.parentElement;d&&(0,o["default"])(s=u.EXTRA_TAG).call(s,d.nodeName)?d.innerHTML=c:e.cmd["do"]("insertHTML","<span>"+c+"</span>")}return!0}}];t=new l["default"](e,n,r),t.create()}function r(){t&&(t.remove(),t=null)}return{showLinkTooltip:n,hideLinkTooltip:r}}function d(e){var t=c(e),n=t.showLinkTooltip,r=t.hideLinkTooltip;e.txt.eventHooks.linkClickEvents.push(n),e.txt.eventHooks.clickEvents.push(r),e.txt.eventHooks.keyupEvents.push(r),e.txt.eventHooks.toolbarClickEvents.push(r),e.txt.eventHooks.menuClickEvents.push(r),e.txt.eventHooks.textScrollEvents.push(r)}t["default"]=d},function(e,t,n){"use strict";var r=n(0),i=r(n(1));(0,i["default"])(t,"__esModule",{value:!0});var o=n(2),a=o.__importDefault(n(23)),s=o.__importDefault(n(3)),l=function(e){function t(t){var n=this,r=s["default"]('<div class="w-e-menu" data-title="斜体">\n                <i class="w-e-icon-italic"></i>\n            </div>');return n=e.call(this,r,t)||this,n}return o.__extends(t,e),t.prototype.clickHandler=function(){var e=this.editor,t=e.selection.isSelectionEmpty();t&&e.selection.createEmptyRange(),e.cmd["do"]("italic"),t&&(e.selection.collapseRange(),e.selection.restoreSelection())},t.prototype.tryChangeActive=function(){var e=this.editor;e.cmd.queryCommandState("italic")?this.active():this.unActive()},t}(a["default"]);t["default"]=l},function(e,t,n){"use strict";var r=n(0),i=r(n(1));(0,i["default"])(t,"__esModule",{value:!0});var o=n(2),a=o.__importDefault(n(23)),s=o.__importDefault(n(3)),l=function(e){function t(t){var n=this,r=s["default"]('<div class="w-e-menu" data-title="下划线">\n                <i class="w-e-icon-underline"></i>\n            </div>');return n=e.call(this,r,t)||this,n}return o.__extends(t,e),t.prototype.clickHandler=function(){var e=this.editor,t=e.selection.isSelectionEmpty();t&&e.selection.createEmptyRange(),e.cmd["do"]("underline"),t&&(e.selection.collapseRange(),e.selection.restoreSelection())},t.prototype.tryChangeActive=function(){var e=this.editor;e.cmd.queryCommandState("underline")?this.active():this.unActive()},t}(a["default"]);t["default"]=l},function(e,t,n){"use strict";var r=n(0),i=r(n(1));(0,i["default"])(t,"__esModule",{value:!0});var o=n(2),a=o.__importDefault(n(23)),s=o.__importDefault(n(3)),l=function(e){function t(t){var n=this,r=s["default"]('<div class="w-e-menu" data-title="删除线">\n                <i class="w-e-icon-strikethrough"></i>\n            </div>');return n=e.call(this,r,t)||this,n}return o.__extends(t,e),t.prototype.clickHandler=function(){var e=this.editor,t=e.selection.isSelectionEmpty();t&&e.selection.createEmptyRange(),e.cmd["do"]("strikeThrough"),t&&(e.selection.collapseRange(),e.selection.restoreSelection())},t.prototype.tryChangeActive=function(){var e=this.editor;e.cmd.queryCommandState("strikeThrough")?this.active():this.unActive()},t}(a["default"]);t["default"]=l},function(e,t,n){"use strict";var r=n(0),i=r(n(1));(0,i["default"])(t,"__esModule",{value:!0});var o=n(2),a=o.__importDefault(n(24)),s=o.__importDefault(n(3)),l=o.__importDefault(n(330)),u=function(e){function t(t){var n=this,r=s["default"]('<div class="w-e-menu" data-title="字体">\n                <i class="w-e-icon-font"></i>\n            </div>'),i=new l["default"](t.config.fontNames),o={width:100,title:"设置字体",type:"list",list:i.getItemList(),clickHandler:function(e){n.command(e)}};return n=e.call(this,r,t,o)||this,n}return o.__extends(t,e),t.prototype.command=function(e){var t,n=this.editor,r=n.selection.isSelectionEmpty(),i=null===(t=n.selection.getSelectionContainerElem())||void 0===t?void 0:t.elems[0];if(null!=i){var o="p"!==(null===i||void 0===i?void 0:i.nodeName.toLowerCase()),a=(null===i||void 0===i?void 0:i.getAttribute("face"))===e;if(r){if(o&&!a){var s=n.selection.getSelectionRangeTopNodes();n.selection.createRangeByElem(s[0]),n.selection.moveCursor(s[0].elems[0])}n.selection.setRangeToElem(i),n.selection.createEmptyRange()}n.cmd["do"]("fontName",e),r&&(n.selection.collapseRange(),n.selection.restoreSelection())}},t.prototype.tryChangeActive=function(){},t}(a["default"]);t["default"]=u},function(e,t,n){"use strict";var r=n(0),i=r(n(1)),o=r(n(4));(0,i["default"])(t,"__esModule",{value:!0});var a=n(2),s=a.__importDefault(n(3)),l=function(){function e(e){var t=this;this.itemList=[],(0,o["default"])(e).call(e,(function(e){var n="string"===typeof e?e:e.value,r="string"===typeof e?e:e.name;t.itemList.push({$elem:s["default"]("<p style=\"font-family:'"+n+"'\">"+r+"</p>"),value:r})}))}return e.prototype.getItemList=function(){return this.itemList},e}();t["default"]=l},function(e,t,n){"use strict";var r=n(0),i=r(n(1));(0,i["default"])(t,"__esModule",{value:!0});var o=n(2),a=o.__importDefault(n(24)),s=o.__importDefault(n(3)),l=o.__importDefault(n(332)),u=function(e){function t(t){var n=this,r=s["default"]('<div class="w-e-menu" data-title="字号">\n                <i class="w-e-icon-text-heigh"></i>\n            </div>'),i=new l["default"](t.config.fontSizes),o={width:160,title:"设置字号",type:"list",list:i.getItemList(),clickHandler:function(e){n.command(e)}};return n=e.call(this,r,t,o)||this,n}return o.__extends(t,e),t.prototype.command=function(e){var t,n=this.editor,r=n.selection.isSelectionEmpty(),i=null===(t=n.selection.getSelectionContainerElem())||void 0===t?void 0:t.elems[0];null!=i&&(n.cmd["do"]("fontSize",e),r&&(n.selection.collapseRange(),n.selection.restoreSelection()))},t.prototype.tryChangeActive=function(){},t}(a["default"]);t["default"]=u},function(e,t,n){"use strict";var r=n(0),i=r(n(1));(0,i["default"])(t,"__esModule",{value:!0});var o=n(2),a=o.__importDefault(n(3)),s=function(){function e(e){for(var t in this.itemList=[],e){var n=e[t];this.itemList.push({$elem:a["default"]('<p style="font-size:'+t+'">'+n.name+"</p>"),value:n.value})}}return e.prototype.getItemList=function(){return this.itemList},e}();t["default"]=s},function(e,t,n){"use strict";var r=n(0),i=r(n(1)),o=r(n(4)),a=r(n(27));(0,i["default"])(t,"__esModule",{value:!0});var s=n(2),l=s.__importDefault(n(24)),u=s.__importDefault(n(3)),c=["LI"],d=["BLOCKQUOTE"],f=function(e){function t(t){var n=this,r=u["default"]('<div class="w-e-menu" data-title="对齐"><i class="w-e-icon-paragraph-left"></i></div>'),i={width:100,title:"对齐方式",type:"list",list:[{$elem:u["default"]('<p>\n                            <i class="w-e-icon-paragraph-left w-e-drop-list-item"></i>\n                            '+t.i18next.t("menus.dropListMenu.justify.靠左")+"\n                        </p>"),value:"left"},{$elem:u["default"]('<p>\n                            <i class="w-e-icon-paragraph-center w-e-drop-list-item"></i>\n                            '+t.i18next.t("menus.dropListMenu.justify.居中")+"\n                        </p>"),value:"center"},{$elem:u["default"]('<p>\n                            <i class="w-e-icon-paragraph-right w-e-drop-list-item"></i>\n                            '+t.i18next.t("menus.dropListMenu.justify.靠右")+"\n                        </p>"),value:"right"},{$elem:u["default"]('<p>\n                            <i class="w-e-icon-paragraph-justify w-e-drop-list-item"></i>\n                            '+t.i18next.t("menus.dropListMenu.justify.两端")+"\n                        </p>"),value:"justify"}],clickHandler:function(e){n.command(e)}};return n=e.call(this,r,t,i)||this,n}return s.__extends(t,e),t.prototype.command=function(e){var t=this.editor,n=t.selection,r=n.getSelectionContainerElem();n.saveRange();var i=t.selection.getSelectionRangeTopNodes();if(null===r||void 0===r?void 0:r.length)if(this.isSpecialNode(r,i[0])||this.isSpecialTopNode(i[0])){var a=this.getSpecialNodeUntilTop(r,i[0]);if(null==a)return;u["default"](a).css("text-align",e)}else(0,o["default"])(i).call(i,(function(t){t.css("text-align",e)}));n.restoreSelection()},t.prototype.getSpecialNodeUntilTop=function(e,t){var n=e.elems[0],r=t.elems[0];while(null!=n){if(-1!==(0,a["default"])(c).call(c,null===n||void 0===n?void 0:n.nodeName))return n;if(n.parentNode===r)return n;n=n.parentNode}return n},t.prototype.isSpecialNode=function(e,t){var n=this.getSpecialNodeUntilTop(e,t);return null!=n&&-1!==(0,a["default"])(c).call(c,n.nodeName)},t.prototype.isSpecialTopNode=function(e){var t;return null!=e&&-1!==(0,a["default"])(d).call(d,null===(t=e.elems[0])||void 0===t?void 0:t.nodeName)},t.prototype.tryChangeActive=function(){},t}(l["default"]);t["default"]=f},function(e,t,n){"use strict";var r=n(0),i=r(n(1)),o=r(n(4));(0,i["default"])(t,"__esModule",{value:!0});var a=n(2),s=a.__importDefault(n(3)),l=a.__importDefault(n(23)),u=a.__importDefault(n(335)),c=a.__importDefault(n(336)),d=n(7),f=function(e){function t(t){var n=this,r=s["default"]('<div class="w-e-menu" data-title="引用">\n                <i class="w-e-icon-quotes-left"></i>\n            </div>');return n=e.call(this,r,t)||this,u["default"](t),n}return a.__extends(t,e),t.prototype.clickHandler=function(){var e,t,n=this.editor,r=n.selection.isSelectionEmpty(),i=n.selection.getSelectionRangeTopNodes(),a=i[i.length-1],l=this.getTopNodeName();if("BLOCKQUOTE"!==l){var u=c["default"](i);if(n.$textElem.equal(a)){var f=null===(e=n.selection.getSelectionContainerElem())||void 0===e?void 0:e.elems[0];n.selection.createRangeByElems(f.children[0],f.children[0]),i=n.selection.getSelectionRangeTopNodes(),u=c["default"](i),a.append(u)}else u.insertAfter(a);this.delSelectNode(i);var h=null===(t=u.childNodes())||void 0===t?void 0:t.last().getNode();if(null==h)return;return h.textContent?n.selection.moveCursor(h):n.selection.moveCursor(h,0),this.tryChangeActive(),void s["default"](d.EMPTY_P).insertAfter(u)}var p=s["default"](a.childNodes()),m=p.length,v=a;(0,o["default"])(p).call(p,(function(e){var t=s["default"](e);t.insertAfter(v),v=t})),a.remove(),n.selection.moveCursor(p.elems[m-1]),this.tryChangeActive(),r&&(n.selection.collapseRange(),n.selection.restoreSelection())},t.prototype.tryChangeActive=function(){var e,t=this.editor,n=null===(e=t.selection.getSelectionRangeTopNodes()[0])||void 0===e?void 0:e.getNodeName();"BLOCKQUOTE"===n?this.active():this.unActive()},t.prototype.getTopNodeName=function(){var e=this.editor,t=e.selection.getSelectionRangeTopNodes()[0],n=null===t||void 0===t?void 0:t.getNodeName();return n},t.prototype.delSelectNode=function(e){(0,o["default"])(e).call(e,(function(e){e.remove()}))},t}(l["default"]);t["default"]=f},function(e,t,n){"use strict";var r=n(0),i=r(n(1));(0,i["default"])(t,"__esModule",{value:!0});var o=n(2),a=n(7),s=o.__importDefault(n(3));function l(e){function t(t){var n,r=e.selection.getSelectionContainerElem(),i=e.selection.getSelectionRangeTopNodes()[0];if("BLOCKQUOTE"===(null===i||void 0===i?void 0:i.getNodeName())){if("BLOCKQUOTE"===r.getNodeName()){var o=null===(n=r.childNodes())||void 0===n?void 0:n.getNode();e.selection.moveCursor(o)}if(""===r.text()){t.preventDefault(),r.remove();var l=s["default"](a.EMPTY_P);l.insertAfter(i),e.selection.moveCursor(l.getNode(),0)}""===i.text()&&i.remove()}}e.txt.eventHooks.enterDownEvents.push(t)}t["default"]=l},function(e,t,n){"use strict";var r=n(0),i=r(n(1)),o=r(n(4));(0,i["default"])(t,"__esModule",{value:!0});var a=n(2),s=a.__importDefault(n(3));function l(e){var t=s["default"]("<blockquote></blockquote>");return(0,o["default"])(e).call(e,(function(e){t.append(e.clone(!0))})),t}t["default"]=l},function(e,t,n){"use strict";var r=n(0),i=r(n(1)),o=r(n(26));(0,i["default"])(t,"__esModule",{value:!0});var a=n(2),s=a.__importDefault(n(24)),l=a.__importDefault(n(3)),u=n(6),c=function(e){function t(t){var n,r=this,i=l["default"]('<div class="w-e-menu" data-title="背景色">\n                <i class="w-e-icon-paint-brush"></i>\n            </div>'),a={width:120,title:"背景颜色",type:"inline-block",list:(0,o["default"])(n=t.config.colors).call(n,(function(e){return{$elem:l["default"]('<i style="color:'+e+';" class="w-e-icon-paint-brush"></i>'),value:e}})),clickHandler:function(e){r.command(e)}};return r=e.call(this,i,t,a)||this,r}return a.__extends(t,e),t.prototype.command=function(e){var t,n=this.editor,r=n.selection.isSelectionEmpty(),i=null===(t=n.selection.getSelectionContainerElem())||void 0===t?void 0:t.elems[0];if(null!=i){var o="p"!==(null===i||void 0===i?void 0:i.nodeName.toLowerCase()),a=null===i||void 0===i?void 0:i.style.backgroundColor,s=u.hexToRgb(e)===a;if(r){if(o&&!s){var l=n.selection.getSelectionRangeTopNodes();n.selection.createRangeByElem(l[0]),n.selection.moveCursor(l[0].elems[0])}n.selection.createEmptyRange()}n.cmd["do"]("backColor",e),r&&(n.selection.collapseRange(),n.selection.restoreSelection())}},t.prototype.tryChangeActive=function(){},t}(s["default"]);t["default"]=c},function(e,t,n){"use strict";var r=n(0),i=r(n(1)),o=r(n(26));(0,i["default"])(t,"__esModule",{value:!0});var a=n(2),s=a.__importDefault(n(24)),l=a.__importDefault(n(3)),u=function(e){function t(t){var n,r=this,i=l["default"]('<div class="w-e-menu" data-title="文字颜色">\n                <i class="w-e-icon-pencil2"></i>\n            </div>'),a={width:120,title:"文字颜色",type:"inline-block",list:(0,o["default"])(n=t.config.colors).call(n,(function(e){return{$elem:l["default"]('<i style="color:'+e+';" class="w-e-icon-pencil2"></i>'),value:e}})),clickHandler:function(e){r.command(e)}};return r=e.call(this,i,t,a)||this,r}return a.__extends(t,e),t.prototype.command=function(e){var t,n=this.editor,r=n.selection.isSelectionEmpty(),i=null===(t=n.selection.getSelectionContainerElem())||void 0===t?void 0:t.elems[0];if(null!=i){var o=n.selection.getSelectionText();if("A"===i.nodeName&&i.textContent===o){var a=l["default"]("<span>&#8203;</span>").getNode();i.appendChild(a)}n.cmd["do"]("foreColor",e),r&&(n.selection.collapseRange(),n.selection.restoreSelection())}},t.prototype.tryChangeActive=function(){},t}(s["default"]);t["default"]=u},function(e,t,n){"use strict";var r=n(0),i=r(n(1));(0,i["default"])(t,"__esModule",{value:!0});var o=n(2),a=o.__importDefault(n(3)),s=o.__importDefault(n(33)),l=o.__importDefault(n(38)),u=o.__importDefault(n(340)),c=o.__importDefault(n(346)),d=function(e){function t(t){var n=this,r=a["default"]('<div class="w-e-menu" data-title="视频">\n                <i class="w-e-icon-play"></i>\n            </div>');return n=e.call(this,r,t)||this,c["default"](t),n}return o.__extends(t,e),t.prototype.clickHandler=function(){this.createPanel("")},t.prototype.createPanel=function(e){var t=u["default"](this.editor,e),n=new s["default"](this,t);n.create()},t.prototype.tryChangeActive=function(){},t}(l["default"]);t["default"]=d},function(e,t,n){"use strict";var r=n(0),i=r(n(1)),o=r(n(17));(0,i["default"])(t,"__esModule",{value:!0});var a=n(2),s=n(6),l=a.__importDefault(n(3)),u=a.__importDefault(n(341)),c=n(7);function d(e,t){var n=e.config,r=new u["default"](e),i=s.getRandom("input-iframe"),a=s.getRandom("btn-ok"),d=s.getRandom("input-upload"),f=s.getRandom("btn-local-ok");function h(t){e.cmd["do"]("insertHTML",t+c.EMPTY_P),e.config.onlineVideoCallback(t)}function p(t){var n=e.config.onlineVideoCheck(t);return!0===n||("string"===typeof n&&e.config.customAlert(n,"error"),!1)}var m=[{title:e.i18next.t("menus.panelMenus.video.上传视频"),tpl:'<div class="w-e-up-video-container">\n                    <div id="'+f+'" class="w-e-up-btn">\n                        <i class="w-e-icon-upload2"></i>\n                    </div>\n                    <div style="display:none;">\n                        <input id="'+d+'" type="file" accept="video/*"/>\n                    </div>\n                 </div>',events:[{selector:"#"+f,type:"click",fn:function(){var e=l["default"]("#"+d),t=e.elems[0];if(!t)return!0;t.click()}},{selector:"#"+d,type:"change",fn:function(){var e=l["default"]("#"+d),t=e.elems[0];if(!t)return!0;var n=t.files;return n.length&&r.uploadVideo(n),!0}}]},{title:e.i18next.t("menus.panelMenus.video.插入视频"),tpl:'<div>\n                    <input \n                        id="'+i+'" \n                        type="text" \n                        class="block" \n                        placeholder="'+e.i18next.t("如")+'：<iframe src=... ></iframe>"/>\n                    </td>\n                    <div class="w-e-button-container">\n                        <button type="button" id="'+a+'" class="right">\n                            '+e.i18next.t("插入")+"\n                        </button>\n                    </div>\n                </div>",events:[{selector:"#"+a,type:"click",fn:function(){var e,t=l["default"]("#"+i),n=(0,o["default"])(e=t.val()).call(e);if(n&&p(n))return h(n),!0},bindEnter:!0}]}],v={width:300,height:0,tabs:[]};return window.FileReader&&(n.uploadVideoServer||n.customUploadVideo)&&v.tabs.push(m[0]),n.showLinkVideo&&v.tabs.push(m[1]),v}t["default"]=d},function(e,t,n){"use strict";var r=n(0),i=r(n(1)),o=r(n(133)),a=r(n(57)),s=r(n(4)),l=r(n(27));(0,i["default"])(t,"__esModule",{value:!0});var u=n(2),c=n(6),d=u.__importDefault(n(135)),f=u.__importDefault(n(136)),h=n(7),p=n(6),m=function(){function e(e){this.editor=e}return e.prototype.uploadVideo=function(e){var t=this;if(e.length){var n=this.editor,r=n.config,i="validate.",u=function(e){return n.i18next.t(i+e)},h=r.uploadVideoServer,p=r.uploadVideoMaxSize,m=p/1024,v=r.uploadVideoName,g=r.uploadVideoParams,y=r.uploadVideoParamsWithUrl,_=r.uploadVideoHeaders,x=r.uploadVideoHooks,b=r.uploadVideoTimeout,w=r.withVideoCredentials,A=r.customUploadVideo,T=r.uploadVideoAccept,S=[],E=[];if(c.arrForEach(e,(function(e){var t=e.name,n=e.size/1024/1024;t&&n&&(T instanceof Array?(0,o["default"])(T).call(T,(function(e){return e===t.split(".")[t.split(".").length-1]}))?m<n?E.push("【"+t+"】"+u("大于")+" "+m+"M"):S.push(e):E.push("【"+t+"】"+u("不是视频")):E.push("【"+T+"】"+u("uploadVideoAccept 不是Array")))})),E.length)r.customAlert(u("视频验证未通过")+": \n"+E.join("\n"),"warning");else if(0!==S.length)if(A&&"function"===typeof A){var C;A(S,(0,a["default"])(C=this.insertVideo).call(C,this))}else{var M=new FormData;if((0,s["default"])(S).call(S,(function(e,t){var n=v||e.name;S.length>1&&(n+=t+1),M.append(n,e)})),h){var L=h.split("#");h=L[0];var N=L[1]||"";(0,s["default"])(c).call(c,g,(function(e,t){y&&((0,l["default"])(h).call(h,"?")>0?h+="&":h+="?",h=h+e+"="+t),M.append(e,t)})),N&&(h+="#"+N);var D=d["default"](h,{timeout:b,formData:M,headers:_,withCredentials:!!w,beforeSend:function(e){if(x.before)return x.before(e,n,S)},onTimeout:function(e){r.customAlert(u("上传视频超时"),"error"),x.timeout&&x.timeout(e,n)},onProgress:function(e,t){var r=new f["default"](n);t.lengthComputable&&(e=t.loaded/t.total,r.show(e))},onError:function(e){r.customAlert(u("上传视频错误"),"error",u("上传视频错误")+"，"+u("服务器返回状态")+": "+e.status),x.error&&x.error(e,n)},onFail:function(e,t){r.customAlert(u("上传视频失败"),"error",u("上传视频返回结果错误")+"，"+u("返回结果")+": "+t),x.fail&&x.fail(e,n,t)},onSuccess:function(e,i){if(x.customInsert){var o;x.customInsert((0,a["default"])(o=t.insertVideo).call(o,t),i,n)}else{if("0"!=i.errno)return r.customAlert(u("上传视频失败"),"error",u("上传视频返回结果错误")+"，"+u("返回结果")+" errno="+i.errno),void(x.fail&&x.fail(e,n,i));var s=i.data;t.insertVideo(s.url),x.success&&x.success(e,n,i)}}});"string"===typeof D&&r.customAlert(D,"error")}}else r.customAlert(u("传入的文件不合法"),"warning")}},e.prototype.insertVideo=function(e){var t=this.editor,n=t.config,r="validate.",i=function(e,n){return void 0===n&&(n=r),t.i18next.t(n+e)};if(n.customInsertVideo)n.customInsertVideo(e);else{p.UA.isFirefox?t.cmd["do"]("insertHTML",'<p data-we-video-p="true"><video src="'+e+'" controls="controls" style="max-width:100%"></video></p><p>&#8203</p>'):t.cmd["do"]("insertHTML",'<video src="'+e+'" controls="controls" style="max-width:100%"></video>'+h.EMPTY_P);var o=document.createElement("video");o.onload=function(){o=null},o.onerror=function(){n.customAlert(i("插入视频错误"),"error","wangEditor: "+i("插入视频错误")+"，"+i("视频链接")+' "'+e+'"，'+i("下载链接失败")),o=null},o.onabort=function(){return o=null},o.src=e}},e}();t["default"]=m},function(e,t,n){e.exports=n(343)},function(e,t,n){var r=n(344);e.exports=r},function(e,t,n){n(345);var r=n(9);e.exports=r.Date.now},function(e,t,n){var r=n(5);r({target:"Date",stat:!0},{now:function(){return(new Date).getTime()}})},function(e,t,n){"use strict";var r=n(0),i=r(n(1));(0,i["default"])(t,"__esModule",{value:!0});var o=n(2),a=o.__importDefault(n(347)),s=o.__importDefault(n(349));function l(e){a["default"](e),s["default"](e)}t["default"]=l},function(e,t,n){"use strict";var r=n(0),i=r(n(1));(0,i["default"])(t,"__esModule",{value:!0}),t.createShowHideFn=void 0;var o=n(2),a=o.__importDefault(n(3)),s=o.__importDefault(n(39)),l=o.__importDefault(n(348));function u(e){var t,n=function(t,n){return void 0===n&&(n=""),e.i18next.t(n+t)};function r(r){var i=[{$elem:a["default"]("<span class='w-e-icon-trash-o'></span>"),onClick:function(e,t){return t.remove(),!0}},{$elem:a["default"]("<span>100%</span>"),onClick:function(e,t){return t.attr("width","100%"),t.removeAttr("height"),!0}},{$elem:a["default"]("<span>50%</span>"),onClick:function(e,t){return t.attr("width","50%"),t.removeAttr("height"),!0}},{$elem:a["default"]("<span>30%</span>"),onClick:function(e,t){return t.attr("width","30%"),t.removeAttr("height"),!0}},{$elem:a["default"]("<span>"+n("重置")+"</span>"),onClick:function(e,t){return t.removeAttr("width"),t.removeAttr("height"),!0}},{$elem:a["default"]("<span>"+n("menus.justify.靠左")+"</span>"),onClick:function(e,t){return l["default"](t,"left"),!0}},{$elem:a["default"]("<span>"+n("menus.justify.居中")+"</span>"),onClick:function(e,t){return l["default"](t,"center"),!0}},{$elem:a["default"]("<span>"+n("menus.justify.靠右")+"</span>"),onClick:function(e,t){return l["default"](t,"right"),!0}}];t=new s["default"](e,r,i),t.create()}function i(){t&&(t.remove(),t=null)}return{showVideoTooltip:r,hideVideoTooltip:i}}function c(e){var t=u(e),n=t.showVideoTooltip,r=t.hideVideoTooltip;e.txt.eventHooks.videoClickEvents.push(n),e.txt.eventHooks.clickEvents.push(r),e.txt.eventHooks.keyupEvents.push(r),e.txt.eventHooks.toolbarClickEvents.push(r),e.txt.eventHooks.menuClickEvents.push(r),e.txt.eventHooks.textScrollEvents.push(r),e.txt.eventHooks.changeEvents.push(r)}t.createShowHideFn=u,t["default"]=c},function(e,t,n){"use strict";var r=n(0),i=r(n(1)),o=r(n(28));(0,i["default"])(t,"__esModule",{value:!0});var a=n(2),s=a.__importDefault(n(3));function l(e,t){var n=["P"],r=u(e,n);r&&s["default"](r).css("text-align",t)}function u(e,t){var n,r=e.elems[0];while(null!=r){if((0,o["default"])(t).call(t,null===r||void 0===r?void 0:r.nodeName))return r;if("BODY"===(null===(n=null===r||void 0===r?void 0:r.parentNode)||void 0===n?void 0:n.nodeName))return null;r=r.parentNode}return r}t["default"]=l},function(e,t,n){"use strict";var r=n(0),i=r(n(1));(0,i["default"])(t,"__esModule",{value:!0});var o=n(6);function a(e){if(o.UA.isFirefox){var t=e.txt,n=e.selection,r=t.eventHooks.keydownEvents;r.push((function(t){var r=n.getSelectionContainerElem();if(r){var i=r.getNodeTop(e),o=i.length&&i.prev().length?i.prev():null;o&&o.attr("data-we-video-p")&&0===n.getCursorPos()&&8===t.keyCode&&o.remove()}}))}}t["default"]=a},function(e,t,n){"use strict";var r=n(0),i=r(n(1)),o=r(n(26));(0,i["default"])(t,"__esModule",{value:!0});var a=n(2),s=n(7),l=a.__importDefault(n(3)),u=a.__importDefault(n(33)),c=a.__importDefault(n(38)),d=a.__importDefault(n(351)),f=a.__importDefault(n(364)),h=function(e){function t(t){var n,r=this,i=l["default"]('<div class="w-e-menu" data-title="图片"><i class="w-e-icon-image"></i></div>'),a=f["default"](t);a.onlyUploadConf&&(i=a.onlyUploadConf.$elem,(0,o["default"])(n=a.onlyUploadConf.events).call(n,(function(e){var t=e.type,n=e.fn||s.EMPTY_FN;i.on(t,(function(e){e.stopPropagation(),n(e)}))})));return r=e.call(this,i,t)||this,r.imgPanelConfig=a,d["default"](t),r}return a.__extends(t,e),t.prototype.clickHandler=function(){this.imgPanelConfig.onlyUploadConf||this.createPanel()},t.prototype.createPanel=function(){var e=this.imgPanelConfig,t=new u["default"](this,e);this.setPanel(t),t.create()},t.prototype.tryChangeActive=function(){},t}(c["default"]);t["default"]=h},function(e,t,n){"use strict";var r=n(0),i=r(n(1));(0,i["default"])(t,"__esModule",{value:!0});var o=n(2),a=o.__importDefault(n(352)),s=o.__importDefault(n(353)),l=o.__importDefault(n(354)),u=o.__importDefault(n(362)),c=o.__importDefault(n(363));function d(e){a["default"](e),s["default"](e),l["default"](e),u["default"](e),c["default"](e)}t["default"]=d},function(e,t,n){"use strict";var r=n(0),i=r(n(1));(0,i["default"])(t,"__esModule",{value:!0});var o=n(2),a=n(131),s=o.__importDefault(n(97));function l(e,t){var n=e.config,r=n.pasteFilterStyle,i=n.pasteIgnoreImg,o=a.getPasteHtml(t,r,i);if(o)return!0;var s=a.getPasteText(t);return!!s}function u(e,t){for(var n,r=(null===(n=t.clipboardData)||void 0===n?void 0:n.types)||[],i=0;i<r.length;i++){var o=r[i];if("Files"===o)return!0}return!1}function c(e,t){if(u(t,e)||!l(t,e)){var n=a.getPasteImgs(e);if(n.length){var r=new s["default"](t);r.uploadImg(n)}}}function d(e){e.txt.eventHooks.pasteEvents.unshift((function(t){c(t,e)}))}t["default"]=d},function(e,t,n){"use strict";var r=n(0),i=r(n(1));(0,i["default"])(t,"__esModule",{value:!0});var o=n(2),a=o.__importDefault(n(97));function s(e){function t(t){var n=t.dataTransfer&&t.dataTransfer.files;if(n&&n.length){var r=new a["default"](e);r.uploadImg(n)}}e.txt.eventHooks.dropEvents.push(t)}t["default"]=s},function(e,t,n){"use strict";var r=n(0),i=r(n(1)),o=r(n(29)),a=r(n(355));(0,i["default"])(t,"__esModule",{value:!0}),t.createShowHideFn=void 0;var s=n(2),l=s.__importDefault(n(3));n(360);var u=n(6);function c(e,t,n,r,i){e.attr("style","width:"+t+"px; height:"+n+"px; left:"+r+"px; top:"+i+"px;")}function d(e,t){var n=l["default"]('<div class="w-e-img-drag-mask">\n            <div class="w-e-img-drag-show-size"></div>\n            <div class="w-e-img-drag-rb"></div>\n         </div>');return n.hide(),t.append(n),n}function f(e,t,n){var r=e.getBoundingClientRect(),i=n.getBoundingClientRect(),s=i.width.toFixed(2),l=i.height.toFixed(2);(0,o["default"])(t).call(t,".w-e-img-drag-show-size").text(s+"px * "+l+"px"),c(t,(0,a["default"])(s),(0,a["default"])(l),i.left-r.left,i.top-r.top),t.show()}function h(e){var t,n=e.$textContainerElem,r=d(e,n);function i(e,n){e.on("click",(function(e){e.stopPropagation()})),e.on("mousedown",".w-e-img-drag-rb",(function(r){if(r.preventDefault(),t){var i=r.clientX,s=r.clientY,u=n.getBoundingClientRect(),d=t.getBoundingClientRect(),f=d.width,h=d.height,p=d.left-u.left,m=d.top-u.top,v=f/h,g=f,y=h,_=l["default"](document);_.on("mousemove",b),_.on("mouseup",w),_.on("mouseleave",x)}function x(){_.off("mousemove",b),_.off("mouseup",w)}function b(t){t.stopPropagation(),t.preventDefault(),g=f+(t.clientX-i),y=h+(t.clientY-s),g/y!=v&&(y=g/v),g=(0,a["default"])(g.toFixed(2)),y=(0,a["default"])(y.toFixed(2)),(0,o["default"])(e).call(e,".w-e-img-drag-show-size").text(g.toFixed(2).replace(".00","")+"px * "+y.toFixed(2).replace(".00","")+"px"),c(e,g,y,p,m)}function w(){t.attr("width",g+""),t.attr("height",y+"");var n=t.getBoundingClientRect();c(e,g,y,n.left-u.left,n.top-u.top),x()}}))}function s(e){if(u.UA.isIE())return!1;e&&(t=e,f(n,r,t))}function h(){(0,o["default"])(n).call(n,".w-e-img-drag-mask").hide()}return i(r,n),l["default"](document).on("click",h),e.beforeDestroy((function(){l["default"](document).off("click",h)})),{showDrag:s,hideDrag:h}}function p(e){var t=h(e),n=t.showDrag,r=t.hideDrag;e.txt.eventHooks.imgClickEvents.push(n),e.txt.eventHooks.textScrollEvents.push(r),e.txt.eventHooks.keyupEvents.push(r),e.txt.eventHooks.toolbarClickEvents.push(r),e.txt.eventHooks.menuClickEvents.push(r),e.txt.eventHooks.changeEvents.push(r)}t.createShowHideFn=h,t["default"]=p},function(e,t,n){e.exports=n(356)},function(e,t,n){var r=n(357);e.exports=r},function(e,t,n){n(358);var r=n(9);e.exports=r.parseFloat},function(e,t,n){var r=n(5),i=n(359);r({global:!0,forced:parseFloat!=i},{parseFloat:i})},function(e,t,n){var r=n(8),i=n(90).trim,o=n(68),a=r.parseFloat,s=1/a(o+"-0")!==-1/0;e.exports=s?function(e){var t=i(String(e)),n=a(t);return 0===n&&"-"==t.charAt(0)?-0:n}:a},function(e,t,n){var r=n(20),i=n(361);i=i.__esModule?i.default:i,"string"===typeof i&&(i=[[e.i,i,""]]);var o={insert:"head",singleton:!1};r(i,o);e.exports=i.locals||{}},function(e,t,n){var r=n(21);t=r(!1),t.push([e.i,".w-e-text-container {\n  overflow: hidden;\n}\n.w-e-img-drag-mask {\n  position: absolute;\n  z-index: 1;\n  border: 1px dashed #ccc;\n  box-sizing: border-box;\n}\n.w-e-img-drag-mask .w-e-img-drag-rb {\n  position: absolute;\n  right: -5px;\n  bottom: -5px;\n  width: 16px;\n  height: 16px;\n  border-radius: 50%;\n  background: #ccc;\n  cursor: se-resize;\n}\n.w-e-img-drag-mask .w-e-img-drag-show-size {\n  min-width: 110px;\n  height: 22px;\n  line-height: 22px;\n  font-size: 14px;\n  color: #999;\n  position: absolute;\n  left: 0;\n  top: 0;\n  background-color: #999;\n  color: #fff;\n  border-radius: 2px;\n  padding: 0 5px;\n}\n",""]),e.exports=t},function(e,t,n){"use strict";var r=n(0),i=r(n(1));(0,i["default"])(t,"__esModule",{value:!0}),t.createShowHideFn=void 0;var o=n(2),a=o.__importDefault(n(3)),s=o.__importDefault(n(39));function l(e){var t,n=function(t,n){return void 0===n&&(n=""),e.i18next.t(n+t)};function r(r){var i=[{$elem:a["default"]("<span class='w-e-icon-trash-o'></span>"),onClick:function(e,t){return e.selection.createRangeByElem(t),e.selection.restoreSelection(),e.cmd["do"]("delete"),!0}},{$elem:a["default"]("<span>30%</span>"),onClick:function(e,t){return t.attr("width","30%"),t.removeAttr("height"),!0}},{$elem:a["default"]("<span>50%</span>"),onClick:function(e,t){return t.attr("width","50%"),t.removeAttr("height"),!0}},{$elem:a["default"]("<span>100%</span>"),onClick:function(e,t){return t.attr("width","100%"),t.removeAttr("height"),!0}}];i.push({$elem:a["default"]("<span>"+n("重置")+"</span>"),onClick:function(e,t){return t.removeAttr("width"),t.removeAttr("height"),!0}}),r.attr("data-href")&&i.push({$elem:a["default"]("<span>"+n("查看链接")+"</span>"),onClick:function(e,t){var n=t.attr("data-href");return n&&(n=decodeURIComponent(n),window.open(n,"_target")),!0}}),t=new s["default"](e,r,i),t.create()}function i(){t&&(t.remove(),t=null)}return{showImgTooltip:r,hideImgTooltip:i}}function u(e){var t=l(e),n=t.showImgTooltip,r=t.hideImgTooltip;e.txt.eventHooks.imgClickEvents.push(n),e.txt.eventHooks.clickEvents.push(r),e.txt.eventHooks.keyupEvents.push(r),e.txt.eventHooks.toolbarClickEvents.push(r),e.txt.eventHooks.menuClickEvents.push(r),e.txt.eventHooks.textScrollEvents.push(r),e.txt.eventHooks.imgDragBarMouseDownEvents.push(r),e.txt.eventHooks.changeEvents.push(r)}t.createShowHideFn=l,t["default"]=u},function(e,t,n){"use strict";var r=n(0),i=r(n(1));function o(e){var t=e.txt,n=e.selection,r=t.eventHooks.keydownEvents;r.push((function(e){var t=n.getSelectionContainerElem(),r=n.getRange();if(r&&t&&8===e.keyCode&&n.isSelectionEmpty()){var i=r.startContainer,o=r.startOffset,a=null;if(0===o)while(i!==t.elems[0]&&t.elems[0].contains(i)&&i.parentNode&&!a){if(i.previousSibling){a=i.previousSibling;break}i=i.parentNode}else 3!==i.nodeType&&(a=i.childNodes[o-1]);if(a){var s=a;while(s.childNodes.length)s=s.childNodes[s.childNodes.length-1];s instanceof HTMLElement&&"IMG"===s.tagName&&(s.remove(),e.preventDefault())}}}))}(0,i["default"])(t,"__esModule",{value:!0}),t["default"]=o},function(e,t,n){"use strict";var r=n(0),i=r(n(1)),o=r(n(26)),a=r(n(17));(0,i["default"])(t,"__esModule",{value:!0});var s=n(2),l=s.__importDefault(n(3)),u=n(6),c=s.__importDefault(n(97));function d(e){var t,n=e.config,r=new c["default"](e),i=u.getRandom("up-trigger-id"),s=u.getRandom("up-file-id"),d=u.getRandom("input-link-url"),f=u.getRandom("input-link-url-alt"),h=u.getRandom("input-link-url-href"),p=u.getRandom("btn-link"),m="menus.panelMenus.image.",v=function(t,n){return void 0===n&&(n=m),e.i18next.t(n+t)};function g(e,t,r){var i=n.linkImgCheck(e);return!0===i||("string"===typeof i&&n.customAlert(i,"error"),!1)}var y=1===n.uploadImgMaxLength?"":'multiple="multiple"',_=(0,o["default"])(t=n.uploadImgAccept).call(t,(function(e){return"image/"+e})).join(","),x=function(e,t,n){return'<div class="'+e+'" data-title="'+n+'">\n            <div id="'+i+'" class="w-e-up-btn">\n                <i class="'+t+'"></i>\n            </div>\n            <div style="display:none;">\n                <input id="'+s+'" type="file" '+y+' accept="'+_+'"/>\n            </div>\n        </div>'},b=[{selector:"#"+i,type:"click",fn:function(){var e=n.uploadImgFromMedia;if(e&&"function"===typeof e)return e(),!0;var t=l["default"]("#"+s),r=t.elems[0];if(!r)return!0;r.click()}},{selector:"#"+s,type:"change",fn:function(){var e=l["default"]("#"+s),t=e.elems[0];if(!t)return!0;var n=t.files;return(null===n||void 0===n?void 0:n.length)&&r.uploadImg(n),t&&(t.value=""),!0}}],w=['<input\n            id="'+d+'"\n            type="text"\n            class="block"\n            placeholder="'+v("图片地址")+'"/>'];n.showLinkImgAlt&&w.push('\n        <input\n            id="'+f+'"\n            type="text"\n            class="block"\n            placeholder="'+v("图片文字说明")+'"/>'),n.showLinkImgHref&&w.push('\n        <input\n            id="'+h+'"\n            type="text"\n            class="block"\n            placeholder="'+v("跳转链接")+'"/>');var A=[{title:v("上传图片"),tpl:x("w-e-up-img-container","w-e-icon-upload2",""),events:b},{title:v("网络图片"),tpl:"<div>\n                    "+w.join("")+'\n                    <div class="w-e-button-container">\n                        <button type="button" id="'+p+'" class="right">'+v("插入","")+"</button>\n                    </div>\n                </div>",events:[{selector:"#"+p,type:"click",fn:function(){var e,t=l["default"]("#"+d),i=(0,a["default"])(e=t.val()).call(e);if(i){var o,s,u,c;if(n.showLinkImgAlt)o=(0,a["default"])(s=l["default"]("#"+f).val()).call(s);if(n.showLinkImgHref)u=(0,a["default"])(c=l["default"]("#"+h).val()).call(c);if(g(i,o,u))return r.insertImg(i,o,u),!0}},bindEnter:!0}]}],T={width:300,height:0,tabs:[],onlyUploadConf:{$elem:l["default"](x("w-e-menu","w-e-icon-image","图片")),events:b}};return window.FileReader&&(n.uploadImgShowBase64||n.uploadImgServer||n.customUploadImg||n.uploadImgFromMedia)&&T.tabs.push(A[0]),n.showLinkImg&&(T.tabs.push(A[1]),T.onlyUploadConf=void 0),T}t["default"]=d},function(e,t,n){"use strict";var r=n(0),i=r(n(1)),o=r(n(4));(0,i["default"])(t,"__esModule",{value:!0});var a=n(2),s=a.__importDefault(n(3)),l=a.__importDefault(n(24)),u=a.__importDefault(n(366)),c=function(e){function t(t){var n=this,r=s["default"]('<div class="w-e-menu" data-title="缩进">\n                <i class="w-e-icon-indent-increase"></i>\n            </div>'),i={width:130,title:"设置缩进",type:"list",list:[{$elem:s["default"]('<p>\n                            <i class="w-e-icon-indent-increase w-e-drop-list-item"></i>\n                            '+t.i18next.t("menus.dropListMenu.indent.增加缩进")+"\n                        <p>"),value:"increase"},{$elem:s["default"]('<p>\n                            <i class="w-e-icon-indent-decrease w-e-drop-list-item"></i>\n                            '+t.i18next.t("menus.dropListMenu.indent.减少缩进")+"\n                        <p>"),value:"decrease"}],clickHandler:function(e){n.command(e)}};return n=e.call(this,r,t,i)||this,n}return a.__extends(t,e),t.prototype.command=function(e){var t=this.editor,n=t.selection.getSelectionContainerElem();if(n&&t.$textElem.equal(n)){var r=t.selection.getSelectionRangeTopNodes();r.length>0&&(0,o["default"])(r).call(r,(function(n){u["default"](s["default"](n),e,t)}))}else n&&n.length>0&&(0,o["default"])(n).call(n,(function(n){u["default"](s["default"](n),e,t)}));t.selection.restoreSelection(),this.tryChangeActive()},t.prototype.tryChangeActive=function(){var e=this.editor,t=e.selection.getSelectionStartElem(),n=s["default"](t).getNodeTop(e);n.length<=0||(""!=n.elems[0].style["paddingLeft"]?this.active():this.unActive())},t}(l["default"]);t["default"]=c},function(e,t,n){"use strict";var r=n(0),i=r(n(1)),o=r(n(45)),a=r(n(17));(0,i["default"])(t,"__esModule",{value:!0});var s=n(2),l=s.__importDefault(n(367)),u=s.__importDefault(n(368)),c=/^(\d+)(\w+)$/,d=/^(\d+)%$/;function f(e){var t=e.config.indentation;if("string"===typeof t){if(c.test(t)){var n,r=(0,o["default"])(n=(0,a["default"])(t).call(t).match(c)).call(n,1,3),i=r[0],s=r[1];return{value:Number(i),unit:s}}if(d.test(t))return{value:Number((0,a["default"])(t).call(t).match(d)[1]),unit:"%"}}else if(void 0!==t.value&&t.unit)return t;return{value:2,unit:"em"}}function h(e,t,n){var r=e.getNodeTop(n),i=/^(P|H[0-9]*)$/;i.test(r.getNodeName())&&("increase"===t?l["default"](r,f(n)):"decrease"===t&&u["default"](r,f(n)))}t["default"]=h},function(e,t,n){"use strict";var r=n(0),i=r(n(1)),o=r(n(45));function a(e,t){var n=e.elems[0];if(""===n.style["paddingLeft"])e.css("padding-left",t.value+t.unit);else{var r=n.style["paddingLeft"],i=(0,o["default"])(r).call(r,0,r.length-t.unit.length),a=Number(i)+t.value;e.css("padding-left",""+a+t.unit)}}(0,i["default"])(t,"__esModule",{value:!0}),t["default"]=a},function(e,t,n){"use strict";var r=n(0),i=r(n(1)),o=r(n(45));function a(e,t){var n=e.elems[0];if(""!==n.style["paddingLeft"]){var r=n.style["paddingLeft"],i=(0,o["default"])(r).call(r,0,r.length-t.unit.length),a=Number(i)-t.value;a>0?e.css("padding-left",""+a+t.unit):e.css("padding-left","")}}(0,i["default"])(t,"__esModule",{value:!0}),t["default"]=a},function(e,t,n){"use strict";var r=n(0),i=r(n(1));(0,i["default"])(t,"__esModule",{value:!0});var o=n(2),a=o.__importDefault(n(3)),s=o.__importDefault(n(38)),l=o.__importDefault(n(33)),u=o.__importDefault(n(370)),c=function(e){function t(t){var n=this,r=a["default"]('<div class="w-e-menu" data-title="表情">\n                <i class="w-e-icon-happy"></i>\n            </div>');return n=e.call(this,r,t)||this,n}return o.__extends(t,e),t.prototype.createPanel=function(){var e=u["default"](this.editor),t=new l["default"](this,e);t.create()},t.prototype.clickHandler=function(){this.createPanel()},t.prototype.tryChangeActive=function(){},t}(s["default"]);t["default"]=c},function(e,t,n){"use strict";var r=n(0),i=r(n(1)),o=r(n(26)),a=r(n(70)),s=r(n(17));(0,i["default"])(t,"__esModule",{value:!0});var l=n(2),u=l.__importDefault(n(3));function c(e){var t=e.config.emotions;function n(e){var t,n,r=[];"image"==e.type?(r=(0,o["default"])(t=e.content).call(t,(function(e){return"string"==typeof e?"":'<span  title="'+e.alt+'">\n                    <img class="eleImg" data-emoji="'+e.alt+'" style src="'+e.src+'" alt="['+e.alt+']">\n                </span>'})),r=(0,a["default"])(r).call(r,(function(e){return""!==e}))):r=(0,o["default"])(n=e.content).call(n,(function(e){return'<span class="eleImg" title="'+e+'">'+e+"</span>"}));return r.join("").replace(/&nbsp;/g,"")}var r=(0,o["default"])(t).call(t,(function(t){return{title:e.i18next.t("menus.panelMenus.emoticon."+t.title),tpl:"<div>"+n(t)+"</div>",events:[{selector:".eleImg",type:"click",fn:function(t){var n,r,i=u["default"](t.target),o=i.getNodeName();"IMG"===o?n=(0,s["default"])(r=i.parent().html()).call(r):n="<span>"+i.html()+"</span>";return e.cmd["do"]("insertHTML",n),!0}}]}})),i={width:300,height:230,tabs:r};return i}t["default"]=c},function(e,t,n){"use strict";var r=n(0),i=r(n(1));(0,i["default"])(t,"__esModule",{value:!0}),t.createListHandle=t.ClassType=void 0;var o,a=n(2),s=a.__importDefault(n(3)),l=a.__importDefault(n(372)),u=a.__importDefault(n(374)),c=a.__importDefault(n(375)),d=a.__importDefault(n(376)),f=a.__importDefault(n(377));(function(e){e["Wrap"]="WrapListHandle",e["Join"]="JoinListHandle",e["StartJoin"]="StartJoinListHandle",e["EndJoin"]="EndJoinListHandle",e["Other"]="OtherListHandle"})(o=t.ClassType||(t.ClassType={}));var h={WrapListHandle:l["default"],JoinListHandle:u["default"],StartJoinListHandle:c["default"],EndJoinListHandle:d["default"],OtherListHandle:f["default"]};function p(e,t,n){if(e===o.Other&&void 0===n)throw new Error("other 类需要传入 range");return e!==o.Other?new h[e](t):new h[e](t,n)}t.createListHandle=p;var m=function(){function e(e){this.handle=e,this.handle.exec()}return e.prototype.getSelectionRangeElem=function(){return s["default"](this.handle.selectionRangeElem.get())},e}();t["default"]=m},function(e,t,n){"use strict";var r=n(0),i=r(n(1)),o=r(n(4));(0,i["default"])(t,"__esModule",{value:!0});var a=n(2),s=a.__importDefault(n(3)),l=n(58),u=n(47),c=function(e){function t(t){return e.call(this,t)||this}return a.__extends(t,e),t.prototype.exec=function(){var e,t=this.options,n=t.listType,r=t.listTarget,i=t.$selectionElem,a=t.$startElem,l=t.$endElem,c=[],d=null===i||void 0===i?void 0:i.getNodeName(),f=a.prior,h=l.prior;if(!a.prior&&!l.prior||!(null===f||void 0===f?void 0:f.prev().length)&&!(null===h||void 0===h?void 0:h.next().length)){var p;(0,o["default"])(p=null===i||void 0===i?void 0:i.children()).call(p,(function(e){c.push(s["default"](e))})),d===n?e=u.createElementFragment(c,u.createDocumentFragment(),"p"):(e=u.createElement(r),(0,o["default"])(c).call(c,(function(t){e.appendChild(t.elems[0])}))),this.selectionRangeElem.set(e),u.insertBefore(i,e,i.elems[0]),i.remove()}else{var m=f;while(m.length)c.push(m),m=(null===h||void 0===h?void 0:h.equal(m))?s["default"](void 0):m.next();var v=f.prev(),g=h.next();if(d===n?e=u.createElementFragment(c,u.createDocumentFragment(),"p"):(e=u.createElement(r),(0,o["default"])(c).call(c,(function(t){e.append(t.elems[0])}))),v.length&&g.length){var y=[];while(g.length)y.push(g),g=g.next();var _=u.createElement(d);(0,o["default"])(y).call(y,(function(e){_.append(e.elems[0])})),s["default"](_).insertAfter(i),this.selectionRangeElem.set(e);var x=i.next();x.length?u.insertBefore(i,e,x.elems[0]):i.parent().elems[0].append(e)}else if(v.length){this.selectionRangeElem.set(e);x=i.next();x.length?u.insertBefore(i,e,x.elems[0]):i.parent().elems[0].append(e)}else this.selectionRangeElem.set(e),u.insertBefore(i,e,i.elems[0])}},t}(l.ListHandle);t["default"]=c},function(e,t,n){"use strict";var r=n(0),i=r(n(1)),o=r(n(4));(0,i["default"])(t,"__esModule",{value:!0});var a=function(){function e(){this._element=null}return e.prototype.set=function(e){if(e instanceof DocumentFragment){var t,n=[];(0,o["default"])(t=e.childNodes).call(t,(function(e){n.push(e)})),e=n}this._element=e},e.prototype.get=function(){return this._element},e.prototype.clear=function(){this._element=null},e}();t["default"]=a},function(e,t,n){"use strict";var r=n(0),i=r(n(1)),o=r(n(4));(0,i["default"])(t,"__esModule",{value:!0});var a=n(2),s=a.__importDefault(n(3)),l=n(58),u=n(47),c=function(e){function t(t){return e.call(this,t)||this}return a.__extends(t,e),t.prototype.exec=function(){var e,t,n,r,i,a,l,c,d=this.options,f=d.editor,h=d.listType,p=d.listTarget,m=d.$startElem,v=d.$endElem,g=f.selection.getSelectionRangeTopNodes(),y=null===m||void 0===m?void 0:m.getNodeName(),_=null===v||void 0===v?void 0:v.getNodeName();if(y===_)if(g.length>2)if(g.shift(),g.pop(),c=u.createElementFragment(u.filterSelectionNodes(g),u.createDocumentFragment()),y===h)null===(e=v.children())||void 0===e||(0,o["default"])(e).call(e,(function(e){c.append(e)})),v.remove(),this.selectionRangeElem.set(c),m.elems[0].append(c);else{var x=document.createDocumentFragment(),b=document.createDocumentFragment(),w=u.getStartPoint(m);while(w.length){var A=w.elems[0];w=w.next(),x.append(A)}var T=u.getEndPoint(v),S=[];while(T.length)S.unshift(T.elems[0]),T=T.prev();(0,o["default"])(S).call(S,(function(e){b.append(e)}));var E=u.createElement(p);E.append(x),E.append(c),E.append(b),c=E,this.selectionRangeElem.set(c),s["default"](E).insertAfter(m),!(null===(t=m.children())||void 0===t?void 0:t.length)&&m.remove(),!(null===(n=v.children())||void 0===n?void 0:n.length)&&v.remove()}else{g.length=0;w=u.getStartPoint(m);while(w.length)g.push(w),w=w.next();T=u.getEndPoint(v),S=[];while(T.length)S.unshift(T),T=T.prev();g.push.apply(g,S),y===h?(c=u.createElementFragment(g,u.createDocumentFragment(),"p"),this.selectionRangeElem.set(c),u.insertBefore(m,c,v.elems[0])):(c=u.createElement(p),(0,o["default"])(g).call(g,(function(e){c.append(e.elems[0])})),this.selectionRangeElem.set(c),s["default"](c).insertAfter(m)),!(null===(r=m.children())||void 0===r?void 0:r.length)&&v.remove(),!(null===(i=v.children())||void 0===i?void 0:i.length)&&v.remove()}else{var C=[];T=u.getEndPoint(v);while(T.length)C.unshift(T),T=T.prev();var M=[];w=u.getStartPoint(m);while(w.length)M.push(w),w=w.next();if(c=u.createDocumentFragment(),g.shift(),g.pop(),(0,o["default"])(M).call(M,(function(e){return c.append(e.elems[0])})),c=u.createElementFragment(u.filterSelectionNodes(g),c),(0,o["default"])(C).call(C,(function(e){return c.append(e.elems[0])})),this.selectionRangeElem.set(c),y===h)m.elems[0].append(c),!(null===(a=v.children())||void 0===a?void 0:a.length)&&v.remove();else if(null===(l=v.children())||void 0===l?void 0:l.length){var L=v.children();u.insertBefore(L,c,L.elems[0])}else v.elems[0].append(c)}},t}(l.ListHandle);t["default"]=c},function(e,t,n){"use strict";var r=n(0),i=r(n(1)),o=r(n(4));(0,i["default"])(t,"__esModule",{value:!0});var a=n(2),s=a.__importDefault(n(3)),l=n(58),u=n(47),c=function(e){function t(t){return e.call(this,t)||this}return a.__extends(t,e),t.prototype.exec=function(){var e,t,n=this.options,r=n.editor,i=n.listType,a=n.listTarget,l=n.$startElem,c=r.selection.getSelectionRangeTopNodes(),d=null===l||void 0===l?void 0:l.getNodeName();c.shift();var f=[],h=u.getStartPoint(l);while(h.length)f.push(h),h=h.next();d===i?(t=u.createDocumentFragment(),(0,o["default"])(f).call(f,(function(e){return t.append(e.elems[0])})),t=u.createElementFragment(u.filterSelectionNodes(c),t),this.selectionRangeElem.set(t),l.elems[0].append(t)):(t=u.createElement(a),(0,o["default"])(f).call(f,(function(e){return t.append(e.elems[0])})),t=u.createElementFragment(u.filterSelectionNodes(c),t),this.selectionRangeElem.set(t),s["default"](t).insertAfter(l),!(null===(e=l.children())||void 0===e?void 0:e.length)&&l.remove())},t}(l.ListHandle);t["default"]=c},function(e,t,n){"use strict";var r=n(0),i=r(n(1)),o=r(n(4));(0,i["default"])(t,"__esModule",{value:!0});var a=n(2),s=a.__importDefault(n(3)),l=n(58),u=n(47),c=function(e){function t(t){return e.call(this,t)||this}return a.__extends(t,e),t.prototype.exec=function(){var e,t,n,r=this.options,i=r.editor,a=r.listType,l=r.listTarget,c=r.$endElem,d=i.selection.getSelectionRangeTopNodes(),f=null===c||void 0===c?void 0:c.getNodeName();d.pop();var h=[],p=u.getEndPoint(c);while(p.length)h.unshift(p),p=p.prev();if(f===a)if(n=u.createElementFragment(u.filterSelectionNodes(d),u.createDocumentFragment()),(0,o["default"])(h).call(h,(function(e){return n.append(e.elems[0])})),this.selectionRangeElem.set(n),null===(e=c.children())||void 0===e?void 0:e.length){var m=c.children();u.insertBefore(m,n,m.elems[0])}else c.elems[0].append(n);else{var v=u.filterSelectionNodes(d);v.push.apply(v,h),n=u.createElementFragment(v,u.createElement(l)),this.selectionRangeElem.set(n),s["default"](n).insertBefore(c),!(null===(t=c.children())||void 0===t?void 0:t.length)&&c.remove()}},t}(l.ListHandle);t["default"]=c},function(e,t,n){"use strict";var r=n(0),i=r(n(1));(0,i["default"])(t,"__esModule",{value:!0});var o=n(2),a=n(58),s=n(47),l=function(e){function t(t,n){var r=e.call(this,t)||this;return r.range=n,r}return o.__extends(t,e),t.prototype.exec=function(){var e=this.options,t=e.editor,n=e.listTarget,r=t.selection.getSelectionRangeTopNodes(),i=s.createElementFragment(s.filterSelectionNodes(r),s.createElement(n));this.selectionRangeElem.set(i),this.range.insertNode(i)},t}(a.ListHandle);t["default"]=l},function(e,t,n){"use strict";var r=n(0),i=r(n(1)),o=r(n(4)),a=r(n(27));(0,i["default"])(t,"__esModule",{value:!0});var s=n(2),l=s.__importDefault(n(24)),u=s.__importDefault(n(3)),c=s.__importDefault(n(379)),d=function(e){function t(t){var n=this,r=u["default"]('<div class="w-e-menu" data-title="行高">\n                    <i class="w-e-icon-row-height"></i>\n                </div>'),i=new c["default"](t,t.config.lineHeights),o={width:100,title:"设置行高",type:"list",list:i.getItemList(),clickHandler:function(e){t.selection.saveRange(),n.command(e)}};return n=e.call(this,r,t,o)||this,n}return s.__extends(t,e),t.prototype.command=function(e){var t=this.editor;t.selection.restoreSelection();var n=u["default"](t.selection.getSelectionContainerElem());if(n.elems.length)if(n&&t.$textElem.equal(n)){for(var r=!1,i=u["default"](t.selection.getSelectionStartElem()).elems[0],o=u["default"](t.selection.getSelectionEndElem()).elems[0],a=this.getDom(i),s=this.getDom(o),l=n.elems[0].children,c=0;c<l.length;c++){var d=l[c];if("P"===u["default"](d).getNodeName()&&(d===a&&(r=!0),r&&(u["default"](d).css("line-height",e),d===s)))return void(r=!1)}t.selection.createRangeByElems(i,o)}else{var f=n.elems[0],h=this.getDom(f);"P"===u["default"](h).getNodeName()&&(u["default"](h).css("line-height",e),t.selection.createRangeByElems(h,h))}},t.prototype.getDom=function(e){var t=u["default"](e).elems[0];if(!t.parentNode)return t;function n(e,t){var r=u["default"](e.parentNode);return t.$textElem.equal(r)?e:n(r.elems[0],t)}return t=n(t,this.editor),t},t.prototype.styleProcessing=function(e){var t="";return(0,o["default"])(e).call(e,(function(e){""!==e&&-1===(0,a["default"])(e).call(e,"line-height")&&(t=t+e+";")})),t},t.prototype.setRange=function(e,t){var n=this.editor,r=window.getSelection?window.getSelection():document.getSelection();null===r||void 0===r||r.removeAllRanges();var i=document.createRange(),o=e,a=t;i.setStart(o,0),i.setEnd(a,1),null===r||void 0===r||r.addRange(i),n.selection.saveRange(),null===r||void 0===r||r.removeAllRanges(),n.selection.restoreSelection()},t.prototype.tryChangeActive=function(){var e=this.editor,t=e.selection.getSelectionContainerElem();if(!t||!e.$textElem.equal(t)){var n=u["default"](e.selection.getSelectionStartElem());if(0!==n.length){n=this.getDom(n.elems[0]);var r=n.getAttribute("style")?n.getAttribute("style"):"";r&&-1!==(0,a["default"])(r).call(r,"line-height")?this.active():this.unActive()}}},t}(l["default"]);t["default"]=d},function(e,t,n){"use strict";var r=n(0),i=r(n(1)),o=r(n(4));(0,i["default"])(t,"__esModule",{value:!0});var a=n(2),s=a.__importDefault(n(3)),l=function(){function e(e,t){var n=this;this.itemList=[{$elem:s["default"]("<span>"+e.i18next.t("默认")+"</span>"),value:""}],(0,o["default"])(t).call(t,(function(e){n.itemList.push({$elem:s["default"]("<span>"+e+"</span>"),value:e})}))}return e.prototype.getItemList=function(){return this.itemList},e}();t["default"]=l},function(e,t,n){"use strict";var r=n(0),i=r(n(1));(0,i["default"])(t,"__esModule",{value:!0});var o=n(2),a=o.__importDefault(n(3)),s=o.__importDefault(n(23)),l=function(e){function t(t){var n=this,r=a["default"]('<div class="w-e-menu" data-title="撤销">\n                <i class="w-e-icon-undo"></i>\n            </div>');return n=e.call(this,r,t)||this,n}return o.__extends(t,e),t.prototype.clickHandler=function(){var e=this.editor;e.history.revoke();var t=e.$textElem.children();if(null===t||void 0===t?void 0:t.length){var n=t.last();e.selection.createRangeByElem(n,!1,!0),e.selection.restoreSelection()}},t.prototype.tryChangeActive=function(){this.editor.isCompatibleMode||(this.editor.history.size[0]?this.active():this.unActive())},t}(s["default"]);t["default"]=l},function(e,t,n){"use strict";var r=n(0),i=r(n(1));(0,i["default"])(t,"__esModule",{value:!0});var o=n(2),a=o.__importDefault(n(3)),s=o.__importDefault(n(23)),l=function(e){function t(t){var n=this,r=a["default"]('<div class="w-e-menu" data-title="恢复">\n                <i class="w-e-icon-redo"></i>\n            </div>');return n=e.call(this,r,t)||this,n}return o.__extends(t,e),t.prototype.clickHandler=function(){var e=this.editor;e.history.restore();var t=e.$textElem.children();if(null===t||void 0===t?void 0:t.length){var n=t.last();e.selection.createRangeByElem(n,!1,!0),e.selection.restoreSelection()}},t.prototype.tryChangeActive=function(){this.editor.isCompatibleMode||(this.editor.history.size[1]?this.active():this.unActive())},t}(s["default"]);t["default"]=l},function(e,t,n){"use strict";var r=n(0),i=r(n(1));(0,i["default"])(t,"__esModule",{value:!0});var o=n(2),a=o.__importDefault(n(38)),s=o.__importDefault(n(3)),l=o.__importDefault(n(383)),u=o.__importDefault(n(33)),c=o.__importDefault(n(392)),d=function(e){function t(t){var n=this,r=s["default"]('<div class="w-e-menu" data-title="表格"><i class="w-e-icon-table2"></i></div>');return n=e.call(this,r,t)||this,c["default"](t),n}return o.__extends(t,e),t.prototype.clickHandler=function(){this.createPanel()},t.prototype.createPanel=function(){var e=l["default"](this.editor),t=new u["default"](this,e);t.create()},t.prototype.tryChangeActive=function(){},t}(a["default"]);t["default"]=d},function(e,t,n){"use strict";var r=n(0),i=r(n(1)),o=r(n(384));(0,i["default"])(t,"__esModule",{value:!0});var a=n(2),s=n(6),l=a.__importDefault(n(3));n(389);var u=a.__importDefault(n(391));function c(e){return e>0&&(0,o["default"])(e)}function d(e){var t=new u["default"](e),n=s.getRandom("w-col-id"),r=s.getRandom("w-row-id"),i=s.getRandom("btn-link"),o="menus.panelMenus.table.",a=function(t){return e.i18next.t(t)},d=[{title:a(o+"插入表格"),tpl:'<div>\n                    <div class="w-e-table">\n                        <span>'+a("创建")+'</span>\n                        <input id="'+r+'"  type="text" class="w-e-table-input" value="5"/></td>\n                        <span>'+a(o+"行")+'</span>\n                        <input id="'+n+'" type="text" class="w-e-table-input" value="5"/></td>\n                        <span>'+(a(o+"列")+a(o+"的")+a(o+"表格"))+'</span>\n                    </div>\n                    <div class="w-e-button-container">\n                        <button type="button" id="'+i+'" class="right">'+a("插入")+"</button>\n                    </div>\n                </div>",events:[{selector:"#"+i,type:"click",fn:function(){var i=Number(l["default"]("#"+n).val()),o=Number(l["default"]("#"+r).val());return c(o)&&c(i)?(t.createAction(o,i),!0):(e.config.customAlert("表格行列请输入正整数","warning"),!1)},bindEnter:!0}]}],f={width:330,height:0,tabs:[]};return f.tabs.push(d[0]),f}t["default"]=d},function(e,t,n){e.exports=n(385)},function(e,t,n){var r=n(386);e.exports=r},function(e,t,n){n(387);var r=n(9);e.exports=r.Number.isInteger},function(e,t,n){var r=n(5),i=n(388);r({target:"Number",stat:!0},{isInteger:i})},function(e,t,n){var r=n(13),i=Math.floor;e.exports=function(e){return!r(e)&&isFinite(e)&&i(e)===e}},function(e,t,n){var r=n(20),i=n(390);i=i.__esModule?i.default:i,"string"===typeof i&&(i=[[e.i,i,""]]);var o={insert:"head",singleton:!1};r(i,o);e.exports=i.locals||{}},function(e,t,n){var r=n(21);t=r(!1),t.push([e.i,".w-e-table {\n  display: flex;\n}\n.w-e-table .w-e-table-input {\n  width: 40px;\n  text-align: center!important;\n  margin: 0 5px;\n}\n",""]),e.exports=t},function(e,t,n){"use strict";var r=n(0),i=r(n(1));(0,i["default"])(t,"__esModule",{value:!0});var o=n(2),a=n(7),s=o.__importDefault(n(3)),l=function(){function e(e){this.editor=e}return e.prototype.createAction=function(e,t){var n=this.editor,r=s["default"](n.selection.getSelectionContainerElem()),i=s["default"](r.elems[0]).parentUntilEditor("UL",n),o=s["default"](r.elems[0]).parentUntilEditor("OL",n);if(!i&&!o){var a=this.createTableHtml(e,t);n.cmd["do"]("insertHTML",a)}},e.prototype.createTableHtml=function(e,t){for(var n="",r="",i=0;i<e;i++){r="";for(var o=0;o<t;o++)r+=0===i?"<th></th>":"<td></td>";n=n+"<tr>"+r+"</tr>"}var s='<table border="0" width="100%" cellpadding="0" cellspacing="0"><tbody>'+n+"</tbody></table>"+a.EMPTY_P;return s},e}();t["default"]=l},function(e,t,n){"use strict";var r=n(0),i=r(n(1));(0,i["default"])(t,"__esModule",{value:!0});var o=n(2),a=o.__importDefault(n(393)),s=n(400);function l(e){a["default"](e),s.bindEventKeyboardEvent(e),s.bindClickEvent(e)}t["default"]=l},function(e,t,n){"use strict";var r=n(0),i=r(n(1));(0,i["default"])(t,"__esModule",{value:!0});var o=n(2),a=o.__importDefault(n(3)),s=o.__importDefault(n(39)),l=o.__importDefault(n(394)),u=o.__importDefault(n(399)),c=n(7);function d(e){var t;function n(n){var r=new u["default"](e),i="menus.panelMenus.table.",o=function(t,n){return void 0===n&&(n=i),e.i18next.t(n+t)},d=[{$elem:a["default"]("<span>"+o("删除表格")+"</span>"),onClick:function(e,t){return e.selection.createRangeByElem(t),e.selection.restoreSelection(),e.cmd["do"]("insertHTML",c.EMPTY_P),!0}},{$elem:a["default"]("<span>"+o("添加行")+"</span>"),onClick:function(e,t){var n=f(e);if(n)return!0;var i=a["default"](e.selection.getSelectionStartElem()),o=r.getRowNode(i.elems[0]);if(!o)return!0;var s=Number(r.getCurrentRowIndex(t.elems[0],o)),u=r.getTableHtml(t.elems[0]),c=r.getTableHtml(l["default"].ProcessingRow(a["default"](u),s).elems[0]);return c=p(t,c),e.selection.createRangeByElem(t),e.selection.restoreSelection(),e.cmd["do"]("insertHTML",c),!0}},{$elem:a["default"]("<span>"+o("删除行")+"</span>"),onClick:function(e,t){var n=f(e);if(n)return!0;var i=a["default"](e.selection.getSelectionStartElem()),o=r.getRowNode(i.elems[0]);if(!o)return!0;var s=Number(r.getCurrentRowIndex(t.elems[0],o)),u=r.getTableHtml(t.elems[0]),d=l["default"].DeleteRow(a["default"](u),s).elems[0].children[0].children.length,h="";return e.selection.createRangeByElem(t),e.selection.restoreSelection(),h=0===d?c.EMPTY_P:r.getTableHtml(l["default"].DeleteRow(a["default"](u),s).elems[0]),h=p(t,h),e.cmd["do"]("insertHTML",h),!0}},{$elem:a["default"]("<span>"+o("添加列")+"</span>"),onClick:function(e,t){var n=f(e);if(n)return!0;var i=a["default"](e.selection.getSelectionStartElem()),o=r.getCurrentColIndex(i.elems[0]),s=r.getTableHtml(t.elems[0]),u=r.getTableHtml(l["default"].ProcessingCol(a["default"](s),o).elems[0]);return u=p(t,u),e.selection.createRangeByElem(t),e.selection.restoreSelection(),e.cmd["do"]("insertHTML",u),!0}},{$elem:a["default"]("<span>"+o("删除列")+"</span>"),onClick:function(e,t){var n=f(e);if(n)return!0;var i=a["default"](e.selection.getSelectionStartElem()),o=r.getCurrentColIndex(i.elems[0]),s=r.getTableHtml(t.elems[0]),u=l["default"].DeleteCol(a["default"](s),o),d=u.elems[0].children[0].children[0].children.length,h="";return e.selection.createRangeByElem(t),e.selection.restoreSelection(),h=0===d?c.EMPTY_P:r.getTableHtml(u.elems[0]),h=p(t,h),e.cmd["do"]("insertHTML",h),!0}},{$elem:a["default"]("<span>"+o("设置表头")+"</span>"),onClick:function(e,t){var n=f(e);if(n)return!0;var i=a["default"](e.selection.getSelectionStartElem()),o=r.getRowNode(i.elems[0]);if(!o)return!0;var s=Number(r.getCurrentRowIndex(t.elems[0],o));0!==s&&(s=0);var u=r.getTableHtml(t.elems[0]),c=r.getTableHtml(l["default"].setTheHeader(a["default"](u),s,"th").elems[0]);return c=p(t,c),e.selection.createRangeByElem(t),e.selection.restoreSelection(),e.cmd["do"]("insertHTML",c),!0}},{$elem:a["default"]("<span>"+o("取消表头")+"</span>"),onClick:function(e,t){var n=a["default"](e.selection.getSelectionStartElem()),i=r.getRowNode(n.elems[0]);if(!i)return!0;var o=Number(r.getCurrentRowIndex(t.elems[0],i));0!==o&&(o=0);var s=r.getTableHtml(t.elems[0]),u=r.getTableHtml(l["default"].setTheHeader(a["default"](s),o,"td").elems[0]);return u=p(t,u),e.selection.createRangeByElem(t),e.selection.restoreSelection(),e.cmd["do"]("insertHTML",u),!0}}];t=new s["default"](e,n,d),t.create()}function r(){t&&(t.remove(),t=null)}return{showTableTooltip:n,hideTableTooltip:r}}function f(e){var t=e.selection.getSelectionStartElem(),n=e.selection.getSelectionEndElem();return(null===t||void 0===t?void 0:t.elems[0])!==(null===n||void 0===n?void 0:n.elems[0])}function h(e){var t=d(e),n=t.showTableTooltip,r=t.hideTableTooltip;e.txt.eventHooks.tableClickEvents.push(n),e.txt.eventHooks.clickEvents.push(r),e.txt.eventHooks.keyupEvents.push(r),e.txt.eventHooks.toolbarClickEvents.push(r),e.txt.eventHooks.menuClickEvents.push(r),e.txt.eventHooks.textScrollEvents.push(r)}function p(e,t){var n=e.elems[0].nextSibling;return n&&"<br>"!==n.innerHTML||(t+=""+c.EMPTY_P),t}t["default"]=h},function(e,t,n){"use strict";var r=n(0),i=r(n(1)),o=r(n(45)),a=r(n(91)),s=r(n(4)),l=r(n(138));(0,i["default"])(t,"__esModule",{value:!0});var u=n(2),c=u.__importDefault(n(3));function d(e,t){for(var n=g(e),r=(0,o["default"])(Array.prototype).apply(n.children),i=r[0].children.length,s=document.createElement("tr"),l=0;l<i;l++){var u=document.createElement("td");s.appendChild(u)}return(0,a["default"])(r).call(r,t+1,0,s),v(n,r),c["default"](n.parentNode)}function f(e,t){for(var n=g(e),r=(0,o["default"])(Array.prototype).apply(n.children),i=function(e){var n,i=[];(0,s["default"])(n=(0,l["default"])(r[e].children)).call(n,(function(e){i.push(e)}));while(0!==r[e].children.length)r[e].removeChild(r[e].children[0]);var o="TH"!==c["default"](i[0]).getNodeName()?document.createElement("td"):document.createElement("th");(0,a["default"])(i).call(i,t+1,0,o);for(var u=0;u<i.length;u++)r[e].appendChild(i[u])},u=0;u<r.length;u++)i(u);return v(n,r),c["default"](n.parentNode)}function h(e,t){var n=g(e),r=(0,o["default"])(Array.prototype).apply(n.children);return(0,a["default"])(r).call(r,t,1),v(n,r),c["default"](n.parentNode)}function p(e,t){for(var n=g(e),r=(0,o["default"])(Array.prototype).apply(n.children),i=function(e){var n,i=[];(0,s["default"])(n=(0,l["default"])(r[e].children)).call(n,(function(e){i.push(e)}));while(0!==r[e].children.length)r[e].removeChild(r[e].children[0]);(0,a["default"])(i).call(i,t,1);for(var o=0;o<i.length;o++)r[e].appendChild(i[o])},u=0;u<r.length;u++)i(u);return v(n,r),c["default"](n.parentNode)}function m(e,t,n){for(var r=g(e),i=(0,o["default"])(Array.prototype).apply(r.children),u=i[t].children,d=document.createElement("tr"),f=function(e){var t,r=document.createElement(n),i=u[e];(0,s["default"])(t=(0,l["default"])(i.childNodes)).call(t,(function(e){r.appendChild(e)})),d.appendChild(r)},h=0;h<u.length;h++)f(h);return(0,a["default"])(i).call(i,t,1,d),v(r,i),c["default"](r.parentNode)}function v(e,t){while(0!==e.children.length)e.removeChild(e.children[0]);for(var n=0;n<t.length;n++)e.appendChild(t[n])}function g(e){var t=e.elems[0].children[0];return"COLGROUP"===t.nodeName&&(t=e.elems[0].children[e.elems[0].children.length-1]),t}t["default"]={ProcessingRow:d,ProcessingCol:f,DeleteRow:h,DeleteCol:p,setTheHeader:m}},function(e,t,n){var r=n(396);e.exports=r},function(e,t,n){n(50),n(397);var r=n(9);e.exports=r.Array.from},function(e,t,n){var r=n(5),i=n(398),o=n(115),a=!o((function(e){Array.from(e)}));r({target:"Array",stat:!0,forced:a},{from:i})},function(e,t,n){"use strict";var r=n(40),i=n(31),o=n(114),a=n(112),s=n(35),l=n(69),u=n(113);e.exports=function(e){var t,n,c,d,f,h,p=i(e),m="function"==typeof this?this:Array,v=arguments.length,g=v>1?arguments[1]:void 0,y=void 0!==g,_=u(p),x=0;if(y&&(g=r(g,v>2?arguments[2]:void 0,2)),void 0==_||m==Array&&a(_))for(t=s(p.length),n=new m(t);t>x;x++)h=y?g(p[x],x):p[x],l(n,x,h);else for(d=_.call(p),f=d.next,n=new m;!(c=f.call(d)).done;x++)h=y?o(d,g,[c.value,x],!0):c.value,l(n,x,h);return n.length=x,n}},function(e,t,n){"use strict";var r=n(0),i=r(n(1)),o=r(n(4)),a=r(n(138));(0,i["default"])(t,"__esModule",{value:!0});var s=n(2),l=s.__importDefault(n(3)),u=function(){function e(e){this.editor=e}return e.prototype.getRowNode=function(e){var t,n=l["default"](e).elems[0];return n.parentNode?(n=null===(t=l["default"](n).parentUntil("TR",n))||void 0===t?void 0:t.elems[0],n):n},e.prototype.getCurrentRowIndex=function(e,t){var n,r=0,i=e.children[0];return"COLGROUP"===i.nodeName&&(i=e.children[e.children.length-1]),(0,o["default"])(n=(0,a["default"])(i.children)).call(n,(function(e,n){e===t&&(r=n)})),r},e.prototype.getCurrentColIndex=function(e){var t,n,r=0,i="TD"===l["default"](e).getNodeName()||"TH"===l["default"](e).getNodeName()?e:null===(n=l["default"](e).parentUntil("TD",e))||void 0===n?void 0:n.elems[0],s=l["default"](i).parent();return(0,o["default"])(t=(0,a["default"])(s.elems[0].children)).call(t,(function(e,t){e===i&&(r=t)})),r},e.prototype.getTableHtml=function(e){var t='<table border="0" width="100%" cellpadding="0" cellspacing="0">'+l["default"](e).html()+"</table>";return t},e}();t["default"]=u},function(e,t,n){"use strict";var r=n(0),i=r(n(1));(0,i["default"])(t,"__esModule",{value:!0}),t.bindEventKeyboardEvent=t.bindClickEvent=void 0;var o=n(2),a=o.__importDefault(n(3));function s(e){if(!e.length)return!1;var t=e.elems[0];return"P"===t.nodeName&&"<br>"===t.innerHTML}function l(e){function t(t,n){if(n.detail>=3){var r=window.getSelection();if(r){var i=r.focusNode,o=r.anchorNode,s=a["default"](null===o||void 0===o?void 0:o.parentElement);if(!t.isContain(a["default"](i))){var l="TD"===s.elems[0].tagName?s:s.parentUntilEditor("td",e);if(l){var u=e.selection.getRange();null===u||void 0===u||u.setEnd(l.elems[0],l.elems[0].childNodes.length),e.selection.restoreSelection()}}}}}e.txt.eventHooks.tableClickEvents.push(t)}function u(e){var t=e.txt,n=e.selection,r=t.eventHooks.keydownEvents;r.push((function(t){e.selection.saveRange();var r=n.getSelectionContainerElem();if(r){var i=r.getNodeTop(e),o=i.length&&i.prev().length?i.prev():null;if(o&&"TABLE"===o.getNodeName()&&n.isSelectionEmpty()&&0===n.getCursorPos()&&8===t.keyCode){var a=i.next(),l=!!a.length;l&&s(i)&&(i.remove(),e.selection.setRangeToElem(a.elems[0])),t.preventDefault()}}}))}t.bindClickEvent=l,t.bindEventKeyboardEvent=u},function(e,t,n){"use strict";var r=n(0),i=r(n(1)),o=r(n(26));(0,i["default"])(t,"__esModule",{value:!0}),t.formatCodeHtml=void 0;var a=n(2),s=a.__importDefault(n(38)),l=a.__importDefault(n(3)),u=n(6),c=a.__importDefault(n(402)),d=a.__importDefault(n(139)),f=a.__importDefault(n(33)),h=a.__importDefault(n(403));function p(e,t){return t?(t=r(t),t=n(t),t=u.replaceSpecialSymbol(t),t):t;function n(e){var t=e.match(/<pre[\s|\S]+?\/pre>/g);return null===t||(0,o["default"])(t).call(t,(function(t){e=e.replace(t,t.replace(/<\/code><code>/g,"\n").replace(/<br>/g,""))})),e}function r(e){var t,n=e.match(/<span\sclass="hljs[\s|\S]+?\/span>/gm);if(!n||!n.length)return e;for(var i=(0,o["default"])(t=u.deepClone(n)).call(t,(function(e){return e=e.replace(/<span\sclass="hljs[^>]+>/,""),e.replace(/<\/span>/,"")})),a=0;a<n.length;a++)e=e.replace(n[a],i[a]);return r(e)}}t.formatCodeHtml=p;var m=function(e){function t(t){var n=this,r=l["default"]('<div class="w-e-menu" data-title="代码"><i class="w-e-icon-terminal"></i></div>');return n=e.call(this,r,t)||this,h["default"](t),n}return a.__extends(t,e),t.prototype.insertLineCode=function(e){var t=this.editor,n=l["default"]("<code>"+e+"</code>");t.cmd["do"]("insertElem",n),t.selection.createRangeByElem(n,!1),t.selection.restoreSelection()},t.prototype.clickHandler=function(){var e=this.editor,t=e.selection.getSelectionText();this.isActive||(e.selection.isSelectionEmpty()?this.createPanel("",""):this.insertLineCode(t))},t.prototype.createPanel=function(e,t){var n=c["default"](this.editor,e,t),r=new f["default"](this,n);r.create()},t.prototype.tryChangeActive=function(){var e=this.editor;d["default"](e)?this.active():this.unActive()},t}(s["default"]);t["default"]=m},function(e,t,n){"use strict";var r=n(0),i=r(n(1)),o=r(n(26));(0,i["default"])(t,"__esModule",{value:!0});var a=n(2),s=n(6),l=a.__importDefault(n(3)),u=a.__importDefault(n(139)),c=n(7);function d(e,t,n){var r,i=s.getRandom("input-iframe"),a=s.getRandom("select"),d=s.getRandom("btn-ok");function f(t,n){var r,i=u["default"](e);i&&h();var o=null===(r=e.selection.getSelectionStartElem())||void 0===r?void 0:r.elems[0].innerHTML;o&&e.cmd["do"]("insertHTML",c.EMPTY_P);var a=n.replace(/</g,"&lt;").replace(/>/g,"&gt;");e.highlight&&(a=e.highlight.highlightAuto(a).value),e.cmd["do"]("insertHTML",'<pre><code class="'+t+'">'+a+"</code></pre>");var s=e.selection.getSelectionStartElem(),d=null===s||void 0===s?void 0:s.getNodeTop(e);0===(null===d||void 0===d?void 0:d.getNextSibling().elems.length)&&l["default"](c.EMPTY_P).insertAfter(d)}function h(){if(u["default"](e)){var t=e.selection.getSelectionStartElem(),n=null===t||void 0===t?void 0:t.getNodeTop(e);n&&(e.selection.createRangeByElem(n),e.selection.restoreSelection(),n)}}var p=function(t){return e.i18next.t(t)},m={width:500,height:0,tabs:[{title:p("menus.panelMenus.code.插入代码"),tpl:'<div>\n                        <select name="" id="'+a+'">\n                            '+(0,o["default"])(r=e.config.languageType).call(r,(function(e){return"<option "+(n==e?"selected":"")+' value ="'+e+'">'+e+"</option>"}))+'\n                        </select>\n                        <textarea id="'+i+'" type="text" class="wang-code-textarea" placeholder="" style="height: 160px">'+t.replace(/&quot;/g,'"')+'</textarea>\n                        <div class="w-e-button-container">\n                            <button type="button" id="'+d+'" class="right">'+(u["default"](e)?p("修改"):p("插入"))+"</button>\n                        </div>\n                    </div>",events:[{selector:"#"+d,type:"click",fn:function(){var t=document.getElementById(i),n=l["default"]("#"+a),r=n.val(),o=t.value;if(o)return!u["default"](e)&&(f(r,o),!0)}}]}]};return m}t["default"]=d},function(e,t,n){"use strict";var r=n(0),i=r(n(1));(0,i["default"])(t,"__esModule",{value:!0});var o=n(2),a=o.__importDefault(n(404)),s=o.__importDefault(n(405));function l(e){a["default"](e),s["default"](e)}t["default"]=l},function(e,t,n){"use strict";var r=n(0),i=r(n(1));(0,i["default"])(t,"__esModule",{value:!0}),t.createShowHideFn=void 0;var o=n(2),a=o.__importDefault(n(3)),s=o.__importDefault(n(39));function l(e){var t;function n(n){var r="menus.panelMenus.code.",i=function(t,n){return void 0===n&&(n=r),e.i18next.t(n+t)},o=[{$elem:a["default"]("<span>"+i("删除代码")+"</span>"),onClick:function(e,t){return t.remove(),!0}}];t=new s["default"](e,n,o),t.create()}function r(){t&&(t.remove(),t=null)}return{showCodeTooltip:n,hideCodeTooltip:r}}function u(e){var t=l(e),n=t.showCodeTooltip,r=t.hideCodeTooltip;e.txt.eventHooks.codeClickEvents.push(n),e.txt.eventHooks.clickEvents.push(r),e.txt.eventHooks.toolbarClickEvents.push(r),e.txt.eventHooks.menuClickEvents.push(r),e.txt.eventHooks.textScrollEvents.push(r)}t.createShowHideFn=l,t["default"]=u},function(e,t,n){"use strict";var r=n(0),i=r(n(1));(0,i["default"])(t,"__esModule",{value:!0});var o=n(2),a=n(7),s=o.__importDefault(n(3));function l(e){var t=e.$textElem,n=e.selection,r=e.txt,i=r.eventHooks.keydownEvents;i.push((function(e){var r;if(40===e.keyCode){var i=n.getSelectionContainerElem(),o=null===(r=t.children())||void 0===r?void 0:r.last();if("XMP"===(null===i||void 0===i?void 0:i.elems[0].tagName)&&"PRE"===(null===o||void 0===o?void 0:o.elems[0].tagName)){var l=s["default"](a.EMPTY_P);t.append(l)}}})),i.push((function(r){e.selection.saveRange();var i=n.getSelectionContainerElem();if(i){var o=i.getNodeTop(e),l=null===o||void 0===o?void 0:o.prev(),u=null===o||void 0===o?void 0:o.getNextSibling();if(l.length&&"PRE"===(null===l||void 0===l?void 0:l.getNodeName())&&0===u.length&&0===n.getCursorPos()&&8===r.keyCode){var c=s["default"](a.EMPTY_P);t.append(c)}}}))}t["default"]=l},function(e,t,n){"use strict";var r=n(0),i=r(n(1));(0,i["default"])(t,"__esModule",{value:!0});var o=n(2),a=o.__importDefault(n(23)),s=o.__importDefault(n(3)),l=o.__importDefault(n(407)),u=n(6),c=n(7),d=function(e){function t(t){var n=this,r=s["default"]('<div class="w-e-menu" data-title="分割线"><i class="w-e-icon-split-line"></i></div>');return n=e.call(this,r,t)||this,l["default"](t),n}return o.__extends(t,e),t.prototype.clickHandler=function(){var e=this.editor,t=e.selection.getRange(),n=e.selection.getSelectionContainerElem();if(null===n||void 0===n?void 0:n.length){var r=s["default"](n.elems[0]),i=r.parentUntil("TABLE",n.elems[0]),o=r.children();"CODE"!==r.getNodeName()&&(i&&"TABLE"===s["default"](i.elems[0]).getNodeName()||o&&0!==o.length&&"IMG"===s["default"](o.elems[0]).getNodeName()&&!(null===t||void 0===t?void 0:t.collapsed)||this.createSplitLine())}},t.prototype.createSplitLine=function(){var e="<hr/>"+c.EMPTY_P;u.UA.isFirefox&&(e="<hr/><p></p>"),this.editor.cmd["do"]("insertHTML",e)},t.prototype.tryChangeActive=function(){},t}(a["default"]);t["default"]=d},function(e,t,n){"use strict";var r=n(0),i=r(n(1));(0,i["default"])(t,"__esModule",{value:!0});var o=n(2),a=o.__importDefault(n(408));function s(e){a["default"](e)}t["default"]=s},function(e,t,n){"use strict";var r=n(0),i=r(n(1));(0,i["default"])(t,"__esModule",{value:!0});var o=n(2),a=o.__importDefault(n(3)),s=o.__importDefault(n(39));function l(e){var t;function n(n){var r=[{$elem:a["default"]("<span>"+e.i18next.t("menus.panelMenus.删除")+"</span>"),onClick:function(e,t){return e.selection.createRangeByElem(t),e.selection.restoreSelection(),e.cmd["do"]("delete"),!0}}];t=new s["default"](e,n,r),t.create()}function r(){t&&(t.remove(),t=null)}return{showSplitLineTooltip:n,hideSplitLineTooltip:r}}function u(e){var t=l(e),n=t.showSplitLineTooltip,r=t.hideSplitLineTooltip;e.txt.eventHooks.splitLineEvents.push(n),e.txt.eventHooks.clickEvents.push(r),e.txt.eventHooks.keyupEvents.push(r),e.txt.eventHooks.toolbarClickEvents.push(r),e.txt.eventHooks.menuClickEvents.push(r),e.txt.eventHooks.textScrollEvents.push(r)}t["default"]=u},function(e,t,n){"use strict";var r=n(0),i=r(n(1)),o=r(n(4));(0,i["default"])(t,"__esModule",{value:!0});var a=n(2),s=a.__importDefault(n(3)),l=a.__importDefault(n(23)),u=n(98),c=a.__importDefault(n(415)),d=a.__importDefault(n(140)),f=function(e){function t(t){var n=this,r=s["default"]('<div class="w-e-menu" data-title="待办事项">\n                    <i class="w-e-icon-checkbox-checked"></i>\n                </div>');return n=e.call(this,r,t)||this,c["default"](t),n}return a.__extends(t,e),t.prototype.clickHandler=function(){var e=this.editor;u.isAllTodo(e)?(this.cancelTodo(),this.tryChangeActive()):this.setTodo()},t.prototype.tryChangeActive=function(){u.isAllTodo(this.editor)?this.active():this.unActive()},t.prototype.setTodo=function(){var e=this.editor,t=e.selection.getSelectionRangeTopNodes();(0,o["default"])(t).call(t,(function(t){var n,r=null===t||void 0===t?void 0:t.getNodeName();if("P"===r){var i=d["default"](t),o=i.getTodo(),a=null===(n=o.children())||void 0===n?void 0:n.getNode();o.insertAfter(t),e.selection.moveCursor(a),t.remove()}})),this.tryChangeActive()},t.prototype.cancelTodo=function(){var e=this.editor,t=e.selection.getSelectionRangeTopNodes();(0,o["default"])(t).call(t,(function(t){var n,r,i,o=null===(r=null===(n=t.childNodes())||void 0===n?void 0:n.childNodes())||void 0===r?void 0:r.clone(!0),a=s["default"]("<p></p>");a.append(o),a.insertAfter(t),null===(i=a.childNodes())||void 0===i||i.get(0).remove(),e.selection.moveCursor(a.getNode()),t.remove()}))},t}(l["default"]);t["default"]=f},function(e,t,n){e.exports=n(411)},function(e,t,n){var r=n(412);e.exports=r},function(e,t,n){var r=n(413),i=Array.prototype;e.exports=function(e){var t=e.every;return e===i||e instanceof Array&&t===i.every?r:t}},function(e,t,n){n(414);var r=n(15);e.exports=r("Array").every},function(e,t,n){"use strict";var r=n(5),i=n(32).every,o=n(67),a=n(22),s=o("every"),l=a("every");r({target:"Array",proto:!0,forced:!s||!l},{every:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}})},function(e,t,n){"use strict";var r=n(0),i=r(n(1)),o=r(n(4));(0,i["default"])(t,"__esModule",{value:!0});var a=n(2),s=a.__importDefault(n(3)),l=n(98),u=a.__importDefault(n(140)),c=n(98),d=n(7);function f(e){function t(t){var n,r;if(l.isAllTodo(e)){t.preventDefault();var i=e.selection,a=i.getSelectionRangeTopNodes()[0],f=null===(n=a.childNodes())||void 0===n?void 0:n.get(0),h=null===(r=window.getSelection())||void 0===r?void 0:r.anchorNode,p=i.getRange();if(!(null===p||void 0===p?void 0:p.collapsed)){var m=null===p||void 0===p?void 0:p.commonAncestorContainer.childNodes,v=null===p||void 0===p?void 0:p.startContainer,g=null===p||void 0===p?void 0:p.endContainer,y=null===p||void 0===p?void 0:p.startOffset,_=null===p||void 0===p?void 0:p.endOffset,x=0,b=0,w=[];null===m||void 0===m||(0,o["default"])(m).call(m,(function(e,t){e.contains(v)&&(x=t),e.contains(g)&&(b=t)})),b-x>1&&(null===m||void 0===m||(0,o["default"])(m).call(m,(function(e,t){t<=x||t>=b||w.push(e)})),(0,o["default"])(w).call(w,(function(e){e.remove()}))),c.dealTextNode(v,y),c.dealTextNode(g,_,!1),e.selection.moveCursor(g,0)}if(""===a.text()){var A=s["default"](d.EMPTY_P);return A.insertAfter(a),i.moveCursor(A.getNode()),void a.remove()}var T=i.getCursorPos(),S=l.getCursorNextNode(null===f||void 0===f?void 0:f.getNode(),h,T),E=u["default"](s["default"](S)),C=E.getInputContainer(),M=C.parent().getNode(),L=E.getTodo(),N=C.getNode().nextSibling;if(""===(null===f||void 0===f?void 0:f.text())&&(null===f||void 0===f||f.append(s["default"]("<br>"))),L.insertAfter(a),N&&""!==(null===N||void 0===N?void 0:N.textContent))i.moveCursor(M);else{if("BR"!==(null===N||void 0===N?void 0:N.nodeName)){var D=s["default"]("<br>");D.insertAfter(C)}i.moveCursor(M,1)}}}function n(t){var n,r;if(l.isAllTodo(e)){var i,a=e.selection,u=a.getSelectionRangeTopNodes()[0],c=null===(n=u.childNodes())||void 0===n?void 0:n.getNode(),f=s["default"]("<p></p>"),h=f.getNode(),p=null===(r=window.getSelection())||void 0===r?void 0:r.anchorNode,m=a.getCursorPos(),v=p.previousSibling;if(""===u.text()){t.preventDefault();var g=s["default"](d.EMPTY_P);return g.insertAfter(u),u.remove(),void a.moveCursor(g.getNode(),0)}if("SPAN"===(null===v||void 0===v?void 0:v.nodeName)&&"INPUT"===v.childNodes[0].nodeName&&0===m)t.preventDefault(),null===c||void 0===c||(0,o["default"])(i=c.childNodes).call(i,(function(e,t){0!==t&&h.appendChild(e.cloneNode(!0))})),f.insertAfter(u),u.remove()}}function r(){var t=e.selection,n=t.getSelectionRangeTopNodes()[0];n&&c.isTodo(n)&&""===n.text()&&(s["default"](d.EMPTY_P).insertAfter(n),n.remove())}function i(e){e&&e.target instanceof HTMLInputElement&&"checkbox"===e.target.type&&(e.target.checked?e.target.setAttribute("checked","true"):e.target.removeAttribute("checked"))}e.txt.eventHooks.enterDownEvents.push(t),e.txt.eventHooks.deleteUpEvents.push(r),e.txt.eventHooks.deleteDownEvents.push(n),e.txt.eventHooks.clickEvents.push(i)}t["default"]=f},function(e,t,n){"use strict";var r=n(0),i=r(n(1));(0,i["default"])(t,"__esModule",{value:!0}),t.selectorValidator=void 0;var o=n(2),a=o.__importDefault(n(3)),s=n(6),l=n(7),u=o.__importDefault(n(130)),c={border:"1px solid #c9d8db",toolbarBgColor:"#FFF",toolbarBottomBorder:"1px solid #EEE"};function d(e){var t,n,r,i=e.toolbarSelector,o=a["default"](i),d=e.textSelector,f=e.config,h=f.height,p=e.i18next,m=a["default"]("<div></div>"),v=a["default"]("<div></div>"),g=null;null==d?(n=o.children(),o.append(m).append(v),m.css("background-color",c.toolbarBgColor).css("border",c.border).css("border-bottom",c.toolbarBottomBorder),v.css("border",c.border).css("border-top","none").css("height",h+"px")):(o.append(m),g=a["default"](d).children(),a["default"](d).append(v),n=v.children()),t=a["default"]("<div></div>"),t.attr("contenteditable","true").css("width","100%").css("height","100%");var y=e.config.placeholder;r=y!==u["default"].placeholder?a["default"]("<div>"+y+"</div>"):a["default"]("<div>"+p.t(y)+"</div>"),r.addClass("placeholder"),n&&n.length?(t.append(n),r.hide()):t.append(a["default"](l.EMPTY_P)),g&&g.length&&(t.append(g),r.hide()),v.append(t),v.append(r),m.addClass("w-e-toolbar").css("z-index",e.zIndex.get("toolbar")),v.addClass("w-e-text-container"),v.css("z-index",e.zIndex.get()),t.addClass("w-e-text");var _=s.getRandom("toolbar-elem");m.attr("id",_);var x=s.getRandom("text-elem");t.attr("id",x);var b=v.getBoundingClientRect().height,w=t.getBoundingClientRect().height;b!==w&&t.css("min-height",b+"px"),e.$toolbarElem=m,e.$textContainerElem=v,e.$textElem=t,e.toolbarElemId=_,e.textElemId=x}function f(e){var t="data-we-id",n=/^wangEditor-\d+$/,r=e.textSelector,i=e.toolbarSelector,o={bar:a["default"]("<div></div>"),text:a["default"]("<div></div>")};if(null==i)throw new Error("错误：初始化编辑器时候未传入任何参数，请查阅文档");if(o.bar=a["default"](i),!o.bar.elems.length)throw new Error("无效的节点选择器："+i);if(n.test(o.bar.attr(t)))throw new Error("初始化节点已存在编辑器实例，无法重复创建编辑器");if(r){if(o.text=a["default"](r),!o.text.elems.length)throw new Error("无效的节点选择器："+r);if(n.test(o.text.attr(t)))throw new Error("初始化节点已存在编辑器实例，无法重复创建编辑器")}o.bar.attr(t,e.id),o.text.attr(t,e.id),e.beforeDestroy((function(){o.bar.removeAttr(t),o.text.removeAttr(t)}))}t["default"]=d,t.selectorValidator=f},function(e,t,n){"use strict";var r=n(0),i=r(n(1));(0,i["default"])(t,"__esModule",{value:!0});var o=n(2),a=o.__importDefault(n(3)),s=n(7);function l(e,t){var n=e.$textElem,r=n.children();if(!r||!r.length)return n.append(a["default"](s.EMPTY_P)),void l(e);var i=r.last();if(t){var o=i.html().toLowerCase(),u=i.getNodeName();if("<br>"!==o&&"<br/>"!==o||"P"!==u)return n.append(a["default"](s.EMPTY_P)),void l(e)}e.selection.createRangeByElem(i,!1,!0),e.config.focus?e.selection.restoreSelection():e.selection.clearWindowSelectionRange()}t["default"]=l},function(e,t,n){"use strict";var r=n(0),i=r(n(1)),o=r(n(4));(0,i["default"])(t,"__esModule",{value:!0});var a=n(2),s=a.__importDefault(n(3));function l(e){u(e),c(e),d(e)}function u(e){e.txt.eventHooks.changeEvents.push((function(){var t=e.config.onchange;if(t){var n=e.txt.html()||"";e.isFocus=!0,t(n)}e.txt.togglePlaceholder()}))}function c(e){function t(t){var n=t.target,r=s["default"](n),i=e.$textElem,o=e.$toolbarElem,a=i.isContain(r),l=o.isContain(r),u=o.elems[0]==t.target;if(a)e.isFocus||h(e),e.isFocus=!0;else{if(l&&!u||!e.isFocus)return;f(e),e.isFocus=!1}}e.isFocus=!1,document.activeElement===e.$textElem.elems[0]&&e.config.focus&&(h(e),e.isFocus=!0),s["default"](document).on("click",t),e.beforeDestroy((function(){s["default"](document).off("click",t)}))}function d(e){e.$textElem.on("compositionstart",(function(){e.isComposing=!0,e.txt.togglePlaceholder()})).on("compositionend",(function(){e.isComposing=!1,e.txt.togglePlaceholder()}))}function f(e){var t,n=e.config,r=n.onblur,i=e.txt.html()||"";(0,o["default"])(t=e.txt.eventHooks.onBlurEvents).call(t,(function(e){return e()})),r(i)}function h(e){var t=e.config,n=t.onfocus,r=e.txt.html()||"";n(r)}t["default"]=l},function(e,t,n){"use strict";var r=n(0),i=r(n(1));function o(e){var t=e.config,n=t.lang,r=t.languages;if(null==e.i18next)e.i18next={t:function(e){var t=e.split(".");return t[t.length-1]}};else try{e.i18next.init({ns:"wangEditor",lng:n,defaultNS:"wangEditor",resources:r})}catch(i){throw new Error("i18next:"+i)}}(0,i["default"])(t,"__esModule",{value:!0}),t["default"]=o},function(e,t,n){"use strict";var r=n(0),i=r(n(1)),o=r(n(29));(0,i["default"])(t,"__esModule",{value:!0}),t.setUnFullScreen=t.setFullScreen=void 0;var a=n(2),s=a.__importDefault(n(3));n(421);var l="w-e-icon-fullscreen",u="w-e-icon-fullscreen_exit",c="w-e-full-screen-editor";t.setFullScreen=function(e){var t=s["default"](e.toolbarSelector),n=e.$textContainerElem,r=e.$toolbarElem,i=(0,o["default"])(r).call(r,"i."+l),a=e.config;i.removeClass(l),i.addClass(u),t.addClass(c),t.css("z-index",a.zIndexFullScreen);var d=r.getBoundingClientRect();n.css("height","calc(100% - "+d.height+"px)")},t.setUnFullScreen=function(e){var t=s["default"](e.toolbarSelector),n=e.$textContainerElem,r=e.$toolbarElem,i=(0,o["default"])(r).call(r,"i."+u),a=e.config;i.removeClass(u),i.addClass(l),t.removeClass(c),t.css("z-index","auto"),n.css("height",a.height+"px")};var d=function(e){if(!e.textSelector&&e.config.showFullScreen){var n=e.$toolbarElem,r=s["default"]('<div class="w-e-menu" data-title="全屏">\n            <i class="'+l+'"></i>\n        </div>');r.on("click",(function(n){var i,a=(0,o["default"])(i=s["default"](n.currentTarget)).call(i,"i");a.hasClass(l)?(r.attr("data-title","取消全屏"),t.setFullScreen(e)):(r.attr("data-title","全屏"),t.setUnFullScreen(e))})),n.append(r)}};t["default"]=d},function(e,t,n){var r=n(20),i=n(422);i=i.__esModule?i.default:i,"string"===typeof i&&(i=[[e.i,i,""]]);var o={insert:"head",singleton:!1};r(i,o);e.exports=i.locals||{}},function(e,t,n){var r=n(21);t=r(!1),t.push([e.i,".w-e-full-screen-editor {\n  position: fixed;\n  width: 100%!important;\n  height: 100%!important;\n  left: 0;\n  top: 0;\n}\n",""]),e.exports=t},function(e,t,n){"use strict";var r=n(0),i=r(n(1)),o=r(n(29));(0,i["default"])(t,"__esModule",{value:!0});var a=function(e,t){var n,r=e.isEnable?e.$textElem:(0,o["default"])(n=e.$textContainerElem).call(n,".w-e-content-mantle"),i=(0,o["default"])(r).call(r,"[id='"+t+"']"),a=i.getOffsetData().top;r.scrollTop(a)};t["default"]=a},function(e,t,n){"use strict";var r=n(0),i=r(n(1));(0,i["default"])(t,"__esModule",{value:!0});var o=n(2),a=o.__importDefault(n(129)),s={menu:2,panel:2,toolbar:1,tooltip:1,textContainer:1},l=function(){function e(){this.tier=s,this.baseZIndex=a["default"].zIndex}return e.prototype.get=function(e){return e&&this.tier[e]?this.baseZIndex+this.tier[e]:this.baseZIndex},e.prototype.init=function(e){this.baseZIndex==a["default"].zIndex&&(this.baseZIndex=e.config.zIndex)},e}();t["default"]=l},function(e,t,n){"use strict";var r=n(0),i=r(n(1)),o=r(n(70)),a=r(n(4));(0,i["default"])(t,"__esModule",{value:!0});var s=n(2),l=s.__importDefault(n(426)),u=n(6),c=n(7);function d(e,t){return(0,o["default"])(e).call(e,(function(e){var n=e.type,r=e.target,i=e.attributeName;return"attributes"!=n||"attributes"==n&&("contenteditable"==i||r!=t)}))}var f=function(e){function t(t){var n=e.call(this,(function(e,r){var i;if(e=d(e,r.target),(i=n.data).push.apply(i,e),t.isCompatibleMode)n.asyncSave();else if(!t.isComposing)return n.asyncSave()}))||this;return n.editor=t,n.data=[],n.asyncSave=c.EMPTY_FN,n}return s.__extends(t,e),t.prototype.save=function(){this.data.length&&(this.editor.history.save(this.data),this.data.length=0,this.emit())},t.prototype.emit=function(){var e;(0,a["default"])(e=this.editor.txt.eventHooks.changeEvents).call(e,(function(e){return e()}))},t.prototype.observe=function(){var t=this;e.prototype.observe.call(this,this.editor.$textElem.elems[0]);var n=this.editor.config.onchangeTimeout;this.asyncSave=u.debounce((function(){t.save()}),n),this.editor.isCompatibleMode||this.editor.$textElem.on("compositionend",(function(){t.asyncSave()}))},t}(l["default"]);t["default"]=f},function(e,t,n){"use strict";var r=n(0),i=r(n(1));(0,i["default"])(t,"__esModule",{value:!0});var o=function(){function e(e,t){var n=this;this.options={subtree:!0,childList:!0,attributes:!0,attributeOldValue:!0,characterData:!0,characterDataOldValue:!0},this.callback=function(t){e(t,n)},this.observer=new MutationObserver(this.callback),t&&(this.options=t)}return(0,i["default"])(e.prototype,"target",{get:function(){return this.node},enumerable:!1,configurable:!0}),e.prototype.observe=function(e){this.node instanceof Node||(this.node=e,this.connect())},e.prototype.connect=function(){if(this.node)return this.observer.observe(this.node,this.options),this;throw new Error("还未初始化绑定，请您先绑定有效的 Node 节点")},e.prototype.disconnect=function(){var e=this.observer.takeRecords();e.length&&this.callback(e),this.observer.disconnect()},e}();t["default"]=o},function(e,t,n){"use strict";var r=n(0),i=r(n(1));(0,i["default"])(t,"__esModule",{value:!0});var o=n(2),a=o.__importDefault(n(428)),s=o.__importDefault(n(435)),l=o.__importDefault(n(436)),u=function(){function e(e){this.editor=e,this.content=new a["default"](e),this.scroll=new s["default"](e),this.range=new l["default"](e)}return(0,i["default"])(e.prototype,"size",{get:function(){return this.scroll.size},enumerable:!1,configurable:!0}),e.prototype.observe=function(){this.content.observe(),this.scroll.observe(),!this.editor.isCompatibleMode&&this.range.observe()},e.prototype.save=function(e){e.length&&(this.content.save(e),this.scroll.save(),!this.editor.isCompatibleMode&&this.range.save())},e.prototype.revoke=function(){this.editor.change.disconnect();var e=this.content.revoke();e&&(this.scroll.revoke(),this.editor.isCompatibleMode||(this.range.revoke(),this.editor.$textElem.focus())),this.editor.change.connect(),e&&this.editor.change.emit()},e.prototype.restore=function(){this.editor.change.disconnect();var e=this.content.restore();e&&(this.scroll.restore(),this.editor.isCompatibleMode||(this.range.restore(),this.editor.$textElem.focus())),this.editor.change.connect(),e&&this.editor.change.emit()},e}();t["default"]=u},function(e,t,n){"use strict";var r=n(0),i=r(n(1));(0,i["default"])(t,"__esModule",{value:!0});var o=n(2),a=o.__importDefault(n(429)),s=o.__importDefault(n(433)),l=function(){function e(e){this.editor=e}return e.prototype.observe=function(){this.editor.isCompatibleMode?this.cache=new s["default"](this.editor):this.cache=new a["default"](this.editor),this.cache.observe()},e.prototype.save=function(e){this.editor.isCompatibleMode?this.cache.save():this.cache.compile(e)},e.prototype.revoke=function(){var e;return null===(e=this.cache)||void 0===e?void 0:e.revoke()},e.prototype.restore=function(){var e;return null===(e=this.cache)||void 0===e?void 0:e.restore()},e}();t["default"]=l},function(e,t,n){"use strict";var r=n(0),i=r(n(1));(0,i["default"])(t,"__esModule",{value:!0});var o=n(2),a=o.__importDefault(n(99)),s=o.__importDefault(n(431)),l=n(432),u=function(e){function t(t){var n=e.call(this,t.config.historyMaxSize)||this;return n.editor=t,n}return o.__extends(t,e),t.prototype.observe=function(){this.resetMaxSize(this.editor.config.historyMaxSize)},t.prototype.compile=function(e){return this.save(s["default"](e)),this},t.prototype.revoke=function(){return e.prototype.revoke.call(this,(function(e){l.revoke(e)}))},t.prototype.restore=function(){return e.prototype.restore.call(this,(function(e){l.restore(e)}))},t}(a["default"]);t["default"]=u},function(e,t,n){"use strict";var r=n(0),i=r(n(1));(0,i["default"])(t,"__esModule",{value:!0}),t.CeilStack=void 0;var o=function(){function e(e){void 0===e&&(e=0),this.data=[],this.max=0,this.reset=!1,e=Math.abs(e),e&&(this.max=e)}return e.prototype.resetMax=function(e){e=Math.abs(e),this.reset||isNaN(e)||(this.max=e,this.reset=!0)},(0,i["default"])(e.prototype,"size",{get:function(){return this.data.length},enumerable:!1,configurable:!0}),e.prototype.instack=function(e){return this.data.unshift(e),this.max&&this.size>this.max&&(this.data.length=this.max),this},e.prototype.outstack=function(){return this.data.shift()},e.prototype.clear=function(){return this.data.length=0,this},e}();t.CeilStack=o},function(e,t,n){"use strict";var r=n(0),i=r(n(1)),o=r(n(4)),a=r(n(27));(0,i["default"])(t,"__esModule",{value:!0}),t.compliePosition=t.complieNodes=t.compileValue=t.compileType=void 0;var s=n(6);function l(e){switch(e){case"childList":return"node";case"attributes":return"attr";default:return"text"}}function u(e){switch(e.type){case"attributes":return e.target.getAttribute(e.attributeName)||"";case"characterData":return e.target.textContent;default:return""}}function c(e){var t={};return e.addedNodes.length&&(t.add=s.toArray(e.addedNodes)),e.removedNodes.length&&(t.remove=s.toArray(e.removedNodes)),t}function d(e){var t;return t=e.previousSibling?{type:"before",target:e.previousSibling}:e.nextSibling?{type:"after",target:e.nextSibling}:{type:"parent",target:e.target},t}t.compileType=l,t.compileValue=u,t.complieNodes=c,t.compliePosition=d;var f=["UL","OL","H1","H2","H3","H4","H5","H6"];function h(e){var t=[],n=!1,r=[];return(0,o["default"])(e).call(e,(function(e,i){var o={type:l(e.type),target:e.target,attr:e.attributeName||"",value:u(e)||"",oldValue:e.oldValue||"",nodes:c(e),position:d(e)};if(t.push(o),s.UA.isFirefox){if(n&&e.addedNodes.length&&1==e.addedNodes[0].nodeType){var h=e.addedNodes[0],m={type:"node",target:h,attr:"",value:"",oldValue:"",nodes:{add:[n]},position:{type:"parent",target:h}};-1!=(0,a["default"])(f).call(f,h.nodeName)?(m.nodes.add=s.toArray(h.childNodes),t.push(m)):3==n.nodeType?(p(h,r)&&(m.nodes.add=s.toArray(h.childNodes)),t.push(m)):-1==(0,a["default"])(f).call(f,e.target.nodeName)&&p(h,r)&&(m.nodes.add=s.toArray(h.childNodes),t.push(m))}"node"==o.type&&1==e.removedNodes.length?(n=e.removedNodes[0],r.push(n)):(n=!1,r.length=0)}})),t}function p(e,t){for(var n=0,r=t.length-1;r>0;r--){if(!e.contains(t[r]))break;n++}return n}t["default"]=h},function(e,t,n){"use strict";var r=n(0),i=r(n(1)),o=r(n(4)),a=r(n(94));function s(e,t){var n=e.position.target;switch(e.position.type){case"before":n.nextSibling?(n=n.nextSibling,(0,o["default"])(t).call(t,(function(t){e.target.insertBefore(t,n)}))):(0,o["default"])(t).call(t,(function(t){e.target.appendChild(t)}));break;case"after":(0,o["default"])(t).call(t,(function(t){e.target.insertBefore(t,n)}));break;default:(0,o["default"])(t).call(t,(function(e){n.appendChild(e)}));break}}function l(e){for(var t=0,n=(0,a["default"])(e.nodes);t<n.length;t++){var r=n[t],i=r[0],l=r[1];switch(i){case"add":(0,o["default"])(l).call(l,(function(t){e.target.removeChild(t)}));break;default:s(e,l);break}}}function u(e){var t=e.target;null==e.oldValue?t.removeAttribute(e.attr):t.setAttribute(e.attr,e.oldValue)}function c(e){e.target.textContent=e.oldValue}(0,i["default"])(t,"__esModule",{value:!0}),t.restore=t.revoke=void 0;var d={node:l,text:c,attr:u};function f(e){for(var t=e.length-1;t>-1;t--){var n=e[t];d[n.type](n)}}function h(e){for(var t=0,n=(0,a["default"])(e.nodes);t<n.length;t++){var r=n[t],i=r[0],l=r[1];switch(i){case"add":s(e,l);break;default:(0,o["default"])(l).call(l,(function(e){e.parentNode.removeChild(e)}));break}}}function p(e){e.target.textContent=e.value}function m(e){e.target.setAttribute(e.attr,e.value)}t.revoke=f;var v={node:h,text:p,attr:m};function g(e){for(var t=0,n=e;t<n.length;t++){var r=n[t];v[r.type](r)}}t.restore=g},function(e,t,n){"use strict";var r=n(0),i=r(n(1));(0,i["default"])(t,"__esModule",{value:!0});var o=n(434),a=function(){function e(e){this.editor=e,this.data=new o.TailChain}return e.prototype.observe=function(){this.data.resetMax(this.editor.config.historyMaxSize),this.data.insertLast(this.editor.$textElem.html())},e.prototype.save=function(){return this.data.insertLast(this.editor.$textElem.html()),this},e.prototype.revoke=function(){var e=this.data.prev();return!!e&&(this.editor.$textElem.html(e),!0)},e.prototype.restore=function(){var e=this.data.next();return!!e&&(this.editor.$textElem.html(e),!0)},e}();t["default"]=a},function(e,t,n){"use strict";var r=n(0),i=r(n(1)),o=r(n(91));(0,i["default"])(t,"__esModule",{value:!0}),t.TailChain=void 0;var a=function(){function e(){this.data=[],this.max=0,this.point=0,this.isRe=!1}return e.prototype.resetMax=function(e){e=Math.abs(e),e&&(this.max=e)},(0,i["default"])(e.prototype,"size",{get:function(){return this.data.length},enumerable:!1,configurable:!0}),e.prototype.insertLast=function(e){var t;this.isRe&&((0,o["default"])(t=this.data).call(t,this.point+1),this.isRe=!1);this.data.push(e);while(this.max&&this.size>this.max)this.data.shift();return this.point=this.size-1,this},e.prototype.current=function(){return this.data[this.point]},e.prototype.prev=function(){if(!this.isRe&&(this.isRe=!0),this.point--,!(this.point<0))return this.current();this.point=0},e.prototype.next=function(){if(!this.isRe&&(this.isRe=!0),this.point++,!(this.point>=this.size))return this.current();this.point=this.size-1},e}();t.TailChain=a},function(e,t,n){"use strict";var r=n(0),i=r(n(1));(0,i["default"])(t,"__esModule",{value:!0});var o=n(2),a=o.__importDefault(n(99)),s=function(e){function t(t){var n=e.call(this,t.config.historyMaxSize)||this;return n.editor=t,n.last=0,n.target=t.$textElem.elems[0],n}return o.__extends(t,e),t.prototype.observe=function(){var e=this;this.target=this.editor.$textElem.elems[0],this.editor.$textElem.on("scroll",(function(){e.last=e.target.scrollTop})),this.resetMaxSize(this.editor.config.historyMaxSize)},t.prototype.save=function(){return e.prototype.save.call(this,[this.last,this.target.scrollTop]),this},t.prototype.revoke=function(){var t=this;return e.prototype.revoke.call(this,(function(e){t.target.scrollTop=e[0]}))},t.prototype.restore=function(){var t=this;return e.prototype.restore.call(this,(function(e){t.target.scrollTop=e[1]}))},t}(a["default"]);t["default"]=s},function(e,t,n){"use strict";var r=n(0),i=r(n(1));(0,i["default"])(t,"__esModule",{value:!0});var o=n(2),a=o.__importDefault(n(99)),s=o.__importDefault(n(3)),l=n(6);function u(e){return{start:[e.startContainer,e.startOffset],end:[e.endContainer,e.endOffset],root:e.commonAncestorContainer,collapsed:e.collapsed}}var c=function(e){function t(t){var n=e.call(this,t.config.historyMaxSize)||this;return n.editor=t,n.lastRange=u(document.createRange()),n.root=t.$textElem.elems[0],n.updateLastRange=l.debounce((function(){n.lastRange=u(n.rangeHandle)}),t.config.onchangeTimeout),n}return o.__extends(t,e),(0,i["default"])(t.prototype,"rangeHandle",{get:function(){var e=document.getSelection();return e&&e.rangeCount?e.getRangeAt(0):document.createRange()},enumerable:!1,configurable:!0}),t.prototype.observe=function(){var e=this;function t(){var t=e.rangeHandle;(e.root===t.commonAncestorContainer||e.root.contains(t.commonAncestorContainer))&&(e.editor.isComposing||e.updateLastRange())}function n(t){"Backspace"!=t.key&&"Delete"!=t.key||e.updateLastRange()}this.root=this.editor.$textElem.elems[0],this.resetMaxSize(this.editor.config.historyMaxSize),s["default"](document).on("selectionchange",t),this.editor.beforeDestroy((function(){s["default"](document).off("selectionchange",t)})),e.editor.$textElem.on("keydown",n)},t.prototype.save=function(){var t=u(this.rangeHandle);return e.prototype.save.call(this,[this.lastRange,t]),this.lastRange=t,this},t.prototype.set=function(e){try{if(e){var t=this.rangeHandle;return t.setStart.apply(t,e.start),t.setEnd.apply(t,e.end),this.editor.menus.changeActive(),!0}}catch(n){return!1}return!1},t.prototype.revoke=function(){var t=this;return e.prototype.revoke.call(this,(function(e){t.set(e[0])}))},t.prototype.restore=function(){var t=this;return e.prototype.restore.call(this,(function(e){t.set(e[1])}))},t}(a["default"]);t["default"]=c},function(e,t,n){"use strict";var r=n(0),i=r(n(1)),o=r(n(29));(0,i["default"])(t,"__esModule",{value:!0});var a=n(2),s=a.__importDefault(n(3));function l(e){var t,n,r=!1;function i(){if(!r){e.$textElem.hide();var i=e.zIndex.get("textContainer"),o=e.txt.html();t=s["default"]('<div class="w-e-content-mantle" style="z-index:'+i+'">\n                <div class="w-e-content-preview w-e-text">'+o+"</div>\n            </div>"),e.$textContainerElem.append(t);var a=e.zIndex.get("menu");n=s["default"]('<div class="w-e-menue-mantle" style="z-index:'+a+'"></div>'),e.$toolbarElem.append(n),r=!0,e.isEnable=!1}}function a(){r&&(t.remove(),n.remove(),e.$textElem.show(),r=!1,e.isEnable=!0)}return e.txt.eventHooks.changeEvents.push((function(){r&&(0,o["default"])(t).call(t,".w-e-content-preview").html(e.$textElem.html())})),{disable:i,enable:a}}n(438),t["default"]=l},function(e,t,n){var r=n(20),i=n(439);i=i.__esModule?i.default:i,"string"===typeof i&&(i=[[e.i,i,""]]);var o={insert:"head",singleton:!1};r(i,o);e.exports=i.locals||{}},function(e,t,n){var r=n(21);t=r(!1),t.push([e.i,".w-e-content-mantle {\n  width: 100%;\n  height: 100%;\n  overflow-y: auto;\n}\n.w-e-content-mantle .w-e-content-preview {\n  width: 100%;\n  min-height: 100%;\n  padding: 0 10px;\n  line-height: 1.5;\n}\n.w-e-content-mantle .w-e-content-preview img {\n  cursor: default;\n}\n.w-e-content-mantle .w-e-content-preview img:hover {\n  box-shadow: none;\n}\n.w-e-menue-mantle {\n  position: absolute;\n  height: 100%;\n  width: 100%;\n  top: 0;\n  left: 0;\n}\n",""]),e.exports=t},function(e,t,n){"use strict";var r=n(0),i=r(n(1));(0,i["default"])(t,"__esModule",{value:!0});var o=function(){function e(e){var t=this;this.editor=e;var n=function(){var n=document.activeElement;n===e.$textElem.elems[0]&&t.emit()};window.document.addEventListener("selectionchange",n),this.editor.beforeDestroy((function(){window.document.removeEventListener("selectionchange",n)}))}return e.prototype.emit=function(){var e,t=this.editor.config.onSelectionChange;if(t){var n=this.editor.selection;n.saveRange(),n.isSelectionEmpty()||t({text:n.getSelectionText(),html:null===(e=n.getSelectionContainerElem())||void 0===e?void 0:e.elems[0].innerHTML,selection:n})}},e}();t["default"]=o},function(e,t,n){"use strict";var r=n(0),i=r(n(1)),o=r(n(128)),a=r(n(94)),s=r(n(4));(0,i["default"])(t,"__esModule",{value:!0}),t.registerPlugin=void 0;var l=n(2),u=l.__importDefault(n(87)),c=n(6);function d(e,t,n){if(!e)throw new TypeError("name is not define");if(!t)throw new TypeError("options is not define");if(!t.intention)throw new TypeError("options.intention is not define");if(t.intention&&"function"!==typeof t.intention)throw new TypeError("options.intention is not function");n[e]&&console.warn("plugin "+e+" 已存在，已覆盖。"),n[e]=t}function f(e){var t=(0,o["default"])({},c.deepClone(u["default"].globalPluginsFunctionList),c.deepClone(e.pluginsFunctionList)),n=(0,a["default"])(t);(0,s["default"])(n).call(n,(function(t){var n=t[0],r=t[1];console.info("plugin "+n+" initializing");var i=r.intention,o=r.config;i(e,o),console.info("plugin "+n+" initialization complete")}))}t.registerPlugin=d,t["default"]=f},function(e,t,n){"use strict";var r=n(0),i=r(n(1));(0,i["default"])(t,"__esModule",{value:!0})}])["default"]}))},7026:function(e,t,n){
/*!
 * vue-treeselect v0.1.0 | (c) 2017-2019 Riophae Lee
 * Released under the MIT License.
 * https://vue-treeselect.js.org/
 */
e.exports=function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/",n(n.s=16)}([function(e,t){e.exports=n("278c")},function(e,t){e.exports=n("448a")},function(e,t){e.exports=n("9523")},function(e,t){e.exports=n("2e39")},function(e,t){e.exports=n("bcdf")},function(e,t){e.exports=n("b047")},function(e,t){e.exports=n("df0f")},function(e,t){e.exports=n("2655")},function(e,t){e.exports=n("1d92")},function(e,t){e.exports=n("cd9d")},function(e,t){e.exports=n("72f0")},function(e,t){e.exports=n("7037")},function(e,t){e.exports=n("4416")},function(e,t){e.exports=n("92fa")},function(e,t){e.exports=n("2b0e")},function(e,t,n){},function(e,t,n){"use strict";n.r(t);var r=n(0),i=n.n(r),o=n(1),a=n.n(o),s=n(2),l=n.n(s),u=n(3),c=n.n(u),d=n(4),f=n.n(d),h=f.a;function p(e){return function(t){if("mousedown"===t.type&&0===t.button){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];e.call.apply(e,[this,t].concat(r))}}}function m(e,t){var n=e.getBoundingClientRect(),r=t.getBoundingClientRect(),i=t.offsetHeight/3;r.bottom+i>n.bottom?e.scrollTop=Math.min(t.offsetTop+t.clientHeight-e.offsetHeight+i,e.scrollHeight):r.top-i<n.top&&(e.scrollTop=Math.max(t.offsetTop-i,0))}var v,g=n(5),y=n.n(g),_=n(6),x=n.n(_);function b(e,t){var n=e.indexOf(t);-1!==n&&e.splice(n,1)}var w=[],A=100;function T(){v=setInterval((function(){w.forEach(E)}),A)}function S(){clearInterval(v),v=null}function E(e){var t=e.$el,n=e.listener,r=e.lastWidth,i=e.lastHeight,o=t.offsetWidth,a=t.offsetHeight;r===o&&i===a||(e.lastWidth=o,e.lastHeight=a,n({width:o,height:a}))}function C(e,t){var n={$el:e,listener:t,lastWidth:null,lastHeight:null},r=function(){b(w,n),w.length||S()};return w.push(n),E(n),T(),r}function M(e,t){var n=9===document.documentMode,r=!0,i=function(){return r||t.apply(void 0,arguments)},o=n?C:x.a,a=o(e,i);return r=!1,a}function L(e){var t=[],n=e.parentNode;while(n&&"BODY"!==n.nodeName&&n.nodeType===document.ELEMENT_NODE)N(n)&&t.push(n),n=n.parentNode;return t.push(window),t}function N(e){var t=getComputedStyle(e),n=t.overflow,r=t.overflowX,i=t.overflowY;return/(auto|scroll|overlay)/.test(n+i+r)}function D(e,t){var n=L(e);return window.addEventListener("resize",t,{passive:!0}),n.forEach((function(e){e.addEventListener("scroll",t,{passive:!0})})),function(){window.removeEventListener("resize",t,{passive:!0}),n.forEach((function(e){e.removeEventListener("scroll",t,{passive:!0})}))}}function O(e){return e!==e}var I=n(7),R=n.n(I),P=n(8),k=n.n(P),B=n(9),F=n.n(B),z=n(10),H=n.n(z),U=function(){return Object.create(null)},G=n(11),V=n.n(G);function j(e){return null!=e&&"object"===V()(e)&&Object.getPrototypeOf(e)===Object.prototype}function W(e,t,n){j(n)?(e[t]||(e[t]={}),X(e[t],n)):e[t]=n}function X(e,t){if(j(t))for(var n=Object.keys(t),r=0,i=n.length;r<i;r++)W(e,n[r],t[n[r]]);return e}var Y=n(12),q=n.n(Y);function Q(e,t){return-1!==e.indexOf(t)}function $(e,t,n){for(var r=0,i=e.length;r<i;r++)if(t.call(n,e[r],r,e))return e[r]}function K(e,t){if(e.length!==t.length)return!0;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!0;return!1}var Z=null,J=0,ee=1,te=2,ne="ALL_CHILDREN",re="ALL_DESCENDANTS",ie="LEAF_CHILDREN",oe="LEAF_DESCENDANTS",ae="LOAD_ROOT_OPTIONS",se="LOAD_CHILDREN_OPTIONS",le="ASYNC_SEARCH",ue="ALL",ce="BRANCH_PRIORITY",de="LEAF_PRIORITY",fe="ALL_WITH_INDETERMINATE",he="ORDER_SELECTED",pe="LEVEL",me="INDEX",ve={BACKSPACE:8,ENTER:13,ESCAPE:27,END:35,HOME:36,ARROW_LEFT:37,ARROW_UP:38,ARROW_RIGHT:39,ARROW_DOWN:40,DELETE:46},ge=200,ye=5,_e=40;function xe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function be(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?xe(n,!0).forEach((function(t){l()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):xe(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function we(e,t){var n=0;do{if(e.level<n)return-1;if(t.level<n)return 1;if(e.index[n]!==t.index[n])return e.index[n]-t.index[n];n++}while(1)}function Ae(e,t){return e.level===t.level?we(e,t):e.level-t.level}function Te(){return{isLoaded:!1,isLoading:!1,loadingError:""}}function Se(e){return"string"===typeof e?e:"number"!==typeof e||O(e)?"":e+""}function Ee(e,t,n){return e?c()(t,n):Q(n,t)}function Ce(e){return e.message||String(e)}var Me=0,Le={provide:function(){return{instance:this}},props:{allowClearingDisabled:{type:Boolean,default:!1},allowSelectingDisabledDescendants:{type:Boolean,default:!1},alwaysOpen:{type:Boolean,default:!1},appendToBody:{type:Boolean,default:!1},async:{type:Boolean,default:!1},autoFocus:{type:Boolean,default:!1},autoLoadRootOptions:{type:Boolean,default:!0},autoDeselectAncestors:{type:Boolean,default:!1},autoDeselectDescendants:{type:Boolean,default:!1},autoSelectAncestors:{type:Boolean,default:!1},autoSelectDescendants:{type:Boolean,default:!1},backspaceRemoves:{type:Boolean,default:!0},beforeClearAll:{type:Function,default:H()(!0)},branchNodesFirst:{type:Boolean,default:!1},cacheOptions:{type:Boolean,default:!0},clearable:{type:Boolean,default:!0},clearAllText:{type:String,default:"Clear all"},clearOnSelect:{type:Boolean,default:!1},clearValueText:{type:String,default:"Clear value"},closeOnSelect:{type:Boolean,default:!0},defaultExpandLevel:{type:Number,default:0},defaultOptions:{default:!1},deleteRemoves:{type:Boolean,default:!0},delimiter:{type:String,default:","},flattenSearchResults:{type:Boolean,default:!1},disableBranchNodes:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},disableFuzzyMatching:{type:Boolean,default:!1},flat:{type:Boolean,default:!1},instanceId:{default:function(){return"".concat(Me++,"$$")},type:[String,Number]},joinValues:{type:Boolean,default:!1},limit:{type:Number,default:1/0},limitText:{type:Function,default:function(e){return"and ".concat(e," more")}},loading:{type:Boolean,default:!1},loadingText:{type:String,default:"Loading..."},loadOptions:{type:Function},matchKeys:{type:Array,default:H()(["label"])},maxHeight:{type:Number,default:300},multiple:{type:Boolean,default:!1},name:{type:String},noChildrenText:{type:String,default:"No sub-options."},noOptionsText:{type:String,default:"No options available."},noResultsText:{type:String,default:"No results found..."},normalizer:{type:Function,default:F.a},openDirection:{type:String,default:"auto",validator:function(e){var t=["auto","top","bottom","above","below"];return Q(t,e)}},openOnClick:{type:Boolean,default:!0},openOnFocus:{type:Boolean,default:!1},options:{type:Array},placeholder:{type:String,default:"Select..."},required:{type:Boolean,default:!1},retryText:{type:String,default:"Retry?"},retryTitle:{type:String,default:"Click to retry"},searchable:{type:Boolean,default:!0},searchNested:{type:Boolean,default:!1},searchPromptText:{type:String,default:"Type to search..."},showCount:{type:Boolean,default:!1},showCountOf:{type:String,default:ne,validator:function(e){var t=[ne,re,ie,oe];return Q(t,e)}},showCountOnSearch:null,sortValueBy:{type:String,default:he,validator:function(e){var t=[he,pe,me];return Q(t,e)}},tabIndex:{type:Number,default:0},value:null,valueConsistsOf:{type:String,default:ce,validator:function(e){var t=[ue,ce,de,fe];return Q(t,e)}},valueFormat:{type:String,default:"id"},zIndex:{type:[Number,String],default:999}},data:function(){return{trigger:{isFocused:!1,searchQuery:""},menu:{isOpen:!1,current:null,lastScrollPosition:0,placement:"bottom"},forest:{normalizedOptions:[],nodeMap:U(),checkedStateMap:U(),selectedNodeIds:this.extractCheckedNodeIdsFromValue(),selectedNodeMap:U()},rootOptionsStates:Te(),localSearch:{active:!1,noResults:!0,countMap:U()},remoteSearch:U()}},computed:{selectedNodes:function(){return this.forest.selectedNodeIds.map(this.getNode)},internalValue:function(){var e,t=this;if(this.single||this.flat||this.disableBranchNodes||this.valueConsistsOf===ue)e=this.forest.selectedNodeIds.slice();else if(this.valueConsistsOf===ce)e=this.forest.selectedNodeIds.filter((function(e){var n=t.getNode(e);return!!n.isRootNode||!t.isSelected(n.parentNode)}));else if(this.valueConsistsOf===de)e=this.forest.selectedNodeIds.filter((function(e){var n=t.getNode(e);return!!n.isLeaf||0===n.children.length}));else if(this.valueConsistsOf===fe){var n,r=[];e=this.forest.selectedNodeIds.slice(),this.selectedNodes.forEach((function(t){t.ancestors.forEach((function(t){Q(r,t.id)||Q(e,t.id)||r.push(t.id)}))})),(n=e).push.apply(n,r)}return this.sortValueBy===pe?e.sort((function(e,n){return Ae(t.getNode(e),t.getNode(n))})):this.sortValueBy===me&&e.sort((function(e,n){return we(t.getNode(e),t.getNode(n))})),e},hasValue:function(){return this.internalValue.length>0},single:function(){return!this.multiple},visibleOptionIds:function(){var e=this,t=[];return this.traverseAllNodesByIndex((function(n){if(e.localSearch.active&&!e.shouldOptionBeIncludedInSearchResult(n)||t.push(n.id),n.isBranch&&!e.shouldExpand(n))return!1})),t},hasVisibleOptions:function(){return 0!==this.visibleOptionIds.length},showCountOnSearchComputed:function(){return"boolean"===typeof this.showCountOnSearch?this.showCountOnSearch:this.showCount},hasBranchNodes:function(){return this.forest.normalizedOptions.some((function(e){return e.isBranch}))},shouldFlattenOptions:function(){return this.localSearch.active&&this.flattenSearchResults}},watch:{alwaysOpen:function(e){e?this.openMenu():this.closeMenu()},branchNodesFirst:function(){this.initialize()},disabled:function(e){e&&this.menu.isOpen?this.closeMenu():e||this.menu.isOpen||!this.alwaysOpen||this.openMenu()},flat:function(){this.initialize()},internalValue:function(e,t){var n=K(e,t);n&&this.$emit("input",this.getValue(),this.getInstanceId())},matchKeys:function(){this.initialize()},multiple:function(e){e&&this.buildForestState()},options:{handler:function(){this.async||(this.initialize(),this.rootOptionsStates.isLoaded=Array.isArray(this.options))},deep:!0,immediate:!0},"trigger.searchQuery":function(){this.async?this.handleRemoteSearch():this.handleLocalSearch(),this.$emit("search-change",this.trigger.searchQuery,this.getInstanceId())},value:function(){var e=this.extractCheckedNodeIdsFromValue(),t=K(e,this.internalValue);t&&this.fixSelectedNodeIds(e)}},methods:{verifyProps:function(){var e=this;if(h((function(){return!e.async||e.searchable}),(function(){return'For async search mode, the value of "searchable" prop must be true.'})),null!=this.options||this.loadOptions||h((function(){return!1}),(function(){return'Are you meant to dynamically load options? You need to use "loadOptions" prop.'})),this.flat&&h((function(){return e.multiple}),(function(){return'You are using flat mode. But you forgot to add "multiple=true"?'})),!this.flat){var t=["autoSelectAncestors","autoSelectDescendants","autoDeselectAncestors","autoDeselectDescendants"];t.forEach((function(t){h((function(){return!e[t]}),(function(){return'"'.concat(t,'" only applies to flat mode.')}))}))}},resetFlags:function(){this._blurOnSelect=!1},initialize:function(){var e=this.async?this.getRemoteSearchEntry().options:this.options;if(Array.isArray(e)){var t=this.forest.nodeMap;this.forest.nodeMap=U(),this.keepDataOfSelectedNodes(t),this.forest.normalizedOptions=this.normalize(Z,e,t),this.fixSelectedNodeIds(this.internalValue)}else this.forest.normalizedOptions=[]},getInstanceId:function(){return null==this.instanceId?this.id:this.instanceId},getValue:function(){var e=this;if("id"===this.valueFormat)return this.multiple?this.internalValue.slice():this.internalValue[0];var t=this.internalValue.map((function(t){return e.getNode(t).raw}));return this.multiple?t:t[0]},getNode:function(e){return h((function(){return null!=e}),(function(){return"Invalid node id: ".concat(e)})),null==e?null:e in this.forest.nodeMap?this.forest.nodeMap[e]:this.createFallbackNode(e)},createFallbackNode:function(e){var t=this.extractNodeFromValue(e),n=this.enhancedNormalizer(t).label||"".concat(e," (unknown)"),r={id:e,label:n,ancestors:[],parentNode:Z,isFallbackNode:!0,isRootNode:!0,isLeaf:!0,isBranch:!1,isDisabled:!1,isNew:!1,index:[-1],level:0,raw:t};return this.$set(this.forest.nodeMap,e,r)},extractCheckedNodeIdsFromValue:function(){var e=this;return null==this.value?[]:"id"===this.valueFormat?this.multiple?this.value.slice():[this.value]:(this.multiple?this.value:[this.value]).map((function(t){return e.enhancedNormalizer(t)})).map((function(e){return e.id}))},extractNodeFromValue:function(e){var t=this,n={id:e};if("id"===this.valueFormat)return n;var r=this.multiple?Array.isArray(this.value)?this.value:[]:this.value?[this.value]:[],i=$(r,(function(n){return n&&t.enhancedNormalizer(n).id===e}));return i||n},fixSelectedNodeIds:function(e){var t=this,n=[];if(this.single||this.flat||this.disableBranchNodes||this.valueConsistsOf===ue)n=e;else if(this.valueConsistsOf===ce)e.forEach((function(e){n.push(e);var r=t.getNode(e);r.isBranch&&t.traverseDescendantsBFS(r,(function(e){n.push(e.id)}))}));else if(this.valueConsistsOf===de){var r=U(),i=e.slice();while(i.length){var o=i.shift(),a=this.getNode(o);n.push(o),a.isRootNode||(a.parentNode.id in r||(r[a.parentNode.id]=a.parentNode.children.length),0===--r[a.parentNode.id]&&i.push(a.parentNode.id))}}else if(this.valueConsistsOf===fe){var s=U(),l=e.filter((function(e){var n=t.getNode(e);return n.isLeaf||0===n.children.length}));while(l.length){var u=l.shift(),c=this.getNode(u);n.push(u),c.isRootNode||(c.parentNode.id in s||(s[c.parentNode.id]=c.parentNode.children.length),0===--s[c.parentNode.id]&&l.push(c.parentNode.id))}}var d=K(this.forest.selectedNodeIds,n);d&&(this.forest.selectedNodeIds=n),this.buildForestState()},keepDataOfSelectedNodes:function(e){var t=this;this.forest.selectedNodeIds.forEach((function(n){if(e[n]){var r=be({},e[n],{isFallbackNode:!0});t.$set(t.forest.nodeMap,n,r)}}))},isSelected:function(e){return!0===this.forest.selectedNodeMap[e.id]},traverseDescendantsBFS:function(e,t){if(e.isBranch){var n=e.children.slice();while(n.length){var r=n[0];r.isBranch&&n.push.apply(n,a()(r.children)),t(r),n.shift()}}},traverseDescendantsDFS:function(e,t){var n=this;e.isBranch&&e.children.forEach((function(e){n.traverseDescendantsDFS(e,t),t(e)}))},traverseAllNodesDFS:function(e){var t=this;this.forest.normalizedOptions.forEach((function(n){t.traverseDescendantsDFS(n,e),e(n)}))},traverseAllNodesByIndex:function(e){var t=function t(n){n.children.forEach((function(n){!1!==e(n)&&n.isBranch&&t(n)}))};t({children:this.forest.normalizedOptions})},toggleClickOutsideEvent:function(e){e?document.addEventListener("mousedown",this.handleClickOutside,!1):document.removeEventListener("mousedown",this.handleClickOutside,!1)},getValueContainer:function(){return this.$refs.control.$refs["value-container"]},getInput:function(){return this.getValueContainer().$refs.input},focusInput:function(){this.getInput().focus()},blurInput:function(){this.getInput().blur()},handleMouseDown:p((function(e){if(e.preventDefault(),e.stopPropagation(),!this.disabled){var t=this.getValueContainer().$el.contains(e.target);t&&!this.menu.isOpen&&(this.openOnClick||this.trigger.isFocused)&&this.openMenu(),this._blurOnSelect?this.blurInput():this.focusInput(),this.resetFlags()}})),handleClickOutside:function(e){this.$refs.wrapper&&!this.$refs.wrapper.contains(e.target)&&(this.blurInput(),this.closeMenu())},handleLocalSearch:function(){var e=this,t=this.trigger.searchQuery,n=function(){return e.resetHighlightedOptionWhenNecessary(!0)};if(!t)return this.localSearch.active=!1,n();this.localSearch.active=!0,this.localSearch.noResults=!0,this.traverseAllNodesDFS((function(t){var n;t.isBranch&&(t.isExpandedOnSearch=!1,t.showAllChildrenOnSearch=!1,t.isMatched=!1,t.hasMatchedDescendants=!1,e.$set(e.localSearch.countMap,t.id,(n={},l()(n,ne,0),l()(n,re,0),l()(n,ie,0),l()(n,oe,0),n)))}));var r=t.trim().toLocaleLowerCase(),i=r.replace(/\s+/g," ").split(" ");this.traverseAllNodesDFS((function(t){e.searchNested&&i.length>1?t.isMatched=i.every((function(e){return Ee(!1,e,t.nestedSearchLabel)})):t.isMatched=e.matchKeys.some((function(n){return Ee(!e.disableFuzzyMatching,r,t.lowerCased[n])})),t.isMatched&&(e.localSearch.noResults=!1,t.ancestors.forEach((function(t){return e.localSearch.countMap[t.id][re]++})),t.isLeaf&&t.ancestors.forEach((function(t){return e.localSearch.countMap[t.id][oe]++})),t.parentNode!==Z&&(e.localSearch.countMap[t.parentNode.id][ne]+=1,t.isLeaf&&(e.localSearch.countMap[t.parentNode.id][ie]+=1))),(t.isMatched||t.isBranch&&t.isExpandedOnSearch)&&t.parentNode!==Z&&(t.parentNode.isExpandedOnSearch=!0,t.parentNode.hasMatchedDescendants=!0)})),n()},handleRemoteSearch:function(){var e=this,t=this.trigger.searchQuery,n=this.getRemoteSearchEntry(),r=function(){e.initialize(),e.resetHighlightedOptionWhenNecessary(!0)};if((""===t||this.cacheOptions)&&n.isLoaded)return r();this.callLoadOptionsProp({action:le,args:{searchQuery:t},isPending:function(){return n.isLoading},start:function(){n.isLoading=!0,n.isLoaded=!1,n.loadingError=""},succeed:function(i){n.isLoaded=!0,n.options=i,e.trigger.searchQuery===t&&r()},fail:function(e){n.loadingError=Ce(e)},end:function(){n.isLoading=!1}})},getRemoteSearchEntry:function(){var e=this,t=this.trigger.searchQuery,n=this.remoteSearch[t]||be({},Te(),{options:[]});if(this.$watch((function(){return n.options}),(function(){e.trigger.searchQuery===t&&e.initialize()}),{deep:!0}),""===t){if(Array.isArray(this.defaultOptions))return n.options=this.defaultOptions,n.isLoaded=!0,n;if(!0!==this.defaultOptions)return n.isLoaded=!0,n}return this.remoteSearch[t]||this.$set(this.remoteSearch,t,n),n},shouldExpand:function(e){return this.localSearch.active?e.isExpandedOnSearch:e.isExpanded},shouldOptionBeIncludedInSearchResult:function(e){return!!e.isMatched||(!(!e.isBranch||!e.hasMatchedDescendants||this.flattenSearchResults)||!(e.isRootNode||!e.parentNode.showAllChildrenOnSearch))},shouldShowOptionInMenu:function(e){return!(this.localSearch.active&&!this.shouldOptionBeIncludedInSearchResult(e))},getControl:function(){return this.$refs.control.$el},getMenu:function(){var e=this.appendToBody?this.$refs.portal.portalTarget:this,t=e.$refs.menu.$refs.menu;return t&&"#comment"!==t.nodeName?t:null},setCurrentHighlightedOption:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=this.menu.current;if(null!=r&&r in this.forest.nodeMap&&(this.forest.nodeMap[r].isHighlighted=!1),this.menu.current=e.id,e.isHighlighted=!0,this.menu.isOpen&&n){var i=function(){var n=t.getMenu(),r=n.querySelector('.vue-treeselect__option[data-id="'.concat(e.id,'"]'));r&&m(n,r)};this.getMenu()?i():this.$nextTick(i)}},resetHighlightedOptionWhenNecessary:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.menu.current;!e&&null!=t&&t in this.forest.nodeMap&&this.shouldShowOptionInMenu(this.getNode(t))||this.highlightFirstOption()},highlightFirstOption:function(){if(this.hasVisibleOptions){var e=this.visibleOptionIds[0];this.setCurrentHighlightedOption(this.getNode(e))}},highlightPrevOption:function(){if(this.hasVisibleOptions){var e=this.visibleOptionIds.indexOf(this.menu.current)-1;if(-1===e)return this.highlightLastOption();this.setCurrentHighlightedOption(this.getNode(this.visibleOptionIds[e]))}},highlightNextOption:function(){if(this.hasVisibleOptions){var e=this.visibleOptionIds.indexOf(this.menu.current)+1;if(e===this.visibleOptionIds.length)return this.highlightFirstOption();this.setCurrentHighlightedOption(this.getNode(this.visibleOptionIds[e]))}},highlightLastOption:function(){if(this.hasVisibleOptions){var e=q()(this.visibleOptionIds);this.setCurrentHighlightedOption(this.getNode(e))}},resetSearchQuery:function(){this.trigger.searchQuery=""},closeMenu:function(){!this.menu.isOpen||!this.disabled&&this.alwaysOpen||(this.saveMenuScrollPosition(),this.menu.isOpen=!1,this.toggleClickOutsideEvent(!1),this.resetSearchQuery(),this.$emit("close",this.getValue(),this.getInstanceId()))},openMenu:function(){this.disabled||this.menu.isOpen||(this.menu.isOpen=!0,this.$nextTick(this.resetHighlightedOptionWhenNecessary),this.$nextTick(this.restoreMenuScrollPosition),this.options||this.async||this.loadRootOptions(),this.toggleClickOutsideEvent(!0),this.$emit("open",this.getInstanceId()))},toggleMenu:function(){this.menu.isOpen?this.closeMenu():this.openMenu()},toggleExpanded:function(e){var t;this.localSearch.active?(t=e.isExpandedOnSearch=!e.isExpandedOnSearch,t&&(e.showAllChildrenOnSearch=!0)):t=e.isExpanded=!e.isExpanded,t&&!e.childrenStates.isLoaded&&this.loadChildrenOptions(e)},buildForestState:function(){var e=this,t=U();this.forest.selectedNodeIds.forEach((function(e){t[e]=!0})),this.forest.selectedNodeMap=t;var n=U();this.multiple&&(this.traverseAllNodesByIndex((function(e){n[e.id]=J})),this.selectedNodes.forEach((function(t){n[t.id]=te,e.flat||e.disableBranchNodes||t.ancestors.forEach((function(t){e.isSelected(t)||(n[t.id]=ee)}))}))),this.forest.checkedStateMap=n},enhancedNormalizer:function(e){return be({},e,{},this.normalizer(e,this.getInstanceId()))},normalize:function(e,t,n){var r=this,o=t.map((function(e){return[r.enhancedNormalizer(e),e]})).map((function(t,o){var a=i()(t,2),s=a[0],u=a[1];r.checkDuplication(s),r.verifyNodeShape(s);var c=s.id,d=s.label,f=s.children,p=s.isDefaultExpanded,m=e===Z,v=m?0:e.level+1,g=Array.isArray(f)||null===f,y=!g,_=!!s.isDisabled||!r.flat&&!m&&e.isDisabled,x=!!s.isNew,b=r.matchKeys.reduce((function(e,t){return be({},e,l()({},t,Se(s[t]).toLocaleLowerCase()))}),{}),w=m?b.label:e.nestedSearchLabel+" "+b.label,A=r.$set(r.forest.nodeMap,c,U());if(r.$set(A,"id",c),r.$set(A,"label",d),r.$set(A,"level",v),r.$set(A,"ancestors",m?[]:[e].concat(e.ancestors)),r.$set(A,"index",(m?[]:e.index).concat(o)),r.$set(A,"parentNode",e),r.$set(A,"lowerCased",b),r.$set(A,"nestedSearchLabel",w),r.$set(A,"isDisabled",_),r.$set(A,"isNew",x),r.$set(A,"isMatched",!1),r.$set(A,"isHighlighted",!1),r.$set(A,"isBranch",g),r.$set(A,"isLeaf",y),r.$set(A,"isRootNode",m),r.$set(A,"raw",u),g){var T,S=Array.isArray(f);r.$set(A,"childrenStates",be({},Te(),{isLoaded:S})),r.$set(A,"isExpanded","boolean"===typeof p?p:v<r.defaultExpandLevel),r.$set(A,"hasMatchedDescendants",!1),r.$set(A,"hasDisabledDescendants",!1),r.$set(A,"isExpandedOnSearch",!1),r.$set(A,"showAllChildrenOnSearch",!1),r.$set(A,"count",(T={},l()(T,ne,0),l()(T,re,0),l()(T,ie,0),l()(T,oe,0),T)),r.$set(A,"children",S?r.normalize(A,f,n):[]),!0===p&&A.ancestors.forEach((function(e){e.isExpanded=!0})),S||"function"===typeof r.loadOptions?!S&&A.isExpanded&&r.loadChildrenOptions(A):h((function(){return!1}),(function(){return'Unloaded branch node detected. "loadOptions" prop is required to load its children.'}))}if(A.ancestors.forEach((function(e){return e.count[re]++})),y&&A.ancestors.forEach((function(e){return e.count[oe]++})),m||(e.count[ne]+=1,y&&(e.count[ie]+=1),_&&(e.hasDisabledDescendants=!0)),n&&n[c]){var E=n[c];A.isMatched=E.isMatched,A.showAllChildrenOnSearch=E.showAllChildrenOnSearch,A.isHighlighted=E.isHighlighted,E.isBranch&&A.isBranch&&(A.isExpanded=E.isExpanded,A.isExpandedOnSearch=E.isExpandedOnSearch,E.childrenStates.isLoaded&&!A.childrenStates.isLoaded?A.isExpanded=!1:A.childrenStates=be({},E.childrenStates))}return A}));if(this.branchNodesFirst){var a=o.filter((function(e){return e.isBranch})),s=o.filter((function(e){return e.isLeaf}));o=a.concat(s)}return o},loadRootOptions:function(){var e=this;this.callLoadOptionsProp({action:ae,isPending:function(){return e.rootOptionsStates.isLoading},start:function(){e.rootOptionsStates.isLoading=!0,e.rootOptionsStates.loadingError=""},succeed:function(){e.rootOptionsStates.isLoaded=!0,e.$nextTick((function(){e.resetHighlightedOptionWhenNecessary(!0)}))},fail:function(t){e.rootOptionsStates.loadingError=Ce(t)},end:function(){e.rootOptionsStates.isLoading=!1}})},loadChildrenOptions:function(e){var t=this,n=e.id,r=e.raw;this.callLoadOptionsProp({action:se,args:{parentNode:r},isPending:function(){return t.getNode(n).childrenStates.isLoading},start:function(){t.getNode(n).childrenStates.isLoading=!0,t.getNode(n).childrenStates.loadingError=""},succeed:function(){t.getNode(n).childrenStates.isLoaded=!0},fail:function(e){t.getNode(n).childrenStates.loadingError=Ce(e)},end:function(){t.getNode(n).childrenStates.isLoading=!1}})},callLoadOptionsProp:function(e){var t=e.action,n=e.args,r=e.isPending,i=e.start,o=e.succeed,a=e.fail,s=e.end;if(this.loadOptions&&!r()){i();var l=k()((function(e,t){e?a(e):o(t),s()})),u=this.loadOptions(be({id:this.getInstanceId(),instanceId:this.getInstanceId(),action:t},n,{callback:l}));R()(u)&&u.then((function(){l()}),(function(e){l(e)})).catch((function(e){console.error(e)}))}},checkDuplication:function(e){var t=this;h((function(){return!(e.id in t.forest.nodeMap&&!t.forest.nodeMap[e.id].isFallbackNode)}),(function(){return"Detected duplicate presence of node id ".concat(JSON.stringify(e.id),". ")+'Their labels are "'.concat(t.forest.nodeMap[e.id].label,'" and "').concat(e.label,'" respectively.')}))},verifyNodeShape:function(e){h((function(){return!(void 0===e.children&&!0===e.isBranch)}),(function(){return"Are you meant to declare an unloaded branch node? `isBranch: true` is no longer supported, please use `children: null` instead."}))},select:function(e){if(!this.disabled&&!e.isDisabled){this.single&&this.clear();var t=this.multiple&&!this.flat?this.forest.checkedStateMap[e.id]===J:!this.isSelected(e);t?this._selectNode(e):this._deselectNode(e),this.buildForestState(),t?this.$emit("select",e.raw,this.getInstanceId()):this.$emit("deselect",e.raw,this.getInstanceId()),this.localSearch.active&&t&&(this.single||this.clearOnSelect)&&this.resetSearchQuery(),this.single&&this.closeOnSelect&&(this.closeMenu(),this.searchable&&(this._blurOnSelect=!0))}},clear:function(){var e=this;this.hasValue&&(this.single||this.allowClearingDisabled?this.forest.selectedNodeIds=[]:this.forest.selectedNodeIds=this.forest.selectedNodeIds.filter((function(t){return e.getNode(t).isDisabled})),this.buildForestState())},_selectNode:function(e){var t=this;if(this.single||this.disableBranchNodes)return this.addValue(e);if(this.flat)return this.addValue(e),void(this.autoSelectAncestors?e.ancestors.forEach((function(e){t.isSelected(e)||e.isDisabled||t.addValue(e)})):this.autoSelectDescendants&&this.traverseDescendantsBFS(e,(function(e){t.isSelected(e)||e.isDisabled||t.addValue(e)})));var n=e.isLeaf||!e.hasDisabledDescendants||this.allowSelectingDisabledDescendants;if(n&&this.addValue(e),e.isBranch&&this.traverseDescendantsBFS(e,(function(e){e.isDisabled&&!t.allowSelectingDisabledDescendants||t.addValue(e)})),n){var r=e;while((r=r.parentNode)!==Z){if(!r.children.every(this.isSelected))break;this.addValue(r)}}},_deselectNode:function(e){var t=this;if(this.disableBranchNodes)return this.removeValue(e);if(this.flat)return this.removeValue(e),void(this.autoDeselectAncestors?e.ancestors.forEach((function(e){t.isSelected(e)&&!e.isDisabled&&t.removeValue(e)})):this.autoDeselectDescendants&&this.traverseDescendantsBFS(e,(function(e){t.isSelected(e)&&!e.isDisabled&&t.removeValue(e)})));var n=!1;if(e.isBranch&&this.traverseDescendantsDFS(e,(function(e){e.isDisabled&&!t.allowSelectingDisabledDescendants||(t.removeValue(e),n=!0)})),e.isLeaf||n||0===e.children.length){this.removeValue(e);var r=e;while((r=r.parentNode)!==Z){if(!this.isSelected(r))break;this.removeValue(r)}}},addValue:function(e){this.forest.selectedNodeIds.push(e.id),this.forest.selectedNodeMap[e.id]=!0},removeValue:function(e){b(this.forest.selectedNodeIds,e.id),delete this.forest.selectedNodeMap[e.id]},removeLastValue:function(){if(this.hasValue){if(this.single)return this.clear();var e=q()(this.internalValue),t=this.getNode(e);this.select(t)}},saveMenuScrollPosition:function(){var e=this.getMenu();e&&(this.menu.lastScrollPosition=e.scrollTop)},restoreMenuScrollPosition:function(){var e=this.getMenu();e&&(e.scrollTop=this.menu.lastScrollPosition)}},created:function(){this.verifyProps(),this.resetFlags()},mounted:function(){(this.autoFocus||this.autofocus)&&this.focusInput(),this.options||this.async||!this.autoLoadRootOptions||this.loadRootOptions(),this.alwaysOpen&&this.openMenu(),this.async&&this.defaultOptions&&this.handleRemoteSearch()},destroyed:function(){this.toggleClickOutsideEvent(!1)}};function Ne(e){return"string"===typeof e?e:null==e||O(e)?"":JSON.stringify(e)}var De,Oe,Ie={name:"vue-treeselect--hidden-fields",inject:["instance"],functional:!0,render:function(e,t){var n=arguments[0],r=t.injections.instance;if(!r.name||r.disabled||!r.hasValue)return null;var i=r.internalValue.map(Ne);return r.multiple&&r.joinValues&&(i=[i.join(r.delimiter)]),i.map((function(e,t){return n("input",{attrs:{type:"hidden",name:r.name},domProps:{value:e},key:"hidden-field-"+t})}))}},Re=Ie;function Pe(e,t,n,r,i,o,a,s){var l,u="function"===typeof e?e.options:e;if(t&&(u.render=t,u.staticRenderFns=n,u._compiled=!0),r&&(u.functional=!0),o&&(u._scopeId="data-v-"+o),a?(l=function(e){e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,e||"undefined"===typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),i&&i.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(a)},u._ssrRegister=l):i&&(l=s?function(){i.call(this,this.$root.$options.shadowRoot)}:i),l)if(u.functional){u._injectStyles=l;var c=u.render;u.render=function(e,t){return l.call(t),c(e,t)}}else{var d=u.beforeCreate;u.beforeCreate=d?[].concat(d,l):[l]}return{exports:e,options:u}}var ke,Be,Fe,ze,He,Ue,Ge,Ve,je,We,Xe,Ye,qe,Qe,$e,Ke,Ze,Je,et,tt,nt,rt=Pe(Re,De,Oe,!1,null,null,null),it=rt.exports,ot=n(13),at=n.n(ot),st=[ve.ENTER,ve.END,ve.HOME,ve.ARROW_LEFT,ve.ARROW_UP,ve.ARROW_RIGHT,ve.ARROW_DOWN],lt={name:"vue-treeselect--input",inject:["instance"],data:function(){return{inputWidth:ye,value:""}},computed:{needAutoSize:function(){var e=this.instance;return e.searchable&&!e.disabled&&e.multiple},inputStyle:function(){return{width:this.needAutoSize?"".concat(this.inputWidth,"px"):null}}},watch:{"instance.trigger.searchQuery":function(e){this.value=e},value:function(){this.needAutoSize&&this.$nextTick(this.updateInputWidth)}},created:function(){this.debouncedCallback=y()(this.updateSearchQuery,ge,{leading:!0,trailing:!0})},methods:{clear:function(){this.onInput({target:{value:""}})},focus:function(){var e=this.instance;e.disabled||this.$refs.input&&this.$refs.input.focus()},blur:function(){this.$refs.input&&this.$refs.input.blur()},onFocus:function(){var e=this.instance;e.trigger.isFocused=!0,e.openOnFocus&&e.openMenu()},onBlur:function(){var e=this.instance,t=e.getMenu();if(t&&document.activeElement===t)return this.focus();e.trigger.isFocused=!1,e.closeMenu()},onInput:function(e){var t=e.target.value;this.value=t,t?this.debouncedCallback():(this.debouncedCallback.cancel(),this.updateSearchQuery())},onKeyDown:function(e){var t=this.instance,n="which"in e?e.which:e.keyCode;if(!(e.ctrlKey||e.shiftKey||e.altKey||e.metaKey)){if(!t.menu.isOpen&&Q(st,n))return e.preventDefault(),t.openMenu();switch(n){case ve.BACKSPACE:t.backspaceRemoves&&!this.value.length&&t.removeLastValue();break;case ve.ENTER:if(e.preventDefault(),null===t.menu.current)return;var r=t.getNode(t.menu.current);if(r.isBranch&&t.disableBranchNodes)return;t.select(r);break;case ve.ESCAPE:this.value.length?this.clear():t.menu.isOpen&&t.closeMenu();break;case ve.END:e.preventDefault(),t.highlightLastOption();break;case ve.HOME:e.preventDefault(),t.highlightFirstOption();break;case ve.ARROW_LEFT:var i=t.getNode(t.menu.current);i.isBranch&&t.shouldExpand(i)?(e.preventDefault(),t.toggleExpanded(i)):!i.isRootNode&&(i.isLeaf||i.isBranch&&!t.shouldExpand(i))&&(e.preventDefault(),t.setCurrentHighlightedOption(i.parentNode));break;case ve.ARROW_UP:e.preventDefault(),t.highlightPrevOption();break;case ve.ARROW_RIGHT:var o=t.getNode(t.menu.current);o.isBranch&&!t.shouldExpand(o)&&(e.preventDefault(),t.toggleExpanded(o));break;case ve.ARROW_DOWN:e.preventDefault(),t.highlightNextOption();break;case ve.DELETE:t.deleteRemoves&&!this.value.length&&t.removeLastValue();break;default:t.openMenu()}}},onMouseDown:function(e){this.value.length&&e.stopPropagation()},renderInputContainer:function(){var e=this.$createElement,t=this.instance,n={},r=[];return t.searchable&&!t.disabled&&(r.push(this.renderInput()),this.needAutoSize&&r.push(this.renderSizer())),t.searchable||X(n,{on:{focus:this.onFocus,blur:this.onBlur,keydown:this.onKeyDown},ref:"input"}),t.searchable||t.disabled||X(n,{attrs:{tabIndex:t.tabIndex}}),e("div",at()([{class:"vue-treeselect__input-container"},n]),[r])},renderInput:function(){var e=this.$createElement,t=this.instance;return e("input",{ref:"input",class:"vue-treeselect__input",attrs:{type:"text",autocomplete:"off",tabIndex:t.tabIndex,required:t.required&&!t.hasValue},domProps:{value:this.value},style:this.inputStyle,on:{focus:this.onFocus,input:this.onInput,blur:this.onBlur,keydown:this.onKeyDown,mousedown:this.onMouseDown}})},renderSizer:function(){var e=this.$createElement;return e("div",{ref:"sizer",class:"vue-treeselect__sizer"},[this.value])},updateInputWidth:function(){this.inputWidth=Math.max(ye,this.$refs.sizer.scrollWidth+15)},updateSearchQuery:function(){var e=this.instance;e.trigger.searchQuery=this.value}},render:function(){return this.renderInputContainer()}},ut=lt,ct=Pe(ut,ke,Be,!1,null,null,null),dt=ct.exports,ft={name:"vue-treeselect--placeholder",inject:["instance"],render:function(){var e=arguments[0],t=this.instance,n={"vue-treeselect__placeholder":!0,"vue-treeselect-helper-zoom-effect-off":!0,"vue-treeselect-helper-hide":t.hasValue||t.trigger.searchQuery};return e("div",{class:n},[t.placeholder])}},ht=ft,pt=Pe(ht,Fe,ze,!1,null,null,null),mt=pt.exports,vt={name:"vue-treeselect--single-value",inject:["instance"],methods:{renderSingleValueLabel:function(){var e=this.instance,t=e.selectedNodes[0],n=e.$scopedSlots["value-label"];return n?n({node:t}):t.label}},render:function(){var e=arguments[0],t=this.instance,n=this.$parent.renderValueContainer,r=t.hasValue&&!t.trigger.searchQuery;return n([r&&e("div",{class:"vue-treeselect__single-value"},[this.renderSingleValueLabel()]),e(mt),e(dt,{ref:"input"})])}},gt=vt,yt=Pe(gt,He,Ue,!1,null,null,null),_t=yt.exports,xt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 348.333 348.333"}},[n("path",{attrs:{d:"M336.559 68.611L231.016 174.165l105.543 105.549c15.699 15.705 15.699 41.145 0 56.85-7.844 7.844-18.128 11.769-28.407 11.769-10.296 0-20.581-3.919-28.419-11.769L174.167 231.003 68.609 336.563c-7.843 7.844-18.128 11.769-28.416 11.769-10.285 0-20.563-3.919-28.413-11.769-15.699-15.698-15.699-41.139 0-56.85l105.54-105.549L11.774 68.611c-15.699-15.699-15.699-41.145 0-56.844 15.696-15.687 41.127-15.687 56.829 0l105.563 105.554L279.721 11.767c15.705-15.687 41.139-15.687 56.832 0 15.705 15.699 15.705 41.145.006 56.844z"}})])},bt=[],wt={name:"vue-treeselect--x"},At=wt,Tt=Pe(At,xt,bt,!1,null,null,null),St=Tt.exports,Et={name:"vue-treeselect--multi-value-item",inject:["instance"],props:{node:{type:Object,required:!0}},methods:{handleMouseDown:p((function(){var e=this.instance,t=this.node;e.select(t)}))},render:function(){var e=arguments[0],t=this.instance,n=this.node,r={"vue-treeselect__multi-value-item":!0,"vue-treeselect__multi-value-item-disabled":n.isDisabled,"vue-treeselect__multi-value-item-new":n.isNew},i=t.$scopedSlots["value-label"],o=i?i({node:n}):n.label;return e("div",{class:"vue-treeselect__multi-value-item-container"},[e("div",{class:r,on:{mousedown:this.handleMouseDown}},[e("span",{class:"vue-treeselect__multi-value-label"},[o]),e("span",{class:"vue-treeselect__icon vue-treeselect__value-remove"},[e(St)])])])}},Ct=Et,Mt=Pe(Ct,Ge,Ve,!1,null,null,null),Lt=Mt.exports,Nt={name:"vue-treeselect--multi-value",inject:["instance"],methods:{renderMultiValueItems:function(){var e=this.$createElement,t=this.instance;return t.internalValue.slice(0,t.limit).map(t.getNode).map((function(t){return e(Lt,{key:"multi-value-item-".concat(t.id),attrs:{node:t}})}))},renderExceedLimitTip:function(){var e=this.$createElement,t=this.instance,n=t.internalValue.length-t.limit;return n<=0?null:e("div",{class:"vue-treeselect__limit-tip vue-treeselect-helper-zoom-effect-off",key:"exceed-limit-tip"},[e("span",{class:"vue-treeselect__limit-tip-text"},[t.limitText(n)])])}},render:function(){var e=arguments[0],t=this.$parent.renderValueContainer,n={props:{tag:"div",name:"vue-treeselect__multi-value-item--transition",appear:!0}};return t(e("transition-group",at()([{class:"vue-treeselect__multi-value"},n]),[this.renderMultiValueItems(),this.renderExceedLimitTip(),e(mt,{key:"placeholder"}),e(dt,{ref:"input",key:"input"})]))}},Dt=Nt,Ot=Pe(Dt,je,We,!1,null,null,null),It=Ot.exports,Rt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 292.362 292.362"}},[n("path",{attrs:{d:"M286.935 69.377c-3.614-3.617-7.898-5.424-12.848-5.424H18.274c-4.952 0-9.233 1.807-12.85 5.424C1.807 72.998 0 77.279 0 82.228c0 4.948 1.807 9.229 5.424 12.847l127.907 127.907c3.621 3.617 7.902 5.428 12.85 5.428s9.233-1.811 12.847-5.428L286.935 95.074c3.613-3.617 5.427-7.898 5.427-12.847 0-4.948-1.814-9.229-5.427-12.85z"}})])},Pt=[],kt={name:"vue-treeselect--arrow"},Bt=kt,Ft=Pe(Bt,Rt,Pt,!1,null,null,null),zt=Ft.exports,Ht={name:"vue-treeselect--control",inject:["instance"],computed:{shouldShowX:function(){var e=this.instance;return e.clearable&&!e.disabled&&e.hasValue&&(this.hasUndisabledValue||e.allowClearingDisabled)},shouldShowArrow:function(){var e=this.instance;return!e.alwaysOpen||!e.menu.isOpen},hasUndisabledValue:function(){var e=this.instance;return e.hasValue&&e.internalValue.some((function(t){return!e.getNode(t).isDisabled}))}},methods:{renderX:function(){var e=this.$createElement,t=this.instance,n=t.multiple?t.clearAllText:t.clearValueText;return this.shouldShowX?e("div",{class:"vue-treeselect__x-container",attrs:{title:n},on:{mousedown:this.handleMouseDownOnX}},[e(St,{class:"vue-treeselect__x"})]):null},renderArrow:function(){var e=this.$createElement,t=this.instance,n={"vue-treeselect__control-arrow":!0,"vue-treeselect__control-arrow--rotated":t.menu.isOpen};return this.shouldShowArrow?e("div",{class:"vue-treeselect__control-arrow-container",on:{mousedown:this.handleMouseDownOnArrow}},[e(zt,{class:n})]):null},handleMouseDownOnX:p((function(e){e.stopPropagation(),e.preventDefault();var t=this.instance,n=t.beforeClearAll(),r=function(e){e&&t.clear()};R()(n)?n.then(r):setTimeout((function(){return r(n)}),0)})),handleMouseDownOnArrow:p((function(e){e.preventDefault(),e.stopPropagation();var t=this.instance;t.focusInput(),t.toggleMenu()})),renderValueContainer:function(e){var t=this.$createElement;return t("div",{class:"vue-treeselect__value-container"},[e])}},render:function(){var e=arguments[0],t=this.instance,n=t.single?_t:It;return e("div",{class:"vue-treeselect__control",on:{mousedown:t.handleMouseDown}},[e(n,{ref:"value-container"}),this.renderX(),this.renderArrow()])}},Ut=Ht,Gt=Pe(Ut,Xe,Ye,!1,null,null,null),Vt=Gt.exports,jt={name:"vue-treeselect--tip",functional:!0,props:{type:{type:String,required:!0},icon:{type:String,required:!0}},render:function(e,t){var n=arguments[0],r=t.props,i=t.children;return n("div",{class:"vue-treeselect__tip vue-treeselect__".concat(r.type,"-tip")},[n("div",{class:"vue-treeselect__icon-container"},[n("span",{class:"vue-treeselect__icon-".concat(r.icon)})]),n("span",{class:"vue-treeselect__tip-text vue-treeselect__".concat(r.type,"-tip-text")},[i])])}},Wt=jt,Xt=Pe(Wt,qe,Qe,!1,null,null,null),Yt=Xt.exports,qt={name:"vue-treeselect--option",inject:["instance"],props:{node:{type:Object,required:!0}},computed:{shouldExpand:function(){var e=this.instance,t=this.node;return t.isBranch&&e.shouldExpand(t)},shouldShow:function(){var e=this.instance,t=this.node;return e.shouldShowOptionInMenu(t)}},methods:{renderOption:function(){var e=this.$createElement,t=this.instance,n=this.node,r={"vue-treeselect__option":!0,"vue-treeselect__option--disabled":n.isDisabled,"vue-treeselect__option--selected":t.isSelected(n),"vue-treeselect__option--highlight":n.isHighlighted,"vue-treeselect__option--matched":t.localSearch.active&&n.isMatched,"vue-treeselect__option--hide":!this.shouldShow};return e("div",{class:r,on:{mouseenter:this.handleMouseEnterOption},attrs:{"data-id":n.id}},[this.renderArrow(),this.renderLabelContainer([this.renderCheckboxContainer([this.renderCheckbox()]),this.renderLabel()])])},renderSubOptionsList:function(){var e=this.$createElement;return this.shouldExpand?e("div",{class:"vue-treeselect__list"},[this.renderSubOptions(),this.renderNoChildrenTip(),this.renderLoadingChildrenTip(),this.renderLoadingChildrenErrorTip()]):null},renderArrow:function(){var e=this.$createElement,t=this.instance,n=this.node;if(t.shouldFlattenOptions&&this.shouldShow)return null;if(n.isBranch){var r={props:{name:"vue-treeselect__option-arrow--prepare",appear:!0}},i={"vue-treeselect__option-arrow":!0,"vue-treeselect__option-arrow--rotated":this.shouldExpand};return e("div",{class:"vue-treeselect__option-arrow-container",on:{mousedown:this.handleMouseDownOnArrow}},[e("transition",r,[e(zt,{class:i})])])}return t.hasBranchNodes?($e||($e=e("div",{class:"vue-treeselect__option-arrow-placeholder"},[" "])),$e):null},renderLabelContainer:function(e){var t=this.$createElement;return t("div",{class:"vue-treeselect__label-container",on:{mousedown:this.handleMouseDownOnLabelContainer}},[e])},renderCheckboxContainer:function(e){var t=this.$createElement,n=this.instance,r=this.node;return n.single||n.disableBranchNodes&&r.isBranch?null:t("div",{class:"vue-treeselect__checkbox-container"},[e])},renderCheckbox:function(){var e=this.$createElement,t=this.instance,n=this.node,r=t.forest.checkedStateMap[n.id],i={"vue-treeselect__checkbox":!0,"vue-treeselect__checkbox--checked":r===te,"vue-treeselect__checkbox--indeterminate":r===ee,"vue-treeselect__checkbox--unchecked":r===J,"vue-treeselect__checkbox--disabled":n.isDisabled};return Ke||(Ke=e("span",{class:"vue-treeselect__check-mark"})),Ze||(Ze=e("span",{class:"vue-treeselect__minus-mark"})),e("span",{class:i},[Ke,Ze])},renderLabel:function(){var e=this.$createElement,t=this.instance,n=this.node,r=n.isBranch&&(t.localSearch.active?t.showCountOnSearchComputed:t.showCount),i=r?t.localSearch.active?t.localSearch.countMap[n.id][t.showCountOf]:n.count[t.showCountOf]:NaN,o="vue-treeselect__label",a="vue-treeselect__count",s=t.$scopedSlots["option-label"];return s?s({node:n,shouldShowCount:r,count:i,labelClassName:o,countClassName:a}):e("label",{class:o},[n.label,r&&e("span",{class:a},["(",i,")"])])},renderSubOptions:function(){var e=this.$createElement,t=this.node;return t.childrenStates.isLoaded?t.children.map((function(t){return e(qt,{attrs:{node:t},key:t.id})})):null},renderNoChildrenTip:function(){var e=this.$createElement,t=this.instance,n=this.node;return!n.childrenStates.isLoaded||n.children.length?null:e(Yt,{attrs:{type:"no-children",icon:"warning"}},[t.noChildrenText])},renderLoadingChildrenTip:function(){var e=this.$createElement,t=this.instance,n=this.node;return n.childrenStates.isLoading?e(Yt,{attrs:{type:"loading",icon:"loader"}},[t.loadingText]):null},renderLoadingChildrenErrorTip:function(){var e=this.$createElement,t=this.instance,n=this.node;return n.childrenStates.loadingError?e(Yt,{attrs:{type:"error",icon:"error"}},[n.childrenStates.loadingError,e("a",{class:"vue-treeselect__retry",attrs:{title:t.retryTitle},on:{mousedown:this.handleMouseDownOnRetry}},[t.retryText])]):null},handleMouseEnterOption:function(e){var t=this.instance,n=this.node;e.target===e.currentTarget&&t.setCurrentHighlightedOption(n,!1)},handleMouseDownOnArrow:p((function(){var e=this.instance,t=this.node;e.toggleExpanded(t)})),handleMouseDownOnLabelContainer:p((function(){var e=this.instance,t=this.node;t.isBranch&&e.disableBranchNodes?e.toggleExpanded(t):e.select(t)})),handleMouseDownOnRetry:p((function(){var e=this.instance,t=this.node;e.loadChildrenOptions(t)}))},render:function(){var e=arguments[0],t=this.node,n=this.instance.shouldFlattenOptions?0:t.level,r=l()({"vue-treeselect__list-item":!0},"vue-treeselect__indent-level-".concat(n),!0),i={props:{name:"vue-treeselect__list--transition"}};return e("div",{class:r},[this.renderOption(),e("transition",i,[this.renderSubOptionsList()])])}},Qt=qt,$t=Qt,Kt=Pe($t,Je,et,!1,null,null,null),Zt=Kt.exports,Jt={top:"top",bottom:"bottom",above:"top",below:"bottom"},en={name:"vue-treeselect--menu",inject:["instance"],computed:{menuStyle:function(){var e=this.instance;return{maxHeight:e.maxHeight+"px"}},menuContainerStyle:function(){var e=this.instance;return{zIndex:e.appendToBody?null:e.zIndex}}},watch:{"instance.menu.isOpen":function(e){e?this.$nextTick(this.onMenuOpen):this.onMenuClose()}},created:function(){this.menuSizeWatcher=null,this.menuResizeAndScrollEventListeners=null},mounted:function(){var e=this.instance;e.menu.isOpen&&this.$nextTick(this.onMenuOpen)},destroyed:function(){this.onMenuClose()},methods:{renderMenu:function(){var e=this.$createElement,t=this.instance;return t.menu.isOpen?e("div",{ref:"menu",class:"vue-treeselect__menu",on:{mousedown:t.handleMouseDown},style:this.menuStyle},[t.async?this.renderAsyncSearchMenuInner():t.localSearch.active?this.renderLocalSearchMenuInner():this.renderNormalMenuInner()]):null},renderNormalMenuInner:function(){var e=this.instance;return e.rootOptionsStates.isLoading?this.renderLoadingOptionsTip():e.rootOptionsStates.loadingError?this.renderLoadingRootOptionsErrorTip():e.rootOptionsStates.isLoaded&&0===e.forest.normalizedOptions.length?this.renderNoAvailableOptionsTip():this.renderOptionList()},renderLocalSearchMenuInner:function(){var e=this.instance;return e.rootOptionsStates.isLoading?this.renderLoadingOptionsTip():e.rootOptionsStates.loadingError?this.renderLoadingRootOptionsErrorTip():e.rootOptionsStates.isLoaded&&0===e.forest.normalizedOptions.length?this.renderNoAvailableOptionsTip():e.localSearch.noResults?this.renderNoResultsTip():this.renderOptionList()},renderAsyncSearchMenuInner:function(){var e=this.instance,t=e.getRemoteSearchEntry(),n=""===e.trigger.searchQuery&&!e.defaultOptions,r=!n&&(t.isLoaded&&0===t.options.length);return n?this.renderSearchPromptTip():t.isLoading?this.renderLoadingOptionsTip():t.loadingError?this.renderAsyncSearchLoadingErrorTip():r?this.renderNoResultsTip():this.renderOptionList()},renderOptionList:function(){var e=this.$createElement,t=this.instance;return e("div",{class:"vue-treeselect__list"},[t.forest.normalizedOptions.map((function(t){return e(Zt,{attrs:{node:t},key:t.id})}))])},renderSearchPromptTip:function(){var e=this.$createElement,t=this.instance;return e(Yt,{attrs:{type:"search-prompt",icon:"warning"}},[t.searchPromptText])},renderLoadingOptionsTip:function(){var e=this.$createElement,t=this.instance;return e(Yt,{attrs:{type:"loading",icon:"loader"}},[t.loadingText])},renderLoadingRootOptionsErrorTip:function(){var e=this.$createElement,t=this.instance;return e(Yt,{attrs:{type:"error",icon:"error"}},[t.rootOptionsStates.loadingError,e("a",{class:"vue-treeselect__retry",on:{click:t.loadRootOptions},attrs:{title:t.retryTitle}},[t.retryText])])},renderAsyncSearchLoadingErrorTip:function(){var e=this.$createElement,t=this.instance,n=t.getRemoteSearchEntry();return e(Yt,{attrs:{type:"error",icon:"error"}},[n.loadingError,e("a",{class:"vue-treeselect__retry",on:{click:t.handleRemoteSearch},attrs:{title:t.retryTitle}},[t.retryText])])},renderNoAvailableOptionsTip:function(){var e=this.$createElement,t=this.instance;return e(Yt,{attrs:{type:"no-options",icon:"warning"}},[t.noOptionsText])},renderNoResultsTip:function(){var e=this.$createElement,t=this.instance;return e(Yt,{attrs:{type:"no-results",icon:"warning"}},[t.noResultsText])},onMenuOpen:function(){this.adjustMenuOpenDirection(),this.setupMenuSizeWatcher(),this.setupMenuResizeAndScrollEventListeners()},onMenuClose:function(){this.removeMenuSizeWatcher(),this.removeMenuResizeAndScrollEventListeners()},adjustMenuOpenDirection:function(){var e=this.instance;if(e.menu.isOpen){var t=e.getMenu(),n=e.getControl(),r=t.getBoundingClientRect(),i=n.getBoundingClientRect(),o=r.height,a=window.innerHeight,s=i.top,l=window.innerHeight-i.bottom,u=i.top>=0&&i.top<=a||i.top<0&&i.bottom>0,c=l>o+_e,d=s>o+_e;u?"auto"!==e.openDirection?e.menu.placement=Jt[e.openDirection]:e.menu.placement=c||!d?"bottom":"top":e.closeMenu()}},setupMenuSizeWatcher:function(){var e=this.instance,t=e.getMenu();this.menuSizeWatcher||(this.menuSizeWatcher={remove:M(t,this.adjustMenuOpenDirection)})},setupMenuResizeAndScrollEventListeners:function(){var e=this.instance,t=e.getControl();this.menuResizeAndScrollEventListeners||(this.menuResizeAndScrollEventListeners={remove:D(t,this.adjustMenuOpenDirection)})},removeMenuSizeWatcher:function(){this.menuSizeWatcher&&(this.menuSizeWatcher.remove(),this.menuSizeWatcher=null)},removeMenuResizeAndScrollEventListeners:function(){this.menuResizeAndScrollEventListeners&&(this.menuResizeAndScrollEventListeners.remove(),this.menuResizeAndScrollEventListeners=null)}},render:function(){var e=arguments[0];return e("div",{ref:"menu-container",class:"vue-treeselect__menu-container",style:this.menuContainerStyle},[e("transition",{attrs:{name:"vue-treeselect__menu--transition"}},[this.renderMenu()])])}},tn=en,nn=Pe(tn,tt,nt,!1,null,null,null),rn=nn.exports,on=n(14),an=n.n(on);function sn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ln(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?sn(n,!0).forEach((function(t){l()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):sn(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var un,cn,dn,fn,hn,pn={name:"vue-treeselect--portal-target",inject:["instance"],watch:{"instance.menu.isOpen":function(e){e?this.setupHandlers():this.removeHandlers()},"instance.menu.placement":function(){this.updateMenuContainerOffset()}},created:function(){this.controlResizeAndScrollEventListeners=null,this.controlSizeWatcher=null},mounted:function(){var e=this.instance;e.menu.isOpen&&this.setupHandlers()},methods:{setupHandlers:function(){this.updateWidth(),this.updateMenuContainerOffset(),this.setupControlResizeAndScrollEventListeners(),this.setupControlSizeWatcher()},removeHandlers:function(){this.removeControlResizeAndScrollEventListeners(),this.removeControlSizeWatcher()},setupControlResizeAndScrollEventListeners:function(){var e=this.instance,t=e.getControl();this.controlResizeAndScrollEventListeners||(this.controlResizeAndScrollEventListeners={remove:D(t,this.updateMenuContainerOffset)})},setupControlSizeWatcher:function(){var e=this,t=this.instance,n=t.getControl();this.controlSizeWatcher||(this.controlSizeWatcher={remove:M(n,(function(){e.updateWidth(),e.updateMenuContainerOffset()}))})},removeControlResizeAndScrollEventListeners:function(){this.controlResizeAndScrollEventListeners&&(this.controlResizeAndScrollEventListeners.remove(),this.controlResizeAndScrollEventListeners=null)},removeControlSizeWatcher:function(){this.controlSizeWatcher&&(this.controlSizeWatcher.remove(),this.controlSizeWatcher=null)},updateWidth:function(){var e=this.instance,t=this.$el,n=e.getControl(),r=n.getBoundingClientRect();t.style.width=r.width+"px"},updateMenuContainerOffset:function(){var e=this.instance,t=e.getControl(),n=this.$el,r=t.getBoundingClientRect(),i=n.getBoundingClientRect(),o="bottom"===e.menu.placement?r.height:0,a=Math.round(r.left-i.left)+"px",s=Math.round(r.top-i.top+o)+"px",l=this.$refs.menu.$refs["menu-container"].style,u=["transform","webkitTransform","MozTransform","msTransform"],c=$(u,(function(e){return e in document.body.style}));l[c]="translate(".concat(a,", ").concat(s,")")}},render:function(){var e=arguments[0],t=this.instance,n=["vue-treeselect__portal-target",t.wrapperClass],r={zIndex:t.zIndex};return e("div",{class:n,style:r,attrs:{"data-instance-id":t.getInstanceId()}},[e(rn,{ref:"menu"})])},destroyed:function(){this.removeHandlers()}},mn={name:"vue-treeselect--menu-portal",created:function(){this.portalTarget=null},mounted:function(){this.setup()},destroyed:function(){this.teardown()},methods:{setup:function(){var e=document.createElement("div");document.body.appendChild(e),this.portalTarget=new an.a(ln({el:e,parent:this},pn))},teardown:function(){document.body.removeChild(this.portalTarget.$el),this.portalTarget.$el.innerHTML="",this.portalTarget.$destroy(),this.portalTarget=null}},render:function(){var e=arguments[0];return un||(un=e("div",{class:"vue-treeselect__menu-placeholder"})),un}},vn=mn,gn=Pe(vn,cn,dn,!1,null,null,null),yn=gn.exports,_n={name:"vue-treeselect",mixins:[Le],computed:{wrapperClass:function(){return{"vue-treeselect":!0,"vue-treeselect--single":this.single,"vue-treeselect--multi":this.multiple,"vue-treeselect--searchable":this.searchable,"vue-treeselect--disabled":this.disabled,"vue-treeselect--focused":this.trigger.isFocused,"vue-treeselect--has-value":this.hasValue,"vue-treeselect--open":this.menu.isOpen,"vue-treeselect--open-above":"top"===this.menu.placement,"vue-treeselect--open-below":"bottom"===this.menu.placement,"vue-treeselect--branch-nodes-disabled":this.disableBranchNodes,"vue-treeselect--append-to-body":this.appendToBody}}},render:function(){var e=arguments[0];return e("div",{ref:"wrapper",class:this.wrapperClass},[e(it),e(Vt,{ref:"control"}),this.appendToBody?e(yn,{ref:"portal"}):e(rn,{ref:"menu"})])}},xn=_n,bn=Pe(xn,fn,hn,!1,null,null,null),wn=bn.exports;n(15);n.d(t,"__esModule",(function(){return An})),n.d(t,"VERSION",(function(){return Tn})),n.d(t,"Treeselect",(function(){return wn})),n.d(t,"treeselectMixin",(function(){return Le})),n.d(t,"LOAD_ROOT_OPTIONS",(function(){return ae})),n.d(t,"LOAD_CHILDREN_OPTIONS",(function(){return se})),n.d(t,"ASYNC_SEARCH",(function(){return le}));t["default"]=wn;var An=!0,Tn="0.1.0"}])},7037:function(e,t){function n(t){return e.exports=n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports["default"]=e.exports,n(t)}e.exports=n,e.exports.__esModule=!0,e.exports["default"]=e.exports},"72f0":function(e,t){function n(e){return function(){return e}}e.exports=n},7514:function(e,t,n){"use strict";var r=n("5ca1"),i=n("0a49")(5),o="find",a=!0;o in[]&&Array(1)[o]((function(){a=!1})),r(r.P+r.F*a,"Array",{find:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),n("9c6c")(o)},"793f":function(e,t,n){"use strict";var r,i;
/*!
 * wordcloud2.js
 * http://timdream.org/wordcloud2.js/
 *
 * Copyright 2011 - 2013 Tim Chien
 * Released under the MIT license
 */window.setImmediate||(window.setImmediate=function(){return window.msSetImmediate||window.webkitSetImmediate||window.mozSetImmediate||window.oSetImmediate||function(){if(!window.postMessage||!window.addEventListener)return null;var e=[void 0],t="zero-timeout-message",n=function(n){var r=e.length;return e.push(n),window.postMessage(t+r.toString(36),"*"),r};return window.addEventListener("message",(function(n){if("string"===typeof n.data&&n.data.substr(0,t.length)===t){n.stopImmediatePropagation();var r=parseInt(n.data.substr(t.length),36);e[r]&&(e[r](),e[r]=void 0)}}),!0),window.clearImmediate=function(t){e[t]&&(e[t]=void 0)},n}()||function(e){window.setTimeout(e,0)}}()),window.clearImmediate||(window.clearImmediate=function(){return window.msClearImmediate||window.webkitClearImmediate||window.mozClearImmediate||window.oClearImmediate||function(e){window.clearTimeout(e)}}()),function(n){var o=function(){var e=document.createElement("canvas");if(!e||!e.getContext)return!1;var t=e.getContext("2d");return!!t.getImageData&&(!!t.fillText&&(!!Array.prototype.some&&!!Array.prototype.push))}(),a=function(){if(o){var e,t,n=document.createElement("canvas").getContext("2d"),r=20;while(r){if(n.font=r.toString(10)+"px sans-serif",n.measureText("Ｗ").width===e&&n.measureText("m").width===t)return r+1;e=n.measureText("Ｗ").width,t=n.measureText("m").width,r--}return 0}}(),s=function(e){for(var t,n,r=e.length;r;t=Math.floor(Math.random()*r),n=e[--r],e[r]=e[t],e[t]=n);return e},l=function(e,t){if(o){Array.isArray(e)||(e=[e]),e.forEach((function(t,n){if("string"===typeof t){if(e[n]=document.getElementById(t),!e[n])throw"The element id specified is not found."}else if(!t.tagName&&!t.appendChild)throw"You must pass valid HTML elements, or ID of the element."}));var n={list:[],fontFamily:'"Trebuchet MS", "Heiti TC", "微軟正黑體", "Arial Unicode MS", "Droid Fallback Sans", sans-serif',fontWeight:"normal",color:"random-dark",minSize:0,weightFactor:1,clearCanvas:!0,backgroundColor:"#fff",gridSize:8,drawOutOfBound:!1,origin:null,drawMask:!1,maskColor:"rgba(255,0,0,0.3)",maskGapWidth:.3,wait:0,abortThreshold:0,abort:function(){},minRotation:-Math.PI/2,maxRotation:Math.PI/2,rotationStep:.1,shuffle:!0,rotateRatio:.1,shape:"circle",ellipticity:.65,classes:null,hover:null,click:null};if(t)for(var r in t)r in n&&(n[r]=t[r]);if("function"!==typeof n.weightFactor){var i=n.weightFactor;n.weightFactor=function(e){return e*i}}if("function"!==typeof n.shape)switch(n.shape){case"circle":default:n.shape="circle";break;case"cardioid":n.shape=function(e){return 1-Math.sin(e)};break;case"diamond":case"square":n.shape=function(e){var t=e%(2*Math.PI/4);return 1/(Math.cos(t)+Math.sin(t))};break;case"triangle-forward":n.shape=function(e){var t=e%(2*Math.PI/3);return 1/(Math.cos(t)+Math.sqrt(3)*Math.sin(t))};break;case"triangle":case"triangle-upright":n.shape=function(e){var t=(e+3*Math.PI/2)%(2*Math.PI/3);return 1/(Math.cos(t)+Math.sqrt(3)*Math.sin(t))};break;case"pentagon":n.shape=function(e){var t=(e+.955)%(2*Math.PI/5);return 1/(Math.cos(t)+.726543*Math.sin(t))};break;case"star":n.shape=function(e){var t=(e+.955)%(2*Math.PI/10);return(e+.955)%(2*Math.PI/5)-2*Math.PI/10>=0?1/(Math.cos(2*Math.PI/10-t)+3.07768*Math.sin(2*Math.PI/10-t)):1/(Math.cos(t)+3.07768*Math.sin(t))};break}n.gridSize=Math.max(Math.floor(n.gridSize),4);var l,u,c,d,f,h,p,m=n.gridSize,v=m-n.maskGapWidth,g=Math.abs(n.maxRotation-n.minRotation),y=Math.min(n.maxRotation,n.minRotation),_=n.rotationStep;switch(n.color){case"random-dark":p=function(){return z(10,50)};break;case"random-light":p=function(){return z(50,90)};break;default:"function"===typeof n.color&&(p=n.color);break}var x=null;"function"===typeof n.classes&&(x=n.classes);var b,w=!1,A=[],T=function(e){var t,n,r=e.currentTarget,i=r.getBoundingClientRect();e.touches?(t=e.touches[0].clientX,n=e.touches[0].clientY):(t=e.clientX,n=e.clientY);var o=t-i.left,a=n-i.top,s=Math.floor(o*(r.width/i.width||1)/m),l=Math.floor(a*(r.height/i.height||1)/m);return A[s][l]},S=function(e){var t=T(e);b!==t&&(b=t,t?n.hover(t.item,t.dimension,e):n.hover(void 0,void 0,e))},E=function(e){var t=T(e);t&&(n.click(t.item,t.dimension,e),e.preventDefault())},C=[],M=function(e){if(C[e])return C[e];var t=8*e,r=t,i=[];0===e&&i.push([d[0],d[1],0]);while(r--){var o=1;"circle"!==n.shape&&(o=n.shape(r/t*2*Math.PI)),i.push([d[0]+e*o*Math.cos(-r/t*2*Math.PI),d[1]+e*o*Math.sin(-r/t*2*Math.PI)*n.ellipticity,r/t*2*Math.PI])}return C[e]=i,i},L=function(){return n.abortThreshold>0&&(new Date).getTime()-h>n.abortThreshold},N=function(){return 0===n.rotateRatio||Math.random()>n.rotateRatio?0:0===g?y:y+Math.round(Math.random()*g/_)*_},D=function(e,t,r){var i=!1,o=n.weightFactor(t);if(o<=n.minSize)return!1;var s=1;o<a&&(s=function(){var e=2;while(e*o<a)e+=2;return e}());var l=document.createElement("canvas"),u=l.getContext("2d",{willReadFrequently:!0});u.font=n.fontWeight+" "+(o*s).toString(10)+"px "+n.fontFamily;var c=u.measureText(e).width/s,d=Math.max(o*s,u.measureText("m").width,u.measureText("Ｗ").width)/s,f=c+2*d,h=3*d,p=Math.ceil(f/m),v=Math.ceil(h/m);f=p*m,h=v*m;var g=-c/2,y=.4*-d,_=Math.ceil((f*Math.abs(Math.sin(r))+h*Math.abs(Math.cos(r)))/m),x=Math.ceil((f*Math.abs(Math.cos(r))+h*Math.abs(Math.sin(r)))/m),b=x*m,w=_*m;l.setAttribute("width",b),l.setAttribute("height",w),i&&(document.body.appendChild(l),u.save()),u.scale(1/s,1/s),u.translate(b*s/2,w*s/2),u.rotate(-r),u.font=n.fontWeight+" "+(o*s).toString(10)+"px "+n.fontFamily,u.fillStyle="#000",u.textBaseline="middle",u.fillText(e,g*s,(y+.5*o)*s);var A=u.getImageData(0,0,b,w).data;if(L())return!1;i&&(u.strokeRect(g*s,y,c*s,d*s),u.restore());var T,S,E,C=[],M=x,N=[_/2,x/2,_/2,x/2];while(M--){T=_;while(T--){E=m;e:{while(E--){S=m;while(S--)if(A[4*((T*m+E)*b+(M*m+S))+3]){C.push([M,T]),M<N[3]&&(N[3]=M),M>N[1]&&(N[1]=M),T<N[0]&&(N[0]=T),T>N[2]&&(N[2]=T),i&&(u.fillStyle="rgba(255, 0, 0, 0.5)",u.fillRect(M*m,T*m,m-.5,m-.5));break e}}i&&(u.fillStyle="rgba(0, 0, 255, 0.5)",u.fillRect(M*m,T*m,m-.5,m-.5))}}}return i&&(u.fillStyle="rgba(0, 255, 0, 0.5)",u.fillRect(N[3]*m,N[0]*m,(N[1]-N[3]+1)*m,(N[2]-N[0]+1)*m)),{mu:s,occupied:C,bounds:N,gw:x,gh:_,fillTextOffsetX:g,fillTextOffsetY:y,fillTextWidth:c,fillTextHeight:d,fontSize:o}},O=function(e,t,r,i,o){var a=o.length;while(a--){var s=e+o[a][0],d=t+o[a][1];if(s>=u||d>=c||s<0||d<0){if(!n.drawOutOfBound)return!1}else if(!l[s][d])return!1}return!0},I=function(t,r,i,o,a,s,l,u,c){var d,f,h=i.fontSize;d=p?p(o,a,h,s,l):n.color,f=x?x(o,a,h,s,l):n.classes;var v=i.bounds;v[3],v[0],v[1],v[3],v[2],v[0],e.forEach((function(e){if(e.getContext){var a=e.getContext("2d"),s=i.mu;a.save(),a.scale(1/s,1/s),a.font=n.fontWeight+" "+(h*s).toString(10)+"px "+n.fontFamily,a.fillStyle=d,a.translate((t+i.gw/2)*m*s,(r+i.gh/2)*m*s),0!==u&&a.rotate(-u),a.textBaseline="middle",a.fillText(o,i.fillTextOffsetX*s,(i.fillTextOffsetY+.5*h)*s),a.restore()}else{var l=document.createElement("span"),p="";p="rotate("+-u/Math.PI*180+"deg) ",1!==i.mu&&(p+="translateX(-"+i.fillTextWidth/4+"px) scale("+1/i.mu+")");var v={position:"absolute",display:"block",font:n.fontWeight+" "+h*i.mu+"px "+n.fontFamily,left:(t+i.gw/2)*m+i.fillTextOffsetX+"px",top:(r+i.gh/2)*m+i.fillTextOffsetY+"px",width:i.fillTextWidth+"px",height:i.fillTextHeight+"px",lineHeight:h+"px",whiteSpace:"nowrap",transform:p,webkitTransform:p,msTransform:p,transformOrigin:"50% 40%",webkitTransformOrigin:"50% 40%",msTransformOrigin:"50% 40%"};for(var g in d&&(v.color=d),l.textContent=o,v)l.style[g]=v[g];if(c)for(var y in c)l.setAttribute(y,c[y]);f&&(l.className+=f),e.appendChild(l)}}))},R=function(t,n,r,i,o){if(!(t>=u||n>=c||t<0||n<0)){if(l[t][n]=!1,r){var a=e[0].getContext("2d");a.fillRect(t*m,n*m,v,v)}w&&(A[t][n]={item:o,dimension:i})}},P=function(t,r,i,o,a,s){var l,d,f=a.occupied,h=n.drawMask;if(h&&(l=e[0].getContext("2d"),l.save(),l.fillStyle=n.maskColor),w){var p=a.bounds;d={x:(t+p[3])*m,y:(r+p[0])*m,w:(p[1]-p[3]+1)*m,h:(p[2]-p[0]+1)*m}}var v=f.length;while(v--){var g=t+f[v][0],y=r+f[v][1];g>=u||y>=c||g<0||y<0||R(g,y,h,d,s)}h&&l.restore()},k=function(e){var t,r,i;Array.isArray(e)?(t=e[0],r=e[1]):(t=e.word,r=e.weight,i=e.attributes);var o=N(),a=D(t,r,o);if(!a)return!1;if(L())return!1;if(!n.drawOutOfBound){var l=a.bounds;if(l[1]-l[3]+1>u||l[2]-l[0]+1>c)return!1}var d=f+1,h=function(n){var s=Math.floor(n[0]-a.gw/2),l=Math.floor(n[1]-a.gh/2),u=a.gw,c=a.gh;return!!O(s,l,u,c,a.occupied)&&(I(s,l,a,t,r,f-d,n[2],o,i),P(s,l,u,c,a,e),{gx:s,gy:l,rot:o,info:a})};while(d--){var p=M(f-d);n.shuffle&&(p=[].concat(p),s(p));for(var m=0;m<p.length;m++){var v=h(p[m]);if(v)return v}}return null},B=function(t,n,r){if(n)return!e.some((function(e){var i=document.createEvent("CustomEvent");return i.initCustomEvent(t,!0,n,r||{}),!e.dispatchEvent(i)}),this);e.forEach((function(e){var i=document.createEvent("CustomEvent");i.initCustomEvent(t,!0,n,r||{}),e.dispatchEvent(i)}),this)},F=function(){var t=e[0];if(t.getContext)u=Math.ceil(t.width/m),c=Math.ceil(t.height/m);else{var r=t.getBoundingClientRect();u=Math.ceil(r.width/m),c=Math.ceil(r.height/m)}if(B("wordcloudstart",!0)){var i,o,a,s,p;if(d=n.origin?[n.origin[0]/m,n.origin[1]/m]:[u/2,c/2],f=Math.floor(Math.sqrt(u*u+c*c)),l=[],!t.getContext||n.clearCanvas){e.forEach((function(e){if(e.getContext){var t=e.getContext("2d");t.fillStyle=n.backgroundColor,t.clearRect(0,0,u*(m+1),c*(m+1)),t.fillRect(0,0,u*(m+1),c*(m+1))}else e.textContent="",e.style.backgroundColor=n.backgroundColor,e.style.position="relative"})),i=u;while(i--){l[i]=[],o=c;while(o--)l[i][o]=!0}}else{var v=document.createElement("canvas").getContext("2d");v.fillStyle=n.backgroundColor,v.fillRect(0,0,1,1);var g,y,_=v.getImageData(0,0,1,1).data,x=t.getContext("2d").getImageData(0,0,u*m,c*m).data;i=u;while(i--){l[i]=[],o=c;while(o--){y=m;e:while(y--){g=m;while(g--){a=4;while(a--)if(x[4*((o*m+y)*u*m+(i*m+g))+a]!==_[a]){l[i][o]=!1;break e}}}!1!==l[i][o]&&(l[i][o]=!0)}}x=v=_=void 0}if(n.hover||n.click){w=!0,i=u+1;while(i--)A[i]=[];n.hover&&t.addEventListener("mousemove",S),n.click&&(t.addEventListener("click",E),t.addEventListener("touchstart",E),t.addEventListener("touchend",(function(e){e.preventDefault()})),t.style.webkitTapHighlightColor="rgba(0, 0, 0, 0)"),t.addEventListener("wordcloudstart",(function e(){t.removeEventListener("wordcloudstart",e),t.removeEventListener("mousemove",S),t.removeEventListener("click",E),b=void 0}))}a=0,0!==n.wait?(s=window.setTimeout,p=window.clearTimeout):(s=window.setImmediate,p=window.clearImmediate);var T=function(t,n){e.forEach((function(e){e.addEventListener(t,n)}),this)},C=function(t,n){e.forEach((function(e){e.removeEventListener(t,n)}),this)},M=function e(){C("wordcloudstart",e),p(N)};T("wordcloudstart",M);var N=s((function e(){if(a>=n.list.length)return p(N),B("wordcloudstop",!1),void C("wordcloudstart",M);h=(new Date).getTime();var t=k(n.list[a]),r=!B("wordclouddrawn",!0,{item:n.list[a],drawn:t});if(L()||r)return p(N),n.abort(),B("wordcloudabort",!1),B("wordcloudstop",!1),void C("wordcloudstart",M);a++,N=s(e,n.wait)}),n.wait)}};F()}function z(e,t){return"hsl("+(360*Math.random()).toFixed()+","+(30*Math.random()+70).toFixed()+"%,"+(Math.random()*(t-e)+e).toFixed()+"%)"}};l.isSupported=o,l.minFontSize=a,r=[],i=function(){return l}.apply(t,r),void 0===i||(e.exports=i)}()},"7cb2":function(e,t,n){(function(t,r){e.exports=r(n("313e"))})(0,(function(e){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=106)}([function(t,n){t.exports=e},function(e,t,n){"use strict";var r=n(40),i=n(52),o=n(5),a=n(4),s=n(8),l=n(19),u=n(35),c=n(15),d=n(0),f=n.n(d),h=n(36),p=n(60),m=n.n(p),v=n(61),g=n(124),y=n(125),_=n(129),x=n(130),b=n(2),w=n(132),A=n(43),T=n(76),S=n(133),E=n(134),C=n(135),M=n(136),L=n(41),N=n(37),D=n(26),O=n(3),I=n(137),R=n(56),P=n(138),k=n(139),B=n(140),F=n(9),z=n(74),H=n(54),U=n(18),G=n(59),V=n(141),j=n(146),W=n(71),X=n(147),Y=n(148),q=n(149),Q=n(150),$=n(151),K=n(152);function Z(e){return!e||"none"===e}function J(e){return e instanceof HTMLCanvasElement||e instanceof HTMLImageElement||e instanceof Image}function ee(e){return e.getZr&&e.setOption}f.a.util.extend(u["a"].prototype,V["a"]),s["a"].import(j["a"]),s["a"].import(W["a"]),s["a"].import(X["a"]),s["a"].import(Y["a"]),s["a"].import(q["a"]),s["a"].import(Q["a"]),s["a"].import($["a"]),s["a"].import(K["a"]);var te=h["a"].prototype.addToScene,ne=h["a"].prototype.removeFromScene;h["a"].prototype.addToScene=function(e){if(te.call(this,e),this.__zr){var t=this.__zr;e.traverse((function(e){e.__zr=t,e.addAnimatorsToZr&&e.addAnimatorsToZr(t)}))}},h["a"].prototype.removeFromScene=function(e){ne.call(this,e),e.traverse((function(e){var t=e.__zr;e.__zr=null,t&&e.removeAnimatorsFromZr&&e.removeAnimatorsFromZr(t)}))},l["a"].prototype.setTextureImage=function(e,t,n,r){if(this.shader){var i,o=n.getZr(),a=this;return a.autoUpdateTextureStatus=!1,a.disableTexture(e),Z(t)||(i=re.loadTexture(t,n,r,(function(t){a.enableTexture(e),o&&o.refresh()})),a.set(e,i)),i}};var re={};re.Renderer=i["a"],re.Node=u["a"],re.Mesh=r["a"],re.Shader=s["a"],re.Material=l["a"],re.Texture=a["a"],re.Texture2D=o["a"],re.Geometry=c["a"],re.SphereGeometry=w["a"],re.PlaneGeometry=A["a"],re.CubeGeometry=T["a"],re.AmbientLight=S["a"],re.DirectionalLight=E["a"],re.PointLight=C["a"],re.SpotLight=M["a"],re.PerspectiveCamera=L["a"],re.OrthographicCamera=N["a"],re.Vector2=D["a"],re.Vector3=O["a"],re.Vector4=I["a"],re.Quaternion=R["a"],re.Matrix2=P["a"],re.Matrix2d=k["a"],re.Matrix3=B["a"],re.Matrix4=F["a"],re.Plane=z["a"],re.Ray=H["a"],re.BoundingBox=U["a"],re.Frustum=G["a"];var ie=v["a"].createBlank("rgba(255,255,255,0)").image;function oe(e){return Math.pow(2,Math.round(Math.log(e)/Math.LN2))}function ae(e){if((e.wrapS===a["a"].REPEAT||e.wrapT===a["a"].REPEAT)&&e.image){var t=oe(e.width),n=oe(e.height);if(t!==e.width||n!==e.height){var r=document.createElement("canvas");r.width=t,r.height=n;var i=r.getContext("2d");i.drawImage(e.image,0,0,t,n),e.image=r}}}re.loadTexture=function(e,t,n,r){"function"===typeof n&&(r=n,n={}),n=n||{};for(var i=Object.keys(n).sort(),o="",a=0;a<i.length;a++)o+=i[a]+"_"+n[i[a]]+"_";var s=t.__textureCache=t.__textureCache||new m.a(20);if(ee(e)){var l=e.__textureid__,u=s.get(o+l);if(u)u.texture.surface.setECharts(e),r&&r(u.texture);else{var c=new g["a"](e);c.onupdate=function(){t.getZr().refresh()},u={texture:c.getTexture()};for(a=0;a<i.length;a++)u.texture[i[a]]=n[i[a]];l=e.__textureid__||"__ecgl_ec__"+u.texture.__uid__,e.__textureid__=l,s.put(o+l,u),r&&r(u.texture)}return u.texture}if(J(e)){l=e.__textureid__,u=s.get(o+l);if(!u){u={texture:new re.Texture2D({image:e})};for(a=0;a<i.length;a++)u.texture[i[a]]=n[i[a]];l=e.__textureid__||"__ecgl_image__"+u.texture.__uid__,e.__textureid__=l,s.put(o+l,u),ae(u.texture),r&&r(u.texture)}return u.texture}u=s.get(o+e);if(u)u.callbacks?u.callbacks.push(r):r&&r(u.texture);else if(e.match(/.hdr$|^data:application\/octet-stream/)){u={callbacks:[r]};var d=v["a"].loadTexture(e,{exposure:n.exposure,fileType:"hdr"},(function(){d.dirty(),u.callbacks.forEach((function(e){e&&e(d)})),u.callbacks=null}));u.texture=d,s.put(o+e,u)}else{for(d=new re.Texture2D({image:new Image}),a=0;a<i.length;a++)d[i[a]]=n[i[a]];u={texture:d,callbacks:[r]};var f=d.image;f.onload=function(){d.image=f,ae(d),d.dirty(),u.callbacks.forEach((function(e){e&&e(d)})),u.callbacks=null},f.src=e,d.image=ie,s.put(o+e,u)}return u.texture},re.createAmbientCubemap=function(e,t,n,r){e=e||{};var i=e.texture,o=b["a"].firstNotNull(e.exposure,1),a=new y["a"]({intensity:b["a"].firstNotNull(e.specularIntensity,1)}),s=new _["a"]({intensity:b["a"].firstNotNull(e.diffuseIntensity,1),coefficients:[.844,.712,.691,-.037,.083,.167,.343,.288,.299,-.041,-.021,-.009,-.003,-.041,-.064,-.011,-.007,-.004,-.031,.034,.081,-.06,-.049,-.06,.046,.056,.05]});return a.cubemap=re.loadTexture(i,n,{exposure:o},(function(){a.cubemap.flipY=!1;var e=Date.now();a.prefilter(t,32);var n=Date.now()-e;console.log("Prefilter environment map: "+n+"ms"),s.coefficients=x["a"].projectEnvironmentMap(t,a.cubemap,{lod:1}),r&&r()})),{specular:a,diffuse:s}},re.createBlankTexture=v["a"].createBlank,re.isImage=J,re.additiveBlend=function(e){e.blendEquation(e.FUNC_ADD),e.blendFunc(e.SRC_ALPHA,e.ONE)},re.parseColor=function(e,t){return e instanceof Array?(t||(t=[]),t[0]=e[0],t[1]=e[1],t[2]=e[2],e.length>3?t[3]=e[3]:t[3]=1,t):(t=f.a.color.parse(e||"#000",t)||[0,0,0,0],t[0]/=255,t[1]/=255,t[2]/=255,t)},re.directionFromAlphaBeta=function(e,t){var n=e/180*Math.PI+Math.PI/2,r=-t/180*Math.PI+Math.PI/2,i=[],o=Math.sin(n);return i[0]=o*Math.cos(r),i[1]=-Math.cos(n),i[2]=o*Math.sin(r),i},re.getShadowResolution=function(e){var t=1024;switch(e){case"low":t=512;break;case"medium":break;case"high":t=2048;break;case"ultra":t=4096;break}return t},re.COMMON_SHADERS=["lambert","color","realistic","hatching"],re.createShader=function(e){var t=s["a"].source(e+".vertex"),n=s["a"].source(e+".fragment");t||console.error("Vertex shader of '%s' not exits",e),n||console.error("Fragment shader of '%s' not exits",e);var r=new s["a"](t,n);return r.name=e,r},re.createMaterial=function(e,t){t instanceof Array||(t=[t]);var n=re.createShader(e),r=new l["a"]({shader:n});return t.forEach((function(e){"string"===typeof e&&r.define(e)})),r},re.setMaterialFromModel=function(e,t,n,r){t.autoUpdateTextureStatus=!1;var i=n.getModel(e+"Material"),o=i.get("detailTexture"),a=b["a"].firstNotNull(i.get("textureTiling"),1),s=b["a"].firstNotNull(i.get("textureOffset"),0);"number"===typeof a&&(a=[a,a]),"number"===typeof s&&(s=[s,s]);var l=a[0]>1||a[1]>1?re.Texture.REPEAT:re.Texture.CLAMP_TO_EDGE,u={anisotropic:8,wrapS:l,wrapT:l};if("realistic"===e){var c=i.get("roughness"),d=i.get("metalness");null!=d?isNaN(d)&&(t.setTextureImage("metalnessMap",d,r,u),d=b["a"].firstNotNull(i.get("metalnessAdjust"),.5)):d=0,null!=c?isNaN(c)&&(t.setTextureImage("roughnessMap",c,r,u),c=b["a"].firstNotNull(i.get("roughnessAdjust"),.5)):c=.5;var f=i.get("normalTexture");t.setTextureImage("detailMap",o,r,u),t.setTextureImage("normalMap",f,r,u),t.set({roughness:c,metalness:d,detailUvRepeat:a,detailUvOffset:s})}else if("lambert"===e)t.setTextureImage("detailMap",o,r,u),t.set({detailUvRepeat:a,detailUvOffset:s});else if("color"===e)t.setTextureImage("detailMap",o,r,u),t.set({detailUvRepeat:a,detailUvOffset:s});else if("hatching"===e){var h=i.get("hatchingTextures")||[];h.length<6&&console.error("Invalid hatchingTextures.");for(var p=0;p<6;p++)t.setTextureImage("hatch"+(p+1),h[p],r,{anisotropic:8,wrapS:re.Texture.REPEAT,wrapT:re.Texture.REPEAT});t.set({detailUvRepeat:a,detailUvOffset:s})}},re.updateVertexAnimation=function(e,t,n,r){var i=r.get("animation"),o=r.get("animationDurationUpdate"),a=r.get("animationEasingUpdate"),s=n.shadowDepthMaterial;if(i&&t&&o>0&&t.geometry.vertexCount===n.geometry.vertexCount){n.material.define("vertex","VERTEX_ANIMATION"),n.ignorePreZ=!0,s&&s.define("vertex","VERTEX_ANIMATION");for(var l=0;l<e.length;l++)n.geometry.attributes[e[l][0]].value=t.geometry.attributes[e[l][1]].value;n.geometry.dirty(),n.__percent=0,n.material.set("percent",0),n.stopAnimation(),n.animate().when(o,{__percent:1}).during((function(){n.material.set("percent",n.__percent),s&&s.set("percent",n.__percent)})).done((function(){n.ignorePreZ=!1,n.material.undefine("vertex","VERTEX_ANIMATION"),s&&s.undefine("vertex","VERTEX_ANIMATION")})).start(a)}else n.material.undefine("vertex","VERTEX_ANIMATION"),s&&s.undefine("vertex","VERTEX_ANIMATION")},t["a"]=re},function(e,t,n){"use strict";var r=n(0),i=n.n(r),o={firstNotNull:function(){for(var e=0,t=arguments.length;e<t;e++)if(null!=arguments[e])return arguments[e]},queryDataIndex:function(e,t){return null!=t.dataIndexInside?t.dataIndexInside:null!=t.dataIndex?i.a.util.isArray(t.dataIndex)?i.a.util.map(t.dataIndex,(function(t){return e.indexOfRawIndex(t)})):e.indexOfRawIndex(t.dataIndex):null!=t.name?i.a.util.isArray(t.name)?i.a.util.map(t.name,(function(t){return e.indexOfName(t)})):e.indexOfName(t.name):void 0}};t["a"]=o},function(e,t,n){"use strict";var r=n(12),i=function(e,t,n){e=e||0,t=t||0,n=n||0,this.array=r["a"].fromValues(e,t,n),this._dirty=!0};i.prototype={constructor:i,add:function(e){return r["a"].add(this.array,this.array,e.array),this._dirty=!0,this},set:function(e,t,n){return this.array[0]=e,this.array[1]=t,this.array[2]=n,this._dirty=!0,this},setArray:function(e){return this.array[0]=e[0],this.array[1]=e[1],this.array[2]=e[2],this._dirty=!0,this},clone:function(){return new i(this.x,this.y,this.z)},copy:function(e){return r["a"].copy(this.array,e.array),this._dirty=!0,this},cross:function(e,t){return r["a"].cross(this.array,e.array,t.array),this._dirty=!0,this},dist:function(e){return r["a"].dist(this.array,e.array)},distance:function(e){return r["a"].distance(this.array,e.array)},div:function(e){return r["a"].div(this.array,this.array,e.array),this._dirty=!0,this},divide:function(e){return r["a"].divide(this.array,this.array,e.array),this._dirty=!0,this},dot:function(e){return r["a"].dot(this.array,e.array)},len:function(){return r["a"].len(this.array)},length:function(){return r["a"].length(this.array)},lerp:function(e,t,n){return r["a"].lerp(this.array,e.array,t.array,n),this._dirty=!0,this},min:function(e){return r["a"].min(this.array,this.array,e.array),this._dirty=!0,this},max:function(e){return r["a"].max(this.array,this.array,e.array),this._dirty=!0,this},mul:function(e){return r["a"].mul(this.array,this.array,e.array),this._dirty=!0,this},multiply:function(e){return r["a"].multiply(this.array,this.array,e.array),this._dirty=!0,this},negate:function(){return r["a"].negate(this.array,this.array),this._dirty=!0,this},normalize:function(){return r["a"].normalize(this.array,this.array),this._dirty=!0,this},random:function(e){return r["a"].random(this.array,e),this._dirty=!0,this},scale:function(e){return r["a"].scale(this.array,this.array,e),this._dirty=!0,this},scaleAndAdd:function(e,t){return r["a"].scaleAndAdd(this.array,this.array,e.array,t),this._dirty=!0,this},sqrDist:function(e){return r["a"].sqrDist(this.array,e.array)},squaredDistance:function(e){return r["a"].squaredDistance(this.array,e.array)},sqrLen:function(){return r["a"].sqrLen(this.array)},squaredLength:function(){return r["a"].squaredLength(this.array)},sub:function(e){return r["a"].sub(this.array,this.array,e.array),this._dirty=!0,this},subtract:function(e){return r["a"].subtract(this.array,this.array,e.array),this._dirty=!0,this},transformMat3:function(e){return r["a"].transformMat3(this.array,this.array,e.array),this._dirty=!0,this},transformMat4:function(e){return r["a"].transformMat4(this.array,this.array,e.array),this._dirty=!0,this},transformQuat:function(e){return r["a"].transformQuat(this.array,this.array,e.array),this._dirty=!0,this},applyProjection:function(e){var t=this.array;if(e=e.array,0===e[15]){var n=-1/t[2];t[0]=e[0]*t[0]*n,t[1]=e[5]*t[1]*n,t[2]=(e[10]*t[2]+e[14])*n}else t[0]=e[0]*t[0]+e[12],t[1]=e[5]*t[1]+e[13],t[2]=e[10]*t[2]+e[14];return this._dirty=!0,this},eulerFromQuat:function(e,t){i.eulerFromQuat(this,e,t)},eulerFromMat3:function(e,t){i.eulerFromMat3(this,e,t)},toString:function(){return"["+Array.prototype.join.call(this.array,",")+"]"},toArray:function(){return Array.prototype.slice.call(this.array)}};var o=Object.defineProperty;if(o){var a=i.prototype;o(a,"x",{get:function(){return this.array[0]},set:function(e){this.array[0]=e,this._dirty=!0}}),o(a,"y",{get:function(){return this.array[1]},set:function(e){this.array[1]=e,this._dirty=!0}}),o(a,"z",{get:function(){return this.array[2]},set:function(e){this.array[2]=e,this._dirty=!0}})}function s(e,t,n){return e<t?t:e>n?n:e}i.add=function(e,t,n){return r["a"].add(e.array,t.array,n.array),e._dirty=!0,e},i.set=function(e,t,n,i){r["a"].set(e.array,t,n,i),e._dirty=!0},i.copy=function(e,t){return r["a"].copy(e.array,t.array),e._dirty=!0,e},i.cross=function(e,t,n){return r["a"].cross(e.array,t.array,n.array),e._dirty=!0,e},i.dist=function(e,t){return r["a"].distance(e.array,t.array)},i.distance=i.dist,i.div=function(e,t,n){return r["a"].divide(e.array,t.array,n.array),e._dirty=!0,e},i.divide=i.div,i.dot=function(e,t){return r["a"].dot(e.array,t.array)},i.len=function(e){return r["a"].length(e.array)},i.lerp=function(e,t,n,i){return r["a"].lerp(e.array,t.array,n.array,i),e._dirty=!0,e},i.min=function(e,t,n){return r["a"].min(e.array,t.array,n.array),e._dirty=!0,e},i.max=function(e,t,n){return r["a"].max(e.array,t.array,n.array),e._dirty=!0,e},i.mul=function(e,t,n){return r["a"].multiply(e.array,t.array,n.array),e._dirty=!0,e},i.multiply=i.mul,i.negate=function(e,t){return r["a"].negate(e.array,t.array),e._dirty=!0,e},i.normalize=function(e,t){return r["a"].normalize(e.array,t.array),e._dirty=!0,e},i.random=function(e,t){return r["a"].random(e.array,t),e._dirty=!0,e},i.scale=function(e,t,n){return r["a"].scale(e.array,t.array,n),e._dirty=!0,e},i.scaleAndAdd=function(e,t,n,i){return r["a"].scaleAndAdd(e.array,t.array,n.array,i),e._dirty=!0,e},i.sqrDist=function(e,t){return r["a"].sqrDist(e.array,t.array)},i.squaredDistance=i.sqrDist,i.sqrLen=function(e){return r["a"].sqrLen(e.array)},i.squaredLength=i.sqrLen,i.sub=function(e,t,n){return r["a"].subtract(e.array,t.array,n.array),e._dirty=!0,e},i.subtract=i.sub,i.transformMat3=function(e,t,n){return r["a"].transformMat3(e.array,t.array,n.array),e._dirty=!0,e},i.transformMat4=function(e,t,n){return r["a"].transformMat4(e.array,t.array,n.array),e._dirty=!0,e},i.transformQuat=function(e,t,n){return r["a"].transformQuat(e.array,t.array,n.array),e._dirty=!0,e};var l=Math.atan2,u=Math.asin,c=Math.abs;i.eulerFromQuat=function(e,t,n){e._dirty=!0,t=t.array;var r=e.array,i=t[0],o=t[1],a=t[2],c=t[3],d=i*i,f=o*o,h=a*a,p=c*c;n=(n||"XYZ").toUpperCase();switch(n){case"XYZ":r[0]=l(2*(i*c-o*a),p-d-f+h),r[1]=u(s(2*(i*a+o*c),-1,1)),r[2]=l(2*(a*c-i*o),p+d-f-h);break;case"YXZ":r[0]=u(s(2*(i*c-o*a),-1,1)),r[1]=l(2*(i*a+o*c),p-d-f+h),r[2]=l(2*(i*o+a*c),p-d+f-h);break;case"ZXY":r[0]=u(s(2*(i*c+o*a),-1,1)),r[1]=l(2*(o*c-a*i),p-d-f+h),r[2]=l(2*(a*c-i*o),p-d+f-h);break;case"ZYX":r[0]=l(2*(i*c+a*o),p-d-f+h),r[1]=u(s(2*(o*c-i*a),-1,1)),r[2]=l(2*(i*o+a*c),p+d-f-h);break;case"YZX":r[0]=l(2*(i*c-a*o),p-d+f-h),r[1]=l(2*(o*c-i*a),p+d-f-h),r[2]=u(s(2*(i*o+a*c),-1,1));break;case"XZY":r[0]=l(2*(i*c+o*a),p-d+f-h),r[1]=l(2*(i*a+o*c),p+d-f-h),r[2]=u(s(2*(a*c-i*o),-1,1));break;default:console.warn("Unkown order: "+n)}return e},i.eulerFromMat3=function(e,t,n){var r=t.array,i=r[0],o=r[3],a=r[6],d=r[1],f=r[4],h=r[7],p=r[2],m=r[5],v=r[8],g=e.array;n=(n||"XYZ").toUpperCase();switch(n){case"XYZ":g[1]=u(s(a,-1,1)),c(a)<.99999?(g[0]=l(-h,v),g[2]=l(-o,i)):(g[0]=l(m,f),g[2]=0);break;case"YXZ":g[0]=u(-s(h,-1,1)),c(h)<.99999?(g[1]=l(a,v),g[2]=l(d,f)):(g[1]=l(-p,i),g[2]=0);break;case"ZXY":g[0]=u(s(m,-1,1)),c(m)<.99999?(g[1]=l(-p,v),g[2]=l(-o,f)):(g[1]=0,g[2]=l(d,i));break;case"ZYX":g[1]=u(-s(p,-1,1)),c(p)<.99999?(g[0]=l(m,v),g[2]=l(d,i)):(g[0]=0,g[2]=l(-o,f));break;case"YZX":g[2]=u(s(d,-1,1)),c(d)<.99999?(g[0]=l(-h,f),g[1]=l(-p,i)):(g[0]=0,g[1]=l(a,v));break;case"XZY":g[2]=u(-s(o,-1,1)),c(o)<.99999?(g[0]=l(m,f),g[1]=l(a,i)):(g[0]=l(-h,v),g[1]=0);break;default:console.warn("Unkown order: "+n)}return e._dirty=!0,e},Object.defineProperties(i,{POSITIVE_X:{get:function(){return new i(1,0,0)}},NEGATIVE_X:{get:function(){return new i(-1,0,0)}},POSITIVE_Y:{get:function(){return new i(0,1,0)}},NEGATIVE_Y:{get:function(){return new i(0,-1,0)}},POSITIVE_Z:{get:function(){return new i(0,0,1)}},NEGATIVE_Z:{get:function(){return new i(0,0,-1)}},UP:{get:function(){return new i(0,1,0)}},ZERO:{get:function(){return new i}}}),t["a"]=i},function(e,t,n){"use strict";var r=n(7),i=n(11),o=n(57),a=r["a"].extend({width:512,height:512,type:i["a"].UNSIGNED_BYTE,format:i["a"].RGBA,wrapS:i["a"].REPEAT,wrapT:i["a"].REPEAT,minFilter:i["a"].LINEAR_MIPMAP_LINEAR,magFilter:i["a"].LINEAR,useMipmap:!0,anisotropic:1,flipY:!0,sRGB:!0,unpackAlignment:4,premultiplyAlpha:!1,dynamic:!1,NPOT:!1,__used:0},(function(){this._cache=new o["a"]}),{getWebGLTexture:function(e){var t=e.gl,n=this._cache;return n.use(e.__uid__),n.miss("webgl_texture")&&n.put("webgl_texture",t.createTexture()),this.dynamic?this.update(e):n.isDirty()&&(this.update(e),n.fresh()),n.get("webgl_texture")},bind:function(){},unbind:function(){},dirty:function(){this._cache&&this._cache.dirtyAll()},update:function(e){},updateCommon:function(e){var t=e.gl;t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,this.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this.premultiplyAlpha),t.pixelStorei(t.UNPACK_ALIGNMENT,this.unpackAlignment),this.format===i["a"].DEPTH_COMPONENT&&(this.useMipmap=!1);var n=e.getGLExtension("EXT_sRGB");this.format!==a.SRGB||n||(this.format=a.RGB),this.format!==a.SRGB_ALPHA||n||(this.format=a.RGBA),this.NPOT=!this.isPowerOfTwo()},getAvailableWrapS:function(){return this.NPOT?i["a"].CLAMP_TO_EDGE:this.wrapS},getAvailableWrapT:function(){return this.NPOT?i["a"].CLAMP_TO_EDGE:this.wrapT},getAvailableMinFilter:function(){var e=this.minFilter;return this.NPOT||!this.useMipmap?e===i["a"].NEAREST_MIPMAP_NEAREST||e===i["a"].NEAREST_MIPMAP_LINEAR?i["a"].NEAREST:e===i["a"].LINEAR_MIPMAP_LINEAR||e===i["a"].LINEAR_MIPMAP_NEAREST?i["a"].LINEAR:e:e},getAvailableMagFilter:function(){return this.magFilter},nextHighestPowerOfTwo:function(e){--e;for(var t=1;t<32;t<<=1)e|=e>>t;return e+1},dispose:function(e){var t=this._cache;t.use(e.__uid__);var n=t.get("webgl_texture");n&&e.gl.deleteTexture(n),t.deleteContext(e.__uid__)},isRenderable:function(){},isPowerOfTwo:function(){}});Object.defineProperty(a.prototype,"width",{get:function(){return this._width},set:function(e){this._width=e}}),Object.defineProperty(a.prototype,"height",{get:function(){return this._height},set:function(e){this._height=e}}),a.BYTE=i["a"].BYTE,a.UNSIGNED_BYTE=i["a"].UNSIGNED_BYTE,a.SHORT=i["a"].SHORT,a.UNSIGNED_SHORT=i["a"].UNSIGNED_SHORT,a.INT=i["a"].INT,a.UNSIGNED_INT=i["a"].UNSIGNED_INT,a.FLOAT=i["a"].FLOAT,a.HALF_FLOAT=36193,a.UNSIGNED_INT_24_8_WEBGL=34042,a.DEPTH_COMPONENT=i["a"].DEPTH_COMPONENT,a.DEPTH_STENCIL=i["a"].DEPTH_STENCIL,a.ALPHA=i["a"].ALPHA,a.RGB=i["a"].RGB,a.RGBA=i["a"].RGBA,a.LUMINANCE=i["a"].LUMINANCE,a.LUMINANCE_ALPHA=i["a"].LUMINANCE_ALPHA,a.SRGB=35904,a.SRGB_ALPHA=35906,a.COMPRESSED_RGB_S3TC_DXT1_EXT=33776,a.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777,a.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778,a.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779,a.NEAREST=i["a"].NEAREST,a.LINEAR=i["a"].LINEAR,a.NEAREST_MIPMAP_NEAREST=i["a"].NEAREST_MIPMAP_NEAREST,a.LINEAR_MIPMAP_NEAREST=i["a"].LINEAR_MIPMAP_NEAREST,a.NEAREST_MIPMAP_LINEAR=i["a"].NEAREST_MIPMAP_LINEAR,a.LINEAR_MIPMAP_LINEAR=i["a"].LINEAR_MIPMAP_LINEAR,a.REPEAT=i["a"].REPEAT,a.CLAMP_TO_EDGE=i["a"].CLAMP_TO_EDGE,a.MIRRORED_REPEAT=i["a"].MIRRORED_REPEAT,t["a"]=a},function(e,t,n){"use strict";var r=n(4),i=n(11),o=n(14),a=n(73),s=a["a"].isPowerOfTwo;function l(e){return Math.pow(2,Math.round(Math.log(e)/Math.LN2))}function u(e,t){var n=l(e.width),r=l(e.height);t=t||document.createElement("canvas"),t.width=n,t.height=r;var i=t.getContext("2d");return i.drawImage(e.image,0,0,n,r),t}var c=r["a"].extend((function(){return{image:null,pixels:null,mipmaps:[],convertToPOT:!1}}),{textureType:"texture2D",update:function(e){var t=e.gl;t.bindTexture(t.TEXTURE_2D,this._cache.get("webgl_texture")),this.updateCommon(e);var n=this.format,o=this.type,a=!(!this.convertToPOT||this.mipmaps.length||!this.image||this.wrapS!==r["a"].REPEAT&&this.wrapT!==r["a"].REPEAT||!this.NPOT);t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,a?this.wrapS:this.getAvailableWrapS()),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,a?this.wrapT:this.getAvailableWrapT()),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,a?this.magFilter:this.getAvailableMagFilter()),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,a?this.minFilter:this.getAvailableMinFilter());var s=e.getGLExtension("EXT_texture_filter_anisotropic");if(s&&this.anisotropic>1&&t.texParameterf(t.TEXTURE_2D,s.TEXTURE_MAX_ANISOTROPY_EXT,this.anisotropic),36193===o){var l=e.getGLExtension("OES_texture_half_float");l||(o=i["a"].FLOAT)}if(this.mipmaps.length)for(var u=this.width,c=this.height,d=0;d<this.mipmaps.length;d++){var f=this.mipmaps[d];this._updateTextureData(t,f,d,u,c,n,o,!1),u/=2,c/=2}else this._updateTextureData(t,this,0,this.width,this.height,n,o,a),!this.useMipmap||this.NPOT&&!a||t.generateMipmap(t.TEXTURE_2D);t.bindTexture(t.TEXTURE_2D,null)},_updateTextureData:function(e,t,n,i,o,a,s,l){if(t.image){var c=t.image;l&&(this._potCanvas=u(this,this._potCanvas),c=this._potCanvas),e.texImage2D(e.TEXTURE_2D,n,a,a,s,c)}else a<=r["a"].COMPRESSED_RGBA_S3TC_DXT5_EXT&&a>=r["a"].COMPRESSED_RGB_S3TC_DXT1_EXT?e.compressedTexImage2D(e.TEXTURE_2D,n,a,i,o,0,t.pixels):e.texImage2D(e.TEXTURE_2D,n,a,i,o,0,a,s,t.pixels)},generateMipmap:function(e){var t=e.gl;this.useMipmap&&!this.NPOT&&(t.bindTexture(t.TEXTURE_2D,this._cache.get("webgl_texture")),t.generateMipmap(t.TEXTURE_2D))},isPowerOfTwo:function(){return s(this.width)&&s(this.height)},isRenderable:function(){return this.image?"CANVAS"===this.image.nodeName||"VIDEO"===this.image.nodeName||this.image.complete:!(!this.width||!this.height)},bind:function(e){e.gl.bindTexture(e.gl.TEXTURE_2D,this.getWebGLTexture(e))},unbind:function(e){e.gl.bindTexture(e.gl.TEXTURE_2D,null)},load:function(e,t){var n=o["a"].createImage();t&&(n.crossOrigin=t);var r=this;return n.onload=function(){r.dirty(),r.trigger("success",r),n.onload=null},n.onerror=function(){r.trigger("error",r),n.onerror=null},n.src=e,this.image=n,this}});Object.defineProperty(c.prototype,"width",{get:function(){return this.image?this.image.width:this._width},set:function(e){this.image?console.warn("Texture from image can't set width"):(this._width!==e&&this.dirty(),this._width=e)}}),Object.defineProperty(c.prototype,"height",{get:function(){return this.image?this.image.height:this._height},set:function(e){this.image?console.warn("Texture from image can't set height"):(this._height!==e&&this.dirty(),this._height=e)}}),t["a"]=c},function(e,t,n){"use strict";var r=n(161);t["a"]=r["a"]},function(e,t,n){"use strict";var r=n(110),i=n(53),o=n(23),a=function(){this.__uid__=o["a"].genGUID()};a.__initializers__=[function(e){o["a"].extend(this,e)}],o["a"].extend(a,r["a"]),o["a"].extend(a.prototype,i["a"]),t["a"]=a},function(e,t,n){"use strict";var r=n(23),i=n(14),o=/uniform\s+(bool|float|int|vec2|vec3|vec4|ivec2|ivec3|ivec4|mat2|mat3|mat4|sampler2D|samplerCube)\s+([\s\S]*?);/g,a=/attribute\s+(float|int|vec2|vec3|vec4)\s+([\s\S]*?);/g,s=/#define\s+(\w+)?(\s+[\d-.]+)?\s*;?\s*\n/g,l={bool:"1i",int:"1i",sampler2D:"t",samplerCube:"t",float:"1f",vec2:"2f",vec3:"3f",vec4:"4f",ivec2:"2i",ivec3:"3i",ivec4:"4i",mat2:"m2",mat3:"m3",mat4:"m4"};function u(e){for(var t=[],n=0;n<e;n++)t[n]=0;return t}var c={bool:function(){return!0},int:function(){return 0},float:function(){return 0},sampler2D:function(){return null},samplerCube:function(){return null},vec2:function(){return u(2)},vec3:function(){return u(3)},vec4:function(){return u(4)},ivec2:function(){return u(2)},ivec3:function(){return u(3)},ivec4:function(){return u(4)},mat2:function(){return u(4)},mat3:function(){return u(9)},mat4:function(){return u(16)},array:function(){return[]}},d=["POSITION","NORMAL","BINORMAL","TANGENT","TEXCOORD","TEXCOORD_0","TEXCOORD_1","COLOR","JOINT","WEIGHT"],f=["SKIN_MATRIX","VIEWPORT_SIZE","VIEWPORT","DEVICEPIXELRATIO","WINDOW_SIZE","NEAR","FAR","TIME"],h=["WORLD","VIEW","PROJECTION","WORLDVIEW","VIEWPROJECTION","WORLDVIEWPROJECTION","WORLDINVERSE","VIEWINVERSE","PROJECTIONINVERSE","WORLDVIEWINVERSE","VIEWPROJECTIONINVERSE","WORLDVIEWPROJECTIONINVERSE","WORLDTRANSPOSE","VIEWTRANSPOSE","PROJECTIONTRANSPOSE","WORLDVIEWTRANSPOSE","VIEWPROJECTIONTRANSPOSE","WORLDVIEWPROJECTIONTRANSPOSE","WORLDINVERSETRANSPOSE","VIEWINVERSETRANSPOSE","PROJECTIONINVERSETRANSPOSE","WORLDVIEWINVERSETRANSPOSE","VIEWPROJECTIONINVERSETRANSPOSE","WORLDVIEWPROJECTIONINVERSETRANSPOSE"],p={vec4:4,vec3:3,vec2:2,float:1},m={},v={};function g(e,t){var n="vertex:"+e+"fragment:"+t;if(m[n])return m[n];var i=r["a"].genGUID();return m[n]=i,v[i]={vertex:e,fragment:t},i}function y(e){return e.replace(/[ \t]*\/\/.*\n/g,"").replace(/[ \t]*\/\*[\s\S]*?\*\//g,"")}function _(){console.error("Wrong uniform/attributes syntax")}function x(e,t){for(var n=/[,=\(\):]/,r=t.replace(/:\s*\[\s*(.*)\s*\]/g,"="+e+"($1)").replace(/\s+/g,"").split(/(?=[,=\(\):])/g),o=[],a=0;a<r.length;a++)r[a].match(n)?o.push(r[a].charAt(0),r[a].slice(1)):o.push(r[a]);r=o;var s,l=0,u=1,c=2,p=3,m=4,v=5,g=l,y={},x=null;function b(e){e||_();var t=e.match(/\[(.*?)\]/);s=e.replace(/\[(.*?)\]/,""),y[s]={},t&&(y[s].isArray=!0,y[s].arraySize=t[1])}b(r[0]);for(a=1;a<r.length;a++){var w=r[a];if(w)if("="!==w)if(":"!==w)if(","!==w)if(")"!==w)if("("!==w)if(w.indexOf("vec")>=0){if(g!==u&&g!==m){_();break}g=c,x=[]}else if(g!==u)if(g!==m)b(w),g=l;else{var A=w;d.indexOf(A)>=0||f.indexOf(A)>=0||h.indexOf(A)>=0?y[s].semantic=A:"ignore"===A||"unconfigurable"===A?y[s].ignore=!0:y[s].value="bool"===e?"true"===A:parseFloat(A)}else y[s].value="bool"===e?"true"===w:parseFloat(w),x=null;else{if(g!==c){_();break}if(!(x instanceof Array)){_();break}x.push(+r[++a])}else y[s].value=new i["a"].Float32Array(x),x=null,g=v;else if(g===c){if(!(x instanceof Array)){_();break}x.push(+r[++a])}else g=v;else g=m;else{if(g!==l&&g!==p){_();break}g=u}}return y}function b(e,t){"object"===typeof e&&(t=e.fragment,e=e.vertex),e=y(e),t=y(t),this._shaderID=g(e,t),this._vertexCode=b.parseImport(e),this._fragmentCode=b.parseImport(t),this.attributeSemantics={},this.matrixSemantics={},this.uniformSemantics={},this.matrixSemanticKeys=[],this.uniformTemplates={},this.attributes={},this.textures={},this.vertexDefines={},this.fragmentDefines={},this._parseAttributes(),this._parseUniforms(),this._parseDefines()}b.prototype={constructor:b,createUniforms:function(){var e={};for(var t in this.uniformTemplates){var n=this.uniformTemplates[t];e[t]={type:n.type,value:n.value()}}return e},_parseImport:function(){this._vertexCode=b.parseImport(this.vertex),this._fragmentCode=b.parseImport(this.fragment)},_addSemanticUniform:function(e,t,n){if(d.indexOf(n)>=0)this.attributeSemantics[n]={symbol:e,type:t};else if(h.indexOf(n)>=0){var r=!1,i=n;n.match(/TRANSPOSE$/)&&(r=!0,i=n.slice(0,-9)),this.matrixSemantics[n]={symbol:e,type:t,isTranspose:r,semanticNoTranspose:i}}else f.indexOf(n)>=0&&(this.uniformSemantics[n]={symbol:e,type:t})},_addMaterialUniform:function(e,t,n,r,i,o){o[e]={type:n,value:i?c["array"]:r||c[t],semantic:null}},_parseUniforms:function(){var e={},t=this,n="vertex";function r(e){return null!=e?function(){return e}:null}function i(i,o,a){var s=x(o,a),u=[];for(var c in s){var d=s[c],f=d.semantic,h=c,p=l[o],m=r(s[c].value);s[c].isArray&&(h+="["+s[c].arraySize+"]",p+="v"),u.push(h),t._uniformList.push(c),d.ignore||("sampler2D"!==o&&"samplerCube"!==o||(t.textures[c]={shaderType:n,type:o}),f?t._addSemanticUniform(c,p,f):t._addMaterialUniform(c,o,p,m,s[c].isArray,e))}return u.length>0?"uniform "+o+" "+u.join(",")+";\n":""}this._uniformList=[],this._vertexCode=this._vertexCode.replace(o,i),n="fragment",this._fragmentCode=this._fragmentCode.replace(o,i),t.matrixSemanticKeys=Object.keys(this.matrixSemantics),this.uniformTemplates=e},_parseAttributes:function(){var e={},t=this;function n(n,r,i){var o=x(r,i),a=p[r]||1,s=[];for(var l in o){var u=o[l].semantic;if(e[l]={type:"float",size:a,semantic:u||null},u){if(d.indexOf(u)<0)throw new Error('Unkown semantic "'+u+'"');t.attributeSemantics[u]={symbol:l,type:r}}s.push(l)}return"attribute "+r+" "+s.join(",")+";\n"}this._vertexCode=this._vertexCode.replace(a,n),this.attributes=e},_parseDefines:function(){var e=this,t="vertex";function n(n,r,i){var o="vertex"===t?e.vertexDefines:e.fragmentDefines;return o[r]||(o[r]="false"!==i&&("true"===i||(i?isNaN(parseFloat(i))?i.trim():parseFloat(i):null))),""}this._vertexCode=this._vertexCode.replace(s,n),t="fragment",this._fragmentCode=this._fragmentCode.replace(s,n)},clone:function(){var e=v[this._shaderID],t=new b(e.vertex,e.fragment);return t}},Object.defineProperty&&(Object.defineProperty(b.prototype,"shaderID",{get:function(){return this._shaderID}}),Object.defineProperty(b.prototype,"vertex",{get:function(){return this._vertexCode}}),Object.defineProperty(b.prototype,"fragment",{get:function(){return this._fragmentCode}}),Object.defineProperty(b.prototype,"uniforms",{get:function(){return this._uniformList}}));var w=/(@import)\s*([0-9a-zA-Z_\-\.]*)/g;b.parseImport=function(e){return e=e.replace(w,(function(e,t,n){e=b.source(n);return e?b.parseImport(e):(console.error('Shader chunk "'+n+'" not existed in library'),"")})),e};var A=/(@export)\s*([0-9a-zA-Z_\-\.]*)\s*\n([\s\S]*?)@end/g;b["import"]=function(e){e.replace(A,(function(e,t,n,r){r=r.replace(/(^[\s\t\xa0\u3000]+)|([\u3000\xa0\s\t]+\x24)/g,"");if(r){var i,o=n.split("."),a=b.codes,s=0;while(s<o.length-1)i=o[s++],a[i]||(a[i]={}),a=a[i];i=o[s],a[i]=r}return r}))},b.codes={},b.source=function(e){var t=e.split("."),n=b.codes,r=0;while(n&&r<t.length){var i=t[r++];n=n[i]}return"string"!==typeof n?(console.error('Shader "'+e+'" not existed in library'),""):n},t["a"]=b},function(e,t,n){"use strict";var r=n(21),i=n(12),o=n(55),a=n(34),s=n(3),l=function(){this._axisX=new s["a"],this._axisY=new s["a"],this._axisZ=new s["a"],this.array=r["a"].create(),this._dirty=!0};l.prototype={constructor:l,setArray:function(e){for(var t=0;t<this.array.length;t++)this.array[t]=e[t];return this._dirty=!0,this},adjoint:function(){return r["a"].adjoint(this.array,this.array),this._dirty=!0,this},clone:function(){return(new l).copy(this)},copy:function(e){return r["a"].copy(this.array,e.array),this._dirty=!0,this},determinant:function(){return r["a"].determinant(this.array)},fromQuat:function(e){return r["a"].fromQuat(this.array,e.array),this._dirty=!0,this},fromRotationTranslation:function(e,t){return r["a"].fromRotationTranslation(this.array,e.array,t.array),this._dirty=!0,this},fromMat2d:function(e){return l.fromMat2d(this,e),this},frustum:function(e,t,n,i,o,a){return r["a"].frustum(this.array,e,t,n,i,o,a),this._dirty=!0,this},identity:function(){return r["a"].identity(this.array),this._dirty=!0,this},invert:function(){return r["a"].invert(this.array,this.array),this._dirty=!0,this},lookAt:function(e,t,n){return r["a"].lookAt(this.array,e.array,t.array,n.array),this._dirty=!0,this},mul:function(e){return r["a"].mul(this.array,this.array,e.array),this._dirty=!0,this},mulLeft:function(e){return r["a"].mul(this.array,e.array,this.array),this._dirty=!0,this},multiply:function(e){return r["a"].multiply(this.array,this.array,e.array),this._dirty=!0,this},multiplyLeft:function(e){return r["a"].multiply(this.array,e.array,this.array),this._dirty=!0,this},ortho:function(e,t,n,i,o,a){return r["a"].ortho(this.array,e,t,n,i,o,a),this._dirty=!0,this},perspective:function(e,t,n,i){return r["a"].perspective(this.array,e,t,n,i),this._dirty=!0,this},rotate:function(e,t){return r["a"].rotate(this.array,this.array,e,t.array),this._dirty=!0,this},rotateX:function(e){return r["a"].rotateX(this.array,this.array,e),this._dirty=!0,this},rotateY:function(e){return r["a"].rotateY(this.array,this.array,e),this._dirty=!0,this},rotateZ:function(e){return r["a"].rotateZ(this.array,this.array,e),this._dirty=!0,this},scale:function(e){return r["a"].scale(this.array,this.array,e.array),this._dirty=!0,this},translate:function(e){return r["a"].translate(this.array,this.array,e.array),this._dirty=!0,this},transpose:function(){return r["a"].transpose(this.array,this.array),this._dirty=!0,this},decomposeMatrix:function(){var e=i["a"].create(),t=i["a"].create(),n=i["a"].create(),r=a["a"].create();return function(s,l,u){var c=this.array;i["a"].set(e,c[0],c[1],c[2]),i["a"].set(t,c[4],c[5],c[6]),i["a"].set(n,c[8],c[9],c[10]);var d=i["a"].length(e),f=i["a"].length(t),h=i["a"].length(n),p=this.determinant();p<0&&(d=-d),s&&s.set(d,f,h),u.set(c[12],c[13],c[14]),a["a"].fromMat4(r,c),r[0]/=d,r[1]/=d,r[2]/=d,r[3]/=f,r[4]/=f,r[5]/=f,r[6]/=h,r[7]/=h,r[8]/=h,o["a"].fromMat3(l.array,r),o["a"].normalize(l.array,l.array),l._dirty=!0,u._dirty=!0}}(),toString:function(){return"["+Array.prototype.join.call(this.array,",")+"]"},toArray:function(){return Array.prototype.slice.call(this.array)}};var u=Object.defineProperty;if(u){var c=l.prototype;u(c,"z",{get:function(){var e=this.array;return this._axisZ.set(e[8],e[9],e[10]),this._axisZ},set:function(e){var t=this.array;e=e.array,t[8]=e[0],t[9]=e[1],t[10]=e[2],this._dirty=!0}}),u(c,"y",{get:function(){var e=this.array;return this._axisY.set(e[4],e[5],e[6]),this._axisY},set:function(e){var t=this.array;e=e.array,t[4]=e[0],t[5]=e[1],t[6]=e[2],this._dirty=!0}}),u(c,"x",{get:function(){var e=this.array;return this._axisX.set(e[0],e[1],e[2]),this._axisX},set:function(e){var t=this.array;e=e.array,t[0]=e[0],t[1]=e[1],t[2]=e[2],this._dirty=!0}})}l.adjoint=function(e,t){return r["a"].adjoint(e.array,t.array),e._dirty=!0,e},l.copy=function(e,t){return r["a"].copy(e.array,t.array),e._dirty=!0,e},l.determinant=function(e){return r["a"].determinant(e.array)},l.identity=function(e){return r["a"].identity(e.array),e._dirty=!0,e},l.ortho=function(e,t,n,i,o,a,s){return r["a"].ortho(e.array,t,n,i,o,a,s),e._dirty=!0,e},l.perspective=function(e,t,n,i,o){return r["a"].perspective(e.array,t,n,i,o),e._dirty=!0,e},l.lookAt=function(e,t,n,i){return r["a"].lookAt(e.array,t.array,n.array,i.array),e._dirty=!0,e},l.invert=function(e,t){return r["a"].invert(e.array,t.array),e._dirty=!0,e},l.mul=function(e,t,n){return r["a"].mul(e.array,t.array,n.array),e._dirty=!0,e},l.multiply=l.mul,l.fromQuat=function(e,t){return r["a"].fromQuat(e.array,t.array),e._dirty=!0,e},l.fromRotationTranslation=function(e,t,n){return r["a"].fromRotationTranslation(e.array,t.array,n.array),e._dirty=!0,e},l.fromMat2d=function(e,t){e._dirty=!0;t=t.array,e=e.array;return e[0]=t[0],e[4]=t[2],e[12]=t[4],e[1]=t[1],e[5]=t[3],e[13]=t[5],e},l.rotate=function(e,t,n,i){return r["a"].rotate(e.array,t.array,n,i.array),e._dirty=!0,e},l.rotateX=function(e,t,n){return r["a"].rotateX(e.array,t.array,n),e._dirty=!0,e},l.rotateY=function(e,t,n){return r["a"].rotateY(e.array,t.array,n),e._dirty=!0,e},l.rotateZ=function(e,t,n){return r["a"].rotateZ(e.array,t.array,n),e._dirty=!0,e},l.scale=function(e,t,n){return r["a"].scale(e.array,t.array,n.array),e._dirty=!0,e},l.transpose=function(e,t){return r["a"].transpose(e.array,t.array),e._dirty=!0,e},l.translate=function(e,t,n){return r["a"].translate(e.array,t.array,n.array),e._dirty=!0,e},t["a"]=l},function(e,t,n){"use strict";var r=n(7),i=n(4),o=(n(27),n(11)),a=n(57),s="framebuffer",l="renderbuffer",u=l+"_width",c=l+"_height",d=l+"_attached",f="depthtexture_attached",h=o["a"].FRAMEBUFFER,p=o["a"].RENDERBUFFER,m=o["a"].DEPTH_ATTACHMENT,v=o["a"].COLOR_ATTACHMENT0,g=r["a"].extend({depthBuffer:!0,viewport:null,_width:0,_height:0,_textures:null,_boundRenderer:null},(function(){this._cache=new a["a"],this._textures={}}),{getTextureWidth:function(){return this._width},getTextureHeight:function(){return this._height},bind:function(e){if(e.__currentFrameBuffer){if(e.__currentFrameBuffer===this)return;console.warn("Renderer already bound with another framebuffer. Unbind it first")}e.__currentFrameBuffer=this;var t=e.gl;t.bindFramebuffer(h,this._getFrameBufferGL(e)),this._boundRenderer=e;var n=this._cache;n.put("viewport",e.viewport);var r,i,o=!1;for(var a in this._textures){o=!0;var s=this._textures[a];s&&(r=s.texture.width,i=s.texture.height,this._doAttach(e,s.texture,a,s.target))}this._width=r,this._height=i,!o&&this.depthBuffer&&console.error("Must attach texture before bind, or renderbuffer may have incorrect width and height."),this.viewport?e.setViewport(this.viewport):e.setViewport(0,0,r,i,1);var v=n.get("attached_textures");if(v)for(var a in v)if(!this._textures[a]){var g=v[a];this._doDetach(t,a,g)}if(!n.get(f)&&this.depthBuffer){n.miss(l)&&n.put(l,t.createRenderbuffer());var y=n.get(l);r===n.get(u)&&i===n.get(c)||(t.bindRenderbuffer(p,y),t.renderbufferStorage(p,t.DEPTH_COMPONENT16,r,i),n.put(u,r),n.put(c,i),t.bindRenderbuffer(p,null)),n.get(d)||(t.framebufferRenderbuffer(h,m,p,y),n.put(d,!0))}},unbind:function(e){e.__currentFrameBuffer=null;var t=e.gl;t.bindFramebuffer(h,null),this._boundRenderer=null,this._cache.use(e.__uid__);var n=this._cache.get("viewport");n&&e.setViewport(n),this.updateMipmap(e)},updateMipmap:function(e){var t=e.gl;for(var n in this._textures){var r=this._textures[n];if(r){var a=r.texture;if(!a.NPOT&&a.useMipmap&&a.minFilter===i["a"].LINEAR_MIPMAP_LINEAR){var s="textureCube"===a.textureType?o["a"].TEXTURE_CUBE_MAP:o["a"].TEXTURE_2D;t.bindTexture(s,a.getWebGLTexture(e)),t.generateMipmap(s),t.bindTexture(s,null)}}}},checkStatus:function(e){return e.checkFramebufferStatus(h)},_getFrameBufferGL:function(e){var t=this._cache;return t.use(e.__uid__),t.miss(s)&&t.put(s,e.gl.createFramebuffer()),t.get(s)},attach:function(e,t,n){if(!e.width)throw new Error("The texture attached to color buffer is not a valid.");t=t||v,n=n||o["a"].TEXTURE_2D;var r,i=this._boundRenderer,a=i&&i.gl;if(a){var s=this._cache;s.use(i.__uid__),r=s.get("attached_textures")}var l=this._textures[t];if(!l||l.target!==n||l.texture!==e||!r||null==r[t]){var u=!0;i&&(u=this._doAttach(i,e,t,n),this.viewport||i.setViewport(0,0,e.width,e.height,1)),u&&(this._textures[t]=this._textures[t]||{},this._textures[t].texture=e,this._textures[t].target=n)}},_doAttach:function(e,t,n,r){var i=e.gl,a=t.getWebGLTexture(e),s=this._cache.get("attached_textures");if(s&&s[n]){var u=s[n];if(u.texture===t&&u.target===r)return}n=+n;var c=!0;if(n===m||n===o["a"].DEPTH_STENCIL_ATTACHMENT){var v=e.getGLExtension("WEBGL_depth_texture");if(v||(console.error("Depth texture is not supported by the browser"),c=!1),t.format!==o["a"].DEPTH_COMPONENT&&t.format!==o["a"].DEPTH_STENCIL&&(console.error("The texture attached to depth buffer is not a valid."),c=!1),c){var g=this._cache.get(l);g&&(i.framebufferRenderbuffer(h,m,p,null),i.deleteRenderbuffer(g),this._cache.put(l,!1)),this._cache.put(d,!1),this._cache.put(f,!0)}}return i.framebufferTexture2D(h,n,r,a,0),s||(s={},this._cache.put("attached_textures",s)),s[n]=s[n]||{},s[n].texture=t,s[n].target=r,c},_doDetach:function(e,t,n){e.framebufferTexture2D(h,t,n,null,0);var r=this._cache.get("attached_textures");r&&r[t]&&(r[t]=null),t!==m&&t!==o["a"].DEPTH_STENCIL_ATTACHMENT||this._cache.put(f,!1)},detach:function(e,t){if(this._textures[e]=null,this._boundRenderer){var n=this._cache;n.use(this._boundRenderer.__uid__),this._doDetach(this._boundRenderer.gl,e,t)}},dispose:function(e){var t=e.gl,n=this._cache;n.use(e.__uid__);var r=n.get(l);r&&t.deleteRenderbuffer(r);var i=n.get(s);i&&t.deleteFramebuffer(i),n.deleteContext(e.__uid__),this._textures={}}});g.DEPTH_ATTACHMENT=m,g.COLOR_ATTACHMENT0=v,g.STENCIL_ATTACHMENT=o["a"].STENCIL_ATTACHMENT,g.DEPTH_STENCIL_ATTACHMENT=o["a"].DEPTH_STENCIL_ATTACHMENT,t["a"]=g},function(e,t,n){"use strict";t["a"]={DEPTH_BUFFER_BIT:256,STENCIL_BUFFER_BIT:1024,COLOR_BUFFER_BIT:16384,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,ZERO:0,ONE:1,SRC_COLOR:768,ONE_MINUS_SRC_COLOR:769,SRC_ALPHA:770,ONE_MINUS_SRC_ALPHA:771,DST_ALPHA:772,ONE_MINUS_DST_ALPHA:773,DST_COLOR:774,ONE_MINUS_DST_COLOR:775,SRC_ALPHA_SATURATE:776,FUNC_ADD:32774,BLEND_EQUATION:32777,BLEND_EQUATION_RGB:32777,BLEND_EQUATION_ALPHA:34877,FUNC_SUBTRACT:32778,FUNC_REVERSE_SUBTRACT:32779,BLEND_DST_RGB:32968,BLEND_SRC_RGB:32969,BLEND_DST_ALPHA:32970,BLEND_SRC_ALPHA:32971,CONSTANT_COLOR:32769,ONE_MINUS_CONSTANT_COLOR:32770,CONSTANT_ALPHA:32771,ONE_MINUS_CONSTANT_ALPHA:32772,BLEND_COLOR:32773,ARRAY_BUFFER:34962,ELEMENT_ARRAY_BUFFER:34963,ARRAY_BUFFER_BINDING:34964,ELEMENT_ARRAY_BUFFER_BINDING:34965,STREAM_DRAW:35040,STATIC_DRAW:35044,DYNAMIC_DRAW:35048,BUFFER_SIZE:34660,BUFFER_USAGE:34661,CURRENT_VERTEX_ATTRIB:34342,FRONT:1028,BACK:1029,FRONT_AND_BACK:1032,CULL_FACE:2884,BLEND:3042,DITHER:3024,STENCIL_TEST:2960,DEPTH_TEST:2929,SCISSOR_TEST:3089,POLYGON_OFFSET_FILL:32823,SAMPLE_ALPHA_TO_COVERAGE:32926,SAMPLE_COVERAGE:32928,NO_ERROR:0,INVALID_ENUM:1280,INVALID_VALUE:1281,INVALID_OPERATION:1282,OUT_OF_MEMORY:1285,CW:2304,CCW:2305,LINE_WIDTH:2849,ALIASED_POINT_SIZE_RANGE:33901,ALIASED_LINE_WIDTH_RANGE:33902,CULL_FACE_MODE:2885,FRONT_FACE:2886,DEPTH_RANGE:2928,DEPTH_WRITEMASK:2930,DEPTH_CLEAR_VALUE:2931,DEPTH_FUNC:2932,STENCIL_CLEAR_VALUE:2961,STENCIL_FUNC:2962,STENCIL_FAIL:2964,STENCIL_PASS_DEPTH_FAIL:2965,STENCIL_PASS_DEPTH_PASS:2966,STENCIL_REF:2967,STENCIL_VALUE_MASK:2963,STENCIL_WRITEMASK:2968,STENCIL_BACK_FUNC:34816,STENCIL_BACK_FAIL:34817,STENCIL_BACK_PASS_DEPTH_FAIL:34818,STENCIL_BACK_PASS_DEPTH_PASS:34819,STENCIL_BACK_REF:36003,STENCIL_BACK_VALUE_MASK:36004,STENCIL_BACK_WRITEMASK:36005,VIEWPORT:2978,SCISSOR_BOX:3088,COLOR_CLEAR_VALUE:3106,COLOR_WRITEMASK:3107,UNPACK_ALIGNMENT:3317,PACK_ALIGNMENT:3333,MAX_TEXTURE_SIZE:3379,MAX_VIEWPORT_DIMS:3386,SUBPIXEL_BITS:3408,RED_BITS:3410,GREEN_BITS:3411,BLUE_BITS:3412,ALPHA_BITS:3413,DEPTH_BITS:3414,STENCIL_BITS:3415,POLYGON_OFFSET_UNITS:10752,POLYGON_OFFSET_FACTOR:32824,TEXTURE_BINDING_2D:32873,SAMPLE_BUFFERS:32936,SAMPLES:32937,SAMPLE_COVERAGE_VALUE:32938,SAMPLE_COVERAGE_INVERT:32939,COMPRESSED_TEXTURE_FORMATS:34467,DONT_CARE:4352,FASTEST:4353,NICEST:4354,GENERATE_MIPMAP_HINT:33170,BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,DEPTH_COMPONENT:6402,ALPHA:6406,RGB:6407,RGBA:6408,LUMINANCE:6409,LUMINANCE_ALPHA:6410,UNSIGNED_SHORT_4_4_4_4:32819,UNSIGNED_SHORT_5_5_5_1:32820,UNSIGNED_SHORT_5_6_5:33635,FRAGMENT_SHADER:35632,VERTEX_SHADER:35633,MAX_VERTEX_ATTRIBS:34921,MAX_VERTEX_UNIFORM_VECTORS:36347,MAX_VARYING_VECTORS:36348,MAX_COMBINED_TEXTURE_IMAGE_UNITS:35661,MAX_VERTEX_TEXTURE_IMAGE_UNITS:35660,MAX_TEXTURE_IMAGE_UNITS:34930,MAX_FRAGMENT_UNIFORM_VECTORS:36349,SHADER_TYPE:35663,DELETE_STATUS:35712,LINK_STATUS:35714,VALIDATE_STATUS:35715,ATTACHED_SHADERS:35717,ACTIVE_UNIFORMS:35718,ACTIVE_ATTRIBUTES:35721,SHADING_LANGUAGE_VERSION:35724,CURRENT_PROGRAM:35725,NEVER:512,LESS:513,EQUAL:514,LEQUAL:515,GREATER:516,NOTEQUAL:517,GEQUAL:518,ALWAYS:519,KEEP:7680,REPLACE:7681,INCR:7682,DECR:7683,INVERT:5386,INCR_WRAP:34055,DECR_WRAP:34056,VENDOR:7936,RENDERER:7937,VERSION:7938,NEAREST:9728,LINEAR:9729,NEAREST_MIPMAP_NEAREST:9984,LINEAR_MIPMAP_NEAREST:9985,NEAREST_MIPMAP_LINEAR:9986,LINEAR_MIPMAP_LINEAR:9987,TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,TEXTURE_2D:3553,TEXTURE:5890,TEXTURE_CUBE_MAP:34067,TEXTURE_BINDING_CUBE_MAP:34068,TEXTURE_CUBE_MAP_POSITIVE_X:34069,TEXTURE_CUBE_MAP_NEGATIVE_X:34070,TEXTURE_CUBE_MAP_POSITIVE_Y:34071,TEXTURE_CUBE_MAP_NEGATIVE_Y:34072,TEXTURE_CUBE_MAP_POSITIVE_Z:34073,TEXTURE_CUBE_MAP_NEGATIVE_Z:34074,MAX_CUBE_MAP_TEXTURE_SIZE:34076,TEXTURE0:33984,TEXTURE1:33985,TEXTURE2:33986,TEXTURE3:33987,TEXTURE4:33988,TEXTURE5:33989,TEXTURE6:33990,TEXTURE7:33991,TEXTURE8:33992,TEXTURE9:33993,TEXTURE10:33994,TEXTURE11:33995,TEXTURE12:33996,TEXTURE13:33997,TEXTURE14:33998,TEXTURE15:33999,TEXTURE16:34e3,TEXTURE17:34001,TEXTURE18:34002,TEXTURE19:34003,TEXTURE20:34004,TEXTURE21:34005,TEXTURE22:34006,TEXTURE23:34007,TEXTURE24:34008,TEXTURE25:34009,TEXTURE26:34010,TEXTURE27:34011,TEXTURE28:34012,TEXTURE29:34013,TEXTURE30:34014,TEXTURE31:34015,ACTIVE_TEXTURE:34016,REPEAT:10497,CLAMP_TO_EDGE:33071,MIRRORED_REPEAT:33648,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,INT_VEC2:35667,INT_VEC3:35668,INT_VEC4:35669,BOOL:35670,BOOL_VEC2:35671,BOOL_VEC3:35672,BOOL_VEC4:35673,FLOAT_MAT2:35674,FLOAT_MAT3:35675,FLOAT_MAT4:35676,SAMPLER_2D:35678,SAMPLER_CUBE:35680,VERTEX_ATTRIB_ARRAY_ENABLED:34338,VERTEX_ATTRIB_ARRAY_SIZE:34339,VERTEX_ATTRIB_ARRAY_STRIDE:34340,VERTEX_ATTRIB_ARRAY_TYPE:34341,VERTEX_ATTRIB_ARRAY_NORMALIZED:34922,VERTEX_ATTRIB_ARRAY_POINTER:34373,VERTEX_ATTRIB_ARRAY_BUFFER_BINDING:34975,COMPILE_STATUS:35713,LOW_FLOAT:36336,MEDIUM_FLOAT:36337,HIGH_FLOAT:36338,LOW_INT:36339,MEDIUM_INT:36340,HIGH_INT:36341,FRAMEBUFFER:36160,RENDERBUFFER:36161,RGBA4:32854,RGB5_A1:32855,RGB565:36194,DEPTH_COMPONENT16:33189,STENCIL_INDEX:6401,STENCIL_INDEX8:36168,DEPTH_STENCIL:34041,RENDERBUFFER_WIDTH:36162,RENDERBUFFER_HEIGHT:36163,RENDERBUFFER_INTERNAL_FORMAT:36164,RENDERBUFFER_RED_SIZE:36176,RENDERBUFFER_GREEN_SIZE:36177,RENDERBUFFER_BLUE_SIZE:36178,RENDERBUFFER_ALPHA_SIZE:36179,RENDERBUFFER_DEPTH_SIZE:36180,RENDERBUFFER_STENCIL_SIZE:36181,FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE:36048,FRAMEBUFFER_ATTACHMENT_OBJECT_NAME:36049,FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL:36050,FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE:36051,COLOR_ATTACHMENT0:36064,DEPTH_ATTACHMENT:36096,STENCIL_ATTACHMENT:36128,DEPTH_STENCIL_ATTACHMENT:33306,NONE:0,FRAMEBUFFER_COMPLETE:36053,FRAMEBUFFER_INCOMPLETE_ATTACHMENT:36054,FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:36055,FRAMEBUFFER_INCOMPLETE_DIMENSIONS:36057,FRAMEBUFFER_UNSUPPORTED:36061,FRAMEBUFFER_BINDING:36006,RENDERBUFFER_BINDING:36007,MAX_RENDERBUFFER_SIZE:34024,INVALID_FRAMEBUFFER_OPERATION:1286,UNPACK_FLIP_Y_WEBGL:37440,UNPACK_PREMULTIPLY_ALPHA_WEBGL:37441,CONTEXT_LOST_WEBGL:37442,UNPACK_COLORSPACE_CONVERSION_WEBGL:37443,BROWSER_DEFAULT_WEBGL:37444}},function(e,t,n){"use strict";var r=n(20),i={create:function(){var e=new r["a"](3);return e[0]=0,e[1]=0,e[2]=0,e},clone:function(e){var t=new r["a"](3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},fromValues:function(e,t,n){var i=new r["a"](3);return i[0]=e,i[1]=t,i[2]=n,i},copy:function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},set:function(e,t,n,r){return e[0]=t,e[1]=n,e[2]=r,e},add:function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e},subtract:function(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e}};i.sub=i.subtract,i.multiply=function(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e[2]=t[2]*n[2],e},i.mul=i.multiply,i.divide=function(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e[2]=t[2]/n[2],e},i.div=i.divide,i.min=function(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e[2]=Math.min(t[2],n[2]),e},i.max=function(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e[2]=Math.max(t[2],n[2]),e},i.scale=function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e},i.scaleAndAdd=function(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e},i.distance=function(e,t){var n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2];return Math.sqrt(n*n+r*r+i*i)},i.dist=i.distance,i.squaredDistance=function(e,t){var n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2];return n*n+r*r+i*i},i.sqrDist=i.squaredDistance,i.length=function(e){var t=e[0],n=e[1],r=e[2];return Math.sqrt(t*t+n*n+r*r)},i.len=i.length,i.squaredLength=function(e){var t=e[0],n=e[1],r=e[2];return t*t+n*n+r*r},i.sqrLen=i.squaredLength,i.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e},i.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e},i.normalize=function(e,t){var n=t[0],r=t[1],i=t[2],o=n*n+r*r+i*i;return o>0&&(o=1/Math.sqrt(o),e[0]=t[0]*o,e[1]=t[1]*o,e[2]=t[2]*o),e},i.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]},i.cross=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=n[0],s=n[1],l=n[2];return e[0]=i*l-o*s,e[1]=o*a-r*l,e[2]=r*s-i*a,e},i.lerp=function(e,t,n,r){var i=t[0],o=t[1],a=t[2];return e[0]=i+r*(n[0]-i),e[1]=o+r*(n[1]-o),e[2]=a+r*(n[2]-a),e},i.random=function(e,t){t=t||1;var n=2*Object(r["c"])()*Math.PI,i=2*Object(r["c"])()-1,o=Math.sqrt(1-i*i)*t;return e[0]=Math.cos(n)*o,e[1]=Math.sin(n)*o,e[2]=i*t,e},i.transformMat4=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=n[3]*r+n[7]*i+n[11]*o+n[15];return a=a||1,e[0]=(n[0]*r+n[4]*i+n[8]*o+n[12])/a,e[1]=(n[1]*r+n[5]*i+n[9]*o+n[13])/a,e[2]=(n[2]*r+n[6]*i+n[10]*o+n[14])/a,e},i.transformMat3=function(e,t,n){var r=t[0],i=t[1],o=t[2];return e[0]=r*n[0]+i*n[3]+o*n[6],e[1]=r*n[1]+i*n[4]+o*n[7],e[2]=r*n[2]+i*n[5]+o*n[8],e},i.transformQuat=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=n[0],s=n[1],l=n[2],u=n[3],c=u*r+s*o-l*i,d=u*i+l*r-a*o,f=u*o+a*i-s*r,h=-a*r-s*i-l*o;return e[0]=c*u+h*-a+d*-l-f*-s,e[1]=d*u+h*-s+f*-a-c*-l,e[2]=f*u+h*-l+c*-s-d*-a,e},i.rotateX=function(e,t,n,r){var i=[],o=[];return i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],o[0]=i[0],o[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),o[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),e[0]=o[0]+n[0],e[1]=o[1]+n[1],e[2]=o[2]+n[2],e},i.rotateY=function(e,t,n,r){var i=[],o=[];return i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],o[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),o[1]=i[1],o[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),e[0]=o[0]+n[0],e[1]=o[1]+n[1],e[2]=o[2]+n[2],e},i.rotateZ=function(e,t,n,r){var i=[],o=[];return i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],o[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),o[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),o[2]=i[2],e[0]=o[0]+n[0],e[1]=o[1]+n[1],e[2]=o[2]+n[2],e},i.forEach=function(){var e=i.create();return function(t,n,r,i,o,a){var s,l;for(n||(n=3),r||(r=0),l=i?Math.min(i*n+r,t.length):t.length,s=r;s<l;s+=n)e[0]=t[s],e[1]=t[s+1],e[2]=t[s+2],o(e,e,a),t[s]=e[0],t[s+1]=e[1],t[s+2]=e[2];return t}}(),i.angle=function(e,t){var n=i.fromValues(e[0],e[1],e[2]),r=i.fromValues(t[0],t[1],t[2]);i.normalize(n,n),i.normalize(r,r);var o=i.dot(n,r);return o>1?0:Math.acos(o)},t["a"]=i},function(e,t){var n={"[object Function]":1,"[object RegExp]":1,"[object Date]":1,"[object Error]":1,"[object CanvasGradient]":1,"[object CanvasPattern]":1,"[object Image]":1,"[object Canvas]":1},r={"[object Int8Array]":1,"[object Uint8Array]":1,"[object Uint8ClampedArray]":1,"[object Int16Array]":1,"[object Uint16Array]":1,"[object Int32Array]":1,"[object Uint32Array]":1,"[object Float32Array]":1,"[object Float64Array]":1},i=Object.prototype.toString,o=Array.prototype,a=o.forEach,s=o.filter,l=o.slice,u=o.map,c=o.reduce,d={};function f(e,t){"createCanvas"===e&&(y=null),d[e]=t}function h(e){if(null==e||"object"!=typeof e)return e;var t=e,o=i.call(e);if("[object Array]"===o){if(!Q(e)){t=[];for(var a=0,s=e.length;a<s;a++)t[a]=h(e[a])}}else if(r[o]){if(!Q(e)){var l=e.constructor;if(e.constructor.from)t=l.from(e);else{t=new l(e.length);for(a=0,s=e.length;a<s;a++)t[a]=h(e[a])}}}else if(!n[o]&&!Q(e)&&!F(e))for(var u in t={},e)e.hasOwnProperty(u)&&(t[u]=h(e[u]));return t}function p(e,t,n){if(!P(t)||!P(e))return n?h(t):e;for(var r in t)if(t.hasOwnProperty(r)){var i=e[r],o=t[r];!P(o)||!P(i)||O(o)||O(i)||F(o)||F(i)||k(o)||k(i)||Q(o)||Q(i)?!n&&r in e||(e[r]=h(t[r],!0)):p(i,o,n)}return e}function m(e,t){for(var n=e[0],r=1,i=e.length;r<i;r++)n=p(n,e[r],t);return n}function v(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}function g(e,t,n){for(var r in t)t.hasOwnProperty(r)&&(n?null!=t[r]:null==e[r])&&(e[r]=t[r]);return e}var y,_=function(){return d.createCanvas()};function x(){return y||(y=_().getContext("2d")),y}function b(e,t){if(e){if(e.indexOf)return e.indexOf(t);for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n}return-1}function w(e,t){var n=e.prototype;function r(){}for(var i in r.prototype=t.prototype,e.prototype=new r,n)e.prototype[i]=n[i];e.prototype.constructor=e,e.superClass=t}function A(e,t,n){e="prototype"in e?e.prototype:e,t="prototype"in t?t.prototype:t,g(e,t,n)}function T(e){if(e)return"string"!=typeof e&&"number"==typeof e.length}function S(e,t,n){if(e&&t)if(e.forEach&&e.forEach===a)e.forEach(t,n);else if(e.length===+e.length)for(var r=0,i=e.length;r<i;r++)t.call(n,e[r],r,e);else for(var o in e)e.hasOwnProperty(o)&&t.call(n,e[o],o,e)}function E(e,t,n){if(e&&t){if(e.map&&e.map===u)return e.map(t,n);for(var r=[],i=0,o=e.length;i<o;i++)r.push(t.call(n,e[i],i,e));return r}}function C(e,t,n,r){if(e&&t){if(e.reduce&&e.reduce===c)return e.reduce(t,n,r);for(var i=0,o=e.length;i<o;i++)n=t.call(r,n,e[i],i,e);return n}}function M(e,t,n){if(e&&t){if(e.filter&&e.filter===s)return e.filter(t,n);for(var r=[],i=0,o=e.length;i<o;i++)t.call(n,e[i],i,e)&&r.push(e[i]);return r}}function L(e,t,n){if(e&&t)for(var r=0,i=e.length;r<i;r++)if(t.call(n,e[r],r,e))return e[r]}function N(e,t){var n=l.call(arguments,2);return function(){return e.apply(t,n.concat(l.call(arguments)))}}function D(e){var t=l.call(arguments,1);return function(){return e.apply(this,t.concat(l.call(arguments)))}}function O(e){return"[object Array]"===i.call(e)}function I(e){return"function"===typeof e}function R(e){return"[object String]"===i.call(e)}function P(e){var t=typeof e;return"function"===t||!!e&&"object"==t}function k(e){return!!n[i.call(e)]}function B(e){return!!r[i.call(e)]}function F(e){return"object"===typeof e&&"number"===typeof e.nodeType&&"object"===typeof e.ownerDocument}function z(e){return e!==e}function H(e){for(var t=0,n=arguments.length;t<n;t++)if(null!=arguments[t])return arguments[t]}function U(e,t){return null!=e?e:t}function G(e,t,n){return null!=e?e:null!=t?t:n}function V(){return Function.call.apply(l,arguments)}function j(e){if("number"===typeof e)return[e,e,e,e];var t=e.length;return 2===t?[e[0],e[1],e[0],e[1]]:3===t?[e[0],e[1],e[2],e[1]]:e}function W(e,t){if(!e)throw new Error(t)}function X(e){return null==e?null:"function"===typeof e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}d.createCanvas=function(){return document.createElement("canvas")};var Y="__ec_primitive__";function q(e){e[Y]=!0}function Q(e){return e[Y]}function $(e){var t=O(e),n=this;function r(e,r){t?n.set(e,r):n.set(r,e)}e instanceof $?e.each(r):e&&S(e,r)}function K(e){return new $(e)}function Z(e,t){for(var n=new e.constructor(e.length+t.length),r=0;r<e.length;r++)n[r]=e[r];var i=e.length;for(r=0;r<t.length;r++)n[r+i]=t[r];return n}function J(){}$.prototype={constructor:$,get:function(e){return this.hasOwnProperty(e)?this[e]:null},set:function(e,t){return this[e]=t},each:function(e,t){for(var n in void 0!==t&&(e=N(e,t)),this)this.hasOwnProperty(n)&&e(this[n],n)},removeKey:function(e){delete this[e]}},t.$override=f,t.clone=h,t.merge=p,t.mergeAll=m,t.extend=v,t.defaults=g,t.createCanvas=_,t.getContext=x,t.indexOf=b,t.inherits=w,t.mixin=A,t.isArrayLike=T,t.each=S,t.map=E,t.reduce=C,t.filter=M,t.find=L,t.bind=N,t.curry=D,t.isArray=O,t.isFunction=I,t.isString=R,t.isObject=P,t.isBuiltInObject=k,t.isTypedArray=B,t.isDom=F,t.eqNaN=z,t.retrieve=H,t.retrieve2=U,t.retrieve3=G,t.slice=V,t.normalizeCssArray=j,t.assert=W,t.trim=X,t.setAsPrimitive=q,t.isPrimitive=Q,t.createHashMap=K,t.concatArray=Z,t.noop=J},function(e,t,n){"use strict";(function(e){var r,i=n(112),o={supportWebGL:function(){if(null==r)try{var e=document.createElement("canvas"),t=e.getContext("webgl")||e.getContext("experimental-webgl");if(!t)throw new Error}catch(n){r=!1}return r}};o.Int8Array="undefined"===typeof Int8Array?Array:Int8Array,o.Uint8Array="undefined"===typeof Uint8Array?Array:Uint8Array,o.Uint16Array="undefined"===typeof Uint16Array?Array:Uint16Array,o.Uint32Array="undefined"===typeof Uint32Array?Array:Uint32Array,o.Int16Array="undefined"===typeof Int16Array?Array:Int16Array,o.Float32Array="undefined"===typeof Float32Array?Array:Float32Array,o.Float64Array="undefined"===typeof Float64Array?Array:Float64Array;var a={};"undefined"!==typeof window?a=window:"undefined"!==typeof e&&(a=e),o.requestAnimationFrame=a.requestAnimationFrame||a.msRequestAnimationFrame||a.mozRequestAnimationFrame||a.webkitRequestAnimationFrame||function(e){setTimeout(e,16)},o.createCanvas=function(){return document.createElement("canvas")},o.createImage=function(){return new a.Image},o.request={get:i["a"].get},t["a"]=o}).call(t,n(68))},function(e,t,n){"use strict";var r=n(14),i=n(12),o=n(21),a=n(18),s=n(118),l=i["a"].create,u=i["a"].add,c=i["a"].set,d=s["a"].Attribute,f=s["a"].extend((function(){return{attributes:{position:new d("position","float",3,"POSITION"),texcoord0:new d("texcoord0","float",2,"TEXCOORD_0"),texcoord1:new d("texcoord1","float",2,"TEXCOORD_1"),normal:new d("normal","float",3,"NORMAL"),tangent:new d("tangent","float",4,"TANGENT"),color:new d("color","float",4,"COLOR"),weight:new d("weight","float",3,"WEIGHT"),joint:new d("joint","float",4,"JOINT"),barycentric:new d("barycentric","float",3,null)},boundingBox:null}}),{mainAttribute:"position",updateBoundingBox:function(){var e=this.boundingBox;e||(e=this.boundingBox=new a["a"]);var t=this.attributes.position.value;if(t&&t.length){var n=e.min,r=e.max,o=n.array,s=r.array;i["a"].set(o,t[0],t[1],t[2]),i["a"].set(s,t[0],t[1],t[2]);for(var l=3;l<t.length;){var u=t[l++],c=t[l++],d=t[l++];u<o[0]&&(o[0]=u),c<o[1]&&(o[1]=c),d<o[2]&&(o[2]=d),u>s[0]&&(s[0]=u),c>s[1]&&(s[1]=c),d>s[2]&&(s[2]=d)}n._dirty=!0,r._dirty=!0}},generateVertexNormals:function(){if(this.vertexCount){var e=this.indices,t=this.attributes,n=t.position.value,o=t.normal.value;if(o&&o.length===n.length)for(var a=0;a<o.length;a++)o[a]=0;else o=t.normal.value=new r["a"].Float32Array(n.length);for(var s,u,d,f=l(),h=l(),p=l(),m=l(),v=l(),g=l(),y=e?e.length:this.vertexCount,_=0;_<y;){e?(s=e[_++],u=e[_++],d=e[_++]):(s=_++,u=_++,d=_++),c(f,n[3*s],n[3*s+1],n[3*s+2]),c(h,n[3*u],n[3*u+1],n[3*u+2]),c(p,n[3*d],n[3*d+1],n[3*d+2]),i["a"].sub(m,f,h),i["a"].sub(v,h,p),i["a"].cross(g,m,v);for(a=0;a<3;a++)o[3*s+a]=o[3*s+a]+g[a],o[3*u+a]=o[3*u+a]+g[a],o[3*d+a]=o[3*d+a]+g[a]}for(a=0;a<o.length;)c(g,o[a],o[a+1],o[a+2]),i["a"].normalize(g,g),o[a++]=g[0],o[a++]=g[1],o[a++]=g[2];this.dirty()}},generateFaceNormals:function(){if(this.vertexCount){this.isUniqueVertex()||this.generateUniqueVertex();var e=this.indices,t=this.attributes,n=t.position.value,r=t.normal.value,o=l(),a=l(),s=l(),u=l(),d=l(),f=l();r||(r=t.normal.value=new Float32Array(n.length));for(var h,p,m,v=e?e.length:this.vertexCount,g=0;g<v;){e?(h=e[g++],p=e[g++],m=e[g++]):(h=g++,p=g++,m=g++),c(o,n[3*h],n[3*h+1],n[3*h+2]),c(a,n[3*p],n[3*p+1],n[3*p+2]),c(s,n[3*m],n[3*m+1],n[3*m+2]),i["a"].sub(u,o,a),i["a"].sub(d,a,s),i["a"].cross(f,u,d),i["a"].normalize(f,f);for(var y=0;y<3;y++)r[3*h+y]=f[y],r[3*p+y]=f[y],r[3*m+y]=f[y]}this.dirty()}},generateTangents:function(){if(this.vertexCount){var e=this.vertexCount,t=this.attributes;t.tangent.value||(t.tangent.value=new Float32Array(4*e));var n=t.texcoord0.value,r=t.position.value,o=t.tangent.value,a=t.normal.value;if(n){for(var s=[],c=[],d=0;d<e;d++)s[d]=[0,0,0],c[d]=[0,0,0];var f,h,p,m=[0,0,0],v=[0,0,0],g=this.indices,y=g?g.length:this.vertexCount;for(d=0;d<y;){g?(f=g[d++],h=g[d++],p=g[d++]):(f=d++,h=d++,p=d++);var _=n[2*f],x=n[2*h],b=n[2*p],w=n[2*f+1],A=n[2*h+1],T=n[2*p+1],S=r[3*f],E=r[3*h],C=r[3*p],M=r[3*f+1],L=r[3*h+1],N=r[3*p+1],D=r[3*f+2],O=r[3*h+2],I=r[3*p+2],R=E-S,P=C-S,k=L-M,B=N-M,F=O-D,z=I-D,H=x-_,U=b-_,G=A-w,V=T-w,j=1/(H*V-G*U);m[0]=(V*R-G*P)*j,m[1]=(V*k-G*B)*j,m[2]=(V*F-G*z)*j,v[0]=(H*P-U*R)*j,v[1]=(H*B-U*k)*j,v[2]=(H*z-U*F)*j,u(s[f],s[f],m),u(s[h],s[h],m),u(s[p],s[p],m),u(c[f],c[f],v),u(c[h],c[h],v),u(c[p],c[p],v)}var W=l(),X=l(),Y=l();for(d=0;d<e;d++){Y[0]=a[3*d],Y[1]=a[3*d+1],Y[2]=a[3*d+2];var q=s[d];i["a"].scale(W,Y,i["a"].dot(Y,q)),i["a"].sub(W,q,W),i["a"].normalize(W,W),i["a"].cross(X,Y,q),o[4*d]=W[0],o[4*d+1]=W[1],o[4*d+2]=W[2],o[4*d+3]=i["a"].dot(X,c[d])<0?-1:1}this.dirty()}else console.warn("Geometry without texcoords can't generate tangents.")}},isUniqueVertex:function(){return!this.isUseIndices()||this.vertexCount===this.indices.length},generateUniqueVertex:function(){if(this.vertexCount&&this.indices){this.indices.length>65535&&(this.indices=new r["a"].Uint32Array(this.indices));for(var e=this.attributes,t=this.indices,n=this.getEnabledAttributes(),i={},o=0;o<n.length;o++){var a=n[o];i[a]=e[a].value,e[a].init(this.indices.length)}for(var s=0,l=0;l<t.length;l++){var u=t[l];for(o=0;o<n.length;o++){a=n[o];for(var c=e[a].value,d=e[a].size,f=0;f<d;f++)c[s*d+f]=i[a][u*d+f]}t[l]=s,s++}this.dirty()}},generateBarycentric:function(){if(this.vertexCount){this.isUniqueVertex()||this.generateUniqueVertex();var e=this.attributes,t=e.barycentric.value,n=this.indices;if(!t||t.length!==3*n.length){t=e.barycentric.value=new Float32Array(3*n.length);for(var r=0;r<(n?n.length:this.vertexCount/3);)for(var i=0;i<3;i++){var o=n?n[r++]:3*r+i;t[3*o+i]=1}this.dirty()}}},applyTransform:function(e){var t=this.attributes,n=t.position.value,r=t.normal.value,a=t.tangent.value;e=e.array;var s=o["a"].create();o["a"].invert(s,e),o["a"].transpose(s,s);var l=i["a"].transformMat4,u=i["a"].forEach;u(n,3,0,null,l,e),r&&u(r,3,0,null,l,s),a&&u(a,4,0,null,l,s),this.boundingBox&&this.updateBoundingBox()},dispose:function(e){var t=this._cache;t.use(e.__uid__);var n=t.get("chunks");if(n)for(var r=0;r<n.length;r++){for(var i=n[r],o=0;o<i.attributeBuffers.length;o++){var a=i.attributeBuffers[o];e.gl.deleteBuffer(a.buffer)}i.indicesBuffer&&e.gl.deleteBuffer(i.indicesBuffer.buffer)}if(this.__vaoCache){var s=e.getGLExtension("OES_vertex_array_object");for(var l in this.__vaoCache){var u=this.__vaoCache[l].vao;u&&s.deleteVertexArrayOES(u)}}this.__vaoCache={},t.deleteContext(e.__uid__)}});f.STATIC_DRAW=s["a"].STATIC_DRAW,f.DYNAMIC_DRAW=s["a"].DYNAMIC_DRAW,f.STREAM_DRAW=s["a"].STREAM_DRAW,f.AttributeBuffer=s["a"].AttributeBuffer,f.IndicesBuffer=s["a"].IndicesBuffer,f.Attribute=d,t["a"]=f},function(e,t,n){"use strict";var r=n(7),i=n(37),o=n(43),a=n(8),s=n(19),l=n(40),u=n(11),c=n(126);a["a"]["import"](c["a"]);var d=new o["a"],f=new l["a"]({geometry:d,frustumCulling:!1}),h=new i["a"],p=r["a"].extend((function(){return{fragment:"",outputs:null,material:null,blendWithPrevious:!1,clearColor:!1,clearDepth:!0}}),(function(){var e=new a["a"](a["a"].source("clay.compositor.vertex"),this.fragment),t=new s["a"]({shader:e});t.enableTexturesAll(),this.material=t}),{setUniform:function(e,t){this.material.setUniform(e,t)},getUniform:function(e){var t=this.material.uniforms[e];if(t)return t.value},attachOutput:function(e,t){this.outputs||(this.outputs={}),t=t||u["a"].COLOR_ATTACHMENT0,this.outputs[t]=e},detachOutput:function(e){for(var t in this.outputs)this.outputs[t]===e&&(this.outputs[t]=null)},bind:function(e,t){if(this.outputs)for(var n in this.outputs){var r=this.outputs[n];r&&t.attach(r,n)}t&&t.bind(e)},unbind:function(e,t){t.unbind(e)},render:function(e,t){var n=e.gl;if(t){this.bind(e,t);var r=e.getGLExtension("EXT_draw_buffers");if(r&&this.outputs){var i=[];for(var o in this.outputs)o=+o,o>=n.COLOR_ATTACHMENT0&&o<=n.COLOR_ATTACHMENT0+8&&i.push(o);r.drawBuffersEXT(i)}}this.trigger("beforerender",this,e);var a=this.clearDepth?n.DEPTH_BUFFER_BIT:0;if(n.depthMask(!0),this.clearColor){a|=n.COLOR_BUFFER_BIT,n.colorMask(!0,!0,!0,!0);var s=this.clearColor;Array.isArray(s)&&n.clearColor(s[0],s[1],s[2],s[3])}n.clear(a),this.blendWithPrevious?(n.enable(n.BLEND),this.material.transparent=!0):(n.disable(n.BLEND),this.material.transparent=!1),this.renderQuad(e),this.trigger("afterrender",this,e),t&&this.unbind(e,t)},renderQuad:function(e){f.material=this.material,e.renderPass([f],h)},dispose:function(e){}});t["a"]=p},function(e,t,n){"use strict";t["a"]=function(e,t,n){return{seriesType:e,reset:function(e,t){var n=e.getData(),r=e.visualColorAccessPath.split(".");r[r.length-1]="opacity";var i=e.get(r);function o(e,t){var n=e.getItemModel(t),i=n.get(r,!0);null!=i&&e.setItemVisual(t,"opacity",i)}return n.setVisual("opacity",null==i?1:i),{dataEach:n.hasItemOption?o:null}}}}},function(e,t,n){"use strict";var r=n(3),i=n(12),o=i["a"].set,a=i["a"].copy,s=function(e,t){this.min=e||new r["a"](1/0,1/0,1/0),this.max=t||new r["a"](-1/0,-1/0,-1/0),this.vertices=null};s.prototype={constructor:s,updateFromVertices:function(e){if(e.length>0){var t=this.min,n=this.max,r=t.array,i=n.array;a(r,e[0]),a(i,e[0]);for(var o=1;o<e.length;o++){var s=e[o];s[0]<r[0]&&(r[0]=s[0]),s[1]<r[1]&&(r[1]=s[1]),s[2]<r[2]&&(r[2]=s[2]),s[0]>i[0]&&(i[0]=s[0]),s[1]>i[1]&&(i[1]=s[1]),s[2]>i[2]&&(i[2]=s[2])}t._dirty=!0,n._dirty=!0}},union:function(e){var t=this.min,n=this.max;return i["a"].min(t.array,t.array,e.min.array),i["a"].max(n.array,n.array,e.max.array),t._dirty=!0,n._dirty=!0,this},intersection:function(e){var t=this.min,n=this.max;return i["a"].max(t.array,t.array,e.min.array),i["a"].min(n.array,n.array,e.max.array),t._dirty=!0,n._dirty=!0,this},intersectBoundingBox:function(e){var t=this.min.array,n=this.max.array,r=e.min.array,i=e.max.array;return!(t[0]>i[0]||t[1]>i[1]||t[2]>i[2]||n[0]<r[0]||n[1]<r[1]||n[2]<r[2])},containBoundingBox:function(e){var t=this.min.array,n=this.max.array,r=e.min.array,i=e.max.array;return t[0]<=r[0]&&t[1]<=r[1]&&t[2]<=r[2]&&n[0]>=i[0]&&n[1]>=i[1]&&n[2]>=i[2]},containPoint:function(e){var t=this.min.array,n=this.max.array,r=e.array;return t[0]<=r[0]&&t[1]<=r[1]&&t[2]<=r[2]&&n[0]>=r[0]&&n[1]>=r[1]&&n[2]>=r[2]},isFinite:function(){var e=this.min.array,t=this.max.array;return isFinite(e[0])&&isFinite(e[1])&&isFinite(e[2])&&isFinite(t[0])&&isFinite(t[1])&&isFinite(t[2])},applyTransform:function(e){this.transformFrom(this,e)},transformFrom:function(){var e=i["a"].create(),t=i["a"].create(),n=i["a"].create(),r=i["a"].create(),o=i["a"].create(),a=i["a"].create();return function(i,s){var l=i.min.array,u=i.max.array,c=s.array;return e[0]=c[0]*l[0],e[1]=c[1]*l[0],e[2]=c[2]*l[0],t[0]=c[0]*u[0],t[1]=c[1]*u[0],t[2]=c[2]*u[0],n[0]=c[4]*l[1],n[1]=c[5]*l[1],n[2]=c[6]*l[1],r[0]=c[4]*u[1],r[1]=c[5]*u[1],r[2]=c[6]*u[1],o[0]=c[8]*l[2],o[1]=c[9]*l[2],o[2]=c[10]*l[2],a[0]=c[8]*u[2],a[1]=c[9]*u[2],a[2]=c[10]*u[2],l=this.min.array,u=this.max.array,l[0]=Math.min(e[0],t[0])+Math.min(n[0],r[0])+Math.min(o[0],a[0])+c[12],l[1]=Math.min(e[1],t[1])+Math.min(n[1],r[1])+Math.min(o[1],a[1])+c[13],l[2]=Math.min(e[2],t[2])+Math.min(n[2],r[2])+Math.min(o[2],a[2])+c[14],u[0]=Math.max(e[0],t[0])+Math.max(n[0],r[0])+Math.max(o[0],a[0])+c[12],u[1]=Math.max(e[1],t[1])+Math.max(n[1],r[1])+Math.max(o[1],a[1])+c[13],u[2]=Math.max(e[2],t[2])+Math.max(n[2],r[2])+Math.max(o[2],a[2])+c[14],this.min._dirty=!0,this.max._dirty=!0,this}}(),applyProjection:function(e){var t=this.min.array,n=this.max.array,r=e.array,i=t[0],o=t[1],a=t[2],s=n[0],l=n[1],u=t[2],c=n[0],d=n[1],f=n[2];if(1===r[15])t[0]=r[0]*i+r[12],t[1]=r[5]*o+r[13],n[2]=r[10]*a+r[14],n[0]=r[0]*c+r[12],n[1]=r[5]*d+r[13],t[2]=r[10]*f+r[14];else{var h=-1/a;t[0]=r[0]*i*h,t[1]=r[5]*o*h,n[2]=(r[10]*a+r[14])*h,h=-1/u,n[0]=r[0]*s*h,n[1]=r[5]*l*h,h=-1/f,t[2]=(r[10]*f+r[14])*h}return this.min._dirty=!0,this.max._dirty=!0,this},updateVertices:function(){var e=this.vertices;if(!e){e=[];for(var t=0;t<8;t++)e[t]=i["a"].fromValues(0,0,0);this.vertices=e}var n=this.min.array,r=this.max.array;return o(e[0],n[0],n[1],n[2]),o(e[1],n[0],r[1],n[2]),o(e[2],r[0],n[1],n[2]),o(e[3],r[0],r[1],n[2]),o(e[4],n[0],n[1],r[2]),o(e[5],n[0],r[1],r[2]),o(e[6],r[0],n[1],r[2]),o(e[7],r[0],r[1],r[2]),this},copy:function(e){var t=this.min,n=this.max;return a(t.array,e.min.array),a(n.array,e.max.array),t._dirty=!0,n._dirty=!0,this},clone:function(){var e=new s;return e.copy(this),e}},t["a"]=s},function(e,t,n){"use strict";var r=n(7),i=n(23),o=n(113),a=o["a"].parseToFloat,s={};function l(e){var t=Object.keys(e);t.sort();for(var n=[],r=0;r<t.length;r++){var i=t[r],o=e[i];null===o?n.push(i):n.push(i+" "+o.toString())}return n.join("\n")}function u(e,t,n){n.sort();for(var r=[],o=0;o<n.length;o++){var a=n[o];r.push(a)}var u=l(e)+"\n"+l(t)+"\n"+r.join("\n");if(s[u])return s[u];var c=i["a"].genGUID();return s[u]=c,c}var c=r["a"].extend((function(){return{name:"",depthTest:!0,depthMask:!0,transparent:!1,blend:null,autoUpdateTextureStatus:!0,uniforms:{},vertexDefines:{},fragmentDefines:{},_textureStatus:{},_enabledUniforms:null}}),(function(){this.name||(this.name="MATERIAL_"+this.__uid__),this.shader&&this.attachShader(this.shader,!0)}),{precision:"highp",setUniform:function(e,t){void 0===t&&console.warn('Uniform value "'+e+'" is undefined');var n=this.uniforms[e];n&&("string"===typeof t&&(t=a(t)||t),n.value=t,this.autoUpdateTextureStatus&&"t"===n.type&&(t?this.enableTexture(e):this.disableTexture(e)))},setUniforms:function(e){for(var t in e){var n=e[t];this.setUniform(t,n)}},isUniformEnabled:function(e){return this._enabledUniforms.indexOf(e)>=0},getEnabledUniforms:function(){return this._enabledUniforms},getTextureUniforms:function(){return this._textureUniforms},set:function(e,t){if("object"===typeof e)for(var n in e){var r=e[n];this.setUniform(n,r)}else this.setUniform(e,t)},get:function(e){var t=this.uniforms[e];if(t)return t.value},attachShader:function(e,t){var n=this.uniforms;this.uniforms=e.createUniforms(),this.shader=e;var r=this.uniforms;this._enabledUniforms=Object.keys(r),this._enabledUniforms.sort(),this._textureUniforms=this._enabledUniforms.filter((function(e){var t=this.uniforms[e].type;return"t"===t||"tv"===t}),this);var o=this.vertexDefines,a=this.fragmentDefines;if(this.vertexDefines=i["a"].clone(e.vertexDefines),this.fragmentDefines=i["a"].clone(e.fragmentDefines),t){for(var s in n)r[s]&&(r[s].value=n[s].value);i["a"].defaults(this.vertexDefines,o),i["a"].defaults(this.fragmentDefines,a)}var l={};for(var u in e.textures)l[u]={shaderType:e.textures[u].shaderType,type:e.textures[u].type,enabled:!(!t||!this._textureStatus[u])&&this._textureStatus[u].enabled};this._textureStatus=l,this._programKey=""},clone:function(){var e=new this.constructor({name:this.name,shader:this.shader});for(var t in this.uniforms)e.uniforms[t].value=this.uniforms[t].value;return e.depthTest=this.depthTest,e.depthMask=this.depthMask,e.transparent=this.transparent,e.blend=this.blend,e.vertexDefines=i["a"].clone(this.vertexDefines),e.fragmentDefines=i["a"].clone(this.fragmentDefines),e.enableTexture(this.getEnabledTextures()),e.precision=this.precision,e},define:function(e,t,n){var r=this.vertexDefines,i=this.fragmentDefines;"vertex"!==e&&"fragment"!==e&&"both"!==e&&arguments.length<3&&(n=t,t=e,e="both"),n=null!=n?n:null,"vertex"!==e&&"both"!==e||r[t]!==n&&(r[t]=n,this._programKey=""),"fragment"!==e&&"both"!==e||i[t]!==n&&(i[t]=n,"both"!==e&&(this._programKey=""))},undefine:function(e,t){"vertex"!==e&&"fragment"!==e&&"both"!==e&&arguments.length<2&&(t=e,e="both"),"vertex"!==e&&"both"!==e||this.isDefined("vertex",t)&&(delete this.vertexDefines[t],this._programKey=""),"fragment"!==e&&"both"!==e||this.isDefined("fragment",t)&&(delete this.fragmentDefines[t],"both"!==e&&(this._programKey=""))},isDefined:function(e,t){switch(e){case"vertex":return void 0!==this.vertexDefines[t];case"fragment":return void 0!==this.fragmentDefines[t]}},getDefine:function(e,t){switch(e){case"vertex":return this.vertexDefines[t];case"fragment":return this.fragmentDefines[t]}},enableTexture:function(e){if(Array.isArray(e))for(var t=0;t<e.length;t++)this.enableTexture(e[t]);else{var n=this._textureStatus[e];if(n){var r=n.enabled;r||(n.enabled=!0,this._programKey="")}}},enableTexturesAll:function(){var e=this._textureStatus;for(var t in e)e[t].enabled=!0;this._programKey=""},disableTexture:function(e){if(Array.isArray(e))for(var t=0;t<e.length;t++)this.disableTexture(e[t]);else{var n=this._textureStatus[e];if(n){var r=!n.enabled;r||(n.enabled=!1,this._programKey="")}}},disableTexturesAll:function(){var e=this._textureStatus;for(var t in e)e[t].enabled=!1;this._programKey=""},isTextureEnabled:function(e){var t=this._textureStatus;return!!t[e]&&t[e].enabled},getEnabledTextures:function(){var e=[],t=this._textureStatus;for(var n in t)t[n].enabled&&e.push(n);return e},dirtyDefines:function(){this._programKey=""},getProgramKey:function(){return this._programKey||(this._programKey=u(this.vertexDefines,this.fragmentDefines,this.getEnabledTextures())),this._programKey}});t["a"]=c},function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return o}));var r=1e-6,i=Array,o=Math.random},function(e,t,n){"use strict";var r=n(20),i={create:function(){var e=new r["a"](16);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},clone:function(e){var t=new r["a"](16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},copy:function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},identity:function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},transpose:function(e,t){if(e===t){var n=t[1],r=t[2],i=t[3],o=t[6],a=t[7],s=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=n,e[6]=t[9],e[7]=t[13],e[8]=r,e[9]=o,e[11]=t[14],e[12]=i,e[13]=a,e[14]=s}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e},invert:function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],l=t[6],u=t[7],c=t[8],d=t[9],f=t[10],h=t[11],p=t[12],m=t[13],v=t[14],g=t[15],y=n*s-r*a,_=n*l-i*a,x=n*u-o*a,b=r*l-i*s,w=r*u-o*s,A=i*u-o*l,T=c*m-d*p,S=c*v-f*p,E=c*g-h*p,C=d*v-f*m,M=d*g-h*m,L=f*g-h*v,N=y*L-_*M+x*C+b*E-w*S+A*T;return N?(N=1/N,e[0]=(s*L-l*M+u*C)*N,e[1]=(i*M-r*L-o*C)*N,e[2]=(m*A-v*w+g*b)*N,e[3]=(f*w-d*A-h*b)*N,e[4]=(l*E-a*L-u*S)*N,e[5]=(n*L-i*E+o*S)*N,e[6]=(v*x-p*A-g*_)*N,e[7]=(c*A-f*x+h*_)*N,e[8]=(a*M-s*E+u*T)*N,e[9]=(r*E-n*M-o*T)*N,e[10]=(p*w-m*x+g*y)*N,e[11]=(d*x-c*w-h*y)*N,e[12]=(s*S-a*C-l*T)*N,e[13]=(n*C-r*S+i*T)*N,e[14]=(m*_-p*b-v*y)*N,e[15]=(c*b-d*_+f*y)*N,e):null},adjoint:function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],l=t[6],u=t[7],c=t[8],d=t[9],f=t[10],h=t[11],p=t[12],m=t[13],v=t[14],g=t[15];return e[0]=s*(f*g-h*v)-d*(l*g-u*v)+m*(l*h-u*f),e[1]=-(r*(f*g-h*v)-d*(i*g-o*v)+m*(i*h-o*f)),e[2]=r*(l*g-u*v)-s*(i*g-o*v)+m*(i*u-o*l),e[3]=-(r*(l*h-u*f)-s*(i*h-o*f)+d*(i*u-o*l)),e[4]=-(a*(f*g-h*v)-c*(l*g-u*v)+p*(l*h-u*f)),e[5]=n*(f*g-h*v)-c*(i*g-o*v)+p*(i*h-o*f),e[6]=-(n*(l*g-u*v)-a*(i*g-o*v)+p*(i*u-o*l)),e[7]=n*(l*h-u*f)-a*(i*h-o*f)+c*(i*u-o*l),e[8]=a*(d*g-h*m)-c*(s*g-u*m)+p*(s*h-u*d),e[9]=-(n*(d*g-h*m)-c*(r*g-o*m)+p*(r*h-o*d)),e[10]=n*(s*g-u*m)-a*(r*g-o*m)+p*(r*u-o*s),e[11]=-(n*(s*h-u*d)-a*(r*h-o*d)+c*(r*u-o*s)),e[12]=-(a*(d*v-f*m)-c*(s*v-l*m)+p*(s*f-l*d)),e[13]=n*(d*v-f*m)-c*(r*v-i*m)+p*(r*f-i*d),e[14]=-(n*(s*v-l*m)-a*(r*v-i*m)+p*(r*l-i*s)),e[15]=n*(s*f-l*d)-a*(r*f-i*d)+c*(r*l-i*s),e},determinant:function(e){var t=e[0],n=e[1],r=e[2],i=e[3],o=e[4],a=e[5],s=e[6],l=e[7],u=e[8],c=e[9],d=e[10],f=e[11],h=e[12],p=e[13],m=e[14],v=e[15],g=t*a-n*o,y=t*s-r*o,_=t*l-i*o,x=n*s-r*a,b=n*l-i*a,w=r*l-i*s,A=u*p-c*h,T=u*m-d*h,S=u*v-f*h,E=c*m-d*p,C=c*v-f*p,M=d*v-f*m;return g*M-y*C+_*E+x*S-b*T+w*A},multiply:function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=t[4],l=t[5],u=t[6],c=t[7],d=t[8],f=t[9],h=t[10],p=t[11],m=t[12],v=t[13],g=t[14],y=t[15],_=n[0],x=n[1],b=n[2],w=n[3];return e[0]=_*r+x*s+b*d+w*m,e[1]=_*i+x*l+b*f+w*v,e[2]=_*o+x*u+b*h+w*g,e[3]=_*a+x*c+b*p+w*y,_=n[4],x=n[5],b=n[6],w=n[7],e[4]=_*r+x*s+b*d+w*m,e[5]=_*i+x*l+b*f+w*v,e[6]=_*o+x*u+b*h+w*g,e[7]=_*a+x*c+b*p+w*y,_=n[8],x=n[9],b=n[10],w=n[11],e[8]=_*r+x*s+b*d+w*m,e[9]=_*i+x*l+b*f+w*v,e[10]=_*o+x*u+b*h+w*g,e[11]=_*a+x*c+b*p+w*y,_=n[12],x=n[13],b=n[14],w=n[15],e[12]=_*r+x*s+b*d+w*m,e[13]=_*i+x*l+b*f+w*v,e[14]=_*o+x*u+b*h+w*g,e[15]=_*a+x*c+b*p+w*y,e},multiplyAffine:function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[4],s=t[5],l=t[6],u=t[8],c=t[9],d=t[10],f=t[12],h=t[13],p=t[14],m=n[0],v=n[1],g=n[2];return e[0]=m*r+v*a+g*u,e[1]=m*i+v*s+g*c,e[2]=m*o+v*l+g*d,m=n[4],v=n[5],g=n[6],e[4]=m*r+v*a+g*u,e[5]=m*i+v*s+g*c,e[6]=m*o+v*l+g*d,m=n[8],v=n[9],g=n[10],e[8]=m*r+v*a+g*u,e[9]=m*i+v*s+g*c,e[10]=m*o+v*l+g*d,m=n[12],v=n[13],g=n[14],e[12]=m*r+v*a+g*u+f,e[13]=m*i+v*s+g*c+h,e[14]=m*o+v*l+g*d+p,e}};i.mul=i.multiply,i.mulAffine=i.multiplyAffine,i.translate=function(e,t,n){var r,i,o,a,s,l,u,c,d,f,h,p,m=n[0],v=n[1],g=n[2];return t===e?(e[12]=t[0]*m+t[4]*v+t[8]*g+t[12],e[13]=t[1]*m+t[5]*v+t[9]*g+t[13],e[14]=t[2]*m+t[6]*v+t[10]*g+t[14],e[15]=t[3]*m+t[7]*v+t[11]*g+t[15]):(r=t[0],i=t[1],o=t[2],a=t[3],s=t[4],l=t[5],u=t[6],c=t[7],d=t[8],f=t[9],h=t[10],p=t[11],e[0]=r,e[1]=i,e[2]=o,e[3]=a,e[4]=s,e[5]=l,e[6]=u,e[7]=c,e[8]=d,e[9]=f,e[10]=h,e[11]=p,e[12]=r*m+s*v+d*g+t[12],e[13]=i*m+l*v+f*g+t[13],e[14]=o*m+u*v+h*g+t[14],e[15]=a*m+c*v+p*g+t[15]),e},i.scale=function(e,t,n){var r=n[0],i=n[1],o=n[2];return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*o,e[9]=t[9]*o,e[10]=t[10]*o,e[11]=t[11]*o,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},i.rotate=function(e,t,n,i){var o,a,s,l,u,c,d,f,h,p,m,v,g,y,_,x,b,w,A,T,S,E,C,M,L=i[0],N=i[1],D=i[2],O=Math.sqrt(L*L+N*N+D*D);return Math.abs(O)<r["b"]?null:(O=1/O,L*=O,N*=O,D*=O,o=Math.sin(n),a=Math.cos(n),s=1-a,l=t[0],u=t[1],c=t[2],d=t[3],f=t[4],h=t[5],p=t[6],m=t[7],v=t[8],g=t[9],y=t[10],_=t[11],x=L*L*s+a,b=N*L*s+D*o,w=D*L*s-N*o,A=L*N*s-D*o,T=N*N*s+a,S=D*N*s+L*o,E=L*D*s+N*o,C=N*D*s-L*o,M=D*D*s+a,e[0]=l*x+f*b+v*w,e[1]=u*x+h*b+g*w,e[2]=c*x+p*b+y*w,e[3]=d*x+m*b+_*w,e[4]=l*A+f*T+v*S,e[5]=u*A+h*T+g*S,e[6]=c*A+p*T+y*S,e[7]=d*A+m*T+_*S,e[8]=l*E+f*C+v*M,e[9]=u*E+h*C+g*M,e[10]=c*E+p*C+y*M,e[11]=d*E+m*C+_*M,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)},i.rotateX=function(e,t,n){var r=Math.sin(n),i=Math.cos(n),o=t[4],a=t[5],s=t[6],l=t[7],u=t[8],c=t[9],d=t[10],f=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=o*i+u*r,e[5]=a*i+c*r,e[6]=s*i+d*r,e[7]=l*i+f*r,e[8]=u*i-o*r,e[9]=c*i-a*r,e[10]=d*i-s*r,e[11]=f*i-l*r,e},i.rotateY=function(e,t,n){var r=Math.sin(n),i=Math.cos(n),o=t[0],a=t[1],s=t[2],l=t[3],u=t[8],c=t[9],d=t[10],f=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*i-u*r,e[1]=a*i-c*r,e[2]=s*i-d*r,e[3]=l*i-f*r,e[8]=o*r+u*i,e[9]=a*r+c*i,e[10]=s*r+d*i,e[11]=l*r+f*i,e},i.rotateZ=function(e,t,n){var r=Math.sin(n),i=Math.cos(n),o=t[0],a=t[1],s=t[2],l=t[3],u=t[4],c=t[5],d=t[6],f=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*i+u*r,e[1]=a*i+c*r,e[2]=s*i+d*r,e[3]=l*i+f*r,e[4]=u*i-o*r,e[5]=c*i-a*r,e[6]=d*i-s*r,e[7]=f*i-l*r,e},i.fromRotationTranslation=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=r+r,l=i+i,u=o+o,c=r*s,d=r*l,f=r*u,h=i*l,p=i*u,m=o*u,v=a*s,g=a*l,y=a*u;return e[0]=1-(h+m),e[1]=d+y,e[2]=f-g,e[3]=0,e[4]=d-y,e[5]=1-(c+m),e[6]=p+v,e[7]=0,e[8]=f+g,e[9]=p-v,e[10]=1-(c+h),e[11]=0,e[12]=n[0],e[13]=n[1],e[14]=n[2],e[15]=1,e},i.fromQuat=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=n+n,s=r+r,l=i+i,u=n*a,c=r*a,d=r*s,f=i*a,h=i*s,p=i*l,m=o*a,v=o*s,g=o*l;return e[0]=1-d-p,e[1]=c+g,e[2]=f-v,e[3]=0,e[4]=c-g,e[5]=1-u-p,e[6]=h+m,e[7]=0,e[8]=f+v,e[9]=h-m,e[10]=1-u-d,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},i.frustum=function(e,t,n,r,i,o,a){var s=1/(n-t),l=1/(i-r),u=1/(o-a);return e[0]=2*o*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*o*l,e[6]=0,e[7]=0,e[8]=(n+t)*s,e[9]=(i+r)*l,e[10]=(a+o)*u,e[11]=-1,e[12]=0,e[13]=0,e[14]=a*o*2*u,e[15]=0,e},i.perspective=function(e,t,n,r,i){var o=1/Math.tan(t/2),a=1/(r-i);return e[0]=o/n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=o,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=(i+r)*a,e[11]=-1,e[12]=0,e[13]=0,e[14]=2*i*r*a,e[15]=0,e},i.ortho=function(e,t,n,r,i,o,a){var s=1/(t-n),l=1/(r-i),u=1/(o-a);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*u,e[11]=0,e[12]=(t+n)*s,e[13]=(i+r)*l,e[14]=(a+o)*u,e[15]=1,e},i.lookAt=function(e,t,n,o){var a,s,l,u,c,d,f,h,p,m,v=t[0],g=t[1],y=t[2],_=o[0],x=o[1],b=o[2],w=n[0],A=n[1],T=n[2];return Math.abs(v-w)<r["b"]&&Math.abs(g-A)<r["b"]&&Math.abs(y-T)<r["b"]?i.identity(e):(f=v-w,h=g-A,p=y-T,m=1/Math.sqrt(f*f+h*h+p*p),f*=m,h*=m,p*=m,a=x*p-b*h,s=b*f-_*p,l=_*h-x*f,m=Math.sqrt(a*a+s*s+l*l),m?(m=1/m,a*=m,s*=m,l*=m):(a=0,s=0,l=0),u=h*l-p*s,c=p*a-f*l,d=f*s-h*a,m=Math.sqrt(u*u+c*c+d*d),m?(m=1/m,u*=m,c*=m,d*=m):(u=0,c=0,d=0),e[0]=a,e[1]=u,e[2]=f,e[3]=0,e[4]=s,e[5]=c,e[6]=h,e[7]=0,e[8]=l,e[9]=d,e[10]=p,e[11]=0,e[12]=-(a*v+s*g+l*y),e[13]=-(u*v+c*g+d*y),e[14]=-(f*v+h*g+p*y),e[15]=1,e)},i.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+Math.pow(e[6],2)+Math.pow(e[7],2)+Math.pow(e[8],2)+Math.pow(e[9],2)+Math.pow(e[10],2)+Math.pow(e[11],2)+Math.pow(e[12],2)+Math.pow(e[13],2)+Math.pow(e[14],2)+Math.pow(e[15],2))},t["a"]=i},function(e,t,n){"use strict";var r=n(0),i=n.n(r),o=n(36),a=n(174),s=n(41),l=n(37),u=n(9),c=n(3),d=n(26),f=n(53),h=n(176),p=n(200),m=n(49);function v(e){e=e||"perspective",this.layer=null,this.scene=new o["a"],this.rootNode=this.scene,this.viewport={x:0,y:0,width:0,height:0},this.setProjection(e),this._compositor=new h["a"],this._temporalSS=new p["a"],this._shadowMapPass=new a["a"];for(var t=[],n=0,r=0;r<30;r++){for(var i=[],s=0;s<6;s++)i.push(4*Object(m["a"])(n,2)-2),i.push(4*Object(m["a"])(n,3)-2),n++;t.push(i)}this._pcfKernels=t,this.scene.on("beforerender",(function(e,t,n){this.needsTemporalSS()&&this._temporalSS.jitterProjection(e,n)}),this)}v.prototype.setProjection=function(e){var t=this.camera;t&&t.update(),"perspective"===e?this.camera instanceof s["a"]||(this.camera=new s["a"],t&&this.camera.setLocalTransform(t.localTransform)):this.camera instanceof l["a"]||(this.camera=new l["a"],t&&this.camera.setLocalTransform(t.localTransform)),this.camera.near=.1,this.camera.far=2e3},v.prototype.setViewport=function(e,t,n,r,i){this.camera instanceof s["a"]&&(this.camera.aspect=n/r),i=i||1,this.viewport.x=e,this.viewport.y=t,this.viewport.width=n,this.viewport.height=r,this.viewport.devicePixelRatio=i,this._compositor.resize(n*i,r*i),this._temporalSS.resize(n*i,r*i)},v.prototype.containPoint=function(e,t){var n=this.viewport,r=this.layer.renderer.getHeight();return t=r-t,e>=n.x&&t>=n.y&&e<=n.x+n.width&&t<=n.y+n.height};var g=new d["a"];v.prototype.castRay=function(e,t,n){var r=this.layer.renderer,i=r.viewport;return r.viewport=this.viewport,r.screenToNDC(e,t,g),this.camera.castRay(g,n),r.viewport=i,n},v.prototype.prepareRender=function(){this.scene.update(),this.camera.update(),this.scene.updateLights();var e=this.scene.updateRenderList(this.camera);this._needsSortProgressively=!1;for(var t=0;t<e.transparent.length;t++){var n=e.transparent[t],r=n.geometry;r.needsSortVerticesProgressively&&r.needsSortVerticesProgressively()&&(this._needsSortProgressively=!0),r.needsSortTrianglesProgressively&&r.needsSortTrianglesProgressively()&&(this._needsSortProgressively=!0)}this._frame=0,this._temporalSS.resetFrame()},v.prototype.render=function(e,t){this._doRender(e,t,this._frame),this._frame++},v.prototype.needsAccumulate=function(){return this.needsTemporalSS()||this._needsSortProgressively},v.prototype.needsTemporalSS=function(){var e=this._enableTemporalSS;return"auto"===e&&(e=this._enablePostEffect),e},v.prototype.hasDOF=function(){return this._enableDOF},v.prototype.isAccumulateFinished=function(){return this.needsTemporalSS()?this._temporalSS.isFinished():this._frame>30},v.prototype._doRender=function(e,t,n){var r=this.scene,i=this.camera;n=n||0,this._updateTransparent(e,r,i,n),t||(this._shadowMapPass.kernelPCF=this._pcfKernels[0],this._shadowMapPass.render(e,r,i,!0)),this._updateShadowPCFKernel(n);var o=e.clearColor;if(e.gl.clearColor(o[0],o[1],o[2],o[3]),this._enablePostEffect&&(this.needsTemporalSS()&&this._temporalSS.jitterProjection(e,i),this._compositor.updateNormal(e,r,i,this._temporalSS.getFrame())),this._updateSSAO(e,r,i,this._temporalSS.getFrame()),this._enablePostEffect){var a=this._compositor.getSourceFrameBuffer();a.bind(e),e.gl.clear(e.gl.DEPTH_BUFFER_BIT|e.gl.COLOR_BUFFER_BIT),e.render(r,i,!0,!0),a.unbind(e),this.needsTemporalSS()&&t?(this._compositor.composite(e,r,i,this._temporalSS.getSourceFrameBuffer(),this._temporalSS.getFrame()),e.setViewport(this.viewport),this._temporalSS.render(e)):(e.setViewport(this.viewport),this._compositor.composite(e,r,i,null,0))}else if(this.needsTemporalSS()&&t){a=this._temporalSS.getSourceFrameBuffer();a.bind(e),e.saveClear(),e.clearBit=e.gl.DEPTH_BUFFER_BIT|e.gl.COLOR_BUFFER_BIT,e.render(r,i,!0,!0),e.restoreClear(),a.unbind(e),e.setViewport(this.viewport),this._temporalSS.render(e)}else e.setViewport(this.viewport),e.render(r,i,!0,!0)},v.prototype._updateTransparent=function(e,t,n,r){for(var i=new c["a"],o=new u["a"],a=n.getWorldPosition(),s=t.getRenderList(n).transparent,l=0;l<s.length;l++){var d=s[l],f=d.geometry;u["a"].invert(o,d.worldTransform),c["a"].transformMat4(i,a,o),f.needsSortTriangles&&f.needsSortTriangles()&&f.doSortTriangles(i,r),f.needsSortVertices&&f.needsSortVertices()&&f.doSortVertices(i,r)}},v.prototype._updateSSAO=function(e,t,n){var r=this._enableSSAO&&this._enablePostEffect;r&&this._compositor.updateSSAO(e,t,n,this._temporalSS.getFrame());for(var i=t.getRenderList(n),o=0;o<i.opaque.length;o++){var a=i.opaque[o];a.renderNormal&&a.material[r?"enableTexture":"disableTexture"]("ssaoMap"),r&&a.material.set("ssaoMap",this._compositor.getSSAOTexture())}},v.prototype._updateShadowPCFKernel=function(e){for(var t=this._pcfKernels[e%this._pcfKernels.length],n=this.scene.getRenderList(this.camera),r=n.opaque,i=0;i<r.length;i++)r[i].receiveShadow&&(r[i].material.set("pcfKernel",t),r[i].material.define("fragment","PCF_KERNEL_SIZE",t.length/2))},v.prototype.dispose=function(e){this._compositor.dispose(e.gl),this._temporalSS.dispose(e.gl),this._shadowMapPass.dispose(e)},v.prototype.setPostEffect=function(e,t){var n=this._compositor;this._enablePostEffect=e.get("enable");var r=e.getModel("bloom"),i=e.getModel("edge"),o=e.getModel("DOF",e.getModel("depthOfField")),a=e.getModel("SSAO",e.getModel("screenSpaceAmbientOcclusion")),s=e.getModel("SSR",e.getModel("screenSpaceReflection")),l=e.getModel("FXAA"),u=e.getModel("colorCorrection");r.get("enable")?n.enableBloom():n.disableBloom(),o.get("enable")?n.enableDOF():n.disableDOF(),s.get("enable")?n.enableSSR():n.disableSSR(),u.get("enable")?n.enableColorCorrection():n.disableColorCorrection(),i.get("enable")?n.enableEdge():n.disableEdge(),l.get("enable")?n.enableFXAA():n.disableFXAA(),this._enableDOF=o.get("enable"),this._enableSSAO=a.get("enable"),this._enableSSAO?n.enableSSAO():n.disableSSAO(),n.setBloomIntensity(r.get("intensity")),n.setEdgeColor(i.get("color")),n.setColorLookupTexture(u.get("lookupTexture"),t),n.setExposure(u.get("exposure")),["radius","quality","intensity"].forEach((function(e){n.setSSAOParameter(e,a.get(e))})),["quality","maxRoughness","physical"].forEach((function(e){n.setSSRParameter(e,s.get(e))})),["quality","focalDistance","focalRange","blurRadius","fstop"].forEach((function(e){n.setDOFParameter(e,o.get(e))})),["brightness","contrast","saturation"].forEach((function(e){n.setColorCorrection(e,u.get(e))}))},v.prototype.setDOFFocusOnPoint=function(e){if(this._enablePostEffect){if(e>this.camera.far||e<this.camera.near)return;return this._compositor.setDOFParameter("focalDistance",e),!0}},v.prototype.setTemporalSuperSampling=function(e){this._enableTemporalSS=e.get("enable")},v.prototype.isLinearSpace=function(){return this._enablePostEffect},v.prototype.setRootNode=function(e){if(this.rootNode!==e){for(var t=this.rootNode.children(),n=0;n<t.length;n++)e.add(t[n]);e!==this.scene&&this.scene.add(e),this.rootNode=e}},v.prototype.add=function(e){this.rootNode.add(e)},v.prototype.remove=function(e){this.rootNode.remove(e)},v.prototype.removeAll=function(e){this.rootNode.removeAll(e)},i.a.util.extend(v.prototype,f["a"]),t["a"]=v},function(e,t,n){"use strict";var r=0,i=Array.prototype,o=i.forEach,a={genGUID:function(){return++r},relative2absolute:function(e,t){if(!t||e.match(/^\//))return e;var n=e.split("/"),r=t.split("/"),i=n[0];while("."===i||".."===i)".."===i&&r.pop(),n.shift(),i=n[0];return r.join("/")+"/"+n.join("/")},extend:function(e,t){if(t)for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},defaults:function(e,t){if(t)for(var n in t)void 0===e[n]&&(e[n]=t[n]);return e},extendWithPropList:function(e,t,n){if(t)for(var r=0;r<n.length;r++){var i=n[r];e[i]=t[i]}return e},defaultsWithPropList:function(e,t,n){if(t)for(var r=0;r<n.length;r++){var i=n[r];null==e[i]&&(e[i]=t[i])}return e},each:function(e,t,n){if(e&&t)if(e.forEach&&e.forEach===o)e.forEach(t,n);else if(e.length===+e.length)for(var r=0,i=e.length;r<i;r++)t.call(n,e[r],r,e);else for(var a in e)e.hasOwnProperty(a)&&t.call(n,e[a],a,e)},isObject:function(e){return e===Object(e)},isArray:function(e){return Array.isArray(e)},isArrayLike:function(e){return!!e&&e.length===+e.length},clone:function(e){if(a.isObject(e)){if(a.isArray(e))return e.slice();if(a.isArrayLike(e)){for(var t=new e.constructor(e.length),n=0;n<e.length;n++)t[n]=e[n];return t}return a.extend({},e)}return e}};t["a"]=a},function(e,t,n){"use strict";var r=n(35),i=n(8),o=n(119);i["a"]["import"](o["a"]);var a=r["a"].extend((function(){return{color:[1,1,1],intensity:1,castShadow:!0,shadowResolution:512,group:0}}),{type:"",clone:function(){var e=r["a"].prototype.clone.call(this);return e.color=Array.prototype.slice.call(this.color),e.intensity=this.intensity,e.castShadow=this.castShadow,e.shadowResolution=this.shadowResolution,e}});t["a"]=a},function(e,t,n){"use strict";var r=n(15),i=n(0),o=n.n(i),a=n(38),s=n(6),l=s["a"].vec3,u=[[0,0],[1,1]],c=r["a"].extend((function(){return{segmentScale:1,dynamic:!0,useNativeLine:!0,attributes:{position:new r["a"].Attribute("position","float",3,"POSITION"),positionPrev:new r["a"].Attribute("positionPrev","float",3),positionNext:new r["a"].Attribute("positionNext","float",3),prevPositionPrev:new r["a"].Attribute("prevPositionPrev","float",3),prevPosition:new r["a"].Attribute("prevPosition","float",3),prevPositionNext:new r["a"].Attribute("prevPositionNext","float",3),offset:new r["a"].Attribute("offset","float",1),color:new r["a"].Attribute("color","float",4,"COLOR")}}}),{resetOffset:function(){this._vertexOffset=0,this._triangleOffset=0,this._itemVertexOffsets=[]},setVertexCount:function(e){var t=this.attributes;this.vertexCount!==e&&(t.position.init(e),t.color.init(e),this.useNativeLine||(t.positionPrev.init(e),t.positionNext.init(e),t.offset.init(e)),e>65535?this.indices instanceof Uint16Array&&(this.indices=new Uint32Array(this.indices)):this.indices instanceof Uint32Array&&(this.indices=new Uint16Array(this.indices)))},setTriangleCount:function(e){this.triangleCount!==e&&(this.indices=0===e?null:this.vertexCount>65535?new Uint32Array(3*e):new Uint16Array(3*e))},_getCubicCurveApproxStep:function(e,t,n,r){var i=l.dist(e,t)+l.dist(n,t)+l.dist(r,n),o=1/(i+1)*this.segmentScale;return o},getCubicCurveVertexCount:function(e,t,n,r){var i=this._getCubicCurveApproxStep(e,t,n,r),o=Math.ceil(1/i);return this.useNativeLine?2*o:2*o+2},getCubicCurveTriangleCount:function(e,t,n,r){var i=this._getCubicCurveApproxStep(e,t,n,r),o=Math.ceil(1/i);return this.useNativeLine?0:2*o},getLineVertexCount:function(){return this.getPolylineVertexCount(u)},getLineTriangleCount:function(){return this.getPolylineTriangleCount(u)},getPolylineVertexCount:function(e){var t;if("number"===typeof e)t=e;else{var n="number"!==typeof e[0];t=n?e.length:e.length/3}return this.useNativeLine?2*(t-1):2*(t-1)+2},getPolylineTriangleCount:function(e){var t;if("number"===typeof e)t=e;else{var n="number"!==typeof e[0];t=n?e.length:e.length/3}return this.useNativeLine?0:2*Math.max(t-1,0)},addCubicCurve:function(e,t,n,r,i,o){null==o&&(o=1);var a=e[0],s=e[1],l=e[2],u=t[0],c=t[1],d=t[2],f=n[0],h=n[1],p=n[2],m=r[0],v=r[1],g=r[2],y=this._getCubicCurveApproxStep(e,t,n,r),_=y*y,x=_*y,b=3*y,w=3*_,A=6*_,T=6*x,S=a-2*u+f,E=s-2*c+h,C=l-2*d+p,M=3*(u-f)-a+m,L=3*(c-h)-s+v,N=3*(d-p)-l+g,D=a,O=s,I=l,R=(u-a)*b+S*w+M*x,P=(c-s)*b+E*w+L*x,k=(d-l)*b+C*w+N*x,B=S*A+M*T,F=E*A+L*T,z=C*A+N*T,H=M*T,U=L*T,G=N*T,V=0,j=0,W=Math.ceil(1/y),X=new Float32Array(3*(W+1)),Y=(X=[],0);for(j=0;j<W+1;j++)X[Y++]=D,X[Y++]=O,X[Y++]=I,D+=R,O+=P,I+=k,R+=B,P+=F,k+=z,B+=H,F+=U,z+=G,V+=y,V>1&&(D=R>0?Math.min(D,m):Math.max(D,m),O=P>0?Math.min(O,v):Math.max(O,v),I=k>0?Math.min(I,g):Math.max(I,g));return this.addPolyline(X,i,o)},addLine:function(e,t,n,r){return this.addPolyline([e,t],n,r)},addPolyline:function(e,t,n,r,i){if(e.length){var o="number"!==typeof e[0];if(null==i&&(i=o?e.length:e.length/3),!(i<2)){null==r&&(r=0),null==n&&(n=1),this._itemVertexOffsets.push(this._vertexOffset);o="number"!==typeof e[0];var a,s,l=o?"number"!==typeof t[0]:t.length/4===i,u=this.attributes.position,c=this.attributes.positionPrev,d=this.attributes.positionNext,f=this.attributes.color,h=this.attributes.offset,p=this.indices,m=this._vertexOffset;n=Math.max(n,.01);for(var v=r;v<i;v++){if(o)a=e[v],s=l?t[v]:t;else{var g=3*v;if(a=a||[],a[0]=e[g],a[1]=e[g+1],a[2]=e[g+2],l){var y=4*v;s=s||[],s[0]=t[y],s[1]=t[y+1],s[2]=t[y+2],s[3]=t[y+3]}else s=t}if(this.useNativeLine?v>1&&(u.copy(m,m-1),f.copy(m,m-1),m++):(v<i-1&&(c.set(m+2,a),c.set(m+3,a)),v>0&&(d.set(m-2,a),d.set(m-1,a)),u.set(m,a),u.set(m+1,a),f.set(m,s),f.set(m+1,s),h.set(m,n/2),h.set(m+1,-n/2),m+=2),this.useNativeLine)f.set(m,s),u.set(m,a),m++;else if(v>0){var _=3*this._triangleOffset;p=this.indices;p[_]=m-4,p[_+1]=m-3,p[_+2]=m-2,p[_+3]=m-3,p[_+4]=m-1,p[_+5]=m-2,this._triangleOffset+=2}}if(!this.useNativeLine){var x=this._vertexOffset,b=this._vertexOffset+2*i;c.copy(x,x+2),c.copy(x+1,x+3),d.copy(b-1,b-3),d.copy(b-2,b-4)}return this._vertexOffset=m,this._vertexOffset}}},setItemColor:function(e,t){for(var n=this._itemVertexOffsets[e],r=e<this._itemVertexOffsets.length-1?this._itemVertexOffsets[e+1]:this._vertexOffset,i=n;i<r;i++)this.attributes.color.set(i,t);this.dirty("color")},currentTriangleOffset:function(){return this._triangleOffset},currentVertexOffset:function(){return this._vertexOffset}});o.a.util.defaults(c.prototype,a["a"]),t["a"]=c},function(e,t,n){"use strict";var r=n(70),i=function(e,t){e=e||0,t=t||0,this.array=r["a"].fromValues(e,t),this._dirty=!0};if(i.prototype={constructor:i,add:function(e){return r["a"].add(this.array,this.array,e.array),this._dirty=!0,this},set:function(e,t){return this.array[0]=e,this.array[1]=t,this._dirty=!0,this},setArray:function(e){return this.array[0]=e[0],this.array[1]=e[1],this._dirty=!0,this},clone:function(){return new i(this.x,this.y)},copy:function(e){return r["a"].copy(this.array,e.array),this._dirty=!0,this},cross:function(e,t){return r["a"].cross(e.array,this.array,t.array),e._dirty=!0,this},dist:function(e){return r["a"].dist(this.array,e.array)},distance:function(e){return r["a"].distance(this.array,e.array)},div:function(e){return r["a"].div(this.array,this.array,e.array),this._dirty=!0,this},divide:function(e){return r["a"].divide(this.array,this.array,e.array),this._dirty=!0,this},dot:function(e){return r["a"].dot(this.array,e.array)},len:function(){return r["a"].len(this.array)},length:function(){return r["a"].length(this.array)},lerp:function(e,t,n){return r["a"].lerp(this.array,e.array,t.array,n),this._dirty=!0,this},min:function(e){return r["a"].min(this.array,this.array,e.array),this._dirty=!0,this},max:function(e){return r["a"].max(this.array,this.array,e.array),this._dirty=!0,this},mul:function(e){return r["a"].mul(this.array,this.array,e.array),this._dirty=!0,this},multiply:function(e){return r["a"].multiply(this.array,this.array,e.array),this._dirty=!0,this},negate:function(){return r["a"].negate(this.array,this.array),this._dirty=!0,this},normalize:function(){return r["a"].normalize(this.array,this.array),this._dirty=!0,this},random:function(e){return r["a"].random(this.array,e),this._dirty=!0,this},scale:function(e){return r["a"].scale(this.array,this.array,e),this._dirty=!0,this},scaleAndAdd:function(e,t){return r["a"].scaleAndAdd(this.array,this.array,e.array,t),this._dirty=!0,this},sqrDist:function(e){return r["a"].sqrDist(this.array,e.array)},squaredDistance:function(e){return r["a"].squaredDistance(this.array,e.array)},sqrLen:function(){return r["a"].sqrLen(this.array)},squaredLength:function(){return r["a"].squaredLength(this.array)},sub:function(e){return r["a"].sub(this.array,this.array,e.array),this._dirty=!0,this},subtract:function(e){return r["a"].subtract(this.array,this.array,e.array),this._dirty=!0,this},transformMat2:function(e){return r["a"].transformMat2(this.array,this.array,e.array),this._dirty=!0,this},transformMat2d:function(e){return r["a"].transformMat2d(this.array,this.array,e.array),this._dirty=!0,this},transformMat3:function(e){return r["a"].transformMat3(this.array,this.array,e.array),this._dirty=!0,this},transformMat4:function(e){return r["a"].transformMat4(this.array,this.array,e.array),this._dirty=!0,this},toString:function(){return"["+Array.prototype.join.call(this.array,",")+"]"},toArray:function(){return Array.prototype.slice.call(this.array)}},Object.defineProperty){var o=i.prototype;Object.defineProperty(o,"x",{get:function(){return this.array[0]},set:function(e){this.array[0]=e,this._dirty=!0}}),Object.defineProperty(o,"y",{get:function(){return this.array[1]},set:function(e){this.array[1]=e,this._dirty=!0}})}i.add=function(e,t,n){return r["a"].add(e.array,t.array,n.array),e._dirty=!0,e},i.set=function(e,t,n){return r["a"].set(e.array,t,n),e._dirty=!0,e},i.copy=function(e,t){return r["a"].copy(e.array,t.array),e._dirty=!0,e},i.cross=function(e,t,n){return r["a"].cross(e.array,t.array,n.array),e._dirty=!0,e},i.dist=function(e,t){return r["a"].distance(e.array,t.array)},i.distance=i.dist,i.div=function(e,t,n){return r["a"].divide(e.array,t.array,n.array),e._dirty=!0,e},i.divide=i.div,i.dot=function(e,t){return r["a"].dot(e.array,t.array)},i.len=function(e){return r["a"].length(e.array)},i.lerp=function(e,t,n,i){return r["a"].lerp(e.array,t.array,n.array,i),e._dirty=!0,e},i.min=function(e,t,n){return r["a"].min(e.array,t.array,n.array),e._dirty=!0,e},i.max=function(e,t,n){return r["a"].max(e.array,t.array,n.array),e._dirty=!0,e},i.mul=function(e,t,n){return r["a"].multiply(e.array,t.array,n.array),e._dirty=!0,e},i.multiply=i.mul,i.negate=function(e,t){return r["a"].negate(e.array,t.array),e._dirty=!0,e},i.normalize=function(e,t){return r["a"].normalize(e.array,t.array),e._dirty=!0,e},i.random=function(e,t){return r["a"].random(e.array,t),e._dirty=!0,e},i.scale=function(e,t,n){return r["a"].scale(e.array,t.array,n),e._dirty=!0,e},i.scaleAndAdd=function(e,t,n,i){return r["a"].scaleAndAdd(e.array,t.array,n.array,i),e._dirty=!0,e},i.sqrDist=function(e,t){return r["a"].sqrDist(e.array,t.array)},i.squaredDistance=i.sqrDist,i.sqrLen=function(e){return r["a"].sqrLen(e.array)},i.squaredLength=i.sqrLen,i.sub=function(e,t,n){return r["a"].subtract(e.array,t.array,n.array),e._dirty=!0,e},i.subtract=i.sub,i.transformMat2=function(e,t,n){return r["a"].transformMat2(e.array,t.array,n.array),e._dirty=!0,e},i.transformMat2d=function(e,t,n){return r["a"].transformMat2d(e.array,t.array,n.array),e._dirty=!0,e},i.transformMat3=function(e,t,n){return r["a"].transformMat3(e.array,t.array,n.array),e._dirty=!0,e},i.transformMat4=function(e,t,n){return r["a"].transformMat4(e.array,t.array,n.array),e._dirty=!0,e},t["a"]=i},function(e,t,n){"use strict";var r=n(4),i=n(11),o=n(23),a=n(73),s=n(14),l=a["a"].isPowerOfTwo,u=["px","nx","py","ny","pz","nz"],c=r["a"].extend((function(){return{image:{px:null,nx:null,py:null,ny:null,pz:null,nz:null},pixels:{px:null,nx:null,py:null,ny:null,pz:null,nz:null},mipmaps:[]}}),{textureType:"textureCube",update:function(e){var t=e.gl;t.bindTexture(t.TEXTURE_CUBE_MAP,this._cache.get("webgl_texture")),this.updateCommon(e);var n=this.format,r=this.type;t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_WRAP_S,this.getAvailableWrapS()),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_WRAP_T,this.getAvailableWrapT()),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,this.getAvailableMagFilter()),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,this.getAvailableMinFilter());var o=e.getGLExtension("EXT_texture_filter_anisotropic");if(o&&this.anisotropic>1&&t.texParameterf(t.TEXTURE_CUBE_MAP,o.TEXTURE_MAX_ANISOTROPY_EXT,this.anisotropic),36193===r){var a=e.getGLExtension("OES_texture_half_float");a||(r=i["a"].FLOAT)}if(this.mipmaps.length)for(var s=this.width,l=this.height,u=0;u<this.mipmaps.length;u++){var c=this.mipmaps[u];this._updateTextureData(t,c,u,s,l,n,r),s/=2,l/=2}else this._updateTextureData(t,this,0,this.width,this.height,n,r),!this.NPOT&&this.useMipmap&&t.generateMipmap(t.TEXTURE_CUBE_MAP);t.bindTexture(t.TEXTURE_CUBE_MAP,null)},_updateTextureData:function(e,t,n,r,i,o,a){for(var s=0;s<6;s++){var l=u[s],c=t.image&&t.image[l];c?e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+s,n,o,o,a,c):e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+s,n,o,r,i,0,o,a,t.pixels&&t.pixels[l])}},generateMipmap:function(e){var t=e.gl;this.useMipmap&&!this.NPOT&&(t.bindTexture(t.TEXTURE_CUBE_MAP,this._cache.get("webgl_texture")),t.generateMipmap(t.TEXTURE_CUBE_MAP))},bind:function(e){e.gl.bindTexture(e.gl.TEXTURE_CUBE_MAP,this.getWebGLTexture(e))},unbind:function(e){e.gl.bindTexture(e.gl.TEXTURE_CUBE_MAP,null)},isPowerOfTwo:function(){return this.image.px?l(this.image.px.width)&&l(this.image.px.height):l(this.width)&&l(this.height)},isRenderable:function(){return this.image.px?d(this.image.px)&&d(this.image.nx)&&d(this.image.py)&&d(this.image.ny)&&d(this.image.pz)&&d(this.image.nz):!(!this.width||!this.height)},load:function(e,t){var n=0,r=this;return o["a"].each(e,(function(e,i){var o=s["a"].createImage();t&&(o.crossOrigin=t),o.onload=function(){n--,0===n&&(r.dirty(),r.trigger("success",r)),o.onload=null},o.onerror=function(){n--,o.onerror=null},n++,o.src=e,r.image[i]=o})),this}});function d(e){return"CANVAS"===e.nodeName||"VIDEO"===e.nodeName||e.complete}Object.defineProperty(c.prototype,"width",{get:function(){return this.image&&this.image.px?this.image.px.width:this._width},set:function(e){this.image&&this.image.px?console.warn("Texture from image can't set width"):(this._width!==e&&this.dirty(),this._width=e)}}),Object.defineProperty(c.prototype,"height",{get:function(){return this.image&&this.image.px?this.image.px.height:this._height},set:function(e){this.image&&this.image.px?console.warn("Texture from image can't set height"):(this._height!==e&&this.dirty(),this._height=e)}}),t["a"]=c},function(e,t,n){"use strict";t["a"]={defaultOption:{postEffect:{enable:!1,bloom:{enable:!0,intensity:.1},depthOfField:{enable:!1,focalRange:20,focalDistance:50,blurRadius:10,fstop:2.8,quality:"medium"},screenSpaceAmbientOcclusion:{enable:!1,radius:2,quality:"medium",intensity:1},screenSpaceReflection:{enable:!1,quality:"medium",maxRoughness:.8},colorCorrection:{enable:!0,exposure:0,brightness:0,contrast:1,saturation:1,lookupTexture:""},edge:{enable:!1},FXAA:{enable:!1}},temporalSuperSampling:{enable:"auto"}}}},function(e,t,n){"use strict";t["a"]={defaultOption:{light:{main:{shadow:!1,shadowQuality:"high",color:"#fff",intensity:1,alpha:0,beta:0},ambient:{color:"#fff",intensity:.2},ambientCubemap:{texture:null,exposure:1,diffuseIntensity:.5,specularIntensity:.5}}}}},function(e,t,n){"use strict";var r=n(1),i=n(42),o=n(0),a=n.n(o);function s(){}s.prototype={constructor:s,setScene:function(e){this._scene=e,this._skybox&&this._skybox.attachScene(this._scene)},initLight:function(e){this._lightRoot=e,this.mainLight=new r["a"].DirectionalLight({shadowBias:.005}),this.ambientLight=new r["a"].AmbientLight,e.add(this.mainLight),e.add(this.ambientLight)},dispose:function(){this._lightRoot&&(this._lightRoot.remove(this.mainLight),this._lightRoot.remove(this.ambientLight))},updateLight:function(e){var t=this.mainLight,n=this.ambientLight,i=e.getModel("light"),o=i.getModel("main"),a=i.getModel("ambient");t.intensity=o.get("intensity"),n.intensity=a.get("intensity"),t.color=r["a"].parseColor(o.get("color")).slice(0,3),n.color=r["a"].parseColor(a.get("color")).slice(0,3);var s=o.get("alpha")||0,l=o.get("beta")||0;t.position.setArray(r["a"].directionFromAlphaBeta(s,l)),t.lookAt(r["a"].Vector3.ZERO),t.castShadow=o.get("shadow"),t.shadowResolution=r["a"].getShadowResolution(o.get("shadowQuality"))},updateAmbientCubemap:function(e,t,n){var i=t.getModel("light.ambientCubemap"),o=i.get("texture");if(o){this._cubemapLightsCache=this._cubemapLightsCache||{};var a=this._cubemapLightsCache[o];if(!a){var s=this;a=this._cubemapLightsCache[o]=r["a"].createAmbientCubemap(i.option,e,n,(function(){s._isSkyboxFromAmbientCubemap&&s._skybox.setEnvironmentMap(a.specular.cubemap),n.getZr().refresh()}))}this._lightRoot.add(a.diffuse),this._lightRoot.add(a.specular),this._currentCubemapLights=a}else this._currentCubemapLights&&(this._lightRoot.remove(this._currentCubemapLights.diffuse),this._lightRoot.remove(this._currentCubemapLights.specular),this._currentCubemapLights=null)},updateSkybox:function(e,t,n){var o=t.get("environment"),s=this;function l(){return s._skybox=s._skybox||new i["a"],s._skybox}var u=l();if(o&&"none"!==o)if("auto"===o)if(this._isSkyboxFromAmbientCubemap=!0,this._currentCubemapLights){var c=this._currentCubemapLights.specular.cubemap;u.setEnvironmentMap(c),this._scene&&u.attachScene(this._scene),u.material.set("lod",3)}else this._skybox&&this._skybox.detachScene();else if("object"===typeof o&&o.colorStops||"string"===typeof o&&a.a.color.parse(o)){this._isSkyboxFromAmbientCubemap=!1;var d=new r["a"].Texture2D({anisotropic:8,flipY:!1});u.setEnvironmentMap(d);var f=d.image=document.createElement("canvas");f.width=f.height=16;var h=f.getContext("2d"),p=new a.a.graphic.Rect({shape:{x:0,y:0,width:16,height:16},style:{fill:o}});p.brush(h),u.attachScene(this._scene)}else{this._isSkyboxFromAmbientCubemap=!1;d=r["a"].loadTexture(o,n,{anisotropic:8,flipY:!1});u.setEnvironmentMap(d),u.attachScene(this._scene)}else this._skybox&&this._skybox.detachScene(this._scene),this._skybox=null;var m=t.coordinateSystem;if(this._skybox)if(!m||!m.viewGL||"auto"===o||o.match&&o.match(/.hdr$/))this._skybox.material.undefine("fragment","SRGB_DECODE");else{var v=m.viewGL.isLinearSpace()?"define":"undefine";this._skybox.material[v]("fragment","SRGB_DECODE")}}},t["a"]=s},function(e,t,n){"use strict";t["a"]={defaultOption:{shading:null,realisticMaterial:{textureTiling:1,textureOffset:0,detailTexture:null},lambertMaterial:{textureTiling:1,textureOffset:0,detailTexture:null},colorMaterial:{textureTiling:1,textureOffset:0,detailTexture:null},hatchingMaterial:{textureTiling:1,textureOffset:0,paperColor:"#fff"}}}},function(e,t,n){"use strict";var r=n(0),i=n.n(r),o={getFormattedLabel:function(e,t,n,r,o){n=n||"normal";var a=e.getData(r),s=a.getItemModel(t),l=e.getDataParams(t,r);null!=o&&l.value instanceof Array&&(l.value=l.value[o]);var u,c=s.get("normal"===n?["label","formatter"]:["emphasis","label","formatter"]);return null==c&&(c=s.get(["label","formatter"])),"function"===typeof c?(l.status=n,u=c(l)):"string"===typeof c&&(u=i.a.format.formatTpl(c,l)),u},normalizeToArray:function(e){return e instanceof Array?e:null==e?[]:[e]}};t["a"]=o},function(e,t,n){"use strict";var r=n(20),i={create:function(){var e=new r["a"](4);return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e},clone:function(e){var t=new r["a"](4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},fromValues:function(e,t,n,i){var o=new r["a"](4);return o[0]=e,o[1]=t,o[2]=n,o[3]=i,o},copy:function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},set:function(e,t,n,r,i){return e[0]=t,e[1]=n,e[2]=r,e[3]=i,e},add:function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e},subtract:function(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e[3]=t[3]-n[3],e}};i.sub=i.subtract,i.multiply=function(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e[2]=t[2]*n[2],e[3]=t[3]*n[3],e},i.mul=i.multiply,i.divide=function(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e[2]=t[2]/n[2],e[3]=t[3]/n[3],e},i.div=i.divide,i.min=function(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e[2]=Math.min(t[2],n[2]),e[3]=Math.min(t[3],n[3]),e},i.max=function(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e[2]=Math.max(t[2],n[2]),e[3]=Math.max(t[3],n[3]),e},i.scale=function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e},i.scaleAndAdd=function(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e[3]=t[3]+n[3]*r,e},i.distance=function(e,t){var n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2],o=t[3]-e[3];return Math.sqrt(n*n+r*r+i*i+o*o)},i.dist=i.distance,i.squaredDistance=function(e,t){var n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2],o=t[3]-e[3];return n*n+r*r+i*i+o*o},i.sqrDist=i.squaredDistance,i.length=function(e){var t=e[0],n=e[1],r=e[2],i=e[3];return Math.sqrt(t*t+n*n+r*r+i*i)},i.len=i.length,i.squaredLength=function(e){var t=e[0],n=e[1],r=e[2],i=e[3];return t*t+n*n+r*r+i*i},i.sqrLen=i.squaredLength,i.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e},i.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e[3]=1/t[3],e},i.normalize=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=n*n+r*r+i*i+o*o;return a>0&&(a=1/Math.sqrt(a),e[0]=t[0]*a,e[1]=t[1]*a,e[2]=t[2]*a,e[3]=t[3]*a),e},i.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},i.lerp=function(e,t,n,r){var i=t[0],o=t[1],a=t[2],s=t[3];return e[0]=i+r*(n[0]-i),e[1]=o+r*(n[1]-o),e[2]=a+r*(n[2]-a),e[3]=s+r*(n[3]-s),e},i.random=function(e,t){return t=t||1,e[0]=Object(r["c"])(),e[1]=Object(r["c"])(),e[2]=Object(r["c"])(),e[3]=Object(r["c"])(),i.normalize(e,e),i.scale(e,e,t),e},i.transformMat4=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3];return e[0]=n[0]*r+n[4]*i+n[8]*o+n[12]*a,e[1]=n[1]*r+n[5]*i+n[9]*o+n[13]*a,e[2]=n[2]*r+n[6]*i+n[10]*o+n[14]*a,e[3]=n[3]*r+n[7]*i+n[11]*o+n[15]*a,e},i.transformQuat=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=n[0],s=n[1],l=n[2],u=n[3],c=u*r+s*o-l*i,d=u*i+l*r-a*o,f=u*o+a*i-s*r,h=-a*r-s*i-l*o;return e[0]=c*u+h*-a+d*-l-f*-s,e[1]=d*u+h*-s+f*-a-c*-l,e[2]=f*u+h*-l+c*-s-d*-a,e},i.forEach=function(){var e=i.create();return function(t,n,r,i,o,a){var s,l;for(n||(n=4),r||(r=0),l=i?Math.min(i*n+r,t.length):t.length,s=r;s<l;s+=n)e[0]=t[s],e[1]=t[s+1],e[2]=t[s+2],e[3]=t[s+3],o(e,e,a),t[s]=e[0],t[s+1]=e[1],t[s+2]=e[2],t[s+3]=e[3];return t}}(),t["a"]=i},function(e,t,n){"use strict";var r=n(20),i={create:function(){var e=new r["a"](9);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},fromMat4:function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e},clone:function(e){var t=new r["a"](9);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},copy:function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},identity:function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},transpose:function(e,t){if(e===t){var n=t[1],r=t[2],i=t[5];e[1]=t[3],e[2]=t[6],e[3]=n,e[5]=t[7],e[6]=r,e[7]=i}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e},invert:function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],l=t[6],u=t[7],c=t[8],d=c*a-s*u,f=-c*o+s*l,h=u*o-a*l,p=n*d+r*f+i*h;return p?(p=1/p,e[0]=d*p,e[1]=(-c*r+i*u)*p,e[2]=(s*r-i*a)*p,e[3]=f*p,e[4]=(c*n-i*l)*p,e[5]=(-s*n+i*o)*p,e[6]=h*p,e[7]=(-u*n+r*l)*p,e[8]=(a*n-r*o)*p,e):null},adjoint:function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],l=t[6],u=t[7],c=t[8];return e[0]=a*c-s*u,e[1]=i*u-r*c,e[2]=r*s-i*a,e[3]=s*l-o*c,e[4]=n*c-i*l,e[5]=i*o-n*s,e[6]=o*u-a*l,e[7]=r*l-n*u,e[8]=n*a-r*o,e},determinant:function(e){var t=e[0],n=e[1],r=e[2],i=e[3],o=e[4],a=e[5],s=e[6],l=e[7],u=e[8];return t*(u*o-a*l)+n*(-u*i+a*s)+r*(l*i-o*s)},multiply:function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=t[4],l=t[5],u=t[6],c=t[7],d=t[8],f=n[0],h=n[1],p=n[2],m=n[3],v=n[4],g=n[5],y=n[6],_=n[7],x=n[8];return e[0]=f*r+h*a+p*u,e[1]=f*i+h*s+p*c,e[2]=f*o+h*l+p*d,e[3]=m*r+v*a+g*u,e[4]=m*i+v*s+g*c,e[5]=m*o+v*l+g*d,e[6]=y*r+_*a+x*u,e[7]=y*i+_*s+x*c,e[8]=y*o+_*l+x*d,e}};i.mul=i.multiply,i.translate=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=t[4],l=t[5],u=t[6],c=t[7],d=t[8],f=n[0],h=n[1];return e[0]=r,e[1]=i,e[2]=o,e[3]=a,e[4]=s,e[5]=l,e[6]=f*r+h*a+u,e[7]=f*i+h*s+c,e[8]=f*o+h*l+d,e},i.rotate=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=t[4],l=t[5],u=t[6],c=t[7],d=t[8],f=Math.sin(n),h=Math.cos(n);return e[0]=h*r+f*a,e[1]=h*i+f*s,e[2]=h*o+f*l,e[3]=h*a-f*r,e[4]=h*s-f*i,e[5]=h*l-f*o,e[6]=u,e[7]=c,e[8]=d,e},i.scale=function(e,t,n){var r=n[0],i=n[1];return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=i*t[3],e[4]=i*t[4],e[5]=i*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},i.fromMat2d=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=0,e[3]=t[2],e[4]=t[3],e[5]=0,e[6]=t[4],e[7]=t[5],e[8]=1,e},i.fromQuat=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=n+n,s=r+r,l=i+i,u=n*a,c=r*a,d=r*s,f=i*a,h=i*s,p=i*l,m=o*a,v=o*s,g=o*l;return e[0]=1-d-p,e[3]=c-g,e[6]=f+v,e[1]=c+g,e[4]=1-u-p,e[7]=h-m,e[2]=f-v,e[5]=h+m,e[8]=1-u-d,e},i.normalFromMat4=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],l=t[6],u=t[7],c=t[8],d=t[9],f=t[10],h=t[11],p=t[12],m=t[13],v=t[14],g=t[15],y=n*s-r*a,_=n*l-i*a,x=n*u-o*a,b=r*l-i*s,w=r*u-o*s,A=i*u-o*l,T=c*m-d*p,S=c*v-f*p,E=c*g-h*p,C=d*v-f*m,M=d*g-h*m,L=f*g-h*v,N=y*L-_*M+x*C+b*E-w*S+A*T;return N?(N=1/N,e[0]=(s*L-l*M+u*C)*N,e[1]=(l*E-a*L-u*S)*N,e[2]=(a*M-s*E+u*T)*N,e[3]=(i*M-r*L-o*C)*N,e[4]=(n*L-i*E+o*S)*N,e[5]=(r*E-n*M-o*T)*N,e[6]=(m*A-v*w+g*b)*N,e[7]=(v*x-p*A-g*_)*N,e[8]=(p*w-m*x+g*y)*N,e):null},i.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+Math.pow(e[6],2)+Math.pow(e[7],2)+Math.pow(e[8],2))},t["a"]=i},function(e,t,n){"use strict";var r=n(7),i=n(3),o=n(56),a=n(9),s=n(21),l=n(18),u=0,c=r["a"].extend({name:"",position:null,rotation:null,scale:null,worldTransform:null,localTransform:null,autoUpdateLocalTransform:!0,_parent:null,_scene:null,_needsUpdateWorldTransform:!0,_inIterating:!1,__depth:0},(function(){this.name||(this.name=(this.type||"NODE")+"_"+u++),this.position||(this.position=new i["a"]),this.rotation||(this.rotation=new o["a"]),this.scale||(this.scale=new i["a"](1,1,1)),this.worldTransform=new a["a"],this.localTransform=new a["a"],this._children=[]}),{target:null,invisible:!1,isSkinnedMesh:function(){return!1},isRenderable:function(){return!1},setName:function(e){var t=this._scene;if(t){var n=t._nodeRepository;delete n[this.name],n[e]=this}this.name=e},add:function(e){var t=e._parent;if(t!==this){t&&t.remove(e),e._parent=this,this._children.push(e);var n=this._scene;n&&n!==e.scene&&e.traverse(this._addSelfToScene,this),e._needsUpdateWorldTransform=!0}},remove:function(e){var t=this._children,n=t.indexOf(e);n<0||(t.splice(n,1),e._parent=null,this._scene&&e.traverse(this._removeSelfFromScene,this))},removeAll:function(){for(var e=this._children,t=0;t<e.length;t++)e[t]._parent=null,this._scene&&e[t].traverse(this._removeSelfFromScene,this);this._children=[]},getScene:function(){return this._scene},getParent:function(){return this._parent},_removeSelfFromScene:function(e){e._scene.removeFromScene(e),e._scene=null},_addSelfToScene:function(e){this._scene.addToScene(e),e._scene=this._scene},isAncestor:function(e){var t=e._parent;while(t){if(t===this)return!0;t=t._parent}return!1},children:function(){return this._children.slice()},childAt:function(e){return this._children[e]},getChildByName:function(e){for(var t=this._children,n=0;n<t.length;n++)if(t[n].name===e)return t[n]},getDescendantByName:function(e){for(var t=this._children,n=0;n<t.length;n++){var r=t[n];if(r.name===e)return r;var i=r.getDescendantByName(e);if(i)return i}},queryNode:function(e){if(e){for(var t=e.split("/"),n=this,r=0;r<t.length;r++){var i=t[r];if(i){for(var o=!1,a=n._children,s=0;s<a.length;s++){var l=a[s];if(l.name===i){n=l,o=!0;break}}if(!o)return}}return n}},getPath:function(e){if(!this._parent)return"/";var t=this._parent,n=this.name;while(t._parent){if(n=t.name+"/"+n,t._parent==e)break;t=t._parent}return!t._parent&&e?null:n},traverse:function(e,t){e.call(t,this);for(var n=this._children,r=0,i=n.length;r<i;r++)n[r].traverse(e,t)},eachChild:function(e,t){for(var n=this._children,r=0,i=n.length;r<i;r++){var o=n[r];e.call(t,o,r)}},setLocalTransform:function(e){s["a"].copy(this.localTransform.array,e.array),this.decomposeLocalTransform()},decomposeLocalTransform:function(e){var t=e?null:this.scale;this.localTransform.decomposeMatrix(t,this.rotation,this.position)},setWorldTransform:function(e){s["a"].copy(this.worldTransform.array,e.array),this.decomposeWorldTransform()},decomposeWorldTransform:function(){var e=s["a"].create();return function(t){var n=this.localTransform,r=this.worldTransform;this._parent?(s["a"].invert(e,this._parent.worldTransform.array),s["a"].multiply(n.array,e,r.array)):s["a"].copy(n.array,r.array);var i=t?null:this.scale;n.decomposeMatrix(i,this.rotation,this.position)}}(),transformNeedsUpdate:function(){return this.position._dirty||this.rotation._dirty||this.scale._dirty},updateLocalTransform:function(){var e=this.position,t=this.rotation,n=this.scale;if(this.transformNeedsUpdate()){var r=this.localTransform.array;s["a"].fromRotationTranslation(r,t.array,e.array),s["a"].scale(r,r,n.array),t._dirty=!1,n._dirty=!1,e._dirty=!1,this._needsUpdateWorldTransform=!0}},_updateWorldTransformTopDown:function(){var e=this.localTransform.array,t=this.worldTransform.array;this._parent?s["a"].multiplyAffine(t,this._parent.worldTransform.array,e):s["a"].copy(t,e)},updateWorldTransform:function(){var e=this;while(e&&e.getParent()&&e.getParent().transformNeedsUpdate())e=e.getParent();e.update()},update:function(e){this.autoUpdateLocalTransform?this.updateLocalTransform():e=!0,(e||this._needsUpdateWorldTransform)&&(this._updateWorldTransformTopDown(),e=!0,this._needsUpdateWorldTransform=!1);for(var t=this._children,n=0,r=t.length;n<r;n++)t[n].update(e)},getBoundingBox:function(){function e(e){return!e.invisible&&e.geometry}var t=new l["a"],n=new a["a"],r=new a["a"];return function(i,o){return o=o||new l["a"],i=i||e,this._parent?a["a"].invert(r,this._parent.worldTransform):a["a"].identity(r),this.traverse((function(e){e.geometry&&e.geometry.boundingBox&&(t.copy(e.geometry.boundingBox),a["a"].multiply(n,r,e.worldTransform),t.applyTransform(n),o.union(t))}),this,e),o}}(),getWorldPosition:function(e){this.transformNeedsUpdate()&&this.updateWorldTransform();var t=this.worldTransform.array;if(e){var n=e.array;return n[0]=t[12],n[1]=t[13],n[2]=t[14],e}return new i["a"](t[12],t[13],t[14])},clone:function(){var e=new this.constructor,t=this._children;e.setName(this.name),e.position.copy(this.position),e.rotation.copy(this.rotation),e.scale.copy(this.scale);for(var n=0;n<t.length;n++)e.add(t[n].clone());return e},rotateAround:function(){var e=new i["a"],t=new a["a"];return function(n,r,i){e.copy(this.position).subtract(n);var o=this.localTransform;o.identity(),o.translate(n),o.rotate(i,r),t.fromRotationTranslation(this.rotation,e),o.multiply(t),o.scale(this.scale),this.decomposeLocalTransform(),this._needsUpdateWorldTransform=!0}}(),lookAt:function(){var e=new a["a"];return function(t,n){e.lookAt(this.position,t,n||this.localTransform.y).invert(),this.setLocalTransform(e),this.target=t}}()});t["a"]=c},function(e,t,n){"use strict";var r=n(35),i=n(24),o=n(58),a=n(18),s=n(23),l=n(21),u=n(69),c=n(9),d=l["a"].create(),f=l["a"].create(),h={};function p(e){var t=[],n=Object.keys(e);n.sort();for(var r=0;r<n.length;r++){var i=n[r];t.push(i+" "+e[i])}var o=t.join("\n");if(h[o])return h[o];var a=s["a"].genGUID();return h[o]=a,a}function m(){this.opaque=[],this.transparent=[],this._opaqueCount=0,this._transparentCount=0}m.prototype.startCount=function(){this._opaqueCount=0,this._transparentCount=0},m.prototype.add=function(e,t){t?this.transparent[this._transparentCount++]=e:this.opaque[this._opaqueCount++]=e},m.prototype.endCount=function(){this.transparent.length=this._transparentCount,this.opaque.length=this._opaqueCount};var v=r["a"].extend((function(){return{material:null,lights:[],viewBoundingBoxLastFrame:new a["a"],shadowUniforms:{},_cameraList:[],_lightUniforms:{},_previousLightNumber:{},_lightNumber:{},_lightProgramKeys:{},_nodeRepository:{},_renderLists:new u["a"](20)}}),(function(){this._scene=this}),{addToScene:function(e){e instanceof o["a"]?(this._cameraList.length>0&&console.warn("Found multiple camera in one scene. Use the fist one."),this._cameraList.push(e)):e instanceof i["a"]&&this.lights.push(e),e.name&&(this._nodeRepository[e.name]=e)},removeFromScene:function(e){var t;e instanceof o["a"]?(t=this._cameraList.indexOf(e),t>=0&&this._cameraList.splice(t,1)):e instanceof i["a"]&&(t=this.lights.indexOf(e),t>=0&&this.lights.splice(t,1)),e.name&&delete this._nodeRepository[e.name]},getNode:function(e){return this._nodeRepository[e]},setMainCamera:function(e){var t=this._cameraList.indexOf(e);t>=0&&this._cameraList.splice(t,1),this._cameraList.unshift(e)},getMainCamera:function(){return this._cameraList[0]},getLights:function(){return this.lights},updateLights:function(){var e=this.lights;this._previousLightNumber=this._lightNumber;for(var t={},n=0;n<e.length;n++){var r=e[n];if(!r.invisible){var i=r.group;t[i]||(t[i]={}),t[i][r.type]=t[i][r.type]||0,t[i][r.type]++}}for(var o in this._lightNumber=t,t)this._lightProgramKeys[o]=p(t[o]);this._updateLightUniforms()},cloneNode:function(e){var t=e.clone(),n={};function r(e,t){n[e.__uid__]=t;for(var i=0;i<e._children.length;i++){var o=e._children[i],a=t._children[i];r(o,a)}}return r(e,t),t.traverse((function(e){e.skeleton&&(e.skeleton=e.skeleton.clone(n)),e.material&&(e.material=e.material.clone())})),t},updateRenderList:function(e,t){var n=e.__uid__,r=this._renderLists.get(n);r||(r=new m,this._renderLists.put(n,r)),r.startCount(),t&&(this.viewBoundingBoxLastFrame.min.set(1/0,1/0,1/0),this.viewBoundingBoxLastFrame.max.set(-1/0,-1/0,-1/0));var i=this.material&&this.material.transparent||!1;return this._doUpdateRenderList(this,e,i,r,t),r.endCount(),r},getRenderList:function(e){return this._renderLists.get(e.__uid__)},_doUpdateRenderList:function(e,t,n,r,i){if(!e.invisible)for(var o=0;o<e._children.length;o++){var a=e._children[o];if(a.isRenderable()){var s=a.isSkinnedMesh()?d:a.worldTransform.array,u=a.geometry;l["a"].multiplyAffine(f,t.viewMatrix.array,s),(i&&!u.boundingBox||!this.isFrustumCulled(a,t,f))&&r.add(a,a.material.transparent||n)}a._children.length>0&&this._doUpdateRenderList(a,t,n,r,i)}},isFrustumCulled:function(){var e=new a["a"],t=new c["a"];return function(n,r,i){var o=n.boundingBox;if(o||(o=n.skeleton&&n.skeleton.boundingBox?n.skeleton.boundingBox:n.geometry.boundingBox),!o)return!1;if(t.array=i,e.transformFrom(o,t),n.castShadow&&this.viewBoundingBoxLastFrame.union(e),n.frustumCulling){if(!e.intersectBoundingBox(r.frustum.boundingBox))return!0;t.array=r.projectionMatrix.array,e.max.array[2]>0&&e.min.array[2]<0&&(e.max.array[2]=-1e-20),e.applyProjection(t);var a=e.min.array,s=e.max.array;if(s[0]<-1||a[0]>1||s[1]<-1||a[1]>1||s[2]<-1||a[2]>1)return!0}return!1}}(),_updateLightUniforms:function(){var e=this.lights;e.sort(g);var t=this._lightUniforms;for(var n in t)for(var r in t[n])t[n][r].value.length=0;for(var i=0;i<e.length;i++){var o=e[i];if(!o.invisible){n=o.group;for(var r in o.uniformTemplates){var a=o.uniformTemplates[r],s=a.value(o);if(null!=s){t[n]||(t[n]={}),t[n][r]||(t[n][r]={type:"",value:[]});var l=t[n][r];switch(l.type=a.type+"v",a.type){case"1i":case"1f":case"t":l.value.push(s);break;case"2f":case"3f":case"4f":for(var u=0;u<s.length;u++)l.value.push(s[u]);break;default:console.error("Unkown light uniform type "+a.type)}}}}}},getLightGroups:function(){var e=[];for(var t in this._lightNumber)e.push(t);return e},getNumberChangedLightGroups:function(){var e=[];for(var t in this._lightNumber)this.isLightNumberChanged(t)&&e.push(t);return e},isLightNumberChanged:function(e){var t=this._previousLightNumber,n=this._lightNumber;for(var r in n[e]){if(!t[e])return!0;if(n[e][r]!==t[e][r])return!0}for(var r in t[e]){if(!n[e])return!0;if(n[e][r]!==t[e][r])return!0}return!1},getLightsNumbers:function(e){return this._lightNumber[e]},getProgramKey:function(e){return this._lightProgramKeys[e]},setLightUniforms:function(){function e(e,t,n){for(var r in e){var i=e[r];if("tv"===i.type){if(!t.hasUniform(r))continue;for(var o=[],a=0;a<i.value.length;a++){var s=i.value[a],l=t.takeCurrentTextureSlot(n,s);o.push(l)}t.setUniform(n.gl,"1iv",r,o)}else t.setUniform(n.gl,i.type,r,i.value)}}return function(t,n,r){e(this._lightUniforms[n],t,r),e(this.shadowUniforms,t,r)}}(),dispose:function(){this.material=null,this._opaqueList=[],this._transparentList=[],this.lights=[],this._lightUniforms={},this._lightNumber={},this._nodeRepository={}}});function g(e,t){if(t.castShadow&&!e.castShadow)return!0}t["a"]=v},function(e,t,n){"use strict";var r=n(58),i=r["a"].extend({left:-1,right:1,near:-1,far:1,top:1,bottom:-1},{updateProjectionMatrix:function(){this.projectionMatrix.ortho(this.left,this.right,this.bottom,this.top,this.near,this.far)},decomposeProjectionMatrix:function(){var e=this.projectionMatrix.array;this.left=(-1-e[12])/e[0],this.right=(1-e[12])/e[0],this.top=(1-e[13])/e[5],this.bottom=(-1-e[13])/e[5],this.near=-(-1-e[14])/e[10],this.far=-(1-e[14])/e[10]},clone:function(){var e=r["a"].prototype.clone.call(this);return e.left=this.left,e.right=this.right,e.near=this.near,e.far=this.far,e.top=this.top,e.bottom=this.bottom,e}});t["a"]=i},function(e,t,n){"use strict";t["a"]={convertToDynamicArray:function(e){e&&this.resetOffset();var t=this.attributes;for(var n in t)e||!t[n].value?t[n].value=[]:t[n].value=Array.prototype.slice.call(t[n].value);e||!this.indices?this.indices=[]:this.indices=Array.prototype.slice.call(this.indices)},convertToTypedArray:function(){var e=this.attributes;for(var t in e)e[t].value&&e[t].value.length>0?e[t].value=new Float32Array(e[t].value):e[t].value=null;this.indices&&this.indices.length>0&&(this.indices=this.vertexCount>65535?new Uint32Array(this.indices):new Uint16Array(this.indices)),this.dirty()}}},function(e,t,n){"use strict";var r=n(0),i=n.n(r);function o(e,t){var n=[];return i.a.util.each(e.dimensions,(function(r){var i=e.getDimensionInfo(r),o=i.otherDims,a=o[t];null!=a&&!1!==a&&(n[a]=i.name)})),n}t["a"]=function(e,t,n){function r(e){var r=!0,s=[],l=o(a,"tooltip");function u(e,t){var o=a.getDimensionInfo(t);if(o&&!1!==o.otherDims.tooltip){var l=o.type,u=(r?"- "+(o.tooltipName||o.name)+": ":"")+("ordinal"===l?e+"":"time"===l?n?"":i.a.format.formatTime("yyyy/MM/dd hh:mm:ss",e):i.a.format.addCommas(e));u&&s.push(i.a.format.encodeHTML(u))}}return l.length?i.a.util.each(l,(function(e){u(a.get(e,t),e)})):i.a.util.each(e,u),(r?"<br/>":"")+s.join(r?"<br/>":", ")}var a=e.getData(),s=e.getRawValue(t),l=i.a.util.isArray(s)?r(s):i.a.format.encodeHTML(i.a.format.addCommas(s)),u=a.getName(t),c=a.getItemVisual(t,"color");i.a.util.isObject(c)&&c.colorStops&&(c=(c.colorStops[0]||{}).color),c=c||"transparent";var d=i.a.format.getTooltipMarker(c),f=e.name;return"\0-"===f&&(f=""),f=f?i.a.format.encodeHTML(f)+(n?": ":"<br/>"):"",n?d+f+l:f+d+(u?i.a.format.encodeHTML(u)+": "+l:l)}},function(e,t,n){"use strict";var r=n(72),i=n(11),o=r["a"].extend({skeleton:null,joints:null,useSkinMatricesTexture:!1},(function(){this.joints||(this.joints=[])}),{isSkinnedMesh:function(){return!!(this.skeleton&&this.joints&&this.joints.length>0)},clone:function(){var e=r["a"].prototype.clone.call(this);return e.skeleton=this.skeleton,this.joints&&(e.joints=this.joints.slice()),e}});o.POINTS=i["a"].POINTS,o.LINES=i["a"].LINES,o.LINE_LOOP=i["a"].LINE_LOOP,o.LINE_STRIP=i["a"].LINE_STRIP,o.TRIANGLES=i["a"].TRIANGLES,o.TRIANGLE_STRIP=i["a"].TRIANGLE_STRIP,o.TRIANGLE_FAN=i["a"].TRIANGLE_FAN,o.BACK=i["a"].BACK,o.FRONT=i["a"].FRONT,o.FRONT_AND_BACK=i["a"].FRONT_AND_BACK,o.CW=i["a"].CW,o.CCW=i["a"].CCW,t["a"]=o},function(e,t,n){"use strict";var r=n(58),i=r["a"].extend({fov:50,aspect:1,near:.1,far:2e3},{updateProjectionMatrix:function(){var e=this.fov/180*Math.PI;this.projectionMatrix.perspective(e,this.aspect,this.near,this.far)},decomposeProjectionMatrix:function(){var e=this.projectionMatrix.array,t=2*Math.atan(1/e[5]);this.fov=t/Math.PI*180,this.aspect=e[5]/e[0],this.near=e[14]/(e[10]-1),this.far=e[14]/(e[10]+1)},clone:function(){var e=r["a"].prototype.clone.call(this);return e.fov=this.fov,e.aspect=this.aspect,e.near=this.near,e.far=this.far,e}});t["a"]=i},function(e,t,n){"use strict";var r=n(40),i=n(76),o=n(8),a=n(19),s=n(4),l=n(121);o["a"].import(l["a"]);var u=r["a"].extend((function(){var e=new o["a"]({vertex:o["a"].source("clay.skybox.vertex"),fragment:o["a"].source("clay.skybox.fragment")}),t=new a["a"]({shader:e,depthMask:!1});return{scene:null,geometry:new i["a"],material:t,environmentMap:null,culling:!1}}),(function(){var e=this.scene;e&&this.attachScene(e),this.environmentMap&&this.setEnvironmentMap(this.environmentMap)}),{attachScene:function(e){this.scene&&this.detachScene(),e.skybox=this,this.scene=e,e.on("beforerender",this._beforeRenderScene,this)},detachScene:function(){this.scene&&(this.scene.off("beforerender",this._beforeRenderScene),this.scene.skybox=null),this.scene=null},dispose:function(e){this.detachScene(),this.geometry.dispose(e)},setEnvironmentMap:function(e){"texture2D"===e.textureType?(this.material.define("EQUIRECTANGULAR"),e.minFilter=s["a"].LINEAR):this.material.undefine("EQUIRECTANGULAR"),this.material.set("environmentMap",e)},getEnvironmentMap:function(){return this.material.get("environmentMap")},_beforeRenderScene:function(e,t,n){this.renderSkybox(e,n)},renderSkybox:function(e,t){this.position.copy(t.getWorldPosition()),this.update(),e.gl.disable(e.gl.BLEND),this.material.get("lod")>0?this.material.define("fragment","LOD"):this.material.undefine("fragment","LOD"),e.renderPass([this],t)}});t["a"]=u},function(e,t,n){"use strict";var r=n(15),i=n(18),o=r["a"].extend({dynamic:!1,widthSegments:1,heightSegments:1},(function(){this.build()}),{build:function(){for(var e=this.heightSegments,t=this.widthSegments,n=this.attributes,r=[],o=[],a=[],s=[],l=0;l<=e;l++)for(var u=l/e,c=0;c<=t;c++){var d=c/t;if(r.push([2*d-1,2*u-1,0]),o&&o.push([d,u]),a&&a.push([0,0,1]),c<t&&l<e){var f=c+l*(t+1);s.push([f,f+1,f+t+1]),s.push([f+t+1,f+1,f+t+2])}}n.position.fromArray(r),n.texcoord0.fromArray(o),n.normal.fromArray(a),this.initIndicesFromArray(s),this.boundingBox=new i["a"],this.boundingBox.min.set(-1,-1,0),this.boundingBox.max.set(1,1,0)}});t["a"]=o},function(e,t,n){"use strict";t["a"]={defaultOption:{viewControl:{projection:"perspective",autoRotate:!1,autoRotateDirection:"cw",autoRotateSpeed:10,autoRotateAfterStill:3,damping:.8,rotateSensitivity:1,zoomSensitivity:1,panSensitivity:1,panMouseButton:"middle",rotateMouseButton:"left",distance:150,minDistance:40,maxDistance:400,orthographicSize:150,maxOrthographicSize:400,minOrthographicSize:20,center:[0,0,0],alpha:0,beta:0,minAlpha:-90,maxAlpha:90}},setView:function(e){e=e||{},this.option.viewControl=this.option.viewControl||{},null!=e.alpha&&(this.option.viewControl.alpha=e.alpha),null!=e.beta&&(this.option.viewControl.beta=e.beta),null!=e.distance&&(this.option.viewControl.distance=e.distance),null!=e.center&&(this.option.viewControl.center=e.center)}}},function(e,t,n){"use strict";var r=n(7),i=n(26),o=n(3),a=(n(56),n(2)),s=a["a"].firstNotNull,l={left:0,middle:1,right:2};function u(e){return e instanceof Array||(e=[e,e]),e}var c=r["a"].extend((function(){return{zr:null,viewGL:null,_center:new o["a"],minDistance:.5,maxDistance:1.5,maxOrthographicSize:300,minOrthographicSize:30,minAlpha:-90,maxAlpha:90,minBeta:-1/0,maxBeta:1/0,autoRotateAfterStill:0,autoRotateDirection:"cw",autoRotateSpeed:60,damping:.8,rotateSensitivity:1,zoomSensitivity:1,panSensitivity:1,panMouseButton:"middle",rotateMouseButton:"left",_mode:"rotate",_camera:null,_needsUpdate:!1,_rotating:!1,_phi:0,_theta:0,_mouseX:0,_mouseY:0,_rotateVelocity:new i["a"],_panVelocity:new i["a"],_distance:500,_zoomSpeed:0,_stillTimeout:0,_animators:[]}}),(function(){["_mouseDownHandler","_mouseWheelHandler","_mouseMoveHandler","_mouseUpHandler","_pinchHandler","_contextMenuHandler","_update"].forEach((function(e){this[e]=this[e].bind(this)}),this)}),{init:function(){var e=this.zr;e&&(e.on("mousedown",this._mouseDownHandler),e.on("globalout",this._mouseUpHandler),e.on("mousewheel",this._mouseWheelHandler),e.on("pinch",this._pinchHandler),e.animation.on("frame",this._update),e.dom.addEventListener("contextmenu",this._contextMenuHandler))},dispose:function(){var e=this.zr;e&&(e.off("mousedown",this._mouseDownHandler),e.off("mousemove",this._mouseMoveHandler),e.off("mouseup",this._mouseUpHandler),e.off("mousewheel",this._mouseWheelHandler),e.off("pinch",this._pinchHandler),e.off("globalout",this._mouseUpHandler),e.dom.removeEventListener("contextmenu",this._contextMenuHandler),e.animation.off("frame",this._update)),this.stopAllAnimation()},getDistance:function(){return this._distance},setDistance:function(e){this._distance=e,this._needsUpdate=!0},getOrthographicSize:function(){return this._orthoSize},setOrthographicSize:function(e){this._orthoSize=e,this._needsUpdate=!0},getAlpha:function(){return this._theta/Math.PI*180},getBeta:function(){return-this._phi/Math.PI*180},getCenter:function(){return this._center.toArray()},setAlpha:function(e){e=Math.max(Math.min(this.maxAlpha,e),this.minAlpha),this._theta=e/180*Math.PI,this._needsUpdate=!0},setBeta:function(e){e=Math.max(Math.min(this.maxBeta,e),this.minBeta),this._phi=-e/180*Math.PI,this._needsUpdate=!0},setCenter:function(e){this._center.setArray(e)},setViewGL:function(e){this.viewGL=e},getCamera:function(){return this.viewGL.camera},setFromViewControlModel:function(e,t){t=t||{};var n=t.baseDistance||0,r=t.baseOrthoSize||1,i=e.get("projection");"perspective"!==i&&"orthographic"!==i&&"isometric"!==i&&(console.error("Unkown projection type %s, use perspective projection instead.",i),i="perspective"),this._projection=i,this.viewGL.setProjection(i);var o=e.get("distance")+n,a=e.get("orthographicSize")+r;[["damping",.8],["autoRotate",!1],["autoRotateAfterStill",3],["autoRotateDirection","cw"],["autoRotateSpeed",10],["minDistance",30],["maxDistance",400],["minOrthographicSize",30],["maxOrthographicSize",300],["minAlpha",-90],["maxAlpha",90],["minBeta",-1/0],["maxBeta",1/0],["rotateSensitivity",1],["zoomSensitivity",1],["panSensitivity",1],["panMouseButton","left"],["rotateMouseButton","middle"]].forEach((function(t){this[t[0]]=s(e.get(t[0]),t[1])}),this),this.minDistance+=n,this.maxDistance+=n,this.minOrthographicSize+=r,this.maxOrthographicSize+=r;var l=e.ecModel,u={};["animation","animationDurationUpdate","animationEasingUpdate"].forEach((function(t){u[t]=s(e.get(t),l&&l.get(t))}));var c=s(t.alpha,e.get("alpha"))||0,d=s(t.beta,e.get("beta"))||0,f=s(t.center,e.get("center"))||[0,0,0];u.animation&&u.animationDurationUpdate>0&&this._notFirst?this.animateTo({alpha:c,beta:d,center:f,distance:o,targetOrthographicSize:a,easing:u.animationEasingUpdate,duration:u.animationDurationUpdate}):(this.setDistance(o),this.setAlpha(c),this.setBeta(d),this.setCenter(f),this.setOrthographicSize(a)),this._notFirst=!0,this._validateProperties()},_validateProperties:function(){null==l[this.panMouseButton]&&console.error("Unkown panMouseButton %s. It should be left|middle|right",this.panMouseButton),null==l[this.rotateMouseButton]&&console.error("Unkown rotateMouseButton %s. It should be left|middle|right",this.rotateMouseButton),"cw"!==this.autoRotateDirection&&"ccw"!==this.autoRotateDirection&&console.error("Unkown autoRotateDirection %s. It should be cw|ccw",this.autoRotateDirection)},animateTo:function(e){var t=this.zr,n=this,r={},i={};return null!=e.distance&&(r.distance=this.getDistance(),i.distance=e.distance),null!=e.orthographicSize&&(r.orthographicSize=this.getOrthographicSize(),i.orthographicSize=e.orthographicSize),null!=e.alpha&&(r.alpha=this.getAlpha(),i.alpha=e.alpha),null!=e.beta&&(r.beta=this.getBeta(),i.beta=e.beta),null!=e.center&&(r.center=this.getCenter(),i.center=e.center),this._addAnimator(t.animation.animate(r).when(e.duration||1e3,i).during((function(){null!=r.alpha&&n.setAlpha(r.alpha),null!=r.beta&&n.setBeta(r.beta),null!=r.distance&&n.setDistance(r.distance),null!=r.center&&n.setCenter(r.center),null!=r.orthographicSize&&n.setOrthographicSize(r.orthographicSize),n._needsUpdate=!0}))).start(e.easing||"linear")},stopAllAnimation:function(){for(var e=0;e<this._animators.length;e++)this._animators[e].stop();this._animators.length=0},update:function(){this._needsUpdate=!0,this._update(20)},_isAnimating:function(){return this._animators.length>0},_update:function(e){if(this._rotating){var t=("cw"===this.autoRotateDirection?1:-1)*this.autoRotateSpeed/180*Math.PI;this._phi-=t*e/1e3,this._needsUpdate=!0}else this._rotateVelocity.len()>0&&(this._needsUpdate=!0);(Math.abs(this._zoomSpeed)>.1||this._panVelocity.len()>0)&&(this._needsUpdate=!0),this._needsUpdate&&(e=Math.min(e,50),this._updateDistanceOrSize(e),this._updatePan(e),this._updateRotate(e),this._updateTransform(),this.getCamera().update(),this.zr&&this.zr.refresh(),this.trigger("update"),this._needsUpdate=!1)},_updateRotate:function(e){var t=this._rotateVelocity;this._phi=t.y*e/20+this._phi,this._theta=t.x*e/20+this._theta,this.setAlpha(this.getAlpha()),this.setBeta(this.getBeta()),this._vectorDamping(t,Math.pow(this.damping,e/16))},_updateDistanceOrSize:function(e){"perspective"===this._projection?this._setDistance(this._distance+this._zoomSpeed*e/20):this._setOrthoSize(this._orthoSize+this._zoomSpeed*e/20),this._zoomSpeed*=Math.pow(this.damping,e/16)},_setDistance:function(e){this._distance=Math.max(Math.min(e,this.maxDistance),this.minDistance)},_setOrthoSize:function(e){this._orthoSize=Math.max(Math.min(e,this.maxOrthographicSize),this.minOrthographicSize);var t=this.getCamera(),n=this._orthoSize,r=n/this.viewGL.viewport.height*this.viewGL.viewport.width;t.left=-r/2,t.right=r/2,t.top=n/2,t.bottom=-n/2},_updatePan:function(e){var t=this._panVelocity,n=this._distance,r=this.getCamera(),i=r.worldTransform.y,o=r.worldTransform.x;this._center.scaleAndAdd(o,-t.x*n/200).scaleAndAdd(i,-t.y*n/200),this._vectorDamping(t,0)},_updateTransform:function(){var e=this.getCamera(),t=new o["a"],n=this._theta+Math.PI/2,r=this._phi+Math.PI/2,i=Math.sin(n);t.x=i*Math.cos(r),t.y=-Math.cos(n),t.z=i*Math.sin(r),e.position.copy(this._center).scaleAndAdd(t,this._distance),e.rotation.identity().rotateY(-this._phi).rotateX(-this._theta)},_startCountingStill:function(){clearTimeout(this._stillTimeout);var e=this.autoRotateAfterStill,t=this;!isNaN(e)&&e>0&&(this._stillTimeout=setTimeout((function(){t._rotating=!0}),1e3*e))},_vectorDamping:function(e,t){var n=e.len();n*=t,n<1e-4&&(n=0),e.normalize().scale(n)},_decomposeTransform:function(){if(this.getCamera()){this.getCamera().updateWorldTransform();var e=this.getCamera().worldTransform.z,t=Math.asin(e.y),n=Math.atan2(e.x,e.z);this._theta=t,this._phi=-n,this.setBeta(this.getBeta()),this.setAlpha(this.getAlpha()),this.getCamera().aspect?this._setDistance(this.getCamera().position.dist(this._center)):this._setOrthoSize(this.getCamera().top-this.getCamera().bottom)}},_mouseDownHandler:function(e){if(!e.target&&!this._isAnimating()){var t=e.offsetX,n=e.offsetY;this.viewGL&&!this.viewGL.containPoint(t,n)||(this.zr.on("mousemove",this._mouseMoveHandler),this.zr.on("mouseup",this._mouseUpHandler),e.event.targetTouches?1===e.event.targetTouches.length&&(this._mode="rotate"):e.event.button===l[this.rotateMouseButton]?this._mode="rotate":e.event.button===l[this.panMouseButton]?this._mode="pan":this._mode="",this._rotateVelocity.set(0,0),this._rotating=!1,this.autoRotate&&this._startCountingStill(),this._mouseX=e.offsetX,this._mouseY=e.offsetY)}},_mouseMoveHandler:function(e){if((!e.target||!e.target.__isGLToZRProxy)&&!this._isAnimating()){var t=u(this.panSensitivity),n=u(this.rotateSensitivity);"rotate"===this._mode?(this._rotateVelocity.y=(e.offsetX-this._mouseX)/this.zr.getHeight()*2*n[0],this._rotateVelocity.x=(e.offsetY-this._mouseY)/this.zr.getWidth()*2*n[1]):"pan"===this._mode&&(this._panVelocity.x=(e.offsetX-this._mouseX)/this.zr.getWidth()*t[0]*400,this._panVelocity.y=(-e.offsetY+this._mouseY)/this.zr.getHeight()*t[1]*400),this._mouseX=e.offsetX,this._mouseY=e.offsetY,e.event.preventDefault()}},_mouseWheelHandler:function(e){if(!this._isAnimating()){var t=e.event.wheelDelta||-e.event.detail;this._zoomHandler(e,t)}},_pinchHandler:function(e){this._isAnimating()||(this._zoomHandler(e,e.pinchScale>1?1:-1),this._mode="")},_zoomHandler:function(e,t){if(0!==t){var n,r=e.offsetX,i=e.offsetY;if(!this.viewGL||this.viewGL.containPoint(r,i))n="perspective"===this._projection?Math.max(Math.max(Math.min(this._distance-this.minDistance,this.maxDistance-this._distance))/20,.5):Math.max(Math.max(Math.min(this._orthoSize-this.minOrthographicSize,this.maxOrthographicSize-this._orthoSize))/20,.5),this._zoomSpeed=(t>0?-1:1)*n*this.zoomSensitivity,this._rotating=!1,this.autoRotate&&"rotate"===this._mode&&this._startCountingStill(),e.event.preventDefault()}},_mouseUpHandler:function(){this.zr.off("mousemove",this._mouseMoveHandler),this.zr.off("mouseup",this._mouseUpHandler)},_isRightMouseButtonUsed:function(){return"right"===this.rotateMouseButton||"right"===this.panMouseButton},_contextMenuHandler:function(e){this._isRightMouseButtonUsed()&&e.preventDefault()},_addAnimator:function(e){var t=this._animators;return t.push(e),e.done((function(){var n=t.indexOf(e);n>=0&&t.splice(n,1)})),e}});Object.defineProperty(c.prototype,"autoRotate",{get:function(e){return this._autoRotate},set:function(e){this._autoRotate=e,this._rotating=e}}),t["a"]=c},function(e,t,n){"use strict";t["a"]="@export ecgl.lines3D.vertex\n\nuniform mat4 worldViewProjection : WORLDVIEWPROJECTION;\n\nattribute vec3 position: POSITION;\nattribute vec4 a_Color : COLOR;\nvarying vec4 v_Color;\n\nvoid main()\n{\n gl_Position = worldViewProjection * vec4(position, 1.0);\n v_Color = a_Color;\n}\n\n@end\n\n@export ecgl.lines3D.fragment\n\nuniform vec4 color : [1.0, 1.0, 1.0, 1.0];\n\nvarying vec4 v_Color;\n\n@import clay.util.srgb\n\nvoid main()\n{\n#ifdef SRGB_DECODE\n gl_FragColor = sRGBToLinear(color * v_Color);\n#else\n gl_FragColor = color * v_Color;\n#endif\n}\n@end\n\n\n\n@export ecgl.lines3D.clipNear\n\nvec4 clipNear(vec4 p1, vec4 p2) {\n float n = (p1.w - near) / (p1.w - p2.w);\n return vec4(mix(p1.xy, p2.xy, n), -near, near);\n}\n\n@end\n\n@export ecgl.lines3D.expandLine\n#ifdef VERTEX_ANIMATION\n vec4 prevProj = worldViewProjection * vec4(mix(prevPositionPrev, positionPrev, percent), 1.0);\n vec4 currProj = worldViewProjection * vec4(mix(prevPosition, position, percent), 1.0);\n vec4 nextProj = worldViewProjection * vec4(mix(prevPositionNext, positionNext, percent), 1.0);\n#else\n vec4 prevProj = worldViewProjection * vec4(positionPrev, 1.0);\n vec4 currProj = worldViewProjection * vec4(position, 1.0);\n vec4 nextProj = worldViewProjection * vec4(positionNext, 1.0);\n#endif\n\n if (currProj.w < 0.0) {\n if (nextProj.w > 0.0) {\n currProj = clipNear(currProj, nextProj);\n }\n else if (prevProj.w > 0.0) {\n currProj = clipNear(currProj, prevProj);\n }\n }\n\n vec2 prevScreen = (prevProj.xy / abs(prevProj.w) + 1.0) * 0.5 * viewport.zw;\n vec2 currScreen = (currProj.xy / abs(currProj.w) + 1.0) * 0.5 * viewport.zw;\n vec2 nextScreen = (nextProj.xy / abs(nextProj.w) + 1.0) * 0.5 * viewport.zw;\n\n vec2 dir;\n float len = offset;\n if (position == positionPrev) {\n dir = normalize(nextScreen - currScreen);\n }\n else if (position == positionNext) {\n dir = normalize(currScreen - prevScreen);\n }\n else {\n vec2 dirA = normalize(currScreen - prevScreen);\n vec2 dirB = normalize(nextScreen - currScreen);\n\n vec2 tanget = normalize(dirA + dirB);\n\n float miter = 1.0 / max(dot(tanget, dirA), 0.5);\n len *= miter;\n dir = tanget;\n }\n\n dir = vec2(-dir.y, dir.x) * len;\n currScreen += dir;\n\n currProj.xy = (currScreen / viewport.zw - 0.5) * 2.0 * abs(currProj.w);\n@end\n\n\n@export ecgl.meshLines3D.vertex\n\nattribute vec3 position: POSITION;\nattribute vec3 positionPrev;\nattribute vec3 positionNext;\nattribute float offset;\nattribute vec4 a_Color : COLOR;\n\n#ifdef VERTEX_ANIMATION\nattribute vec3 prevPosition;\nattribute vec3 prevPositionPrev;\nattribute vec3 prevPositionNext;\nuniform float percent : 1.0;\n#endif\n\nuniform mat4 worldViewProjection : WORLDVIEWPROJECTION;\nuniform vec4 viewport : VIEWPORT;\nuniform float near : NEAR;\n\nvarying vec4 v_Color;\n\n@import ecgl.common.wireframe.vertexHeader\n\n@import ecgl.lines3D.clipNear\n\nvoid main()\n{\n @import ecgl.lines3D.expandLine\n\n gl_Position = currProj;\n\n v_Color = a_Color;\n\n @import ecgl.common.wireframe.vertexMain\n}\n@end\n\n\n@export ecgl.meshLines3D.fragment\n\nuniform vec4 color : [1.0, 1.0, 1.0, 1.0];\n\nvarying vec4 v_Color;\n\n@import ecgl.common.wireframe.fragmentHeader\n\n@import clay.util.srgb\n\nvoid main()\n{\n#ifdef SRGB_DECODE\n gl_FragColor = sRGBToLinear(color * v_Color);\n#else\n gl_FragColor = color * v_Color;\n#endif\n\n @import ecgl.common.wireframe.fragmentMain\n}\n\n@end"},function(e,t,n){var r=n(13),i=n(82),o=n(85),a=o.parsePercent,s=n(171),l=r.each,u=["left","right","top","bottom","width","height"],c=[["width","left","right"],["height","top","bottom"]];function d(e,t,n,r,i){var o=0,a=0;null==r&&(r=1/0),null==i&&(i=1/0);var s=0;t.eachChild((function(l,u){var c,d,f=l.position,h=l.getBoundingRect(),p=t.childAt(u+1),m=p&&p.getBoundingRect();if("horizontal"===e){var v=h.width+(m?-m.x+h.x:0);c=o+v,c>r||l.newline?(o=0,c=v,a+=s+n,s=h.height):s=Math.max(s,h.height)}else{var g=h.height+(m?-m.y+h.y:0);d=a+g,d>i||l.newline?(o+=s+n,a=0,d=g,s=h.width):s=Math.max(s,h.width)}l.newline||(f[0]=o,f[1]=a,"horizontal"===e?o=c+n:a=d+n)}))}var f=d,h=r.curry(d,"vertical"),p=r.curry(d,"horizontal");function m(e,t,n){var r=t.width,i=t.height,o=a(e.x,r),l=a(e.y,i),u=a(e.x2,r),c=a(e.y2,i);return(isNaN(o)||isNaN(parseFloat(e.x)))&&(o=0),(isNaN(u)||isNaN(parseFloat(e.x2)))&&(u=r),(isNaN(l)||isNaN(parseFloat(e.y)))&&(l=0),(isNaN(c)||isNaN(parseFloat(e.y2)))&&(c=i),n=s.normalizeCssArray(n||0),{width:Math.max(u-o-n[1]-n[3],0),height:Math.max(c-l-n[0]-n[2],0)}}function v(e,t,n){n=s.normalizeCssArray(n||0);var r=t.width,o=t.height,l=a(e.left,r),u=a(e.top,o),c=a(e.right,r),d=a(e.bottom,o),f=a(e.width,r),h=a(e.height,o),p=n[2]+n[0],m=n[1]+n[3],v=e.aspect;switch(isNaN(f)&&(f=r-c-m-l),isNaN(h)&&(h=o-d-p-u),null!=v&&(isNaN(f)&&isNaN(h)&&(v>r/o?f=.8*r:h=.8*o),isNaN(f)&&(f=v*h),isNaN(h)&&(h=f/v)),isNaN(l)&&(l=r-c-f-m),isNaN(u)&&(u=o-d-h-p),e.left||e.right){case"center":l=r/2-f/2-n[3];break;case"right":l=r-f-m;break}switch(e.top||e.bottom){case"middle":case"center":u=o/2-h/2-n[0];break;case"bottom":u=o-h-p;break}l=l||0,u=u||0,isNaN(f)&&(f=r-m-l-(c||0)),isNaN(h)&&(h=o-p-u-(d||0));var g=new i(l+n[3],u+n[0],f,h);return g.margin=n,g}function g(e,t,n,o,a){var s=!a||!a.hv||a.hv[0],l=!a||!a.hv||a.hv[1],u=a&&a.boundingMode||"all";if(s||l){var c;if("raw"===u)c="group"===e.type?new i(0,0,+t.width||0,+t.height||0):e.getBoundingRect();else if(c=e.getBoundingRect(),e.needLocalTransform()){var d=e.getLocalTransform();c=c.clone(),c.applyTransform(d)}t=v(r.defaults({width:c.width,height:c.height},t),n,o);var f=e.position,h=s?t.x-c.x:0,p=l?t.y-c.y:0;e.attr("position","raw"===u?[h,p]:[f[0]+h,f[1]+p])}}function y(e,t){return null!=e[c[t][0]]||null!=e[c[t][1]]&&null!=e[c[t][2]]}function _(e,t,n){!r.isObject(n)&&(n={});var i=n.ignoreSize;!r.isArray(i)&&(i=[i,i]);var o=s(c[0],0),a=s(c[1],1);function s(n,r){var o={},a=0,s={},c=0,f=2;if(l(n,(function(t){s[t]=e[t]})),l(n,(function(e){u(t,e)&&(o[e]=s[e]=t[e]),d(o,e)&&a++,d(s,e)&&c++})),i[r])return d(t,n[1])?s[n[2]]=null:d(t,n[2])&&(s[n[1]]=null),s;if(c!==f&&a){if(a>=f)return o;for(var h=0;h<n.length;h++){var p=n[h];if(!u(o,p)&&u(e,p)){o[p]=e[p];break}}return o}return s}function u(e,t){return e.hasOwnProperty(t)}function d(e,t){return null!=e[t]&&"auto"!==e[t]}function f(e,t,n){l(e,(function(e){t[e]=n[e]}))}f(c[0],e,o),f(c[1],e,a)}function x(e){return b({},e)}function b(e,t){return t&&e&&l(u,(function(n){t.hasOwnProperty(n)&&(e[n]=t[n])})),e}t.LOCATION_PARAMS=u,t.HV_NAMES=c,t.box=f,t.vbox=h,t.hbox=p,t.getAvailableSize=m,t.getLayoutRect=v,t.positionElement=g,t.sizeCalculable=y,t.mergeLayoutParam=_,t.getLayoutParams=x,t.copyLayoutParams=b},function(e,t,n){"use strict";var r=n(7),i=r["a"].extend((function(){return{name:"",inputLinks:{},outputLinks:{},_prevOutputTextures:{},_outputTextures:{},_outputReferences:{},_rendering:!1,_rendered:!1,_compositor:null}}),{updateParameter:function(e,t){var n,r,i=this.outputs[e],o=i.parameters,a=i._parametersCopy;if(a||(a=i._parametersCopy={}),o)for(var s in o)"width"!==s&&"height"!==s&&(a[s]=o[s]);return n=o.width instanceof Function?o.width.call(this,t):o.width,r=o.height instanceof Function?o.height.call(this,t):o.height,a.width===n&&a.height===r||this._outputTextures[e]&&this._outputTextures[e].dispose(t.gl),a.width=n,a.height=r,a},setParameter:function(e,t){},getParameter:function(e){},setParameters:function(e){for(var t in e)this.setParameter(t,e[t])},render:function(){},getOutput:function(e,t){if(null==t)return t=e,this._outputTextures[t];var n=this.outputs[t];return n?this._rendered?n.outputLastFrame?this._prevOutputTextures[t]:this._outputTextures[t]:this._rendering?(this._prevOutputTextures[t]||(this._prevOutputTextures[t]=this._compositor.allocateTexture(n.parameters||{})),this._prevOutputTextures[t]):(this.render(e),this._outputTextures[t]):void 0},removeReference:function(e){if(this._outputReferences[e]--,0===this._outputReferences[e]){var t=this.outputs[e];t.keepLastFrame?(this._prevOutputTextures[e]&&this._compositor.releaseTexture(this._prevOutputTextures[e]),this._prevOutputTextures[e]=this._outputTextures[e]):this._compositor.releaseTexture(this._outputTextures[e])}},link:function(e,t,n){this.inputLinks[e]={node:t,pin:n},t.outputLinks[n]||(t.outputLinks[n]=[]),t.outputLinks[n].push({node:this,pin:e}),this.pass.material.enableTexture(e)},clear:function(){this.inputLinks={},this.outputLinks={}},updateReference:function(e){if(!this._rendering){for(var t in this._rendering=!0,this.inputLinks){var n=this.inputLinks[t];n.node.updateReference(n.pin)}this._rendering=!1}e&&this._outputReferences[e]++},beforeFrame:function(){for(var e in this._rendered=!1,this.outputLinks)this._outputReferences[e]=0},afterFrame:function(){for(var e in this.outputLinks)if(this._outputReferences[e]>0){var t=this.outputs[e];t.keepLastFrame?(this._prevOutputTextures[e]&&this._compositor.releaseTexture(this._prevOutputTextures[e]),this._prevOutputTextures[e]=this._outputTextures[e]):this._compositor.releaseTexture(this._outputTextures[e])}}});t["a"]=i},function(e,t,n){"use strict";function r(e,t){var n=0,r=1/t,i=e;while(i>0)n+=r*(i%t),i=Math.floor(i/t),r/=t;return n}t["a"]=r},function(e,t,n){"use strict";var r=n(0),i=n.n(r);t["a"]=function(e,t,n){n=n||e.getSource();var r=t||i.a.getCoordinateSystemDimensions(e.get("coordinateSystem"))||["x","y","z"],o=i.a.helper.createDimensions(n,{dimensionsDefine:n.dimensionsDefine||e.get("dimensions"),encodeDefine:n.encodeDefine||e.get("encode"),coordDimensions:r.map((function(t){var n=e.getReferringComponents(t+"Axis3D")[0];return{type:n&&"category"===n.get("type")?"ordinal":"float",name:t}}))});"cartesian3D"===e.get("coordinateSystem")&&o.forEach((function(t){if(r.indexOf(t.coordDim)>=0){var n=e.getReferringComponents(t.coordDim+"Axis3D")[0];n&&"category"===n.get("type")&&(t.ordinalMeta=n.getOrdinalMeta())}}));var a=i.a.helper.dataStack.enableDataStack(e,o,{byIndex:!0,stackedCoordDimension:"z"}),s=new i.a.List(o,e);return s.setCalculationInfo(a),s.initData(n),s}},function(e,t){function n(e,t,n){return{seriesType:e,performRawSeries:!0,reset:function(e,r,i){var o=e.getData(),a=e.get("symbol")||t,s=e.get("symbolSize"),l=e.get("symbolKeepAspect");if(o.setVisual({legendSymbol:n||a,symbol:a,symbolSize:s,symbolKeepAspect:l}),!r.isSeriesFiltered(e)){var u="function"===typeof s;return{dataEach:o.hasItemOption||u?c:null}}function c(t,n){if("function"===typeof s){var r=e.getRawValue(n),i=e.getDataParams(n);t.setItemVisual(n,"symbolSize",s(r,i))}if(t.hasItemOption){var o=t.getItemModel(n),a=o.getShallow("symbol",!0),l=o.getShallow("symbolSize",!0),u=o.getShallow("symbolKeepAspect",!0);null!=a&&t.setItemVisual(n,"symbol",a),null!=l&&t.setItemVisual(n,"symbolSize",l),null!=u&&t.setItemVisual(n,"symbolKeepAspect",u)}}}}}e.exports=n},function(e,t,n){"use strict";var r=n(7),i=n(111),o=n(11),a=n(14),s=n(19),l=n(26),u=n(115),c=n(8),d=n(71),f=n(21),h=n(12);c["a"]["import"](d["a"]);var p=f["a"].create,m={};function v(e){return e.material}function g(e,t,n){return t.uniforms[n].value}function y(e,t,n,r){return n!==r}function _(e){return!0}function x(){}var b={float:o["a"].FLOAT,byte:o["a"].BYTE,ubyte:o["a"].UNSIGNED_BYTE,short:o["a"].SHORT,ushort:o["a"].UNSIGNED_SHORT};function w(e,t,n){this.availableAttributes=e,this.availableAttributeSymbols=t,this.indicesBuffer=n,this.vao=null}function A(e){var t,n;this.bind=function(e){t||(t=a["a"].createCanvas(),t.width=t.height=1,t.getContext("2d"));var r=e.gl,i=!n;i&&(n=r.createTexture()),r.bindTexture(r.TEXTURE_2D,n),i&&r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,t)},this.unbind=function(e){e.gl.bindTexture(e.gl.TEXTURE_2D,null)},this.isRenderable=function(){return!0}}var T=r["a"].extend((function(){return{canvas:null,_width:100,_height:100,devicePixelRatio:"undefined"!==typeof window&&window.devicePixelRatio||1,clearColor:[0,0,0,0],clearBit:17664,alpha:!0,depth:!0,stencil:!1,antialias:!0,premultipliedAlpha:!0,preserveDrawingBuffer:!1,throwError:!0,gl:null,viewport:{},__currentFrameBuffer:null,_viewportStack:[],_clearStack:[],_sceneRendering:null}}),(function(){this.canvas||(this.canvas=a["a"].createCanvas());var e=this.canvas;try{var t={alpha:this.alpha,depth:this.depth,stencil:this.stencil,antialias:this.antialias,premultipliedAlpha:this.premultipliedAlpha,preserveDrawingBuffer:this.preserveDrawingBuffer};if(this.gl=e.getContext("webgl",t)||e.getContext("experimental-webgl",t),!this.gl)throw new Error;this._glinfo=new i["a"](this.gl),this.gl.targetRenderer&&console.error("Already created a renderer"),this.gl.targetRenderer=this,this.resize()}catch(n){throw"Error creating WebGL Context "+n}this._programMgr=new u["a"](this),this._placeholderTexture=new A(this)}),{resize:function(e,t){var n=this.canvas,r=this.devicePixelRatio;null!=e?(n.style.width=e+"px",n.style.height=t+"px",n.width=e*r,n.height=t*r,this._width=e,this._height=t):(this._width=n.width/r,this._height=n.height/r),this.setViewport(0,0,this._width,this._height)},getWidth:function(){return this._width},getHeight:function(){return this._height},getViewportAspect:function(){var e=this.viewport;return e.width/e.height},setDevicePixelRatio:function(e){this.devicePixelRatio=e,this.resize(this._width,this._height)},getDevicePixelRatio:function(){return this.devicePixelRatio},getGLExtension:function(e){return this._glinfo.getExtension(e)},getGLParameter:function(e){return this._glinfo.getParameter(e)},setViewport:function(e,t,n,r,i){if("object"===typeof e){var o=e;e=o.x,t=o.y,n=o.width,r=o.height,i=o.devicePixelRatio}i=i||this.devicePixelRatio,this.gl.viewport(e*i,t*i,n*i,r*i),this.viewport={x:e,y:t,width:n,height:r,devicePixelRatio:i}},saveViewport:function(){this._viewportStack.push(this.viewport)},restoreViewport:function(){this._viewportStack.length>0&&this.setViewport(this._viewportStack.pop())},saveClear:function(){this._clearStack.push({clearBit:this.clearBit,clearColor:this.clearColor})},restoreClear:function(){if(this._clearStack.length>0){var e=this._clearStack.pop();this.clearColor=e.clearColor,this.clearBit=e.clearBit}},bindSceneRendering:function(e){this._sceneRendering=e},render:function(e,t,n,r){var i=this.gl,o=this.clearColor;if(this.clearBit){i.colorMask(!0,!0,!0,!0),i.depthMask(!0);var a=this.viewport,s=!1,l=a.devicePixelRatio;(a.width!==this._width||a.height!==this._height||l&&l!==this.devicePixelRatio||a.x||a.y)&&(s=!0,i.enable(i.SCISSOR_TEST),i.scissor(a.x*l,a.y*l,a.width*l,a.height*l)),i.clearColor(o[0],o[1],o[2],o[3]),i.clear(this.clearBit),s&&i.disable(i.SCISSOR_TEST)}if(n||e.update(!1),e.updateLights(),t=t||e.getMainCamera(),t){t.update();var u=e.updateRenderList(t,!0);this._sceneRendering=e;var c=u.opaque,d=u.transparent,m=e.material;e.trigger("beforerender",this,e,t,u),r?(this.renderPreZ(c,e,t),i.depthFunc(i.LEQUAL)):i.depthFunc(i.LESS);for(var v=p(),g=h["a"].create(),y=0;y<d.length;y++){var _=d[y];f["a"].multiplyAffine(v,t.viewMatrix.array,_.worldTransform.array),h["a"].transformMat4(g,_.position.array,v),_.__depth=g[2]}this.renderPass(c,t,{getMaterial:function(e){return m||e.material},sortCompare:this.opaqueSortCompare}),this.renderPass(d,t,{getMaterial:function(e){return m||e.material},sortCompare:this.transparentSortCompare}),e.trigger("afterrender",this,e,t,u),this._sceneRendering=null}else console.error("Can't find camera in the scene.")},getProgram:function(e,t,n){return t=t||e.material,this._programMgr.getProgram(e,t,n)},validateProgram:function(e){if(e.__error){var t=e.__error;if(m[e.__uid__])return;if(m[e.__uid__]=!0,this.throwError)throw new Error(t);this.trigger("error",t)}},updatePrograms:function(e,t,n){var r=n&&n.getMaterial||v;t=t||null;for(var i=0;i<e.length;i++){var o=e[i],a=r.call(this,o);if(i>0){var s=e[i-1],l=s.joints?s.joints.length:0,u=o.joints?o.joints.length:0;if(u===l&&o.material===s.material&&o.lightGroup===s.lightGroup){o.__program=s.__program;continue}}var c=this._programMgr.getProgram(o,a,t);this.validateProgram(c),o.__program=c}},renderPass:function(e,t,n){this.trigger("beforerenderpass",this,e,t,n),n=n||{},n.getMaterial=n.getMaterial||v,n.getUniform=n.getUniform||g,n.isMaterialChanged=n.isMaterialChanged||y,n.beforeRender=n.beforeRender||x,n.afterRender=n.afterRender||x;var r=n.ifRender||_;this.updatePrograms(e,this._sceneRendering,n),n.sortCompare&&e.sort(n.sortCompare);var i=this.viewport,o=i.devicePixelRatio,a=[i.x*o,i.y*o,i.width*o,i.height*o],s=this.devicePixelRatio,l=this.__currentFrameBuffer?[this.__currentFrameBuffer.getTextureWidth(),this.__currentFrameBuffer.getTextureHeight()]:[this._width*s,this._height*s],u=[a[2],a[3]],c=Date.now();t?(f["a"].copy(S.VIEW,t.viewMatrix.array),f["a"].copy(S.PROJECTION,t.projectionMatrix.array),f["a"].copy(S.VIEWINVERSE,t.worldTransform.array)):(f["a"].identity(S.VIEW),f["a"].identity(S.PROJECTION),f["a"].identity(S.VIEWINVERSE)),f["a"].multiply(S.VIEWPROJECTION,S.PROJECTION,S.VIEW),f["a"].invert(S.PROJECTIONINVERSE,S.PROJECTION),f["a"].invert(S.VIEWPROJECTIONINVERSE,S.VIEWPROJECTION);for(var d,h,p,m,b,w,A,T,E,C,M,L,N=this.gl,D=this._sceneRendering,O=this.getGLExtension("OES_vertex_array_object"),I=0;I<e.length;I++){var R,P=e[I],k=null!=P.worldTransform;if(r(P)){k&&(R=P.isSkinnedMesh&&P.isSkinnedMesh()?S.IDENTITY:P.worldTransform.array);var B=P.geometry,F=n.getMaterial.call(this,P),z=P.__program,H=F.shader,U=B.__uid__+"-"+z.__uid__,G=U!==C;C=U,G&&O&&O.bindVertexArrayOES(null),k&&(f["a"].copy(S.WORLD,R),f["a"].multiply(S.WORLDVIEWPROJECTION,S.VIEWPROJECTION,R),f["a"].multiplyAffine(S.WORLDVIEW,S.VIEW,R),(H.matrixSemantics.WORLDINVERSE||H.matrixSemantics.WORLDINVERSETRANSPOSE)&&f["a"].invert(S.WORLDINVERSE,R),(H.matrixSemantics.WORLDVIEWINVERSE||H.matrixSemantics.WORLDVIEWINVERSETRANSPOSE)&&f["a"].invert(S.WORLDVIEWINVERSE,S.WORLDVIEW),(H.matrixSemantics.WORLDVIEWPROJECTIONINVERSE||H.matrixSemantics.WORLDVIEWPROJECTIONINVERSETRANSPOSE)&&f["a"].invert(S.WORLDVIEWPROJECTIONINVERSE,S.WORLDVIEWPROJECTION)),P.beforeRender&&P.beforeRender(this),n.beforeRender.call(this,P,F,d);var V=z!==h;V?(z.bind(this),z.setUniformOfSemantic(N,"VIEWPORT",a),z.setUniformOfSemantic(N,"WINDOW_SIZE",l),t&&(z.setUniformOfSemantic(N,"NEAR",t.near),z.setUniformOfSemantic(N,"FAR",t.far)),z.setUniformOfSemantic(N,"DEVICEPIXELRATIO",o),z.setUniformOfSemantic(N,"TIME",c),z.setUniformOfSemantic(N,"VIEWPORT_SIZE",u),D&&D.setLightUniforms(z,P.lightGroup,this)):z=h,(V||n.isMaterialChanged(P,p,F,d))&&(F.depthTest!==m&&(F.depthTest?N.enable(N.DEPTH_TEST):N.disable(N.DEPTH_TEST),m=F.depthTest),F.depthMask!==b&&(N.depthMask(F.depthMask),b=F.depthMask),F.transparent!==E&&(F.transparent?N.enable(N.BLEND):N.disable(N.BLEND),E=F.transparent),F.transparent&&(F.blend?F.blend(N):(N.blendEquationSeparate(N.FUNC_ADD,N.FUNC_ADD),N.blendFuncSeparate(N.SRC_ALPHA,N.ONE_MINUS_SRC_ALPHA,N.ONE,N.ONE_MINUS_SRC_ALPHA))),L=this._bindMaterial(P,F,z,p||null,d||null,h||null,n.getUniform),d=F);var j=H.matrixSemanticKeys;if(k)for(var W=0;W<j.length;W++){var X=j[W],Y=H.matrixSemantics[X],q=S[X];if(Y.isTranspose){var Q=S[Y.semanticNoTranspose];f["a"].transpose(q,Q)}z.setUniform(N,Y.type,Y.symbol,q)}P.cullFace!==A&&(A=P.cullFace,N.cullFace(A)),P.frontFace!==T&&(T=P.frontFace,N.frontFace(T)),P.culling!==w&&(w=P.culling,w?N.enable(N.CULL_FACE):N.disable(N.CULL_FACE)),this._updateSkeleton(P,z,L),G&&(M=this._bindVAO(O,H,B,z)),this._renderObject(P,M),n.afterRender(this,P),P.afterRender&&P.afterRender(this),h=z,p=P}}O&&O.bindVertexArrayOES(null),this.trigger("afterrenderpass",this,e,t,n)},getMaxJointNumber:function(){return this._glinfo.getMaxJointNumber()},_updateSkeleton:function(e,t,n){var r=this.gl,i=e.skeleton;if(i)if(i.update(),e.joints.length>this._glinfo.getMaxJointNumber()){var o=i.getSubSkinMatricesTexture(e.__uid__,e.joints);t.useTextureSlot(this,o,n),t.setUniform(r,"1i","skinMatricesTexture",n),t.setUniform(r,"1f","skinMatricesTextureSize",o.width)}else{var a=i.getSubSkinMatrices(e.__uid__,e.joints);t.setUniformOfSemantic(r,"SKIN_MATRIX",a)}},_renderObject:function(e,t){var n=this.gl,r=e.geometry,i=e.mode;if(null==i&&(i=4),t.indicesBuffer){var o=this.getGLExtension("OES_element_index_uint"),a=o&&r.indices instanceof Uint32Array,s=a?n.UNSIGNED_INT:n.UNSIGNED_SHORT;n.drawElements(i,t.indicesBuffer.count,s,0)}else n.drawArrays(i,0,r.vertexCount)},_bindMaterial:function(e,t,n,r,i,o,a){for(var s=this.gl,l=o===n,u=n.currentTextureSlot(),c=t.getEnabledUniforms(),d=t.getTextureUniforms(),f=this._placeholderTexture,h=0;h<d.length;h++){var p=d[h],m=a(e,t,p),v=t.uniforms[p].type;if("t"===v&&m)m.__slot=-1;else if("tv"===v)for(var g=0;g<m.length;g++)m[g]&&(m[g].__slot=-1)}f.__slot=-1;for(h=0;h<c.length;h++){p=c[h];var y=t.uniforms[p],_=(m=a(e,t,p),v=y.type,"t"===v);if(_&&(m&&m.isRenderable()||(m=f)),i&&l){var x=a(r,i,p);if(_&&(x&&x.isRenderable()||(x=f)),x===m){if(_)n.takeCurrentTextureSlot(this,null);else if("tv"===v&&m)for(g=0;g<m.length;g++)n.takeCurrentTextureSlot(this,null);continue}}if(null!=m)if(_)if(m.__slot<0){var b=n.currentTextureSlot(),w=n.setUniform(s,"1i",p,b);w&&(n.takeCurrentTextureSlot(this,m),m.__slot=b)}else n.setUniform(s,"1i",p,m.__slot);else if(Array.isArray(m)){if(0===m.length)continue;if("tv"===v){if(!n.hasUniform(p))continue;var A=[];for(g=0;g<m.length;g++){var T=m[g];if(T.__slot<0){b=n.currentTextureSlot();A.push(b),n.takeCurrentTextureSlot(this,T),T.__slot=b}else A.push(T.__slot)}n.setUniform(s,"1iv",p,A)}else n.setUniform(s,y.type,p,m)}else n.setUniform(s,y.type,p,m)}var S=n.currentTextureSlot();return n.resetTextureSlot(u),S},_bindVAO:function(e,t,n,r){var i=!n.dynamic,o=this.gl,a=this.__uid__+"-"+r.__uid__,s=n.__vaoCache[a];if(!s){var l=n.getBufferChunks(this);if(!l||!l.length)return;for(var u=l[0],c=u.attributeBuffers,d=u.indicesBuffer,f=[],h=[],p=0;p<c.length;p++){var m,v=c[p],g=v.name,y=v.semantic;if(y){var _=t.attributeSemantics[y];m=_&&_.symbol}else m=g;m&&r.attributes[m]&&(f.push(v),h.push(m))}s=new w(f,h,d),i&&(n.__vaoCache[a]=s)}var x=!0;e&&i&&(null==s.vao?s.vao=e.createVertexArrayOES():x=!1,e.bindVertexArrayOES(s.vao));f=s.availableAttributes,d=s.indicesBuffer;if(x){var A=r.enableAttributes(this,s.availableAttributeSymbols,e&&i&&s);for(p=0;p<f.length;p++){var T=A[p];if(-1!==T){v=f[p];var S=v.buffer,E=v.size,C=b[v.type]||o.FLOAT;o.bindBuffer(o.ARRAY_BUFFER,S),o.vertexAttribPointer(T,E,C,!1,0,0)}}n.isUseIndices()&&o.bindBuffer(o.ELEMENT_ARRAY_BUFFER,d.buffer)}return s},renderPreZ:function(e,t,n){var r=this.gl,i=this._prezMaterial||new s["a"]({shader:new c["a"](c["a"].source("clay.prez.vertex"),c["a"].source("clay.prez.fragment"))});this._prezMaterial=i,r.colorMask(!1,!1,!1,!1),r.depthMask(!0),this.renderPass(e,n,{ifRender:function(e){return!e.ignorePreZ},isMaterialChanged:function(e,t){var n=e.material,r=t.material;return n.get("diffuseMap")!==r.get("diffuseMap")||(n.get("alphaCutoff")||0)!==(r.get("alphaCutoff")||0)},getUniform:function(e,t,n){if("alphaMap"===n)return e.material.get("diffuseMap");if("alphaCutoff"===n){if(e.material.isDefined("fragment","ALPHA_TEST")&&e.material.get("diffuseMap")){var r=e.material.get("alphaCutoff");return r||0}return 0}return t.get(n)},getMaterial:function(){return i},sort:this.opaqueSortCompare}),r.colorMask(!0,!0,!0,!0),r.depthMask(!0)},disposeScene:function(e){this.disposeNode(e,!0,!0),e.dispose()},disposeNode:function(e,t,n){e.getParent()&&e.getParent().remove(e);var r={};e.traverse((function(e){var i=e.material;if(e.geometry&&t&&e.geometry.dispose(this),n&&i&&!r[i.__uid__]){for(var o=i.getTextureUniforms(),a=0;a<o.length;a++){var s=o[a],l=i.uniforms[s].value,u=i.uniforms[s].type;if(l)if("t"===u)l.dispose&&l.dispose(this);else if("tv"===u)for(var c=0;c<l.length;c++)l[c]&&l[c].dispose&&l[c].dispose(this)}r[i.__uid__]=!0}e.dispose&&e.dispose(this)}),this)},disposeGeometry:function(e){e.dispose(this)},disposeTexture:function(e){e.dispose(this)},disposeFrameBuffer:function(e){e.dispose(this)},dispose:function(){},screenToNDC:function(e,t,n){n||(n=new l["a"]),t=this._height-t;var r=this.viewport,i=n.array;return i[0]=(e-r.x)/r.width,i[0]=2*i[0]-1,i[1]=(t-r.y)/r.height,i[1]=2*i[1]-1,n}});T.opaqueSortCompare=T.prototype.opaqueSortCompare=function(e,t){return e.renderOrder===t.renderOrder?e.__program===t.__program?e.material===t.material?e.geometry.__uid__-t.geometry.__uid__:e.material.__uid__-t.material.__uid__:e.__program&&t.__program?e.__program.__uid__-t.__program.__uid__:0:e.renderOrder-t.renderOrder},T.transparentSortCompare=T.prototype.transparentSortCompare=function(e,t){return e.renderOrder===t.renderOrder?e.__depth===t.__depth?e.__program===t.__program?e.material===t.material?e.geometry.__uid__-t.geometry.__uid__:e.material.__uid__-t.material.__uid__:e.__program&&t.__program?e.__program.__uid__-t.__program.__uid__:0:e.__depth-t.__depth:e.renderOrder-t.renderOrder};var S={IDENTITY:p(),WORLD:p(),VIEW:p(),PROJECTION:p(),WORLDVIEW:p(),VIEWPROJECTION:p(),WORLDVIEWPROJECTION:p(),WORLDINVERSE:p(),VIEWINVERSE:p(),PROJECTIONINVERSE:p(),WORLDVIEWINVERSE:p(),VIEWPROJECTIONINVERSE:p(),WORLDVIEWPROJECTIONINVERSE:p(),WORLDTRANSPOSE:p(),VIEWTRANSPOSE:p(),PROJECTIONTRANSPOSE:p(),WORLDVIEWTRANSPOSE:p(),VIEWPROJECTIONTRANSPOSE:p(),WORLDVIEWPROJECTIONTRANSPOSE:p(),WORLDINVERSETRANSPOSE:p(),VIEWINVERSETRANSPOSE:p(),PROJECTIONINVERSETRANSPOSE:p(),WORLDVIEWINVERSETRANSPOSE:p(),VIEWPROJECTIONINVERSETRANSPOSE:p(),WORLDVIEWPROJECTIONINVERSETRANSPOSE:p()};T.COLOR_BUFFER_BIT=o["a"].COLOR_BUFFER_BIT,T.DEPTH_BUFFER_BIT=o["a"].DEPTH_BUFFER_BIT,T.STENCIL_BUFFER_BIT=o["a"].STENCIL_BUFFER_BIT,t["a"]=T},function(e,t,n){"use strict";function r(e,t){this.action=e,this.context=t}var i={trigger:function(e){if(this.hasOwnProperty("__handlers__")&&this.__handlers__.hasOwnProperty(e)){var t=this.__handlers__[e],n=t.length,r=-1,i=arguments;switch(i.length){case 1:while(++r<n)t[r].action.call(t[r].context);return;case 2:while(++r<n)t[r].action.call(t[r].context,i[1]);return;case 3:while(++r<n)t[r].action.call(t[r].context,i[1],i[2]);return;case 4:while(++r<n)t[r].action.call(t[r].context,i[1],i[2],i[3]);return;case 5:while(++r<n)t[r].action.call(t[r].context,i[1],i[2],i[3],i[4]);return;default:while(++r<n)t[r].action.apply(t[r].context,Array.prototype.slice.call(i,1));return}}},on:function(e,t,n){if(e&&t){var i=this.__handlers__||(this.__handlers__={});if(i[e]){if(this.has(e,t))return}else i[e]=[];var o=new r(t,n||this);return i[e].push(o),this}},once:function(e,t,n){if(e&&t){var r=this;return this.on(e,i,n)}function i(){r.off(e,i),t.apply(this,arguments)}},before:function(e,t,n){if(e&&t)return e="before"+e,this.on(e,t,n)},after:function(e,t,n){if(e&&t)return e="after"+e,this.on(e,t,n)},success:function(e,t){return this.once("success",e,t)},error:function(e,t){return this.once("error",e,t)},off:function(e,t){var n=this.__handlers__||(this.__handlers__={});if(t){if(n[e]){for(var r=n[e],i=[],o=0;o<r.length;o++)t&&r[o].action!==t&&i.push(r[o]);n[e]=i}return this}n[e]=[]},has:function(e,t){var n=this.__handlers__;if(!n||!n[e])return!1;for(var r=n[e],i=0;i<r.length;i++)if(r[i].action===t)return!0}};t["a"]=i},function(e,t,n){"use strict";var r=n(3),i=n(12),o=1e-5,a=function(e,t){this.origin=e||new r["a"],this.direction=t||new r["a"]};a.prototype={constructor:a,intersectPlane:function(e,t){var n=e.normal.array,o=e.distance,a=this.origin.array,s=this.direction.array,l=i["a"].dot(n,s);if(0===l)return null;t||(t=new r["a"]);var u=(i["a"].dot(n,a)-o)/l;return i["a"].scaleAndAdd(t.array,a,s,-u),t._dirty=!0,t},mirrorAgainstPlane:function(e){var t=i["a"].dot(e.normal.array,this.direction.array);i["a"].scaleAndAdd(this.direction.array,this.direction.array,e.normal.array,2*-t),this.direction._dirty=!0},distanceToPoint:function(){var e=i["a"].create();return function(t){i["a"].sub(e,t,this.origin.array);var n=i["a"].dot(e,this.direction.array);if(n<0)return i["a"].distance(this.origin.array,t);var r=i["a"].lenSquared(e);return Math.sqrt(r-n*n)}}(),intersectSphere:function(){var e=i["a"].create();return function(t,n,o){var a=this.origin.array,s=this.direction.array;t=t.array,i["a"].sub(e,t,a);var l=i["a"].dot(e,s),u=i["a"].squaredLength(e),c=u-l*l,d=n*n;if(!(c>d)){var f=Math.sqrt(d-c),h=l-f,p=l+f;return o||(o=new r["a"]),h<0?p<0?null:(i["a"].scaleAndAdd(o.array,a,s,p),o):(i["a"].scaleAndAdd(o.array,a,s,h),o)}}}(),intersectBoundingBox:function(e,t){var n,o,a,s,l,u,c=this.direction.array,d=this.origin.array,f=e.min.array,h=e.max.array,p=1/c[0],m=1/c[1],v=1/c[2];if(p>=0?(n=(f[0]-d[0])*p,o=(h[0]-d[0])*p):(o=(f[0]-d[0])*p,n=(h[0]-d[0])*p),m>=0?(a=(f[1]-d[1])*m,s=(h[1]-d[1])*m):(s=(f[1]-d[1])*m,a=(h[1]-d[1])*m),n>s||a>o)return null;if((a>n||n!==n)&&(n=a),(s<o||o!==o)&&(o=s),v>=0?(l=(f[2]-d[2])*v,u=(h[2]-d[2])*v):(u=(f[2]-d[2])*v,l=(h[2]-d[2])*v),n>u||l>o)return null;if((l>n||n!==n)&&(n=l),(u<o||o!==o)&&(o=u),o<0)return null;var g=n>=0?n:o;return t||(t=new r["a"]),i["a"].scaleAndAdd(t.array,d,c,g),t},intersectTriangle:function(){var e=i["a"].create(),t=i["a"].create(),n=i["a"].create(),a=i["a"].create();return function(s,l,u,c,d,f){var h=this.direction.array,p=this.origin.array;s=s.array,l=l.array,u=u.array,i["a"].sub(e,l,s),i["a"].sub(t,u,s),i["a"].cross(a,t,h);var m=i["a"].dot(e,a);if(c){if(m>-o)return null}else if(m>-o&&m<o)return null;i["a"].sub(n,p,s);var v=i["a"].dot(a,n)/m;if(v<0||v>1)return null;i["a"].cross(a,e,n);var g=i["a"].dot(h,a)/m;if(g<0||g>1||v+g>1)return null;i["a"].cross(a,e,t);var y=-i["a"].dot(n,a)/m;return y<0?null:(d||(d=new r["a"]),f&&r["a"].set(f,1-v-g,v,g),i["a"].scaleAndAdd(d.array,p,h,y),d)}}(),applyTransform:function(e){r["a"].add(this.direction,this.direction,this.origin),r["a"].transformMat4(this.origin,this.origin,e),r["a"].transformMat4(this.direction,this.direction,e),r["a"].sub(this.direction,this.direction,this.origin),r["a"].normalize(this.direction,this.direction)},copy:function(e){r["a"].copy(this.origin,e.origin),r["a"].copy(this.direction,e.direction)},clone:function(){var e=new a;return e.copy(this),e}},t["a"]=a},function(e,t,n){"use strict";var r=n(20),i=n(12),o=n(33),a=n(34),s={create:function(){var e=new r["a"](4);return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e}};s.rotationTo=function(){var e=i["a"].create(),t=i["a"].fromValues(1,0,0),n=i["a"].fromValues(0,1,0);return function(r,o,a){var l=i["a"].dot(o,a);return l<-.999999?(i["a"].cross(e,t,o),i["a"].length(e)<1e-6&&i["a"].cross(e,n,o),i["a"].normalize(e,e),s.setAxisAngle(r,e,Math.PI),r):l>.999999?(r[0]=0,r[1]=0,r[2]=0,r[3]=1,r):(i["a"].cross(e,o,a),r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=1+l,s.normalize(r,r))}}(),s.setAxes=function(){var e=a["a"].create();return function(t,n,r,i){return e[0]=r[0],e[3]=r[1],e[6]=r[2],e[1]=i[0],e[4]=i[1],e[7]=i[2],e[2]=-n[0],e[5]=-n[1],e[8]=-n[2],s.normalize(t,s.fromMat3(t,e))}}(),s.clone=o["a"].clone,s.fromValues=o["a"].fromValues,s.copy=o["a"].copy,s.set=o["a"].set,s.identity=function(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e},s.setAxisAngle=function(e,t,n){n*=.5;var r=Math.sin(n);return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=Math.cos(n),e},s.add=o["a"].add,s.multiply=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=n[0],l=n[1],u=n[2],c=n[3];return e[0]=r*c+a*s+i*u-o*l,e[1]=i*c+a*l+o*s-r*u,e[2]=o*c+a*u+r*l-i*s,e[3]=a*c-r*s-i*l-o*u,e},s.mul=s.multiply,s.scale=o["a"].scale,s.rotateX=function(e,t,n){n*=.5;var r=t[0],i=t[1],o=t[2],a=t[3],s=Math.sin(n),l=Math.cos(n);return e[0]=r*l+a*s,e[1]=i*l+o*s,e[2]=o*l-i*s,e[3]=a*l-r*s,e},s.rotateY=function(e,t,n){n*=.5;var r=t[0],i=t[1],o=t[2],a=t[3],s=Math.sin(n),l=Math.cos(n);return e[0]=r*l-o*s,e[1]=i*l+a*s,e[2]=o*l+r*s,e[3]=a*l-i*s,e},s.rotateZ=function(e,t,n){n*=.5;var r=t[0],i=t[1],o=t[2],a=t[3],s=Math.sin(n),l=Math.cos(n);return e[0]=r*l+i*s,e[1]=i*l-r*s,e[2]=o*l+a*s,e[3]=a*l-o*s,e},s.calculateW=function(e,t){var n=t[0],r=t[1],i=t[2];return e[0]=n,e[1]=r,e[2]=i,e[3]=Math.sqrt(Math.abs(1-n*n-r*r-i*i)),e},s.dot=o["a"].dot,s.lerp=o["a"].lerp,s.slerp=function(e,t,n,r){var i,o,a,s,l,u=t[0],c=t[1],d=t[2],f=t[3],h=n[0],p=n[1],m=n[2],v=n[3];return o=u*h+c*p+d*m+f*v,o<0&&(o=-o,h=-h,p=-p,m=-m,v=-v),1-o>1e-6?(i=Math.acos(o),a=Math.sin(i),s=Math.sin((1-r)*i)/a,l=Math.sin(r*i)/a):(s=1-r,l=r),e[0]=s*u+l*h,e[1]=s*c+l*p,e[2]=s*d+l*m,e[3]=s*f+l*v,e},s.invert=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=n*n+r*r+i*i+o*o,s=a?1/a:0;return e[0]=-n*s,e[1]=-r*s,e[2]=-i*s,e[3]=o*s,e},s.conjugate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e},s.length=o["a"].length,s.len=s.length,s.squaredLength=o["a"].squaredLength,s.sqrLen=s.squaredLength,s.normalize=o["a"].normalize,s.fromMat3=function(e,t){var n,r=t[0]+t[4]+t[8];if(r>0)n=Math.sqrt(r+1),e[3]=.5*n,n=.5/n,e[0]=(t[5]-t[7])*n,e[1]=(t[6]-t[2])*n,e[2]=(t[1]-t[3])*n;else{var i=0;t[4]>t[0]&&(i=1),t[8]>t[3*i+i]&&(i=2);var o=(i+1)%3,a=(i+2)%3;n=Math.sqrt(t[3*i+i]-t[3*o+o]-t[3*a+a]+1),e[i]=.5*n,n=.5/n,e[3]=(t[3*o+a]-t[3*a+o])*n,e[o]=(t[3*o+i]+t[3*i+o])*n,e[a]=(t[3*a+i]+t[3*i+a])*n}return e},t["a"]=s},function(e,t,n){"use strict";var r=n(55),i=n(34),o=function(e,t,n,i){e=e||0,t=t||0,n=n||0,i=void 0===i?1:i,this.array=r["a"].fromValues(e,t,n,i),this._dirty=!0};o.prototype={constructor:o,add:function(e){return r["a"].add(this.array,this.array,e.array),this._dirty=!0,this},calculateW:function(){return r["a"].calculateW(this.array,this.array),this._dirty=!0,this},set:function(e,t,n,r){return this.array[0]=e,this.array[1]=t,this.array[2]=n,this.array[3]=r,this._dirty=!0,this},setArray:function(e){return this.array[0]=e[0],this.array[1]=e[1],this.array[2]=e[2],this.array[3]=e[3],this._dirty=!0,this},clone:function(){return new o(this.x,this.y,this.z,this.w)},conjugate:function(){return r["a"].conjugate(this.array,this.array),this._dirty=!0,this},copy:function(e){return r["a"].copy(this.array,e.array),this._dirty=!0,this},dot:function(e){return r["a"].dot(this.array,e.array)},fromMat3:function(e){return r["a"].fromMat3(this.array,e.array),this._dirty=!0,this},fromMat4:function(){var e=i["a"].create();return function(t){return i["a"].fromMat4(e,t.array),i["a"].transpose(e,e),r["a"].fromMat3(this.array,e),this._dirty=!0,this}}(),identity:function(){return r["a"].identity(this.array),this._dirty=!0,this},invert:function(){return r["a"].invert(this.array,this.array),this._dirty=!0,this},len:function(){return r["a"].len(this.array)},length:function(){return r["a"].length(this.array)},lerp:function(e,t,n){return r["a"].lerp(this.array,e.array,t.array,n),this._dirty=!0,this},mul:function(e){return r["a"].mul(this.array,this.array,e.array),this._dirty=!0,this},mulLeft:function(e){return r["a"].multiply(this.array,e.array,this.array),this._dirty=!0,this},multiply:function(e){return r["a"].multiply(this.array,this.array,e.array),this._dirty=!0,this},multiplyLeft:function(e){return r["a"].multiply(this.array,e.array,this.array),this._dirty=!0,this},normalize:function(){return r["a"].normalize(this.array,this.array),this._dirty=!0,this},rotateX:function(e){return r["a"].rotateX(this.array,this.array,e),this._dirty=!0,this},rotateY:function(e){return r["a"].rotateY(this.array,this.array,e),this._dirty=!0,this},rotateZ:function(e){return r["a"].rotateZ(this.array,this.array,e),this._dirty=!0,this},rotationTo:function(e,t){return r["a"].rotationTo(this.array,e.array,t.array),this._dirty=!0,this},setAxes:function(e,t,n){return r["a"].setAxes(this.array,e.array,t.array,n.array),this._dirty=!0,this},setAxisAngle:function(e,t){return r["a"].setAxisAngle(this.array,e.array,t),this._dirty=!0,this},slerp:function(e,t,n){return r["a"].slerp(this.array,e.array,t.array,n),this._dirty=!0,this},sqrLen:function(){return r["a"].sqrLen(this.array)},squaredLength:function(){return r["a"].squaredLength(this.array)},fromEuler:function(e,t){return o.fromEuler(this,e,t)},toString:function(){return"["+Array.prototype.join.call(this.array,",")+"]"},toArray:function(){return Array.prototype.slice.call(this.array)}};var a=Object.defineProperty;if(a){var s=o.prototype;a(s,"x",{get:function(){return this.array[0]},set:function(e){this.array[0]=e,this._dirty=!0}}),a(s,"y",{get:function(){return this.array[1]},set:function(e){this.array[1]=e,this._dirty=!0}}),a(s,"z",{get:function(){return this.array[2]},set:function(e){this.array[2]=e,this._dirty=!0}}),a(s,"w",{get:function(){return this.array[3]},set:function(e){this.array[3]=e,this._dirty=!0}})}o.add=function(e,t,n){return r["a"].add(e.array,t.array,n.array),e._dirty=!0,e},o.set=function(e,t,n,i,o){r["a"].set(e.array,t,n,i,o),e._dirty=!0},o.copy=function(e,t){return r["a"].copy(e.array,t.array),e._dirty=!0,e},o.calculateW=function(e,t){return r["a"].calculateW(e.array,t.array),e._dirty=!0,e},o.conjugate=function(e,t){return r["a"].conjugate(e.array,t.array),e._dirty=!0,e},o.identity=function(e){return r["a"].identity(e.array),e._dirty=!0,e},o.invert=function(e,t){return r["a"].invert(e.array,t.array),e._dirty=!0,e},o.dot=function(e,t){return r["a"].dot(e.array,t.array)},o.len=function(e){return r["a"].length(e.array)},o.lerp=function(e,t,n,i){return r["a"].lerp(e.array,t.array,n.array,i),e._dirty=!0,e},o.slerp=function(e,t,n,i){return r["a"].slerp(e.array,t.array,n.array,i),e._dirty=!0,e},o.mul=function(e,t,n){return r["a"].multiply(e.array,t.array,n.array),e._dirty=!0,e},o.multiply=o.mul,o.rotateX=function(e,t,n){return r["a"].rotateX(e.array,t.array,n),e._dirty=!0,e},o.rotateY=function(e,t,n){return r["a"].rotateY(e.array,t.array,n),e._dirty=!0,e},o.rotateZ=function(e,t,n){return r["a"].rotateZ(e.array,t.array,n),e._dirty=!0,e},o.setAxisAngle=function(e,t,n){return r["a"].setAxisAngle(e.array,t.array,n),e._dirty=!0,e},o.normalize=function(e,t){return r["a"].normalize(e.array,t.array),e._dirty=!0,e},o.sqrLen=function(e){return r["a"].sqrLen(e.array)},o.squaredLength=o.sqrLen,o.fromMat3=function(e,t){return r["a"].fromMat3(e.array,t.array),e._dirty=!0,e},o.setAxes=function(e,t,n,i){return r["a"].setAxes(e.array,t.array,n.array,i.array),e._dirty=!0,e},o.rotationTo=function(e,t,n){return r["a"].rotationTo(e.array,t.array,n.array),e._dirty=!0,e},o.fromEuler=function(e,t,n){e._dirty=!0,t=t.array;var r=e.array,i=Math.cos(t[0]/2),o=Math.cos(t[1]/2),a=Math.cos(t[2]/2),s=Math.sin(t[0]/2),l=Math.sin(t[1]/2),u=Math.sin(t[2]/2);n=(n||"XYZ").toUpperCase();switch(n){case"XYZ":r[0]=s*o*a+i*l*u,r[1]=i*l*a-s*o*u,r[2]=i*o*u+s*l*a,r[3]=i*o*a-s*l*u;break;case"YXZ":r[0]=s*o*a+i*l*u,r[1]=i*l*a-s*o*u,r[2]=i*o*u-s*l*a,r[3]=i*o*a+s*l*u;break;case"ZXY":r[0]=s*o*a-i*l*u,r[1]=i*l*a+s*o*u,r[2]=i*o*u+s*l*a,r[3]=i*o*a-s*l*u;break;case"ZYX":r[0]=s*o*a-i*l*u,r[1]=i*l*a+s*o*u,r[2]=i*o*u-s*l*a,r[3]=i*o*a+s*l*u;break;case"YZX":r[0]=s*o*a+i*l*u,r[1]=i*l*a+s*o*u,r[2]=i*o*u-s*l*a,r[3]=i*o*a-s*l*u;break;case"XZY":r[0]=s*o*a-i*l*u,r[1]=i*l*a-s*o*u,r[2]=i*o*u+s*l*a,r[3]=i*o*a+s*l*u;break}},t["a"]=o},function(e,t,n){"use strict";var r="__dt__",i=function(){this._contextId=0,this._caches=[],this._context={}};i.prototype={use:function(e,t){var n=this._caches;n[e]||(n[e]={},t&&(n[e]=t())),this._contextId=e,this._context=n[e]},put:function(e,t){this._context[e]=t},get:function(e){return this._context[e]},dirty:function(e){e=e||"";var t=r+e;this.put(t,!0)},dirtyAll:function(e){e=e||"";for(var t=r+e,n=this._caches,i=0;i<n.length;i++)n[i]&&(n[i][t]=!0)},fresh:function(e){e=e||"";var t=r+e;this.put(t,!1)},freshAll:function(e){e=e||"";for(var t=r+e,n=this._caches,i=0;i<n.length;i++)n[i]&&(n[i][t]=!1)},isDirty:function(e){e=e||"";var t=r+e,n=this._context;return!n.hasOwnProperty(t)||!0===n[t]},deleteContext:function(e){delete this._caches[e],this._context={}},delete:function(e){delete this._context[e]},clearAll:function(){this._caches={}},getContext:function(){return this._context},eachContext:function(e,t){var n=Object.keys(this._caches);n.forEach((function(n){e&&e.call(t,n)}))},miss:function(e){return!this._context.hasOwnProperty(e)}},i.prototype.constructor=i,t["a"]=i},function(e,t,n){"use strict";var r=n(35),i=n(9),o=n(59),a=n(54),s=n(33),l=n(12),u=r["a"].extend((function(){return{projectionMatrix:new i["a"],invProjectionMatrix:new i["a"],viewMatrix:new i["a"],frustum:new o["a"]}}),(function(){this.update(!0)}),{update:function(e){r["a"].prototype.update.call(this,e),i["a"].invert(this.viewMatrix,this.worldTransform),this.updateProjectionMatrix(),i["a"].invert(this.invProjectionMatrix,this.projectionMatrix),this.frustum.setFromProjection(this.projectionMatrix)},setViewMatrix:function(e){i["a"].copy(this.viewMatrix,e),i["a"].invert(this.worldTransform,e),this.decomposeWorldTransform()},decomposeProjectionMatrix:function(){},setProjectionMatrix:function(e){i["a"].copy(this.projectionMatrix,e),i["a"].invert(this.invProjectionMatrix,e),this.decomposeProjectionMatrix()},updateProjectionMatrix:function(){},castRay:function(){var e=s["a"].create();return function(t,n){var r=void 0!==n?n:new a["a"],i=t.array[0],o=t.array[1];return s["a"].set(e,i,o,-1,1),s["a"].transformMat4(e,e,this.invProjectionMatrix.array),s["a"].transformMat4(e,e,this.worldTransform.array),l["a"].scale(r.origin.array,e,1/e[3]),s["a"].set(e,i,o,1,1),s["a"].transformMat4(e,e,this.invProjectionMatrix.array),s["a"].transformMat4(e,e,this.worldTransform.array),l["a"].scale(e,e,1/e[3]),l["a"].sub(r.direction.array,e,r.origin.array),l["a"].normalize(r.direction.array,r.direction.array),r.direction._dirty=!0,r.origin._dirty=!0,r}}()});t["a"]=u},function(e,t,n){"use strict";var r=n(18),i=n(74),o=n(12),a=o["a"].set,s=o["a"].copy,l=o["a"].transformMat4,u=Math.min,c=Math.max,d=function(){this.planes=[];for(var e=0;e<6;e++)this.planes.push(new i["a"]);this.boundingBox=new r["a"],this.vertices=[];for(e=0;e<8;e++)this.vertices[e]=o["a"].fromValues(0,0,0)};d.prototype={setFromProjection:function(e){var t=this.planes,n=e.array,r=n[0],i=n[1],o=n[2],s=n[3],l=n[4],u=n[5],c=n[6],d=n[7],f=n[8],h=n[9],p=n[10],m=n[11],v=n[12],g=n[13],y=n[14],_=n[15];a(t[0].normal.array,s-r,d-l,m-f),t[0].distance=-(_-v),t[0].normalize(),a(t[1].normal.array,s+r,d+l,m+f),t[1].distance=-(_+v),t[1].normalize(),a(t[2].normal.array,s+i,d+u,m+h),t[2].distance=-(_+g),t[2].normalize(),a(t[3].normal.array,s-i,d-u,m-h),t[3].distance=-(_-g),t[3].normalize(),a(t[4].normal.array,s-o,d-c,m-p),t[4].distance=-(_-y),t[4].normalize(),a(t[5].normal.array,s+o,d+c,m+p),t[5].distance=-(_+y),t[5].normalize();var x=this.boundingBox,b=this.vertices;if(0===_){var w=u/r,A=-y/(p-1),T=-y/(p+1),S=-T/u,E=-A/u;x.min.set(-S*w,-S,T),x.max.set(S*w,S,A),a(b[0],-S*w,-S,T),a(b[1],-S*w,S,T),a(b[2],S*w,-S,T),a(b[3],S*w,S,T),a(b[4],-E*w,-E,A),a(b[5],-E*w,E,A),a(b[6],E*w,-E,A),a(b[7],E*w,E,A)}else{var C=(-1-v)/r,M=(1-v)/r,L=(1-g)/u,N=(-1-g)/u,D=(-1-y)/p,O=(1-y)/p;x.min.set(Math.min(C,M),Math.min(N,L),Math.min(O,D)),x.max.set(Math.max(M,C),Math.max(L,N),Math.max(D,O));var I=x.min.array,R=x.max.array;a(b[0],I[0],I[1],I[2]),a(b[1],I[0],R[1],I[2]),a(b[2],R[0],I[1],I[2]),a(b[3],R[0],R[1],I[2]),a(b[4],I[0],I[1],R[2]),a(b[5],I[0],R[1],R[2]),a(b[6],R[0],I[1],R[2]),a(b[7],R[0],R[1],R[2])}},getTransformedBoundingBox:function(){var e=o["a"].create();return function(t,n){var r=this.vertices,i=n.array,o=t.min,a=t.max,d=o.array,f=a.array,h=r[0];l(e,h,i),s(d,e),s(f,e);for(var p=1;p<8;p++)h=r[p],l(e,h,i),d[0]=u(e[0],d[0]),d[1]=u(e[1],d[1]),d[2]=u(e[2],d[2]),f[0]=c(e[0],f[0]),f[1]=c(e[1],f[1]),f[2]=c(e[2],f[2]);return o._dirty=!0,a._dirty=!0,t}}()},t["a"]=d},function(e,t){var n=function(){this.head=null,this.tail=null,this._len=0},r=n.prototype;r.insert=function(e){var t=new i(e);return this.insertEntry(t),t},r.insertEntry=function(e){this.head?(this.tail.next=e,e.prev=this.tail,e.next=null,this.tail=e):this.head=this.tail=e,this._len++},r.remove=function(e){var t=e.prev,n=e.next;t?t.next=n:this.head=n,n?n.prev=t:this.tail=t,e.next=e.prev=null,this._len--},r.len=function(){return this._len},r.clear=function(){this.head=this.tail=null,this._len=0};var i=function(e){this.value=e,this.next,this.prev},o=function(e){this._list=new n,this._map={},this._maxSize=e||10,this._lastRemovedEntry=null},a=o.prototype;a.put=function(e,t){var n=this._list,r=this._map,o=null;if(null==r[e]){var a=n.len(),s=this._lastRemovedEntry;if(a>=this._maxSize&&a>0){var l=n.head;n.remove(l),delete r[l.key],o=l.value,this._lastRemovedEntry=l}s?s.value=t:s=new i(t),s.key=e,n.insertEntry(s),r[e]=s}return o},a.get=function(e){var t=this._map[e],n=this._list;if(null!=t)return t!==n.tail&&(n.remove(t),n.insertEntry(t)),t.value},a.clear=function(){this._list.clear(),this._map={}};var s=o;e.exports=s},function(e,t,n){"use strict";var r=n(5),i=n(27),o=n(14),a=n(62),s=n(75),l=n(36),u=n(122),c=n(123),d={loadTexture:function(e,t,n,o){var a;if("function"===typeof t?(n=t,o=n,t={}):t=t||{},"string"===typeof e){if(e.match(/.hdr$/)||"hdr"===t.fileType)return a=new r["a"]({width:0,height:0,sRGB:!1}),d._fetchTexture(e,(function(e){c["a"].parseRGBE(e,a,t.exposure),a.dirty(),n&&n(a)}),o),a;e.match(/.dds$/)||"dds"===t.fileType?(a=new r["a"]({width:0,height:0}),d._fetchTexture(e,(function(e){u["a"].parse(e,a),a.dirty(),n&&n(a)}),o)):(a=new r["a"],a.load(e),a.success(n),a.error(o))}else"object"===typeof e&&"undefined"!==typeof e.px&&(a=new i["a"],a.load(e),a.success(n),a.error(o));return a},loadPanorama:function(e,t,n,r,i,o){var a=this;"function"===typeof r?(i=r,o=i,r={}):r=r||{},d.loadTexture(t,r,(function(t){t.flipY=r.flipY||!1,a.panoramaToCubeMap(e,t,n,r),t.dispose(e),i&&i(n)}),o)},panoramaToCubeMap:function(e,t,n,r){var i=new a["a"],o=new s["a"]({scene:new l["a"]});return o.setEnvironmentMap(t),r=r||{},r.encodeRGBM&&o.material.define("fragment","RGBM_ENCODE"),n.sRGB=t.sRGB,i.texture=n,i.render(e,o.scene),i.texture=null,i.dispose(e),n},heightToNormal:function(e,t){var n=document.createElement("canvas"),r=n.width=e.width,i=n.height=e.height,o=n.getContext("2d");o.drawImage(e,0,0,r,i),t=t||!1;for(var a=o.getImageData(0,0,r,i),s=o.createImageData(r,i),l=0;l<a.data.length;l+=4){if(t){var u=a.data[l],c=a.data[l+1],d=a.data[l+2],f=Math.abs(u-c)+Math.abs(c-d);if(f>20)return console.warn("Given image is not a height map"),e}var h,p,m,v;l%(4*r)===0?(h=a.data[l],m=a.data[l+4]):l%(4*r)===4*(r-1)?(h=a.data[l-4],m=a.data[l]):(h=a.data[l-4],m=a.data[l+4]),l<4*r?(p=a.data[l],v=a.data[l+4*r]):l>r*(i-1)*4?(p=a.data[l-4*r],v=a.data[l]):(p=a.data[l-4*r],v=a.data[l+4*r]),s.data[l]=h-m+127,s.data[l+1]=p-v+127,s.data[l+2]=255,s.data[l+3]=255}return o.putImageData(s,0,0),n},isHeightImage:function(e,t,n){if(!e||!e.width||!e.height)return!1;var r=document.createElement("canvas"),i=r.getContext("2d"),o=t||32;n=n||20,r.width=r.height=o,i.drawImage(e,0,0,o,o);for(var a=i.getImageData(0,0,o,o),s=0;s<a.data.length;s+=4){var l=a.data[s],u=a.data[s+1],c=a.data[s+2],d=Math.abs(l-u)+Math.abs(u-c);if(d>n)return!1}return!0},_fetchTexture:function(e,t,n){o["a"].request.get({url:e,responseType:"arraybuffer",onload:t,onerror:n})},createChessboard:function(e,t,n,i){e=e||512,t=t||64,n=n||"black",i=i||"white";var o=Math.ceil(e/t),a=document.createElement("canvas");a.width=e,a.height=e;var s=a.getContext("2d");s.fillStyle=i,s.fillRect(0,0,e,e),s.fillStyle=n;for(var l=0;l<o;l++)for(var u=0;u<o;u++){var c=u%2?l%2:l%2-1;c&&s.fillRect(l*t,u*t,t,t)}var d=new r["a"]({image:a,anisotropic:8});return d},createBlank:function(e){var t=document.createElement("canvas");t.width=1,t.height=1;var n=t.getContext("2d");n.fillStyle=e,n.fillRect(0,0,1,1);var i=new r["a"]({image:t});return i}};t["a"]=d},function(e,t,n){"use strict";var r=n(7),i=n(3),o=n(41),a=n(10),s=["px","nx","py","ny","pz","nz"],l=r["a"].extend((function(){var e={position:new i["a"],far:1e3,near:.1,texture:null,shadowMapPass:null},t=e._cameras={px:new o["a"]({fov:90}),nx:new o["a"]({fov:90}),py:new o["a"]({fov:90}),ny:new o["a"]({fov:90}),pz:new o["a"]({fov:90}),nz:new o["a"]({fov:90})};return t.px.lookAt(i["a"].POSITIVE_X,i["a"].NEGATIVE_Y),t.nx.lookAt(i["a"].NEGATIVE_X,i["a"].NEGATIVE_Y),t.py.lookAt(i["a"].POSITIVE_Y,i["a"].POSITIVE_Z),t.ny.lookAt(i["a"].NEGATIVE_Y,i["a"].NEGATIVE_Z),t.pz.lookAt(i["a"].POSITIVE_Z,i["a"].NEGATIVE_Y),t.nz.lookAt(i["a"].NEGATIVE_Z,i["a"].NEGATIVE_Y),e._frameBuffer=new a["a"],e}),{getCamera:function(e){return this._cameras[e]},render:function(e,t,n){var r=e.gl;n||t.update();for(var o=this.texture.width,a=2*Math.atan(o/(o-.5))/Math.PI*180,l=0;l<6;l++){var u=s[l],c=this._cameras[u];if(i["a"].copy(c.position,this.position),c.far=this.far,c.near=this.near,c.fov=a,this.shadowMapPass){c.update();var d=t.getBoundingBox();d.applyTransform(c.viewMatrix),t.viewBoundingBoxLastFrame.copy(d),this.shadowMapPass.render(e,t,c,!0)}this._frameBuffer.attach(this.texture,r.COLOR_ATTACHMENT0,r.TEXTURE_CUBE_MAP_POSITIVE_X+l),this._frameBuffer.bind(e),e.render(t,c,!0),this._frameBuffer.unbind(e)}},dispose:function(e){this._frameBuffer.dispose(e)}});t["a"]=l},function(e,t,n){"use strict";var r=n(1),i=n(165),o=n(166);r["a"].Shader.import(o["a"]),t["a"]=r["a"].Mesh.extend((function(){var e=new i["a"]({dynamic:!0}),t=new r["a"].Material({shader:r["a"].createShader("ecgl.labels"),transparent:!0,depthMask:!1});return{geometry:e,material:t,culling:!1,castShadow:!1,ignorePicking:!0}}))},function(e,t,n){"use strict";var r=n(0),i=n.n(r),o=n(1),a=n(204),s=n(25),l=n(2),u=n(6),c=n(65),d=n(66),f=n(46),h=u["a"].vec3;function p(e){this.rootNode=new o["a"].Node,this._triangulationResults={},this._shadersMap=o["a"].COMMON_SHADERS.reduce((function(e,t){return e[t]=o["a"].createShader("ecgl."+t),e}),{}),this._linesShader=o["a"].createShader("ecgl.meshLines3D");var t={};o["a"].COMMON_SHADERS.forEach((function(e){t[e]=new o["a"].Material({shader:o["a"].createShader("ecgl."+e)})})),this._groundMaterials=t,this._groundMesh=new o["a"].Mesh({geometry:new o["a"].PlaneGeometry({dynamic:!0}),castShadow:!1,renderNormal:!0,$ignorePicking:!0}),this._groundMesh.rotation.rotateX(-Math.PI/2),this._labelsBuilder=new d["a"](512,512,e),this._labelsBuilder.getMesh().renderOrder=100,this._labelsBuilder.getMesh().material.depthTest=!1,this.rootNode.add(this._labelsBuilder.getMesh()),this._initMeshes(),this._api=e}o["a"].Shader.import(f["a"]),p.prototype={constructor:p,extrudeY:!0,update:function(e,t,n,r,i){var o=e.getData();null==r&&(r=0),null==i&&(i=o.count()),this._startIndex=r,this._endIndex=i-1,this._triangulation(e,r,i);var a=this._getShader(e.get("shading"));this._prepareMesh(e,a,n,r,i),this.rootNode.updateWorldTransform(),this._updateRegionMesh(e,n,r,i);var s=e.coordinateSystem;"geo3D"===s.type&&this._updateGroundPlane(e,s,n);var l=this;this._labelsBuilder.updateData(o,r,i),this._labelsBuilder.getLabelPosition=function(e,t,n){var r=o.getName(e),i=n;if("geo3D"===s.type){var a=s.getRegion(r);if(!a)return[NaN,NaN,NaN];d=a.center;var u=s.dataToPoint([d[0],d[1],i]);return u}var c=l._triangulationResults[e-l._startIndex],d=l.extrudeY?[(c.max[0]+c.min[0])/2,c.max[1]+i,(c.max[2]+c.min[2])/2]:[(c.max[0]+c.min[0])/2,(c.max[1]+c.min[1])/2,c.max[2]+i]},this._data=o,this._labelsBuilder.updateLabels(),this._updateDebugWireframe(e),this._lastHoverDataIndex=0},_initMeshes:function(){var e=this;function t(){var t=new o["a"].Mesh({name:"Polygon",material:new o["a"].Material({shader:e._shadersMap.lambert}),geometry:new o["a"].Geometry({sortTriangles:!0,dynamic:!0}),culling:!1,ignorePicking:!0,renderNormal:!0});return i.a.util.extend(t.geometry,c["a"]),t}var n=t(),r=new o["a"].Mesh({material:new o["a"].Material({shader:this._linesShader}),castShadow:!1,ignorePicking:!0,$ignorePicking:!0,geometry:new s["a"]({useNativeLine:!1})});this.rootNode.add(n),this.rootNode.add(r),n.material.define("both","VERTEX_COLOR"),n.material.define("fragment","DOUBLE_SIDED"),this._polygonMesh=n,this._linesMesh=r,this.rootNode.add(this._groundMesh)},_getShader:function(e){var t=this._shadersMap[e];return t||(console.warn("Unkown shading "+e),t=this._shadersMap.lambert),t.__shading=e,t},_prepareMesh:function(e,t,n,r,i){for(var a=0,s=0,l=0,u=0,c=r;c<i;c++){var d=this._getRegionPolygonInfo(c),f=this._getRegionLinesInfo(c,e,this._linesMesh.geometry);a+=d.vertexCount,s+=d.triangleCount,l+=f.vertexCount,u+=f.triangleCount}var h=this._polygonMesh,p=h.geometry;["position","normal","texcoord0","color"].forEach((function(e){p.attributes[e].init(a)})),p.indices=a>65535?new Uint32Array(3*s):new Uint16Array(3*s),h.material.shader!==t&&h.material.attachShader(t,!0),o["a"].setMaterialFromModel(t.__shading,h.material,e,n),l>0&&(this._linesMesh.geometry.resetOffset(),this._linesMesh.geometry.setVertexCount(l),this._linesMesh.geometry.setTriangleCount(u)),this._dataIndexOfVertex=new Uint32Array(a),this._vertexRangeOfDataIndex=new Uint32Array(2*(i-r))},_updateRegionMesh:function(e,t,n,r){for(var i=e.getData(),a=0,s=0,u=!1,c=this._polygonMesh,d=this._linesMesh,f=n;f<r;f++){var h=e.getRegionModel(f),p=h.getModel("itemStyle"),m=p.get("color"),v=l["a"].firstNotNull(p.get("opacity"),1),g=i.getItemVisual(f,"color",!0);null!=g&&i.hasValue(f)&&(m=g),i.setItemVisual(f,"color",m),i.setItemVisual(f,"opacity",v),m=o["a"].parseColor(m);var y=o["a"].parseColor(p.get("borderColor"));m[3]*=v,y[3]*=v;var _=m[3]<.99;c.material.set("color",[1,1,1,1]),u=u||_;for(var x=l["a"].firstNotNull(h.get("height",!0),e.get("regionHeight")),b=this._updatePolygonGeometry(e,c.geometry,f,x,a,s,m),w=a;w<b.vertexOffset;w++)this._dataIndexOfVertex[w]=f;this._vertexRangeOfDataIndex[2*(f-n)]=a,this._vertexRangeOfDataIndex[2*(f-n)+1]=b.vertexOffset,a=b.vertexOffset,s=b.triangleOffset;var A=p.get("borderWidth"),T=A>0;T&&(A*=t.getDevicePixelRatio(),this._updateLinesGeometry(d.geometry,e,f,x,A,e.coordinateSystem.transform)),d.invisible=!T,d.material.set({color:y})}c=this._polygonMesh;c.material.transparent=u,c.material.depthMask=!u,c.geometry.updateBoundingBox(),c.frontFace=this.extrudeY?o["a"].Mesh.CCW:o["a"].Mesh.CW,c.material.get("normalMap")&&c.geometry.generateTangents(),c.seriesIndex=e.seriesIndex,c.on("mousemove",this._onmousemove,this),c.on("mouseout",this._onmouseout,this)},_updateDebugWireframe:function(e){var t=e.getModel("debug.wireframe");if(t.get("show")){var n=o["a"].parseColor(t.get("lineStyle.color")||"rgba(0,0,0,0.5)"),r=l["a"].firstNotNull(t.get("lineStyle.width"),1),i=this._polygonMesh;i.geometry.generateBarycentric(),i.material.define("both","WIREFRAME_TRIANGLE"),i.material.set("wireframeLineColor",n),i.material.set("wireframeLineWidth",r)}},_onmousemove:function(e){var t=this._dataIndexOfVertex[e.triangle[0]];null==t&&(t=-1),t!==this._lastHoverDataIndex&&(this.downplay(this._lastHoverDataIndex),this.highlight(t),this._labelsBuilder.updateLabels([t])),this._lastHoverDataIndex=t,this._polygonMesh.dataIndex=t},_onmouseout:function(e){e.target&&(this.downplay(this._lastHoverDataIndex),this._lastHoverDataIndex=-1,this._polygonMesh.dataIndex=-1),this._labelsBuilder.updateLabels([])},_updateGroundPlane:function(e,t,n){var r=e.getModel("groundPlane",e);if(this._groundMesh.invisible=!r.get("show",!0),!this._groundMesh.invisible){var i=e.get("shading"),a=this._groundMaterials[i];a||(console.warn("Unkown shading "+i),a=this._groundMaterials.lambert),o["a"].setMaterialFromModel(i,a,r,n),a.get("normalMap")&&this._groundMesh.geometry.generateTangents(),this._groundMesh.material=a,this._groundMesh.material.set("color",o["a"].parseColor(r.get("color"))),this._groundMesh.scale.set(t.size[0],t.size[2],1)}},_triangulation:function(e,t,n){this._triangulationResults=[];for(var r=[1/0,1/0,1/0],i=[-1/0,-1/0,-1/0],o=e.coordinateSystem,s=t;s<n;s++){for(var l=[],u=e.getRegionPolygonCoords(s),c=0;c<u.length;c++){var d=u[c].exterior,f=u[c].interiors,p=[],m=[];if(!(d.length<3)){for(var v=0,g=0;g<d.length;g++){var y=d[g];p[v++]=y[0],p[v++]=y[1]}for(g=0;g<f.length;g++)if(!(f[g].length<3)){for(var _=p.length/2,x=0;x<f[g].length;x++){y=f[g][x];p.push(y[0]),p.push(y[1])}m.push(_)}var b=Object(a["a"])(p,m),w=new Float64Array(p.length/2*3),A=[],T=[1/0,1/0,1/0],S=[-1/0,-1/0,-1/0],E=0;for(g=0;g<p.length;)h.set(A,p[g++],0,p[g++]),o&&o.transform&&h.transformMat4(A,A,o.transform),h.min(T,T,A),h.max(S,S,A),w[E++]=A[0],w[E++]=A[1],w[E++]=A[2];h.min(r,r,T),h.max(i,i,S),l.push({points:w,indices:b,min:T,max:S})}}this._triangulationResults.push(l)}this._geoBoundingBox=[r,i]},_getRegionPolygonInfo:function(e){for(var t=this._triangulationResults[e-this._startIndex],n=0,r=0,i=0;i<t.length;i++)n+=t[i].points.length/3,r+=t[i].indices.length/3;var o=2*n+4*n,a=2*r+2*n;return{vertexCount:o,triangleCount:a}},_updatePolygonGeometry:function(e,t,n,r,i,o,a){var s=e.get("projectUVOnGround"),l=t.attributes.position,u=t.attributes.normal,c=t.attributes.texcoord0,d=t.attributes.color,f=this._triangulationResults[n-this._startIndex],p=d.value&&a,m=t.indices,v=this.extrudeY?1:2,g=this.extrudeY?2:1,y=[this.rootNode.worldTransform.x.len(),this.rootNode.worldTransform.y.len(),this.rootNode.worldTransform.z.len()],_=h.mul([],this._geoBoundingBox[0],y),x=h.mul([],this._geoBoundingBox[1],y),b=Math.max(x[0]-_[0],x[2]-_[2]);function w(e,t,n){for(var r=e.points,o=r.length,s=[],u=[],f=0;f<o;f+=3)s[0]=r[f],s[v]=t,s[g]=r[f+2],u[0]=(r[f]*y[0]-_[0])/b,u[1]=(r[f+2]*y[g]-_[2])/b,l.set(i,s),p&&d.set(i,a),c.set(i++,u)}function A(e,t,n){var r=i;w(e,t,n);for(var a=e.indices.length,s=0;s<a;s++)m[3*o+s]=e.indices[s]+r;o+=e.indices.length/3}for(var T=this.extrudeY?[0,1,0]:[0,0,1],S=h.negate([],T),E=0;E<f.length;E++){var C=i,M=f[E];A(M,0,0),A(M,r,0);for(var L=M.points.length/3,N=0;N<L;N++)u.set(C+N,S),u.set(C+N+L,T);var D=[0,3,1,1,3,2],O=[[],[],[],[]],I=[],R=[],P=[],k=[],B=0;for(N=0;N<L;N++){for(var F=(N+1)%L,z=(M.points[3*F]-M.points[3*N])*y[0],H=(M.points[3*F+2]-M.points[3*N+2])*y[g],U=Math.sqrt(z*z+H*H),G=0;G<4;G++){var V=0===G||3===G,j=3*(V?N:F);O[G][0]=M.points[j],O[G][v]=G>1?r:0,O[G][g]=M.points[j+2],l.set(i+G,O[G]),s?(k[0]=(M.points[j]*y[0]-_[0])/b,k[1]=(M.points[j+2]*y[g]-_[g])/b):(k[0]=(V?B:B+U)/b,k[1]=(O[G][v]*y[v]-_[v])/b),c.set(i+G,k)}h.sub(I,O[1],O[0]),h.sub(R,O[3],O[0]),h.cross(P,I,R),h.normalize(P,P);for(G=0;G<4;G++)u.set(i+G,P),p&&d.set(i+G,a);for(G=0;G<6;G++)m[3*o+G]=D[G]+i;i+=4,o+=2,B+=U}}return t.dirty(),{vertexOffset:i,triangleOffset:o}},_getRegionLinesInfo:function(e,t,n){var r=0,i=0,o=t.getRegionModel(e),a=o.getModel("itemStyle"),s=a.get("borderWidth");if(s>0){var l=t.getRegionPolygonCoords(e);l.forEach((function(e){var t=e.exterior,o=e.interiors;r+=n.getPolylineVertexCount(t),i+=n.getPolylineTriangleCount(t);for(var a=0;a<o.length;a++)r+=n.getPolylineVertexCount(o[a]),i+=n.getPolylineTriangleCount(o[a])}),this)}return{vertexCount:r,triangleCount:i}},_updateLinesGeometry:function(e,t,n,r,i,o){function a(e){for(var t=new Float64Array(3*e.length),n=0,i=[],a=0;a<e.length;a++)i[0]=e[a][0],i[1]=r+.1,i[2]=e[a][1],o&&h.transformMat4(i,i,o),t[n++]=i[0],t[n++]=i[1],t[n++]=i[2];return t}var s=[1,1,1,1],l=t.getRegionPolygonCoords(n);l.forEach((function(t){var n=t.exterior,r=t.interiors;e.addPolyline(a(n),s,i);for(var o=0;o<r.length;o++)e.addPolyline(a(r[o]),s,i)}))},highlight:function(e){var t=this._data;if(t){var n=t.getItemModel(e),r=n.getModel("emphasis.itemStyle"),a=r.get("color"),s=l["a"].firstNotNull(r.get("opacity"),t.getItemVisual(e,"opacity"),1);if(null==a){var u=t.getItemVisual(e,"color");a=i.a.color.lift(u,-.4)}null==s&&(s=t.getItemVisual(e,"opacity"));var c=o["a"].parseColor(a);c[3]*=s,this._setColorOfDataIndex(t,e,c)}},downplay:function(e){var t=this._data;if(t){var n=t.getItemVisual(e,"color"),r=l["a"].firstNotNull(t.getItemVisual(e,"opacity"),1),i=o["a"].parseColor(n);i[3]*=r,this._setColorOfDataIndex(t,e,i)}},_setColorOfDataIndex:function(e,t,n){if(!(t<this._startIndex&&t>this._endIndex)){t-=this._startIndex;for(var r=this._vertexRangeOfDataIndex[2*t];r<this._vertexRangeOfDataIndex[2*t+1];r++)this._polygonMesh.geometry.attributes.color.set(r,n);this._polygonMesh.geometry.dirty(),this._api.getZr().refresh()}}},t["a"]=p},function(e,t,n){"use strict";var r=n(97),i=n(6),o=i["a"].vec3,a=o.create(),s=o.create(),l=o.create();t["a"]={needsSortTriangles:function(){return this.indices&&this.sortTriangles},needsSortTrianglesProgressively:function(){return this.needsSortTriangles()&&this.triangleCount>=2e4},doSortTriangles:function(e,t){var n=this.indices;if(0===t){var r=this.attributes.position;e=e.array;this._triangleZList&&this._triangleZList.length===this.triangleCount||(this._triangleZList=new Float32Array(this.triangleCount),this._sortedTriangleIndices=new Uint32Array(this.triangleCount),this._indicesTmp=new n.constructor(n.length),this._triangleZListTmp=new Float32Array(this.triangleCount));for(var i,u=0,c=0;c<n.length;){r.get(n[c++],a),r.get(n[c++],s),r.get(n[c++],l);var d=o.sqrDist(a,e),f=o.sqrDist(s,e),h=o.sqrDist(l,e),p=Math.min(d,f);p=Math.min(p,h),3===c?(i=p,p=0):p-=i,this._triangleZList[u++]=p}}var m=this._sortedTriangleIndices;for(c=0;c<m.length;c++)m[c]=c;if(this.triangleCount<2e4)0===t&&this._simpleSort(!0);else for(c=0;c<3;c++)this._progressiveQuickSort(3*t+c);var v=this._indicesTmp,g=this._triangleZListTmp,y=this._triangleZList;for(c=0;c<this.triangleCount;c++){var _=3*m[c],x=3*c;v[x++]=n[_++],v[x++]=n[_++],v[x]=n[_],g[c]=y[m[c]]}var b=this._indicesTmp;this._indicesTmp=this.indices,this.indices=b;b=this._triangleZListTmp;this._triangleZListTmp=this._triangleZList,this._triangleZList=b,this.dirtyIndices()},_simpleSort:function(e){var t=this._triangleZList,n=this._sortedTriangleIndices;function i(e,n){return t[n]-t[e]}e?Array.prototype.sort.call(n,i):r["a"].sort(n,i,0,n.length-1)},_progressiveQuickSort:function(e){var t=this._triangleZList,n=this._sortedTriangleIndices;this._quickSort=this._quickSort||new r["a"],this._quickSort.step(n,(function(e,n){return t[n]-t[e]}),e)}}},function(e,t,n){"use strict";var r=n(0),i=n.n(r),o=n(81),a=n(63),s=n(2),l=1,u=2;function c(e,t,n){this._labelsMesh=new a["a"],this._labelTextureSurface=new o["a"]({width:512,height:512,devicePixelRatio:n.getDevicePixelRatio(),onupdate:function(){n.getZr().refresh()}}),this._api=n,this._labelsMesh.material.set("textureAtlas",this._labelTextureSurface.getTexture())}c.prototype.getLabelPosition=function(e,t,n){return[0,0,0]},c.prototype.getLabelDistance=function(e,t,n){return 0},c.prototype.getMesh=function(){return this._labelsMesh},c.prototype.updateData=function(e,t,n){null==t&&(t=0),null==n&&(n=e.count()),this._labelsVisibilitiesBits&&this._labelsVisibilitiesBits.length===n-t||(this._labelsVisibilitiesBits=new Uint8Array(n-t));for(var r=["label","show"],i=["emphasis","label","show"],o=t;o<n;o++){var a=e.getItemModel(o),s=a.get(r),c=a.get(i);null==c&&(c=s);var d=(s?l:0)|(c?u:0);this._labelsVisibilitiesBits[o-t]=d}this._start=t,this._end=n,this._data=e},c.prototype.updateLabels=function(e){if(this._data){e=e||[];for(var t=e.length>0,n={},r=0;r<e.length;r++)n[e[r]]=!0;this._labelsMesh.geometry.convertToDynamicArray(!0),this._labelTextureSurface.clear();for(var o=["label"],a=["emphasis","label"],c=this._data.hostModel,d=this._data,f=c.getModel(o),h=c.getModel(a,f),p={left:"right",right:"left",top:"center",bottom:"center"},m={left:"middle",right:"middle",top:"bottom",bottom:"top"},v=this._start;v<this._end;v++){var g=!1;t&&n[v]&&(g=!0);var y=this._labelsVisibilitiesBits[v-this._start]&(g?u:l);if(y){var _=d.getItemModel(v),x=_.getModel(g?a:o,g?h:f),b=x.get("distance")||0,w=x.get("position"),A=x.getModel("textStyle"),T=this._api.getDevicePixelRatio(),S=c.getFormattedLabel(v,g?"emphasis":"normal");if(null==S||""===S)return;var E=new i.a.graphic.Text;i.a.graphic.setTextStyle(E.style,A,{text:S,textFill:A.get("color")||d.getItemVisual(v,"color")||"#000",textAlign:"left",textVerticalAlign:"top",opacity:s["a"].firstNotNull(A.get("opacity"),d.getItemVisual(v,"opacity"),1)});var C=E.getBoundingRect(),M=1.2;C.height*=M;var L=this._labelTextureSurface.add(E),N=p[w]||"center",D=m[w]||"bottom";this._labelsMesh.geometry.addSprite(this.getLabelPosition(v,w,b),[C.width*T,C.height*T],L,N,D,this.getLabelDistance(v,w,b)*T)}}this._labelsMesh.material.set("uvScale",this._labelTextureSurface.getCoordsScale()),this._labelTextureSurface.getZr().refreshImmediately(),this._labelsMesh.geometry.convertToTypedArray(),this._labelsMesh.geometry.dirty()}},t["a"]=c},function(e,t,n){"use strict";var r=n(0),i=n.n(r),o=n(1),a=n(239),s=n(240),l=n(66),u=n(9),c=n(2),d=20,f=-10;function h(e,t){return e&&t&&e[0]===t[0]&&e[1]===t[1]}function p(e,t){this.rootNode=new o["a"].Node,this.is2D=e,this._labelsBuilder=new l["a"](256,256,t),this._labelsBuilder.getMesh().renderOrder=100,this.rootNode.add(this._labelsBuilder.getMesh()),this._api=t,this._spriteImageCanvas=document.createElement("canvas"),this._startDataIndex=0,this._endDataIndex=0,this._sizeScale=1}p.prototype={constructor:p,highlightOnMouseover:!0,update:function(e,t,n,r,i){var a=this._prevMesh;this._prevMesh=this._mesh,this._mesh=a;var l=e.getData();if(null==r&&(r=0),null==i&&(i=l.count()),this._startDataIndex=r,this._endDataIndex=i-1,!this._mesh){var u=this._prevMesh&&this._prevMesh.material;this._mesh=new s["a"]({renderOrder:10,frustumCulling:!1}),u&&(this._mesh.material=u)}u=this._mesh.material;var c=this._mesh.geometry,d=c.attributes;this.rootNode.remove(this._prevMesh),this.rootNode.add(this._mesh),this._setPositionTextureToMesh(this._mesh,this._positionTexture);var h=this._getSymbolInfo(e,r,i),p=n.getDevicePixelRatio(),m=e.getModel("itemStyle").getItemStyle(),v=e.get("large"),g=1;h.maxSize>2?(g=this._updateSymbolSprite(e,m,h,p),u.enableTexture("sprite")):u.disableTexture("sprite"),d.position.init(i-r);var y=[];if(v){u.undefine("VERTEX_SIZE"),u.undefine("VERTEX_COLOR");var _=l.getVisual("color"),x=l.getVisual("opacity");o["a"].parseColor(_,y),y[3]*=x,u.set({color:y,u_Size:h.maxSize*this._sizeScale})}else u.set({color:[1,1,1,1]}),u.define("VERTEX_SIZE"),u.define("VERTEX_COLOR"),d.size.init(i-r),d.color.init(i-r),this._originalOpacity=new Float32Array(i-r);for(var b=l.getLayout("points"),w=d.position.value,A=0;A<i-r;A++){var T=3*A,S=2*A;if(this.is2D?(w[T]=b[S],w[T+1]=b[S+1],w[T+2]=f):(w[T]=b[T],w[T+1]=b[T+1],w[T+2]=b[T+2]),!v){_=l.getItemVisual(A,"color"),x=l.getItemVisual(A,"opacity");o["a"].parseColor(_,y),y[3]*=x,d.color.set(A,y),y[3]<.99&&!0;var E=l.getItemVisual(A,"symbolSize");E=E instanceof Array?Math.max(E[0],E[1]):E,isNaN(E)&&(E=0),d.size.value[A]=E*g*this._sizeScale,this._originalOpacity[A]=y[3]}}this._mesh.sizeScale=g,c.updateBoundingBox(),c.dirty(),this._updateMaterial(e,m);var C=e.coordinateSystem;if(C&&C.viewGL){var M=C.viewGL.isLinearSpace()?"define":"undefine";u[M]("fragment","SRGB_DECODE")}v||this._updateLabelBuilder(e,r,i),this._updateHandler(e,t,n),this._updateAnimation(e),this._api=n},getPointsMesh:function(){return this._mesh},updateLabels:function(e){this._labelsBuilder.updateLabels(e)},hideLabels:function(){this.rootNode.remove(this._labelsBuilder.getMesh())},showLabels:function(){this.rootNode.add(this._labelsBuilder.getMesh())},_updateSymbolSprite:function(e,t,n,r){n.maxSize=Math.min(2*n.maxSize,200);var i=[];return n.aspect>1?(i[0]=n.maxSize,i[1]=n.maxSize/n.aspect):(i[1]=n.maxSize,i[0]=n.maxSize*n.aspect),i[0]=i[0]||1,i[1]=i[1]||1,this._symbolType===n.type&&h(this._symbolSize,i)&&this._lineWidth===t.lineWidth||(a["a"].createSymbolSprite(n.type,i,{fill:"#fff",lineWidth:t.lineWidth,stroke:"transparent",shadowColor:"transparent",minMargin:Math.min(i[0]/2,10)},this._spriteImageCanvas),a["a"].createSDFFromCanvas(this._spriteImageCanvas,Math.min(this._spriteImageCanvas.width,32),d,this._mesh.material.get("sprite").image),this._symbolType=n.type,this._symbolSize=i,this._lineWidth=t.lineWidth),this._spriteImageCanvas.width/n.maxSize*r},_updateMaterial:function(e,t){var n="lighter"===e.get("blendMode")?o["a"].additiveBlend:null,r=this._mesh.material;r.blend=n,r.set("lineWidth",t.lineWidth/d);var i=o["a"].parseColor(t.stroke);r.set("strokeColor",i),r.transparent=!0,r.depthMask=!1,r.depthTest=!this.is2D,r.sortVertices=!this.is2D},_updateLabelBuilder:function(e,t,n){var r=e.getData(),i=this._mesh.geometry,o=i.attributes.position.value,a=(t=this._startDataIndex,this._mesh.sizeScale);this._labelsBuilder.updateData(r,t,n),this._labelsBuilder.getLabelPosition=function(e,n,r){var i=3*(e-t);return[o[i],o[i+1],o[i+2]]},this._labelsBuilder.getLabelDistance=function(e,n,r){var o=i.attributes.size.get(e-t)/a;return o/2+r},this._labelsBuilder.updateLabels()},_updateAnimation:function(e){o["a"].updateVertexAnimation([["prevPosition","position"],["prevSize","size"]],this._prevMesh,this._mesh,e)},_updateHandler:function(e,t,n){var r,i=e.getData(),o=this._mesh,a=this,s=-1,l=e.coordinateSystem&&"cartesian3D"===e.coordinateSystem.type;l&&(r=e.coordinateSystem.model),o.seriesIndex=e.seriesIndex,o.off("mousemove"),o.off("mouseout"),o.on("mousemove",(function(t){var u=t.vertexIndex+a._startDataIndex;u!==s&&(this.highlightOnMouseover&&(this.downplay(i,s),this.highlight(i,u),this._labelsBuilder.updateLabels([u])),l&&n.dispatchAction({type:"grid3DShowAxisPointer",value:[i.get(e.coordDimToDataDim("x")[0],u),i.get(e.coordDimToDataDim("y")[0],u),i.get(e.coordDimToDataDim("z")[0],u)],grid3DIndex:r.componentIndex})),o.dataIndex=u,s=u}),this),o.on("mouseout",(function(e){var t=e.vertexIndex+a._startDataIndex;this.highlightOnMouseover&&(this.downplay(i,t),this._labelsBuilder.updateLabels()),s=-1,o.dataIndex=-1,l&&n.dispatchAction({type:"grid3DHideAxisPointer",grid3DIndex:r.componentIndex})}),this)},updateLayout:function(e,t,n){var r=e.getData();if(this._mesh){var i=this._mesh.geometry.attributes.position.value,o=r.getLayout("points");if(this.is2D)for(var a=0;a<o.length/2;a++){var s=3*a,l=2*a;i[s]=o[l],i[s+1]=o[l+1],i[s+2]=f}else for(a=0;a<o.length;a++)i[a]=o[a];this._mesh.geometry.dirty(),n.getZr().refresh()}},updateView:function(e){if(this._mesh){var t=new u["a"];u["a"].mul(t,e.viewMatrix,this._mesh.worldTransform),u["a"].mul(t,e.projectionMatrix,t),this._mesh.updateNDCPosition(t,this.is2D,this._api)}},highlight:function(e,t){if(!(t>this._endDataIndex||t<this._startDataIndex)){var n=e.getItemModel(t),r=n.getModel("emphasis.itemStyle"),a=r.get("color"),s=r.get("opacity");if(null==a){var l=e.getItemVisual(t,"color");a=i.a.color.lift(l,-.4)}null==s&&(s=e.getItemVisual(t,"opacity"));var u=o["a"].parseColor(a);u[3]*=s,this._mesh.geometry.attributes.color.set(t-this._startDataIndex,u),this._mesh.geometry.dirtyAttribute("color"),this._api.getZr().refresh()}},downplay:function(e,t){if(!(t>this._endDataIndex||t<this._startDataIndex)){var n=e.getItemVisual(t,"color"),r=e.getItemVisual(t,"opacity"),i=o["a"].parseColor(n);i[3]*=r,this._mesh.geometry.attributes.color.set(t-this._startDataIndex,i),this._mesh.geometry.dirtyAttribute("color"),this._api.getZr().refresh()}},fadeOutAll:function(e){if(this._originalOpacity){for(var t=this._mesh.geometry,n=0;n<t.vertexCount;n++){var r=this._originalOpacity[n]*e;t.attributes.color.value[4*n+3]=r}t.dirtyAttribute("color"),this._api.getZr().refresh()}},fadeInAll:function(){this.fadeOutAll(1)},setPositionTexture:function(e){this._mesh&&this._setPositionTextureToMesh(this._mesh,e),this._positionTexture=e},removePositionTexture:function(){this._positionTexture=null,this._mesh&&this._setPositionTextureToMesh(this._mesh,null)},setSizeScale:function(e){if(e!==this._sizeScale){if(this._mesh){var t=this._mesh.material.get("u_Size");this._mesh.material.set("u_Size",t/this._sizeScale*e);var n=this._mesh.geometry.attributes;if(n.size.value)for(var r=0;r<n.size.value.length;r++)n.size.value[r]=n.size.value[r]/this._sizeScale*e}this._sizeScale=e}},_setPositionTextureToMesh:function(e,t){t&&e.material.set("positionTexture",t),e.material[t?"enableTexture":"disableTexture"]("positionTexture")},_getSymbolInfo:function(e,t,n){if(e.get("large")){var r=c["a"].firstNotNull(e.get("symbolSize"),1);return r instanceof Array?(u=Math.max(r[0],r[1]),i=r[0]/r[1]):(u=r,i=1),{maxSize:r,type:e.get("symbol"),aspect:i}}for(var i,o=e.getData(),a=!1,s=o.getItemVisual(0,"symbol")||"circle",l=!1,u=0,d=t;d<n;d++){r=o.getItemVisual(d,"symbolSize");var f,h=o.getItemVisual(d,"symbol");if(r instanceof Array)f=r[0]/r[1],u=Math.max(Math.max(r[0],r[1]),u);else{if(isNaN(r))return;f=1,u=Math.max(r,u)}null!=i&&Math.abs(f-i)>.05&&(a=!0),h!==s&&(l=!0),s=h,i=f}return a&&console.warn("Different symbol width / height ratio will be ignored."),l&&console.warn("Different symbol type will be ignored."),{maxSize:u,type:s,aspect:i}}},t["a"]=p},function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(r){"object"===typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";var r=n(114),i=function(e){this._list=new r["a"],this._map={},this._maxSize=e||10};i.prototype.setMaxSize=function(e){this._maxSize=e},i.prototype.put=function(e,t){if(!this._map.hasOwnProperty(e)){var n=this._list.length();if(n>=this._maxSize&&n>0){var r=this._list.head;this._list.remove(r),delete this._map[r.key]}var i=this._list.insert(t);i.key=e,this._map[e]=i}},i.prototype.get=function(e){var t=this._map[e];if(this._map.hasOwnProperty(e))return t!==this._list.tail&&(this._list.remove(t),this._list.insertEntry(t)),t.value},i.prototype.remove=function(e){var t=this._map[e];"undefined"!==typeof t&&(delete this._map[e],this._list.remove(t))},i.prototype.clear=function(){this._list.clear(),this._map={}},t["a"]=i},function(e,t,n){"use strict";var r=n(20),i={create:function(){var e=new r["a"](2);return e[0]=0,e[1]=0,e},clone:function(e){var t=new r["a"](2);return t[0]=e[0],t[1]=e[1],t},fromValues:function(e,t){var n=new r["a"](2);return n[0]=e,n[1]=t,n},copy:function(e,t){return e[0]=t[0],e[1]=t[1],e},set:function(e,t,n){return e[0]=t,e[1]=n,e},add:function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e},subtract:function(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e}};i.sub=i.subtract,i.multiply=function(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e},i.mul=i.multiply,i.divide=function(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e},i.div=i.divide,i.min=function(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e},i.max=function(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e},i.scale=function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e},i.scaleAndAdd=function(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e},i.distance=function(e,t){var n=t[0]-e[0],r=t[1]-e[1];return Math.sqrt(n*n+r*r)},i.dist=i.distance,i.squaredDistance=function(e,t){var n=t[0]-e[0],r=t[1]-e[1];return n*n+r*r},i.sqrDist=i.squaredDistance,i.length=function(e){var t=e[0],n=e[1];return Math.sqrt(t*t+n*n)},i.len=i.length,i.squaredLength=function(e){var t=e[0],n=e[1];return t*t+n*n},i.sqrLen=i.squaredLength,i.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e},i.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e},i.normalize=function(e,t){var n=t[0],r=t[1],i=n*n+r*r;return i>0&&(i=1/Math.sqrt(i),e[0]=t[0]*i,e[1]=t[1]*i),e},i.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]},i.cross=function(e,t,n){var r=t[0]*n[1]-t[1]*n[0];return e[0]=e[1]=0,e[2]=r,e},i.lerp=function(e,t,n,r){var i=t[0],o=t[1];return e[0]=i+r*(n[0]-i),e[1]=o+r*(n[1]-o),e},i.random=function(e,t){t=t||1;var n=2*GLMAT_RANDOM()*Math.PI;return e[0]=Math.cos(n)*t,e[1]=Math.sin(n)*t,e},i.transformMat2=function(e,t,n){var r=t[0],i=t[1];return e[0]=n[0]*r+n[2]*i,e[1]=n[1]*r+n[3]*i,e},i.transformMat2d=function(e,t,n){var r=t[0],i=t[1];return e[0]=n[0]*r+n[2]*i+n[4],e[1]=n[1]*r+n[3]*i+n[5],e},i.transformMat3=function(e,t,n){var r=t[0],i=t[1];return e[0]=n[0]*r+n[3]*i+n[6],e[1]=n[1]*r+n[4]*i+n[7],e},i.transformMat4=function(e,t,n){var r=t[0],i=t[1];return e[0]=n[0]*r+n[4]*i+n[12],e[1]=n[1]*r+n[5]*i+n[13],e},i.forEach=function(){var e=i.create();return function(t,n,r,i,o,a){var s,l;for(n||(n=2),r||(r=0),l=i?Math.min(i*n+r,t.length):t.length,s=r;s<l;s+=n)e[0]=t[s],e[1]=t[s+1],o(e,e,a),t[s]=e[0],t[s+1]=e[1];return t}}(),t["a"]=i},function(e,t,n){"use strict";t["a"]="@export clay.prez.vertex\nuniform mat4 WVP : WORLDVIEWPROJECTION;\nattribute vec3 pos : POSITION;\nattribute vec2 uv : TEXCOORD_0;\n@import clay.chunk.skinning_header\nvarying vec2 v_Texcoord;\nvoid main()\n{\n vec3 P = pos;\n#ifdef SKINNING\n @import clay.chunk.skin_matrix\n P = (skinMatrixWS * vec4(pos, 1.0)).xyz;\n#endif\n gl_Position = WVP * vec4(P, 1.0);\n v_Texcoord = uv;\n}\n@end\n@export clay.prez.fragment\nuniform sampler2D alphaMap;\nuniform float alphaCutoff: 0.0;\nvarying vec2 v_Texcoord;\nvoid main()\n{\n if (alphaCutoff > 0.0) {\n if (texture2D(alphaMap, v_Texcoord).a <= alphaCutoff) {\n discard;\n }\n }\n gl_FragColor = vec4(0.0,0.0,0.0,1.0);\n}\n@end"},function(e,t,n){"use strict";var r=n(35),i=n(11),o=r["a"].extend({material:null,geometry:null,mode:i["a"].TRIANGLES,_renderInfo:null},{__program:null,lightGroup:0,renderOrder:0,culling:!0,cullFace:i["a"].BACK,frontFace:i["a"].CCW,frustumCulling:!0,receiveShadow:!0,castShadow:!0,ignorePicking:!1,ignorePreZ:!1,ignoreGBuffer:!1,isRenderable:function(){return this.geometry&&this.material&&this.material.shader&&!this.invisible&&this.geometry.vertexCount>0},beforeRender:function(e){},afterRender:function(e,t){},getBoundingBox:function(e,t){return t=r["a"].prototype.getBoundingBox.call(this,e,t),this.geometry&&this.geometry.boundingBox&&t.union(this.geometry.boundingBox),t},clone:function(){var e=["castShadow","receiveShadow","mode","culling","cullFace","frontFace","frustumCulling","renderOrder","lineWidth","ignorePicking","ignorePreZ","ignoreGBuffer"];return function(){var t=r["a"].prototype.clone.call(this);t.geometry=this.geometry,t.material=this.material;for(var n=0;n<e.length;n++){var i=e[n];t[i]!==this[i]&&(t[i]=this[i])}return t}}()});o.POINTS=i["a"].POINTS,o.LINES=i["a"].LINES,o.LINE_LOOP=i["a"].LINE_LOOP,o.LINE_STRIP=i["a"].LINE_STRIP,o.TRIANGLES=i["a"].TRIANGLES,o.TRIANGLE_STRIP=i["a"].TRIANGLE_STRIP,o.TRIANGLE_FAN=i["a"].TRIANGLE_FAN,o.BACK=i["a"].BACK,o.FRONT=i["a"].FRONT,o.FRONT_AND_BACK=i["a"].FRONT_AND_BACK,o.CW=i["a"].CW,o.CCW=i["a"].CCW,t["a"]=o},function(e,t,n){"use strict";var r={isPowerOfTwo:function(e){return 0===(e&e-1)},nextPowerOfTwo:function(e){return e--,e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,e|=e>>16,e++,e},nearestPowerOfTwo:function(e){return Math.pow(2,Math.round(Math.log(e)/Math.LN2))}};t["a"]=r},function(e,t,n){"use strict";var r=n(3),i=n(21),o=n(12),a=n(33),s=function(e,t){this.normal=e||new r["a"](0,1,0),this.distance=t||0};s.prototype={constructor:s,distanceToPoint:function(e){return o["a"].dot(e.array,this.normal.array)-this.distance},projectPoint:function(e,t){t||(t=new r["a"]);var n=this.distanceToPoint(e);return o["a"].scaleAndAdd(t.array,e.array,this.normal.array,-n),t._dirty=!0,t},normalize:function(){var e=1/o["a"].len(this.normal.array);o["a"].scale(this.normal.array,e),this.distance*=e},intersectFrustum:function(e){for(var t=e.vertices,n=this.normal.array,r=o["a"].dot(t[0].array,n)>this.distance,i=1;i<8;i++)if(o["a"].dot(t[i].array,n)>this.distance!=r)return!0},intersectLine:function(){var e=o["a"].create();return function(t,n,i){var a=this.distanceToPoint(t),s=this.distanceToPoint(n);if(a>0&&s>0||a<0&&s<0)return null;var l=this.normal.array,u=this.distance,c=t.array;o["a"].sub(e,n.array,t.array),o["a"].normalize(e,e);var d=o["a"].dot(l,e);if(0===d)return null;i||(i=new r["a"]);var f=(o["a"].dot(l,c)-u)/d;return o["a"].scaleAndAdd(i.array,c,e,-f),i._dirty=!0,i}}(),applyTransform:function(){var e=i["a"].create(),t=a["a"].create(),n=a["a"].create();return n[3]=1,function(r){r=r.array,o["a"].scale(n,this.normal.array,this.distance),a["a"].transformMat4(n,n,r),this.distance=o["a"].dot(n,this.normal.array),i["a"].invert(e,r),i["a"].transpose(e,e),t[3]=0,o["a"].copy(t,this.normal.array),a["a"].transformMat4(t,t,e),o["a"].copy(this.normal.array,t)}}(),copy:function(e){o["a"].copy(this.normal.array,e.normal.array),this.normal._dirty=!0,this.distance=e.distance},clone:function(){var e=new s;return e.copy(this),e}},t["a"]=s},function(e,t,n){"use strict";var r=n(42);t["a"]=r["a"]},function(e,t,n){"use strict";var r=n(15),i=n(43),o=n(9),a=n(3),s=n(18),l=n(14),u=new o["a"],c=r["a"].extend({dynamic:!1,widthSegments:1,heightSegments:1,depthSegments:1,inside:!1},(function(){this.build()}),{build:function(){var e={px:d("px",this.depthSegments,this.heightSegments),nx:d("nx",this.depthSegments,this.heightSegments),py:d("py",this.widthSegments,this.depthSegments),ny:d("ny",this.widthSegments,this.depthSegments),pz:d("pz",this.widthSegments,this.heightSegments),nz:d("nz",this.widthSegments,this.heightSegments)},t=["position","texcoord0","normal"],n=0,r=0;for(var i in e)n+=e[i].vertexCount,r+=e[i].indices.length;for(var o=0;o<t.length;o++)this.attributes[t[o]].init(n);this.indices=new l["a"].Uint16Array(r);var a=0,u=0;for(var i in e){var c=e[i];for(o=0;o<t.length;o++)for(var f=t[o],h=c.attributes[f].value,p=c.attributes[f].size,m="normal"===f,v=0;v<h.length;v++){var g=h[v];this.inside&&m&&(g=-g),this.attributes[f].value[v+p*u]=g}var y=c.indices.length;for(v=0;v<c.indices.length;v++)this.indices[v+a]=u+c.indices[this.inside?y-v-1:v];a+=c.indices.length,u+=c.vertexCount}this.boundingBox=new s["a"],this.boundingBox.max.set(1,1,1),this.boundingBox.min.set(-1,-1,-1)}});function d(e,t,n){u.identity();var r=new i["a"]({widthSegments:t,heightSegments:n});switch(e){case"px":o["a"].translate(u,u,a["a"].POSITIVE_X),o["a"].rotateY(u,u,Math.PI/2);break;case"nx":o["a"].translate(u,u,a["a"].NEGATIVE_X),o["a"].rotateY(u,u,-Math.PI/2);break;case"py":o["a"].translate(u,u,a["a"].POSITIVE_Y),o["a"].rotateX(u,u,-Math.PI/2);break;case"ny":o["a"].translate(u,u,a["a"].NEGATIVE_Y),o["a"].rotateX(u,u,Math.PI/2);break;case"pz":o["a"].translate(u,u,a["a"].POSITIVE_Z);break;case"nz":o["a"].translate(u,u,a["a"].NEGATIVE_Z),o["a"].rotateY(u,u,Math.PI);break}return r.applyTransform(u),r}t["a"]=c},function(e,t,n){"use strict";var r=n(5),i=n(27),o=n(4),a=n(10),s=n(16),l=n(19),u=n(8),c=n(42),d=n(36),f=n(62),h=n(14),p=n(61),m=n(127),v=n(128),g={},y=["px","nx","py","ny","pz","nz"];g.prefilterEnvironmentMap=function(e,t,n,s,m){m&&s||(s=g.generateNormalDistribution(),m=g.integrateBRDF(e,s)),n=n||{};var _=n.width||64,x=n.height||64,b=n.type||t.type,w=new i["a"]({width:_,height:x,type:b,flipY:!1,mipmaps:[]});w.isPowerOfTwo()||console.warn("Width and height must be power of two to enable mipmap.");var A=Math.min(_,x),T=Math.log(A)/Math.log(2)+1,S=new l["a"]({shader:new u["a"]({vertex:u["a"].source("clay.skybox.vertex"),fragment:v["a"]})});S.set("normalDistribution",s),n.encodeRGBM&&S.define("fragment","RGBM_ENCODE"),n.decodeRGBM&&S.define("fragment","RGBM_DECODE");var E,C=new d["a"];if("texture2D"===t.textureType){var M=new i["a"]({width:_,height:x,type:b===o["a"].FLOAT?o["a"].HALF_FLOAT:b});p["a"].panoramaToCubeMap(e,t,M,{encodeRGBM:n.decodeRGBM}),t=M}E=new c["a"]({scene:C,material:S}),E.material.set("environmentMap",t);var L=new f["a"]({texture:w});n.encodeRGBM&&(b=w.type=o["a"].UNSIGNED_BYTE);for(var N=new r["a"]({width:_,height:x,type:b}),D=new a["a"]({depthBuffer:!1}),O=h["a"][b===o["a"].UNSIGNED_BYTE?"Uint8Array":"Float32Array"],I=0;I<T;I++){w.mipmaps[I]={pixels:{}},E.material.set("roughness",I/(T-1));for(var R=N.width,P=2*Math.atan(R/(R-.5))/Math.PI*180,k=0;k<y.length;k++){var B=new O(N.width*N.height*4);D.attach(N),D.bind(e);var F=L.getCamera(y[k]);F.fov=P,e.render(C,F),e.gl.readPixels(0,0,N.width,N.height,o["a"].RGBA,b,B),D.unbind(e),w.mipmaps[I].pixels[y[k]]=B}N.width/=2,N.height/=2,N.dirty()}return D.dispose(e),N.dispose(e),E.dispose(e),s.dispose(e),{environmentMap:w,brdfLookup:m,normalDistribution:s,maxMipmapLevel:T}},g.integrateBRDF=function(e,t){t=t||g.generateNormalDistribution();var n=new a["a"]({depthBuffer:!1}),i=new s["a"]({fragment:m["a"]}),l=new r["a"]({width:512,height:256,type:o["a"].HALF_FLOAT,wrapS:o["a"].CLAMP_TO_EDGE,wrapT:o["a"].CLAMP_TO_EDGE,minFilter:o["a"].NEAREST,magFilter:o["a"].NEAREST,useMipmap:!1});return i.setUniform("normalDistribution",t),i.setUniform("viewportSize",[512,256]),i.attachOutput(l),i.render(e,n),n.dispose(e),l},g.generateNormalDistribution=function(e,t){e=e||256,t=t||1024;for(var n=new r["a"]({width:e,height:t,type:o["a"].FLOAT,minFilter:o["a"].NEAREST,magFilter:o["a"].NEAREST,wrapS:o["a"].CLAMP_TO_EDGE,wrapT:o["a"].CLAMP_TO_EDGE,useMipmap:!1}),i=new Float32Array(t*e*4),a=[],s=0;s<e;s++){for(var l=s/e,u=l*l,c=0;c<t;c++){var d=(c<<16|c>>>16)>>>0;d=((1431655765&d)<<1|(2863311530&d)>>>1)>>>0,d=((858993459&d)<<2|(3435973836&d)>>>2)>>>0,d=((252645135&d)<<4|(4042322160&d)>>>4)>>>0,d=(((16711935&d)<<8|(4278255360&d)>>>8)>>>0)/4294967296;var f=Math.sqrt((1-d)/(1+(u*u-1)*d));a[c]=f}for(c=0;c<t;c++){var h=4*(c*e+s),p=(f=a[c],Math.sqrt(1-f*f)),m=c/t,v=2*Math.PI*m;i[h]=p*Math.cos(v),i[h+1]=f,i[h+2]=p*Math.sin(v),i[h+3]=1}}return n.pixels=i,n},t["a"]=g},function(e,t,n){"use strict";var r=n(20),i={create:function(){var e=new r["a"](4);return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e},clone:function(e){var t=new r["a"](4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},copy:function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},identity:function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e},transpose:function(e,t){if(e===t){var n=t[1];e[1]=t[2],e[2]=n}else e[0]=t[0],e[1]=t[2],e[2]=t[1],e[3]=t[3];return e},invert:function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=n*o-i*r;return a?(a=1/a,e[0]=o*a,e[1]=-r*a,e[2]=-i*a,e[3]=n*a,e):null},adjoint:function(e,t){var n=t[0];return e[0]=t[3],e[1]=-t[1],e[2]=-t[2],e[3]=n,e},determinant:function(e){return e[0]*e[3]-e[2]*e[1]},multiply:function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=n[0],l=n[1],u=n[2],c=n[3];return e[0]=r*s+o*l,e[1]=i*s+a*l,e[2]=r*u+o*c,e[3]=i*u+a*c,e}};i.mul=i.multiply,i.rotate=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=Math.sin(n),l=Math.cos(n);return e[0]=r*l+o*s,e[1]=i*l+a*s,e[2]=r*-s+o*l,e[3]=i*-s+a*l,e},i.scale=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=n[0],l=n[1];return e[0]=r*s,e[1]=i*s,e[2]=o*l,e[3]=a*l,e},i.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2))},i.LDU=function(e,t,n,r){return e[2]=r[2]/r[0],n[0]=r[0],n[1]=r[1],n[3]=r[3]-e[2]*n[1],[e,t,n]},t["a"]=i},function(e,t,n){"use strict";var r=n(20),i={create:function(){var e=new r["a"](6);return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e},clone:function(e){var t=new r["a"](6);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},copy:function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},identity:function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e},invert:function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],l=n*o-r*i;return l?(l=1/l,e[0]=o*l,e[1]=-r*l,e[2]=-i*l,e[3]=n*l,e[4]=(i*s-o*a)*l,e[5]=(r*a-n*s)*l,e):null},determinant:function(e){return e[0]*e[3]-e[1]*e[2]},multiply:function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=t[4],l=t[5],u=n[0],c=n[1],d=n[2],f=n[3],h=n[4],p=n[5];return e[0]=r*u+o*c,e[1]=i*u+a*c,e[2]=r*d+o*f,e[3]=i*d+a*f,e[4]=r*h+o*p+s,e[5]=i*h+a*p+l,e}};i.mul=i.multiply,i.rotate=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=t[4],l=t[5],u=Math.sin(n),c=Math.cos(n);return e[0]=r*c+o*u,e[1]=i*c+a*u,e[2]=r*-u+o*c,e[3]=i*-u+a*c,e[4]=s,e[5]=l,e},i.scale=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=t[4],l=t[5],u=n[0],c=n[1];return e[0]=r*u,e[1]=i*u,e[2]=o*c,e[3]=a*c,e[4]=s,e[5]=l,e},i.translate=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=t[4],l=t[5],u=n[0],c=n[1];return e[0]=r,e[1]=i,e[2]=o,e[3]=a,e[4]=r*u+o*c+s,e[5]=i*u+a*c+l,e},i.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+1)},t["a"]=i},function(e,t){var n="undefined"!==typeof window&&(window.requestAnimationFrame&&window.requestAnimationFrame.bind(window)||window.msRequestAnimationFrame&&window.msRequestAnimationFrame.bind(window)||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame)||function(e){setTimeout(e,16)};e.exports=n},function(e,t,n){"use strict";var r=n(0),i=n.n(r),o=n(5);function a(e,t,n,r,i,o,a){this._zr=e,this._x=0,this._y=0,this._rowHeight=0,this.width=r,this.height=i,this.offsetX=t,this.offsetY=n,this.dpr=a,this.gap=o}function s(e){e=e||{},e.width=e.width||512,e.height=e.height||512,e.devicePixelRatio=e.devicePixelRatio||1,e.gap=null==e.gap?2:e.gap;var t=document.createElement("canvas");t.width=e.width*e.devicePixelRatio,t.height=e.height*e.devicePixelRatio,this._canvas=t,this._texture=new o["a"]({image:t,flipY:!1});var n=this;this._zr=i.a.zrender.init(t);var r=this._zr.refreshImmediately;this._zr.refreshImmediately=function(){r.call(this),n._texture.dirty(),n.onupdate&&n.onupdate()},this._dpr=e.devicePixelRatio,this._coords={},this.onupdate=e.onupdate,this._gap=e.gap,this._textureAtlasNodes=[new a(this._zr,0,0,e.width,e.height,this._gap,this._dpr)],this._nodeWidth=e.width,this._nodeHeight=e.height,this._currentNodeIdx=0}a.prototype={constructor:a,clear:function(){this._x=0,this._y=0,this._rowHeight=0},add:function(e,t,n){var r=e.getBoundingRect();null==t&&(t=r.width),null==n&&(n=r.height),t*=this.dpr,n*=this.dpr,this._fitElement(e,t,n);var i=this._x,o=this._y,a=this.width*this.dpr,s=this.height*this.dpr,l=this.gap;if(i+t+l>a&&(i=this._x=0,o+=this._rowHeight+l,this._y=o,this._rowHeight=0),this._x+=t+l,this._rowHeight=Math.max(this._rowHeight,n),o+n+l>s)return null;e.position[0]+=this.offsetX*this.dpr+i,e.position[1]+=this.offsetY*this.dpr+o,this._zr.add(e);var u=[this.offsetX/this.width,this.offsetY/this.height],c=[[i/a+u[0],o/s+u[1]],[(i+t)/a+u[0],(o+n)/s+u[1]]];return c},_fitElement:function(e,t,n){var r=e.getBoundingRect(),i=t/r.width,o=n/r.height;e.position=[-r.x*i,-r.y*o],e.scale=[i,o],e.update()}},s.prototype={clear:function(){for(var e=0;e<this._textureAtlasNodes.length;e++)this._textureAtlasNodes[e].clear();this._currentNodeIdx=0,this._zr.clear(),this._coords={}},getWidth:function(){return this._width},getHeight:function(){return this._height},getTexture:function(){return this._texture},getDevicePixelRatio:function(){return this._dpr},getZr:function(){return this._zr},_getCurrentNode:function(){return this._textureAtlasNodes[this._currentNodeIdx]},_expand:function(){if(this._currentNodeIdx++,this._textureAtlasNodes[this._currentNodeIdx])return this._textureAtlasNodes[this._currentNodeIdx];var e=4096/this._dpr,t=this._textureAtlasNodes,n=t.length,r=n*this._nodeWidth%e,i=Math.floor(n*this._nodeWidth/e)*this._nodeHeight;if(!(i>=e)){var o=(r+this._nodeWidth)*this._dpr,s=(i+this._nodeHeight)*this._dpr;try{this._zr.resize({width:o,height:s})}catch(u){this._canvas.width=o,this._canvas.height=s}var l=new a(this._zr,r,i,this._nodeWidth,this._nodeHeight,this._gap,this._dpr);return this._textureAtlasNodes.push(l),l}console.error("Too much labels. Some will be ignored.")},add:function(e,t,n){if(this._coords[e.id])return console.warn("Element already been add"),this._coords[e.id];var r=this._getCurrentNode().add(e,t,n);if(!r){var i=this._expand();if(!i)return;r=i.add(e,t,n)}return this._coords[e.id]=r,r},getCoordsScale:function(){var e=this._dpr;return[this._nodeWidth/this._canvas.width*e,this._nodeHeight/this._canvas.height*e]},getCoords:function(e){return this._coords[e]}},t["a"]=s},function(e,t,n){var r=n(83),i=n(84),o=r.applyTransform,a=Math.min,s=Math.max;function l(e,t,n,r){n<0&&(e+=n,n=-n),r<0&&(t+=r,r=-r),this.x=e,this.y=t,this.width=n,this.height=r}l.prototype={constructor:l,union:function(e){var t=a(e.x,this.x),n=a(e.y,this.y);this.width=s(e.x+e.width,this.x+this.width)-t,this.height=s(e.y+e.height,this.y+this.height)-n,this.x=t,this.y=n},applyTransform:function(){var e=[],t=[],n=[],r=[];return function(i){if(i){e[0]=n[0]=this.x,e[1]=r[1]=this.y,t[0]=r[0]=this.x+this.width,t[1]=n[1]=this.y+this.height,o(e,e,i),o(t,t,i),o(n,n,i),o(r,r,i),this.x=a(e[0],t[0],n[0],r[0]),this.y=a(e[1],t[1],n[1],r[1]);var l=s(e[0],t[0],n[0],r[0]),u=s(e[1],t[1],n[1],r[1]);this.width=l-this.x,this.height=u-this.y}}}(),calculateTransform:function(e){var t=this,n=e.width/t.width,r=e.height/t.height,o=i.create();return i.translate(o,o,[-t.x,-t.y]),i.scale(o,o,[n,r]),i.translate(o,o,[e.x,e.y]),o},intersect:function(e){if(!e)return!1;e instanceof l||(e=l.create(e));var t=this,n=t.x,r=t.x+t.width,i=t.y,o=t.y+t.height,a=e.x,s=e.x+e.width,u=e.y,c=e.y+e.height;return!(r<a||s<n||o<u||c<i)},contain:function(e,t){var n=this;return e>=n.x&&e<=n.x+n.width&&t>=n.y&&t<=n.y+n.height},clone:function(){return new l(this.x,this.y,this.width,this.height)},copy:function(e){this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height},plain:function(){return{x:this.x,y:this.y,width:this.width,height:this.height}}},l.create=function(e){return new l(e.x,e.y,e.width,e.height)};var u=l;e.exports=u},function(e,t){var n="undefined"===typeof Float32Array?Array:Float32Array;function r(e,t){var r=new n(2);return null==e&&(e=0),null==t&&(t=0),r[0]=e,r[1]=t,r}function i(e,t){return e[0]=t[0],e[1]=t[1],e}function o(e){var t=new n(2);return t[0]=e[0],t[1]=e[1],t}function a(e,t,n){return e[0]=t,e[1]=n,e}function s(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e}function l(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e}function u(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e}function c(e){return Math.sqrt(f(e))}var d=c;function f(e){return e[0]*e[0]+e[1]*e[1]}var h=f;function p(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e}function m(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e}function v(e,t){return e[0]*t[0]+e[1]*t[1]}function g(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e}function y(e,t){var n=c(t);return 0===n?(e[0]=0,e[1]=0):(e[0]=t[0]/n,e[1]=t[1]/n),e}function _(e,t){return Math.sqrt((e[0]-t[0])*(e[0]-t[0])+(e[1]-t[1])*(e[1]-t[1]))}var x=_;function b(e,t){return(e[0]-t[0])*(e[0]-t[0])+(e[1]-t[1])*(e[1]-t[1])}var w=b;function A(e,t){return e[0]=-t[0],e[1]=-t[1],e}function T(e,t,n,r){return e[0]=t[0]+r*(n[0]-t[0]),e[1]=t[1]+r*(n[1]-t[1]),e}function S(e,t,n){var r=t[0],i=t[1];return e[0]=n[0]*r+n[2]*i+n[4],e[1]=n[1]*r+n[3]*i+n[5],e}function E(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e}function C(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e}t.create=r,t.copy=i,t.clone=o,t.set=a,t.add=s,t.scaleAndAdd=l,t.sub=u,t.len=c,t.length=d,t.lenSquare=f,t.lengthSquare=h,t.mul=p,t.div=m,t.dot=v,t.scale=g,t.normalize=y,t.distance=_,t.dist=x,t.distanceSquare=b,t.distSquare=w,t.negate=A,t.lerp=T,t.applyTransform=S,t.min=E,t.max=C},function(e,t){var n="undefined"===typeof Float32Array?Array:Float32Array;function r(){var e=new n(6);return i(e),e}function i(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e}function o(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e}function a(e,t,n){var r=t[0]*n[0]+t[2]*n[1],i=t[1]*n[0]+t[3]*n[1],o=t[0]*n[2]+t[2]*n[3],a=t[1]*n[2]+t[3]*n[3],s=t[0]*n[4]+t[2]*n[5]+t[4],l=t[1]*n[4]+t[3]*n[5]+t[5];return e[0]=r,e[1]=i,e[2]=o,e[3]=a,e[4]=s,e[5]=l,e}function s(e,t,n){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4]+n[0],e[5]=t[5]+n[1],e}function l(e,t,n){var r=t[0],i=t[2],o=t[4],a=t[1],s=t[3],l=t[5],u=Math.sin(n),c=Math.cos(n);return e[0]=r*c+a*u,e[1]=-r*u+a*c,e[2]=i*c+s*u,e[3]=-i*u+c*s,e[4]=c*o+u*l,e[5]=c*l-u*o,e}function u(e,t,n){var r=n[0],i=n[1];return e[0]=t[0]*r,e[1]=t[1]*i,e[2]=t[2]*r,e[3]=t[3]*i,e[4]=t[4]*r,e[5]=t[5]*i,e}function c(e,t){var n=t[0],r=t[2],i=t[4],o=t[1],a=t[3],s=t[5],l=n*a-o*r;return l?(l=1/l,e[0]=a*l,e[1]=-o*l,e[2]=-r*l,e[3]=n*l,e[4]=(r*s-a*i)*l,e[5]=(o*i-n*s)*l,e):null}function d(e){var t=r();return o(t,e),t}t.create=r,t.identity=i,t.copy=o,t.mul=a,t.translate=s,t.rotate=l,t.scale=u,t.invert=c,t.clone=d},function(e,t,n){var r=n(13),i=1e-4;function o(e){return e.replace(/^\s+/,"").replace(/\s+$/,"")}function a(e,t,n,r){var i=t[1]-t[0],o=n[1]-n[0];if(0===i)return 0===o?n[0]:(n[0]+n[1])/2;if(r)if(i>0){if(e<=t[0])return n[0];if(e>=t[1])return n[1]}else{if(e>=t[0])return n[0];if(e<=t[1])return n[1]}else{if(e===t[0])return n[0];if(e===t[1])return n[1]}return(e-t[0])/i*o+n[0]}function s(e,t){switch(e){case"center":case"middle":e="50%";break;case"left":case"top":e="0%";break;case"right":case"bottom":e="100%";break}return"string"===typeof e?o(e).match(/%$/)?parseFloat(e)/100*t:parseFloat(e):null==e?NaN:+e}function l(e,t,n){return null==t&&(t=10),t=Math.min(Math.max(0,t),20),e=(+e).toFixed(t),n?e:+e}function u(e){return e.sort((function(e,t){return e-t})),e}function c(e){if(e=+e,isNaN(e))return 0;var t=1,n=0;while(Math.round(e*t)/t!==e)t*=10,n++;return n}function d(e){var t=e.toString(),n=t.indexOf("e");if(n>0){var r=+t.slice(n+1);return r<0?-r:0}var i=t.indexOf(".");return i<0?0:t.length-1-i}function f(e,t){var n=Math.log,r=Math.LN10,i=Math.floor(n(e[1]-e[0])/r),o=Math.round(n(Math.abs(t[1]-t[0]))/r),a=Math.min(Math.max(-i+o,0),20);return isFinite(a)?a:20}function h(e,t,n){if(!e[t])return 0;var i=r.reduce(e,(function(e,t){return e+(isNaN(t)?0:t)}),0);if(0===i)return 0;var o=Math.pow(10,n),a=r.map(e,(function(e){return(isNaN(e)?0:e)/i*o*100})),s=100*o,l=r.map(a,(function(e){return Math.floor(e)})),u=r.reduce(l,(function(e,t){return e+t}),0),c=r.map(a,(function(e,t){return e-l[t]}));while(u<s){for(var d=Number.NEGATIVE_INFINITY,f=null,h=0,p=c.length;h<p;++h)c[h]>d&&(d=c[h],f=h);++l[f],c[f]=0,++u}return l[t]/o}var p=9007199254740991;function m(e){var t=2*Math.PI;return(e%t+t)%t}function v(e){return e>-i&&e<i}var g=/^(?:(\d{4})(?:[-\/](\d{1,2})(?:[-\/](\d{1,2})(?:[T ](\d{1,2})(?::(\d\d)(?::(\d\d)(?:[.,](\d+))?)?)?(Z|[\+\-]\d\d:?\d\d)?)?)?)?)?$/;function y(e){if(e instanceof Date)return e;if("string"===typeof e){var t=g.exec(e);if(!t)return new Date(NaN);if(t[8]){var n=+t[4]||0;return"Z"!==t[8].toUpperCase()&&(n-=t[8].slice(0,3)),new Date(Date.UTC(+t[1],+(t[2]||1)-1,+t[3]||1,n,+(t[5]||0),+t[6]||0,+t[7]||0))}return new Date(+t[1],+(t[2]||1)-1,+t[3]||1,+t[4]||0,+(t[5]||0),+t[6]||0,+t[7]||0)}return null==e?new Date(NaN):new Date(Math.round(e))}function _(e){return Math.pow(10,x(e))}function x(e){return Math.floor(Math.log(e)/Math.LN10)}function b(e,t){var n,r=x(e),i=Math.pow(10,r),o=e/i;return n=t?o<1.5?1:o<2.5?2:o<4?3:o<7?5:10:o<1?1:o<2?2:o<3?3:o<5?5:10,e=n*i,r>=-20?+e.toFixed(r<0?-r:0):e}function w(e){e.sort((function(e,t){return s(e,t,0)?-1:1}));for(var t=-1/0,n=1,r=0;r<e.length;){for(var i=e[r].interval,o=e[r].close,a=0;a<2;a++)i[a]<=t&&(i[a]=t,o[a]=a?1:1-n),t=i[a],n=o[a];i[0]===i[1]&&o[0]*o[1]!==1?e.splice(r,1):r++}return e;function s(e,t,n){return e.interval[n]<t.interval[n]||e.interval[n]===t.interval[n]&&(e.close[n]-t.close[n]===(n?-1:1)||!n&&s(e,t,1))}}function A(e){return e-parseFloat(e)>=0}t.linearMap=a,t.parsePercent=s,t.round=l,t.asc=u,t.getPrecision=c,t.getPrecisionSafe=d,t.getPixelPrecision=f,t.getPercentWithPrecision=h,t.MAX_SAFE_INTEGER=p,t.remRadian=m,t.isRadianAroundZero=v,t.parseDate=y,t.quantity=_,t.nice=b,t.reformIntervals=w,t.isNumeric=A},function(e,t,n){"use strict";var r=n(5),i=n(11),o=n(23),a=function(){this._pool={},this._allocatedTextures=[]};a.prototype={constructor:a,get:function(e){var t=u(e);this._pool.hasOwnProperty(t)||(this._pool[t]=[]);var n=this._pool[t];if(!n.length){var i=new r["a"](e);return this._allocatedTextures.push(i),i}return n.pop()},put:function(e){var t=u(e);this._pool.hasOwnProperty(t)||(this._pool[t]=[]);var n=this._pool[t];n.push(e)},clear:function(e){for(var t=0;t<this._allocatedTextures.length;t++)this._allocatedTextures[t].dispose(e);this._pool={},this._allocatedTextures=[]}};var s={width:512,height:512,type:i["a"].UNSIGNED_BYTE,format:i["a"].RGBA,wrapS:i["a"].CLAMP_TO_EDGE,wrapT:i["a"].CLAMP_TO_EDGE,minFilter:i["a"].LINEAR_MIPMAP_LINEAR,magFilter:i["a"].LINEAR,useMipmap:!0,anisotropic:1,flipY:!0,unpackAlignment:4,premultiplyAlpha:!1},l=Object.keys(s);function u(e){o["a"].defaultsWithPropList(e,s,l),c(e);for(var t="",n=0;n<l.length;n++){var r=l[n],i=e[r].toString();t+=i}return t}function c(e){var t=d(e.width,e.height);e.format===i["a"].DEPTH_COMPONENT&&(e.useMipmap=!1),t&&e.useMipmap||(e.minFilter==i["a"].NEAREST_MIPMAP_NEAREST||e.minFilter==i["a"].NEAREST_MIPMAP_LINEAR?e.minFilter=i["a"].NEAREST:e.minFilter!=i["a"].LINEAR_MIPMAP_LINEAR&&e.minFilter!=i["a"].LINEAR_MIPMAP_NEAREST||(e.minFilter=i["a"].LINEAR)),t||(e.wrapS=i["a"].CLAMP_TO_EDGE,e.wrapT=i["a"].CLAMP_TO_EDGE)}function d(e,t){return 0===(e&e-1)&&0===(t&t-1)}t["a"]=a},function(e,t,n){"use strict";t["a"]="@export clay.compositor.kernel.gaussian_9\nfloat gaussianKernel[9];\ngaussianKernel[0] = 0.07;\ngaussianKernel[1] = 0.09;\ngaussianKernel[2] = 0.12;\ngaussianKernel[3] = 0.14;\ngaussianKernel[4] = 0.16;\ngaussianKernel[5] = 0.14;\ngaussianKernel[6] = 0.12;\ngaussianKernel[7] = 0.09;\ngaussianKernel[8] = 0.07;\n@end\n@export clay.compositor.kernel.gaussian_13\nfloat gaussianKernel[13];\ngaussianKernel[0] = 0.02;\ngaussianKernel[1] = 0.03;\ngaussianKernel[2] = 0.06;\ngaussianKernel[3] = 0.08;\ngaussianKernel[4] = 0.11;\ngaussianKernel[5] = 0.13;\ngaussianKernel[6] = 0.14;\ngaussianKernel[7] = 0.13;\ngaussianKernel[8] = 0.11;\ngaussianKernel[9] = 0.08;\ngaussianKernel[10] = 0.06;\ngaussianKernel[11] = 0.03;\ngaussianKernel[12] = 0.02;\n@end\n@export clay.compositor.gaussian_blur\n#define SHADER_NAME gaussian_blur\nuniform sampler2D texture;varying vec2 v_Texcoord;\nuniform float blurSize : 2.0;\nuniform vec2 textureSize : [512.0, 512.0];\nuniform float blurDir : 0.0;\n@import clay.util.rgbm\n@import clay.util.clamp_sample\nvoid main (void)\n{\n @import clay.compositor.kernel.gaussian_9\n vec2 off = blurSize / textureSize;\n off *= vec2(1.0 - blurDir, blurDir);\n vec4 sum = vec4(0.0);\n float weightAll = 0.0;\n for (int i = 0; i < 9; i++) {\n float w = gaussianKernel[i];\n vec4 texel = decodeHDR(clampSample(texture, v_Texcoord + float(i - 4) * off));\n sum += texel * w;\n weightAll += w;\n }\n gl_FragColor = encodeHDR(sum / max(weightAll, 0.01));\n}\n@end\n"},function(e,t,n){"use strict";t["a"]="\n@export clay.compositor.lut\nvarying vec2 v_Texcoord;\nuniform sampler2D texture;\nuniform sampler2D lookup;\nvoid main()\n{\n vec4 tex = texture2D(texture, v_Texcoord);\n float blueColor = tex.b * 63.0;\n vec2 quad1;\n quad1.y = floor(floor(blueColor) / 8.0);\n quad1.x = floor(blueColor) - (quad1.y * 8.0);\n vec2 quad2;\n quad2.y = floor(ceil(blueColor) / 8.0);\n quad2.x = ceil(blueColor) - (quad2.y * 8.0);\n vec2 texPos1;\n texPos1.x = (quad1.x * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * tex.r);\n texPos1.y = (quad1.y * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * tex.g);\n vec2 texPos2;\n texPos2.x = (quad2.x * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * tex.r);\n texPos2.y = (quad2.y * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * tex.g);\n vec4 newColor1 = texture2D(lookup, texPos1);\n vec4 newColor2 = texture2D(lookup, texPos2);\n vec4 newColor = mix(newColor1, newColor2, fract(blueColor));\n gl_FragColor = vec4(newColor.rgb, tex.w);\n}\n@end"},function(e,t,n){"use strict";t["a"]="@export clay.compositor.output\n#define OUTPUT_ALPHA\nvarying vec2 v_Texcoord;\nuniform sampler2D texture;\n@import clay.util.rgbm\nvoid main()\n{\n vec4 tex = decodeHDR(texture2D(texture, v_Texcoord));\n gl_FragColor.rgb = tex.rgb;\n#ifdef OUTPUT_ALPHA\n gl_FragColor.a = tex.a;\n#else\n gl_FragColor.a = 1.0;\n#endif\n gl_FragColor = encodeHDR(gl_FragColor);\n#ifdef PREMULTIPLY_ALPHA\n gl_FragColor.rgb *= gl_FragColor.a;\n#endif\n}\n@end"},function(e,t,n){"use strict";t["a"]="@export clay.compositor.bright\nuniform sampler2D texture;\nuniform float threshold : 1;\nuniform float scale : 1.0;\nuniform vec2 textureSize: [512, 512];\nvarying vec2 v_Texcoord;\nconst vec3 lumWeight = vec3(0.2125, 0.7154, 0.0721);\n@import clay.util.rgbm\nvec4 median(vec4 a, vec4 b, vec4 c)\n{\n return a + b + c - min(min(a, b), c) - max(max(a, b), c);\n}\nvoid main()\n{\n vec4 texel = decodeHDR(texture2D(texture, v_Texcoord));\n#ifdef ANTI_FLICKER\n vec3 d = 1.0 / textureSize.xyx * vec3(1.0, 1.0, 0.0);\n vec4 s1 = decodeHDR(texture2D(texture, v_Texcoord - d.xz));\n vec4 s2 = decodeHDR(texture2D(texture, v_Texcoord + d.xz));\n vec4 s3 = decodeHDR(texture2D(texture, v_Texcoord - d.zy));\n vec4 s4 = decodeHDR(texture2D(texture, v_Texcoord + d.zy));\n texel = median(median(texel, s1, s2), s3, s4);\n#endif\n float lum = dot(texel.rgb , lumWeight);\n vec4 color;\n if (lum > threshold && texel.a > 0.0)\n {\n color = vec4(texel.rgb * scale, texel.a * scale);\n }\n else\n {\n color = vec4(0.0);\n }\n gl_FragColor = encodeHDR(color);\n}\n@end\n"},function(e,t,n){"use strict";t["a"]="@export clay.compositor.downsample\nuniform sampler2D texture;\nuniform vec2 textureSize : [512, 512];\nvarying vec2 v_Texcoord;\n@import clay.util.rgbm\nfloat brightness(vec3 c)\n{\n return max(max(c.r, c.g), c.b);\n}\n@import clay.util.clamp_sample\nvoid main()\n{\n vec4 d = vec4(-1.0, -1.0, 1.0, 1.0) / textureSize.xyxy;\n#ifdef ANTI_FLICKER\n vec3 s1 = decodeHDR(clampSample(texture, v_Texcoord + d.xy)).rgb;\n vec3 s2 = decodeHDR(clampSample(texture, v_Texcoord + d.zy)).rgb;\n vec3 s3 = decodeHDR(clampSample(texture, v_Texcoord + d.xw)).rgb;\n vec3 s4 = decodeHDR(clampSample(texture, v_Texcoord + d.zw)).rgb;\n float s1w = 1.0 / (brightness(s1) + 1.0);\n float s2w = 1.0 / (brightness(s2) + 1.0);\n float s3w = 1.0 / (brightness(s3) + 1.0);\n float s4w = 1.0 / (brightness(s4) + 1.0);\n float oneDivideSum = 1.0 / (s1w + s2w + s3w + s4w);\n vec4 color = vec4(\n (s1 * s1w + s2 * s2w + s3 * s3w + s4 * s4w) * oneDivideSum,\n 1.0\n );\n#else\n vec4 color = decodeHDR(clampSample(texture, v_Texcoord + d.xy));\n color += decodeHDR(clampSample(texture, v_Texcoord + d.zy));\n color += decodeHDR(clampSample(texture, v_Texcoord + d.xw));\n color += decodeHDR(clampSample(texture, v_Texcoord + d.zw));\n color *= 0.25;\n#endif\n gl_FragColor = encodeHDR(color);\n}\n@end"},function(e,t,n){"use strict";t["a"]="\n@export clay.compositor.upsample\n#define HIGH_QUALITY\nuniform sampler2D texture;\nuniform vec2 textureSize : [512, 512];\nuniform float sampleScale: 0.5;\nvarying vec2 v_Texcoord;\n@import clay.util.rgbm\n@import clay.util.clamp_sample\nvoid main()\n{\n#ifdef HIGH_QUALITY\n vec4 d = vec4(1.0, 1.0, -1.0, 0.0) / textureSize.xyxy * sampleScale;\n vec4 s;\n s = decodeHDR(clampSample(texture, v_Texcoord - d.xy));\n s += decodeHDR(clampSample(texture, v_Texcoord - d.wy)) * 2.0;\n s += decodeHDR(clampSample(texture, v_Texcoord - d.zy));\n s += decodeHDR(clampSample(texture, v_Texcoord + d.zw)) * 2.0;\n s += decodeHDR(clampSample(texture, v_Texcoord )) * 4.0;\n s += decodeHDR(clampSample(texture, v_Texcoord + d.xw)) * 2.0;\n s += decodeHDR(clampSample(texture, v_Texcoord + d.zy));\n s += decodeHDR(clampSample(texture, v_Texcoord + d.wy)) * 2.0;\n s += decodeHDR(clampSample(texture, v_Texcoord + d.xy));\n gl_FragColor = encodeHDR(s / 16.0);\n#else\n vec4 d = vec4(-1.0, -1.0, +1.0, +1.0) / textureSize.xyxy;\n vec4 s;\n s = decodeHDR(clampSample(texture, v_Texcoord + d.xy));\n s += decodeHDR(clampSample(texture, v_Texcoord + d.zy));\n s += decodeHDR(clampSample(texture, v_Texcoord + d.xw));\n s += decodeHDR(clampSample(texture, v_Texcoord + d.zw));\n gl_FragColor = encodeHDR(s / 4.0);\n#endif\n}\n@end"},function(e,t,n){"use strict";t["a"]="@export clay.compositor.hdr.composite\n#define TONEMAPPING\nuniform sampler2D texture;\n#ifdef BLOOM_ENABLED\nuniform sampler2D bloom;\n#endif\n#ifdef LENSFLARE_ENABLED\nuniform sampler2D lensflare;\nuniform sampler2D lensdirt;\n#endif\n#ifdef LUM_ENABLED\nuniform sampler2D lum;\n#endif\n#ifdef LUT_ENABLED\nuniform sampler2D lut;\n#endif\n#ifdef COLOR_CORRECTION\nuniform float brightness : 0.0;\nuniform float contrast : 1.0;\nuniform float saturation : 1.0;\n#endif\n#ifdef VIGNETTE\nuniform float vignetteDarkness: 1.0;\nuniform float vignetteOffset: 1.0;\n#endif\nuniform float exposure : 1.0;\nuniform float bloomIntensity : 0.25;\nuniform float lensflareIntensity : 1;\nvarying vec2 v_Texcoord;\n@import clay.util.srgb\nvec3 ACESToneMapping(vec3 color)\n{\n const float A = 2.51;\n const float B = 0.03;\n const float C = 2.43;\n const float D = 0.59;\n const float E = 0.14;\n return (color * (A * color + B)) / (color * (C * color + D) + E);\n}\nfloat eyeAdaption(float fLum)\n{\n return mix(0.2, fLum, 0.5);\n}\n#ifdef LUT_ENABLED\nvec3 lutTransform(vec3 color) {\n float blueColor = color.b * 63.0;\n vec2 quad1;\n quad1.y = floor(floor(blueColor) / 8.0);\n quad1.x = floor(blueColor) - (quad1.y * 8.0);\n vec2 quad2;\n quad2.y = floor(ceil(blueColor) / 8.0);\n quad2.x = ceil(blueColor) - (quad2.y * 8.0);\n vec2 texPos1;\n texPos1.x = (quad1.x * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * color.r);\n texPos1.y = (quad1.y * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * color.g);\n vec2 texPos2;\n texPos2.x = (quad2.x * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * color.r);\n texPos2.y = (quad2.y * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * color.g);\n vec4 newColor1 = texture2D(lut, texPos1);\n vec4 newColor2 = texture2D(lut, texPos2);\n vec4 newColor = mix(newColor1, newColor2, fract(blueColor));\n return newColor.rgb;\n}\n#endif\n@import clay.util.rgbm\nvoid main()\n{\n vec4 texel = vec4(0.0);\n vec4 originalTexel = vec4(0.0);\n#ifdef TEXTURE_ENABLED\n texel = decodeHDR(texture2D(texture, v_Texcoord));\n originalTexel = texel;\n#endif\n#ifdef BLOOM_ENABLED\n vec4 bloomTexel = decodeHDR(texture2D(bloom, v_Texcoord));\n texel.rgb += bloomTexel.rgb * bloomIntensity;\n texel.a += bloomTexel.a * bloomIntensity;\n#endif\n#ifdef LENSFLARE_ENABLED\n texel += decodeHDR(texture2D(lensflare, v_Texcoord)) * texture2D(lensdirt, v_Texcoord) * lensflareIntensity;\n#endif\n texel.a = min(texel.a, 1.0);\n#ifdef LUM_ENABLED\n float fLum = texture2D(lum, vec2(0.5, 0.5)).r;\n float adaptedLumDest = 3.0 / (max(0.1, 1.0 + 10.0*eyeAdaption(fLum)));\n float exposureBias = adaptedLumDest * exposure;\n#else\n float exposureBias = exposure;\n#endif\n#ifdef TONEMAPPING\n texel.rgb *= exposureBias;\n texel.rgb = ACESToneMapping(texel.rgb);\n#endif\n texel = linearTosRGB(texel);\n#ifdef LUT_ENABLED\n texel.rgb = lutTransform(clamp(texel.rgb,vec3(0.0),vec3(1.0)));\n#endif\n#ifdef COLOR_CORRECTION\n texel.rgb = clamp(texel.rgb + vec3(brightness), 0.0, 1.0);\n texel.rgb = clamp((texel.rgb - vec3(0.5))*contrast+vec3(0.5), 0.0, 1.0);\n float lum = dot(texel.rgb, vec3(0.2125, 0.7154, 0.0721));\n texel.rgb = mix(vec3(lum), texel.rgb, saturation);\n#endif\n#ifdef VIGNETTE\n vec2 uv = (v_Texcoord - vec2(0.5)) * vec2(vignetteOffset);\n texel.rgb = mix(texel.rgb, vec3(1.0 - vignetteDarkness), dot(uv, uv));\n#endif\n gl_FragColor = encodeHDR(texel);\n#ifdef DEBUG\n #if DEBUG == 1\n gl_FragColor = encodeHDR(decodeHDR(texture2D(texture, v_Texcoord)));\n #elif DEBUG == 2\n gl_FragColor = encodeHDR(decodeHDR(texture2D(bloom, v_Texcoord)) * bloomIntensity);\n #elif DEBUG == 3\n gl_FragColor = encodeHDR(decodeHDR(texture2D(lensflare, v_Texcoord) * lensflareIntensity));\n #endif\n#endif\n if (originalTexel.a <= 0.01 && gl_FragColor.a > 1e-5) {\n gl_FragColor.a = dot(gl_FragColor.rgb, vec3(0.2125, 0.7154, 0.0721));\n }\n#ifdef PREMULTIPLY_ALPHA\n gl_FragColor.rgb *= gl_FragColor.a;\n#endif\n}\n@end"},function(e,t,n){"use strict";t["a"]="@export clay.compositor.blend\n#define SHADER_NAME blend\n#ifdef TEXTURE1_ENABLED\nuniform sampler2D texture1;\nuniform float weight1 : 1.0;\n#endif\n#ifdef TEXTURE2_ENABLED\nuniform sampler2D texture2;\nuniform float weight2 : 1.0;\n#endif\n#ifdef TEXTURE3_ENABLED\nuniform sampler2D texture3;\nuniform float weight3 : 1.0;\n#endif\n#ifdef TEXTURE4_ENABLED\nuniform sampler2D texture4;\nuniform float weight4 : 1.0;\n#endif\n#ifdef TEXTURE5_ENABLED\nuniform sampler2D texture5;\nuniform float weight5 : 1.0;\n#endif\n#ifdef TEXTURE6_ENABLED\nuniform sampler2D texture6;\nuniform float weight6 : 1.0;\n#endif\nvarying vec2 v_Texcoord;\n@import clay.util.rgbm\nvoid main()\n{\n vec4 tex = vec4(0.0);\n#ifdef TEXTURE1_ENABLED\n tex += decodeHDR(texture2D(texture1, v_Texcoord)) * weight1;\n#endif\n#ifdef TEXTURE2_ENABLED\n tex += decodeHDR(texture2D(texture2, v_Texcoord)) * weight2;\n#endif\n#ifdef TEXTURE3_ENABLED\n tex += decodeHDR(texture2D(texture3, v_Texcoord)) * weight3;\n#endif\n#ifdef TEXTURE4_ENABLED\n tex += decodeHDR(texture2D(texture4, v_Texcoord)) * weight4;\n#endif\n#ifdef TEXTURE5_ENABLED\n tex += decodeHDR(texture2D(texture5, v_Texcoord)) * weight5;\n#endif\n#ifdef TEXTURE6_ENABLED\n tex += decodeHDR(texture2D(texture6, v_Texcoord)) * weight6;\n#endif\n gl_FragColor = encodeHDR(tex);\n}\n@end"},function(e,t,n){"use strict";t["a"]="@export clay.compositor.fxaa\nuniform sampler2D texture;\nuniform vec4 viewport : VIEWPORT;\nvarying vec2 v_Texcoord;\n#define FXAA_REDUCE_MIN (1.0/128.0)\n#define FXAA_REDUCE_MUL (1.0/8.0)\n#define FXAA_SPAN_MAX 8.0\n@import clay.util.rgbm\nvoid main()\n{\n vec2 resolution = 1.0 / viewport.zw;\n vec3 rgbNW = decodeHDR( texture2D( texture, ( gl_FragCoord.xy + vec2( -1.0, -1.0 ) ) * resolution ) ).xyz;\n vec3 rgbNE = decodeHDR( texture2D( texture, ( gl_FragCoord.xy + vec2( 1.0, -1.0 ) ) * resolution ) ).xyz;\n vec3 rgbSW = decodeHDR( texture2D( texture, ( gl_FragCoord.xy + vec2( -1.0, 1.0 ) ) * resolution ) ).xyz;\n vec3 rgbSE = decodeHDR( texture2D( texture, ( gl_FragCoord.xy + vec2( 1.0, 1.0 ) ) * resolution ) ).xyz;\n vec4 rgbaM = decodeHDR( texture2D( texture, gl_FragCoord.xy * resolution ) );\n vec3 rgbM = rgbaM.xyz;\n float opacity = rgbaM.w;\n vec3 luma = vec3( 0.299, 0.587, 0.114 );\n float lumaNW = dot( rgbNW, luma );\n float lumaNE = dot( rgbNE, luma );\n float lumaSW = dot( rgbSW, luma );\n float lumaSE = dot( rgbSE, luma );\n float lumaM = dot( rgbM, luma );\n float lumaMin = min( lumaM, min( min( lumaNW, lumaNE ), min( lumaSW, lumaSE ) ) );\n float lumaMax = max( lumaM, max( max( lumaNW, lumaNE) , max( lumaSW, lumaSE ) ) );\n vec2 dir;\n dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));\n dir.y = ((lumaNW + lumaSW) - (lumaNE + lumaSE));\n float dirReduce = max( ( lumaNW + lumaNE + lumaSW + lumaSE ) * ( 0.25 * FXAA_REDUCE_MUL ), FXAA_REDUCE_MIN );\n float rcpDirMin = 1.0 / ( min( abs( dir.x ), abs( dir.y ) ) + dirReduce );\n dir = min( vec2( FXAA_SPAN_MAX, FXAA_SPAN_MAX),\n max( vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),\n dir * rcpDirMin)) * resolution;\n vec3 rgbA = decodeHDR( texture2D( texture, gl_FragCoord.xy * resolution + dir * ( 1.0 / 3.0 - 0.5 ) ) ).xyz;\n rgbA += decodeHDR( texture2D( texture, gl_FragCoord.xy * resolution + dir * ( 2.0 / 3.0 - 0.5 ) ) ).xyz;\n rgbA *= 0.5;\n vec3 rgbB = decodeHDR( texture2D( texture, gl_FragCoord.xy * resolution + dir * -0.5 ) ).xyz;\n rgbB += decodeHDR( texture2D( texture, gl_FragCoord.xy * resolution + dir * 0.5 ) ).xyz;\n rgbB *= 0.25;\n rgbB += rgbA * 0.5;\n float lumaB = dot( rgbB, luma );\n if ( ( lumaB < lumaMin ) || ( lumaB > lumaMax ) )\n {\n gl_FragColor = vec4( rgbA, opacity );\n }\n else {\n gl_FragColor = vec4( rgbB, opacity );\n }\n}\n@end"},function(e,t,n){"use strict";var r=n(0),i=n.n(r);t["a"]={getFilledRegions:function(e,t){var n,r=(e||[]).slice();if("string"===typeof t?(t=i.a.getMap(t),n=t&&t.geoJson):t&&t.features&&(n=t),!n)return console.error("Map "+t+" not exists. You can download map file on http://echarts.baidu.com/download-map.html"),n.features||console.error("Invalid GeoJSON for map3D"),[];for(var o={},a=n.features,s=0;s<r.length;s++)o[r[s].name]=r[s];for(s=0;s<a.length;s++){var l=a[s].properties.name;o[l]||r.push({name:l})}return r},defaultOption:{show:!0,zlevel:-10,map:"",left:0,top:0,width:"100%",height:"100%",boxWidth:100,boxHeight:10,boxDepth:"auto",regionHeight:3,environment:"auto",groundPlane:{show:!1,color:"#aaa"},shading:"lambert",light:{main:{alpha:40,beta:30}},viewControl:{alpha:40,beta:0,distance:100,orthographicSize:60,minAlpha:5,minBeta:-80,maxBeta:80},label:{show:!1,distance:2,textStyle:{fontSize:20,color:"#000",backgroundColor:"rgba(255,255,255,0.7)",padding:3,borderRadius:4}},itemStyle:{color:"#fff",borderWidth:0,borderColor:"#333"},emphasis:{itemStyle:{color:"#639fc0"},label:{show:!0}}}}},function(e,t,n){"use strict";function r(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function i(e,t,n,i,o){var a=n,s=e[t];r(e,t,i);for(var l=n;l<i;l++)o(e[l],s)<0&&(r(e,l,a),a++);return r(e,i,a),a}function o(e,t,n,r){if(n<r){var a=Math.floor((n+r)/2),s=i(e,a,n,r,t);o(e,t,n,s-1),o(e,t,s+1,r)}}function a(){this._parts=[]}a.prototype.step=function(e,t,n){var r=e.length;if(0===n){this._parts=[],this._sorted=!1;var a=Math.floor(r/2);this._parts.push({pivot:a,left:0,right:r-1}),this._currentSortPartIdx=0}if(!this._sorted){var s=this._parts;if(0===s.length)return this._sorted=!0,!0;if(s.length<512){for(var l=0;l<s.length;l++)s[l].pivot=i(e,s[l].pivot,s[l].left,s[l].right,t);var u=[];for(l=0;l<s.length;l++){var c=s[l].left,d=s[l].pivot-1;d>c&&u.push({pivot:Math.floor((d+c)/2),left:c,right:d});c=s[l].pivot+1,d=s[l].right;d>c&&u.push({pivot:Math.floor((d+c)/2),left:c,right:d})}s=this._parts=u}else for(l=0;l<Math.floor(s.length/10);l++){var f=s.length-1-this._currentSortPartIdx;if(o(e,t,s[f].left,s[f].right),this._currentSortPartIdx++,this._currentSortPartIdx===s.length)return this._sorted=!0,!0}return!1}},a.sort=o,t["a"]=a},function(e,t,n){"use strict";var r=n(99),i=n(0),o=n.n(i),a=n(47),s=n.n(a),l=n(22),u=n(2);function c(e,t){var n=e.getBoxLayoutParams(),r=s.a.getLayoutRect(n,{width:t.getWidth(),height:t.getHeight()});r.y=t.getHeight()-r.y-r.height,this.viewGL.setViewport(r.x,r.y,r.width,r.height,t.getDevicePixelRatio());var i=this.getGeoBoundingRect(),o=i.width/i.height*(e.get("aspectScale")||.75),a=e.get("boxWidth"),l=e.get("boxDepth"),u=e.get("boxHeight");null==u&&(u=5),isNaN(a)&&isNaN(l)&&(a=100),isNaN(l)?l=a/o:isNaN(a)&&(a=l/o),this.setSize(a,u,l),this.regionHeight=e.get("regionHeight"),this.altitudeAxis&&this.altitudeAxis.setExtent(0,Math.max(u-this.regionHeight,0))}function d(e,t){var n=[1/0,-1/0];if(e.eachSeries((function(e){if(e.coordinateSystem===this&&"series.map3D"!==e.type){var t=e.getData(),r=e.coordDimToDataDim("alt"),i=r&&r[0];if(i){var o=t.getDataExtent(i,!0);n[0]=Math.min(n[0],o[0]),n[1]=Math.max(n[1],o[1])}}}),this),n&&isFinite(n[1]-n[0])){var r=o.a.helper.createScale(n,{type:"value",min:"dataMin",max:"dataMax"});this.altitudeAxis=new o.a.Axis("altitude",r),this.resize(this.model,t)}}var f=function(e){console.error("Map "+e+" not exists. You can download map file on http://echarts.baidu.com/download-map.html")},h=0,p={dimensions:r["a"].prototype.dimensions,create:function(e,t){var n=[];if(!o.a.getMap)throw new Error("geo3D component depends on geo component");function r(e,r){var i=p.createGeo3D(e);e.__viewGL=e.__viewGL||new l["a"],i.viewGL=e.__viewGL,e.coordinateSystem=i,i.model=e,n.push(i),i.resize=c,i.resize(e,t),i.update=d}return e.eachComponent("geo3D",(function(e,t){r(e,t)})),e.eachSeriesByType("map3D",(function(e,t){var n=e.get("coordinateSystem");null==n&&(n="geo3D"),"geo3D"===n&&r(e,t)})),e.eachSeries((function(t){if("geo3D"===t.get("coordinateSystem")){if("series.map3D"===t.type)return;var n=t.getReferringComponents("geo3D")[0];if(n||(n=e.getComponent("geo3D")),!n)throw new Error('geo "'+u["a"].firstNotNull(t.get("geo3DIndex"),t.get("geo3DId"),0)+'" not found');t.coordinateSystem=n.coordinateSystem}})),n},createGeo3D:function(e){var t,n=e.get("map");if("string"===typeof n?(t=n,n=o.a.getMap(n)):n&&n.features&&(n={geoJson:n}),n||f(n),!n.geoJson.features)throw new Error("Invalid GeoJSON for map3D");return null==t&&(t="GEO_ANONYMOUS_"+h++),new r["a"](t+h++,t,n&&n.geoJson,n&&n.specialAreas,e.get("nameMap"))}};o.a.registerCoordinateSystem("geo3D",p),t["a"]=p},function(e,t,n){"use strict";var r=n(0),i=n.n(r),o=n(6),a=n(205),s=n.n(a),l=n(206),u=n.n(l),c=o["a"].vec3,d=o["a"].mat4,f=[s.a,u.a];function h(e,t,n,r,i){this.name=e,this.map=t,this.regionHeight=0,this.regions=[],this._nameCoordMap={},this.loadGeoJson(n,r,i),this.transform=d.identity(new Float64Array(16)),this.invTransform=d.identity(new Float64Array(16)),this.extrudeY=!0,this.altitudeAxis}h.prototype={constructor:h,type:"geo3D",dimensions:["lng","lat","alt"],containPoint:function(){},loadGeoJson:function(e,t,n){var r=i.a.parseGeoJSON||i.a.parseGeoJson;try{this.regions=e?r(e):[]}catch(c){throw"Invalid geoJson format\n"+c}t=t||{},n=n||{};for(var o=this.regions,a={},s=0;s<o.length;s++){var l=o[s].name;l=n[l]||l,o[s].name=l,a[l]=o[s],this.addGeoCoord(l,o[s].center);var u=t[l];u&&o[s].transformTo(u.left,u.top,u.width,u.height)}this._regionsMap=a,this._geoRect=null,f.forEach((function(e){e(this)}),this)},getGeoBoundingRect:function(){if(this._geoRect)return this._geoRect;for(var e,t=this.regions,n=0;n<t.length;n++){var r=t[n].getBoundingRect();e=e||r.clone(),e.union(r)}return this._geoRect=e||new i.a.graphic.BoundingRect(0,0,0,0)},addGeoCoord:function(e,t){this._nameCoordMap[e]=t},getRegion:function(e){return this._regionsMap[e]},getRegionByCoord:function(e){for(var t=this.regions,n=0;n<t.length;n++)if(t[n].contain(e))return t[n]},setSize:function(e,t,n){this.size=[e,t,n];var r=this.getGeoBoundingRect(),i=e/r.width,o=-n/r.height,a=-e/2-r.x*i,s=n/2-r.y*o,l=this.extrudeY?[a,0,s]:[a,s,0],u=this.extrudeY?[i,1,o]:[i,o,1],c=this.transform;d.identity(c),d.translate(c,c,l),d.scale(c,c,u),d.invert(this.invTransform,c)},dataToPoint:function(e,t){t=t||[];var n=this.extrudeY?1:2,r=this.extrudeY?2:1,i=e[2];return isNaN(i)&&(i=0),t[0]=e[0],t[r]=e[1],this.altitudeAxis?t[n]=this.altitudeAxis.dataToCoord(i):t[n]=0,t[n]+=this.regionHeight,c.transformMat4(t,t,this.transform),t},pointToData:function(e,t){}},t["a"]=h},function(e,t,n){"use strict";var r=n(6),i=r["a"].mat4,o=512,a=.6435011087932844,s=Math.PI,l=.1;function u(){this.width=0,this.height=0,this.altitudeScale=1,this.boxHeight="auto",this.altitudeExtent,this.bearing=0,this.pitch=0,this.center=[0,0],this._origin,this.zoom=0,this._initialZoom,this.maxPitch=60,this.zoomOffset=0}u.prototype={constructor:u,dimensions:["lng","lat","alt"],containPoint:function(){},setCameraOption:function(e){this.bearing=e.bearing,this.pitch=e.pitch,this.center=e.center,this.zoom=e.zoom,this._origin||(this._origin=this.projectOnTileWithScale(this.center,o)),null==this._initialZoom&&(this._initialZoom=this.zoom),this.updateTransform()},updateTransform:function(){if(this.height){var e=.5/Math.tan(a/2)*this.height*l,t=Math.max(Math.min(this.pitch,this.maxPitch),0)/180*Math.PI,n=a/2,r=Math.PI/2+t,s=Math.sin(n)*e/Math.sin(Math.PI-r-n),u=Math.cos(Math.PI/2-t)*s+e,c=1.1*u;this.pitch>50&&(c=1e3);var d=[];i.perspective(d,a,this.width/this.height,1,c),this.viewGL.camera.projectionMatrix.setArray(d),this.viewGL.camera.decomposeProjectionMatrix();d=i.identity([]);var f=this.dataToPoint(this.center);i.scale(d,d,[1,-1,1]),i.translate(d,d,[0,0,-e]),i.rotateX(d,d,t),i.rotateZ(d,d,-this.bearing/180*Math.PI),i.translate(d,d,[-f[0]*this.getScale()*l,-f[1]*this.getScale()*l,0]),this.viewGL.camera.viewMatrix.array=d;var h=[];i.invert(h,d),this.viewGL.camera.worldTransform.array=h,this.viewGL.camera.decomposeWorldTransform();var p,m=o*this.getScale();if(this.altitudeExtent&&!isNaN(this.boxHeight)){var v=this.altitudeExtent[1]-this.altitudeExtent[0];p=this.boxHeight/v*this.getScale()/Math.pow(2,this._initialZoom-this.zoomOffset)}else p=m/(2*Math.PI*6378e3*Math.abs(Math.cos(this.center[1]*(Math.PI/180))))*this.altitudeScale*l;this.viewGL.rootNode.scale.set(this.getScale()*l,this.getScale()*l,p)}},getScale:function(){return Math.pow(2,this.zoom-this.zoomOffset)},projectOnTile:function(e,t){return this.projectOnTileWithScale(e,this.getScale()*o,t)},projectOnTileWithScale:function(e,t,n){var r=e[0],i=e[1],o=r*s/180,a=i*s/180,l=t*(o+s)/(2*s),u=t*(s-Math.log(Math.tan(s/4+.5*a)))/(2*s);return n=n||[],n[0]=l,n[1]=u,n},unprojectFromTile:function(e,t){return this.unprojectOnTileWithScale(e,this.getScale()*o,t)},unprojectOnTileWithScale:function(e,t,n){var r=e[0],i=e[1],o=r/t*(2*s)-s,a=2*(Math.atan(Math.exp(s-i/t*(2*s)))-s/4);return n=n||[],n[0]=180*o/s,n[1]=180*a/s,n},dataToPoint:function(e,t){return t=this.projectOnTileWithScale(e,o,t),t[0]-=this._origin[0],t[1]-=this._origin[1],t[2]=isNaN(e[2])?0:e[2],isNaN(e[2])||(t[2]=e[2],this.altitudeExtent&&(t[2]-=this.altitudeExtent[0])),t}},t["a"]=u},function(e,t,n){"use strict";var r=n(2),i=n(1),o=n(22);t["a"]=function(e,t,n){function a(e,t){var n=t.getWidth(),r=t.getHeight(),i=t.getDevicePixelRatio();this.viewGL.setViewport(0,0,n,r,i),this.width=n,this.height=r,this.altitudeScale=e.get("altitudeScale"),this.boxHeight=e.get("boxHeight")}function s(e,t){if("auto"!==this.model.get("boxHeight")){var n=[1/0,-1/0];e.eachSeries((function(e){if(e.coordinateSystem===this){var t=e.getData(),r=e.coordDimToDataDim("alt")[0];if(r){var i=t.getDataExtent(r,!0);n[0]=Math.min(n[0],i[0]),n[1]=Math.max(n[1],i[1])}}}),this),n&&isFinite(n[1]-n[0])&&(this.altitudeExtent=n)}}return{dimensions:t.prototype.dimensions,create:function(l,u){var c=[];return l.eachComponent(e,(function(e){var n=e.__viewGL;n||(n=e.__viewGL=new o["a"],n.setRootNode(new i["a"].Node));var r=new t;r.viewGL=e.__viewGL,r.resize=a,r.resize(e,u),c.push(r),e.coordinateSystem=r,r.model=e,r.update=s})),l.eachSeries((function(t){if(t.get("coordinateSystem")===e){var n=t.getReferringComponents(e)[0];if(n||(n=l.getComponent(e)),!n)throw new Error(e+' "'+r["a"].firstNotNull(t.get(e+"Index"),t.get(e+"Id"),0)+'" not found');t.coordinateSystem=n.coordinateSystem}})),n&&n(c,l,u),c}}}},function(e,t,n){"use strict";t["a"]="\n@export ecgl.displayShadow.vertex\n\n@import ecgl.common.transformUniforms\n\n@import ecgl.common.uv.header\n\n@import ecgl.common.attributes\n\nvarying vec3 v_WorldPosition;\n\nvarying vec3 v_Normal;\n\nvoid main()\n{\n @import ecgl.common.uv.main\n v_Normal = normalize((worldInverseTranspose * vec4(normal, 0.0)).xyz);\n\n v_WorldPosition = (world * vec4(position, 1.0)).xyz;\n gl_Position = worldViewProjection * vec4(position, 1.0);\n}\n\n@end\n\n\n@export ecgl.displayShadow.fragment\n\n@import ecgl.common.uv.fragmentHeader\n\nvarying vec3 v_Normal;\nvarying vec3 v_WorldPosition;\n\nuniform float roughness: 0.2;\n\n#ifdef DIRECTIONAL_LIGHT_COUNT\n@import clay.header.directional_light\n#endif\n\n@import ecgl.common.ssaoMap.header\n\n@import clay.plugin.compute_shadow_map\n\nvoid main()\n{\n float shadow = 1.0;\n\n @import ecgl.common.ssaoMap.main\n\n#if defined(DIRECTIONAL_LIGHT_COUNT) && defined(DIRECTIONAL_LIGHT_SHADOWMAP_COUNT)\n float shadowContribsDir[DIRECTIONAL_LIGHT_COUNT];\n if(shadowEnabled)\n {\n computeShadowOfDirectionalLights(v_WorldPosition, shadowContribsDir);\n }\n for (int i = 0; i < DIRECTIONAL_LIGHT_COUNT; i++) {\n shadow = min(shadow, shadowContribsDir[i] * 0.5 + 0.5);\n }\n#endif\n\n shadow *= 0.5 + ao * 0.5;\n shadow = clamp(shadow, 0.0, 1.0);\n\n gl_FragColor = vec4(vec3(0.0), 1.0 - shadow);\n}\n\n@end"},function(e,t,n){"use strict";var r=n(84),i=n.n(r),o=n(83),a=n.n(o);function s(e){this.viewGL=e}s.prototype.reset=function(e,t){this._updateCamera(t.getWidth(),t.getHeight(),t.getDevicePixelRatio()),this._viewTransform=i.a.create(),this.updateTransform(e,t)},s.prototype.updateTransform=function(e,t){var n=e.coordinateSystem;n.getRoamTransform&&(i.a.invert(this._viewTransform,n.getRoamTransform()),this._setCameraTransform(this._viewTransform),t.getZr().refresh())},s.prototype.dataToPoint=function(e,t,n){n=e.dataToPoint(t,null,n);var r=this._viewTransform;r&&a.a.applyTransform(n,n,r)},s.prototype.removeTransformInPoint=function(e){return this._viewTransform&&a.a.applyTransform(e,e,this._viewTransform),e},s.prototype.getZoom=function(){if(this._viewTransform){var e=this._viewTransform;return 1/Math.max(Math.sqrt(e[0]*e[0]+e[1]*e[1]),Math.sqrt(e[2]*e[2]+e[3]*e[3]))}return 1},s.prototype._setCameraTransform=function(e){var t=this.viewGL.camera;t.position.set(e[4],e[5],0),t.scale.set(Math.sqrt(e[0]*e[0]+e[1]*e[1]),Math.sqrt(e[2]*e[2]+e[3]*e[3]),1)},s.prototype._updateCamera=function(e,t,n){this.viewGL.setViewport(0,0,e,t,n);var r=this.viewGL.camera;r.left=r.top=0,r.bottom=t,r.right=e,r.near=0,r.far=100},t["a"]=s},function(e,t,n){(function(e){var n;"undefined"!==typeof window?n=window.__DEV__:"undefined"!==typeof e&&(n=e.__DEV__),"undefined"===typeof n&&(n=!0);var r=n;t.__DEV__=r}).call(t,n(68))},function(e,t,n){"use strict";var r=n(15),i=n(0),o=n.n(i),a=n(38),s=n(6),l=s["a"].vec2,u=[[0,0],[1,1]],c=r["a"].extend((function(){return{segmentScale:4,dynamic:!0,useNativeLine:!0,attributes:{position:new r["a"].Attribute("position","float",2,"POSITION"),normal:new r["a"].Attribute("normal","float",2),offset:new r["a"].Attribute("offset","float",1),color:new r["a"].Attribute("color","float",4,"COLOR")}}}),{resetOffset:function(){this._vertexOffset=0,this._faceOffset=0,this._itemVertexOffsets=[]},setVertexCount:function(e){var t=this.attributes;this.vertexCount!==e&&(t.position.init(e),t.color.init(e),this.useNativeLine||(t.offset.init(e),t.normal.init(e)),e>65535?this.indices instanceof Uint16Array&&(this.indices=new Uint32Array(this.indices)):this.indices instanceof Uint32Array&&(this.indices=new Uint16Array(this.indices)))},setTriangleCount:function(e){this.triangleCount!==e&&(this.indices=0===e?null:this.vertexCount>65535?new Uint32Array(3*e):new Uint16Array(3*e))},_getCubicCurveApproxStep:function(e,t,n,r){var i=l.dist(e,t)+l.dist(n,t)+l.dist(r,n),o=1/(i+1)*this.segmentScale;return o},getCubicCurveVertexCount:function(e,t,n,r){var i=this._getCubicCurveApproxStep(e,t,n,r),o=Math.ceil(1/i);return this.useNativeLine?2*o:2*o+2},getCubicCurveTriangleCount:function(e,t,n,r){var i=this._getCubicCurveApproxStep(e,t,n,r),o=Math.ceil(1/i);return this.useNativeLine?0:2*o},getLineVertexCount:function(){return this.getPolylineVertexCount(u)},getLineTriangleCount:function(){return this.getPolylineTriangleCount(u)},getPolylineVertexCount:function(e){var t;if("number"===typeof e)t=e;else{var n="number"!==typeof e[0];t=n?e.length:e.length/2}return this.useNativeLine?2*(t-1):2*(t-1)+2},getPolylineTriangleCount:function(e){var t;if("number"===typeof e)t=e;else{var n="number"!==typeof e[0];t=n?e.length:e.length/2}return this.useNativeLine?0:2*(t-1)},addCubicCurve:function(e,t,n,r,i,o){null==o&&(o=1);var a=e[0],s=e[1],l=t[0],u=t[1],c=n[0],d=n[1],f=r[0],h=r[1],p=this._getCubicCurveApproxStep(e,t,n,r),m=p*p,v=m*p,g=3*p,y=3*m,_=6*m,x=6*v,b=a-2*l+c,w=s-2*u+d,A=3*(l-c)-a+f,T=3*(u-d)-s+h,S=a,E=s,C=(l-a)*g+b*y+A*v,M=(u-s)*g+w*y+T*v,L=b*_+A*x,N=w*_+T*x,D=A*x,O=T*x,I=0,R=0,P=Math.ceil(1/p),k=new Float32Array(3*(P+1)),B=(k=[],0);for(R=0;R<P+1;R++)k[B++]=S,k[B++]=E,S+=C,E+=M,C+=L,M+=N,L+=D,N+=O,I+=p,I>1&&(S=C>0?Math.min(S,f):Math.max(S,f),E=M>0?Math.min(E,h):Math.max(E,h));this.addPolyline(k,i,o)},addLine:function(e,t,n,r){this.addPolyline([e,t],n,r)},addPolyline:function(){var e=l.create(),t=l.create(),n=l.create(),r=l.create(),i=[],o=[],a=[];return function(s,u,c,d,f){if(s.length){var h="number"!==typeof s[0];if(null==f&&(f=h?s.length:s.length/2),!(f<2)){null==d&&(d=0),null==c&&(c=1),this._itemVertexOffsets.push(this._vertexOffset);for(var p,m=h?"number"!==typeof u[0]:u.length/4===f,v=this.attributes.position,g=this.attributes.color,y=this.attributes.offset,_=this.attributes.normal,x=this.indices,b=this._vertexOffset,w=0;w<f;w++){if(h)i=s[w+d],p=m?u[w+d]:u;else{var A=2*w+d;if(i=i||[],i[0]=s[A],i[1]=s[A+1],m){var T=4*w+d;p=p||[],p[0]=u[T],p[1]=u[T+1],p[2]=u[T+2],p[3]=u[T+3]}else p=u}if(this.useNativeLine)w>1&&(v.copy(b,b-1),g.copy(b,b-1),b++);else{var S;if(w<f-1){if(h)l.copy(o,s[w+1]);else{A=2*(w+1)+d;o=o||[],o[0]=s[A],o[1]=s[A+1]}if(w>0){l.sub(e,i,a),l.sub(t,o,i),l.normalize(e,e),l.normalize(t,t),l.add(r,e,t),l.normalize(r,r);var E=c/2*Math.min(1/l.dot(e,r),2);n[0]=-r[1],n[1]=r[0],S=E}else l.sub(e,o,i),l.normalize(e,e),n[0]=-e[1],n[1]=e[0],S=c/2}else l.sub(e,i,a),l.normalize(e,e),n[0]=-e[1],n[1]=e[0],S=c/2;_.set(b,n),_.set(b+1,n),y.set(b,S),y.set(b+1,-S),l.copy(a,i),v.set(b,i),v.set(b+1,i),g.set(b,p),g.set(b+1,p),b+=2}if(this.useNativeLine)g.set(b,p),v.set(b,i),b++;else if(w>0){var C=3*this._faceOffset;x=this.indices;x[C]=b-4,x[C+1]=b-3,x[C+2]=b-2,x[C+3]=b-3,x[C+4]=b-1,x[C+5]=b-2,this._faceOffset+=2}}this._vertexOffset=b}}}}(),setItemColor:function(e,t){for(var n=this._itemVertexOffsets[e],r=e<this._itemVertexOffsets.length-1?this._itemVertexOffsets[e+1]:this._vertexOffset,i=n;i<r;i++)this.attributes.color.set(i,t);this.dirty("color")}});o.a.util.defaults(c.prototype,a["a"]),t["a"]=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n(107),n(154),n(201),n(207),n(213),n(219),n(225),n(232),n(236),n(243),n(249),n(252),n(256),n(259),n(262),n(275),n(281)},function(e,t,n){"use strict";var r=n(0),i=n.n(r),o=n(108),a=n(109),s=n(153),l=n(1),u={version:"1.1.1",dependencies:{echarts:"4.1.0",claygl:"1.2.1"}},c=u.dependencies;function d(e){throw new Error(e+" version is too old, needs "+c[e]+" or higher")}function f(e,t){e.replace(".","")-0<c[t].replace(".","")-0&&d(t),console.log("Loaded "+t+", version "+e)}function h(e){this._layers={},this._zr=e}f(o["a"],"claygl"),f(i.a.version,"echarts"),h.prototype.update=function(e,t){var n=this,r=t.getZr();if(r.getWidth()&&r.getHeight()){for(var o in this._layers)this._layers[o].removeViewsAll();e.eachComponent((function(n,r){if("series"!==n){var i=t.getViewOfComponentModel(r),o=r.coordinateSystem;if(i.__ecgl__){if(o){if(!o.viewGL)return void console.error("Can't find viewGL in coordinateSystem of component "+r.id);a=o.viewGL}else{if(!r.viewGL)return void console.error("Can't find viewGL of component "+r.id);a=o.viewGL}var a=o.viewGL,u=s(r);u.addView(a),i.afterRender&&i.afterRender(r,e,t,u),l(i.groupGL,r.get("silent"))}}})),e.eachSeries((function(n){var r=t.getViewOfSeriesModel(n),i=n.coordinateSystem;if(r.__ecgl__){if(i&&!i.viewGL&&!r.viewGL)return void console.error("Can't find viewGL of series "+r.id);var o=i&&i.viewGL||r.viewGL,a=s(n);a.addView(o),r.afterRender&&r.afterRender(n,e,t,a),l(r.groupGL,n.get("silent"))}}))}else console.warn("Dom has no width or height");function s(e){var t;t=(e.coordinateSystem&&e.coordinateSystem.model,e.get("zlevel"));var o=n._layers,s=o[t];if(!s){if(s=o[t]=new a["a"]("gl-"+t,r),r.painter.isSingleCanvas()){s.virtual=!0;var l=new i.a.graphic.Image({z:1e4,style:{image:s.renderer.canvas},silent:!0});s.__hostImage=l,r.add(l)}r.painter.insertLayer(t,s)}return s.__hostImage&&s.__hostImage.setStyle({width:s.renderer.getWidth(),height:s.renderer.getHeight()}),s}function l(e,t){e&&e.traverse((function(e){e.isRenderable&&e.isRenderable()&&(e.ignorePicking=null!=e.$ignorePicking?e.$ignorePicking:t)}))}};var p=i.a.init;i.a.init=function(){var e=p.apply(this,arguments);return e.getZr().painter.getRenderedCanvas=function(e){if(e=e||{},this._singleCanvas)return this._layers[0].dom;var t=document.createElement("canvas"),n=e.pixelRatio||this.dpr;t.width=this.getWidth()*n,t.height=this.getHeight()*n;var r=t.getContext("2d");r.dpr=n,r.clearRect(0,0,t.width,t.height),e.backgroundColor&&(r.fillStyle=e.backgroundColor,r.fillRect(0,0,t.width,t.height));var i,o=this.storage.getDisplayList(!0),a={},s=this;function l(e,t){var n,i=s._zlevelList;null==e&&(e=-1/0);for(var o=0;o<i.length;o++){var a=i[o],l=s._layers[a];if(!l.__builtin__&&a>e&&a<t){n=l;break}}n&&n.renderToCanvas&&(r.save(),n.renderToCanvas(r),r.restore())}for(var u={ctx:r},c=0;c<o.length;c++){var d=o[c];d.zlevel!==i&&(l(i,d.zlevel),i=d.zlevel),this._doPaintEl(d,u,!0,a)}return l(i,1/0),t},e},i.a.registerPostUpdate((function(e,t){var n=t.getZr(),r=n.__egl=n.__egl||new h(n);r.update(e,t)})),i.a.registerPreprocessor(s["a"]),i.a.graphicGL=l["a"]},function(e,t,n){"use strict";t["a"]="1.2.1"},function(e,t,n){"use strict";var r=n(0),i=n.n(r),o=n(52),a=n(117),s=n(4),l=n(1),u=n(53),c=n(80),d=n.n(c),f=function(e,t){this.id=e,this.zr=t;try{this.renderer=new o["a"]({clearBit:0,devicePixelRatio:t.painter.dpr,preserveDrawingBuffer:!0,premultipliedAlpha:!0}),this.renderer.resize(t.painter.getWidth(),t.painter.getHeight())}catch(r){return this.renderer=null,this.dom=document.createElement("div"),this.dom.style.cssText="position:absolute; left: 0; top: 0; right: 0; bottom: 0;",this.dom.className="ecgl-nowebgl",this.dom.innerHTML="Sorry, your browser does not support WebGL",void console.error(r)}this.onglobalout=this.onglobalout.bind(this),t.on("globalout",this.onglobalout),this.dom=this.renderer.canvas;var n=this.dom.style;n.position="absolute",n.left="0",n.top="0",this.views=[],this._picking=new a["a"]({renderer:this.renderer}),this._viewsToDispose=[],this._accumulatingId=0,this._zrEventProxy=new i.a.graphic.Rect({shape:{x:-1,y:-1,width:2,height:2},__isGLToZRProxy:!0}),this._backgroundColor=null};function h(e){var t=e.__zr;e.__zr=null,t&&e.removeAnimatorsFromZr&&e.removeAnimatorsFromZr(t)}f.prototype.addView=function(e){if(e.layer!==this){var t=this._viewsToDispose.indexOf(e);t>=0&&this._viewsToDispose.splice(t,1),this.views.push(e),e.layer=this;var n=this.zr;e.scene.traverse((function(e){e.__zr=n,e.addAnimatorsToZr&&e.addAnimatorsToZr(n)}))}},f.prototype.removeView=function(e){if(e.layer===this){var t=this.views.indexOf(e);t>=0&&(this.views.splice(t,1),e.scene.traverse(h,this),e.layer=null,this._viewsToDispose.push(e))}},f.prototype.removeViewsAll=function(){this.views.forEach((function(e){e.scene.traverse(h,this),e.layer=null,this._viewsToDispose.push(e)}),this),this.views.length=0},f.prototype.resize=function(e,t){var n=this.renderer;n.resize(e,t)},f.prototype.clear=function(){var e=this.renderer.gl,t=this._backgroundColor||[0,0,0,0];e.clearColor(t[0],t[1],t[2],t[3]),e.depthMask(!0),e.colorMask(!0,!0,!0,!0),e.clear(e.DEPTH_BUFFER_BIT|e.COLOR_BUFFER_BIT)},f.prototype.clearDepth=function(){var e=this.renderer.gl;e.clear(e.DEPTH_BUFFER_BIT)},f.prototype.clearColor=function(){var e=this.renderer.gl;e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT)},f.prototype.needsRefresh=function(){this.zr.refresh()},f.prototype.refresh=function(e){this._backgroundColor=e?l["a"].parseColor(e):[0,0,0,0],this.renderer.clearColor=this._backgroundColor;for(var t=0;t<this.views.length;t++)this.views[t].prepareRender(this.renderer);this._doRender(!1),this._trackAndClean();for(t=0;t<this._viewsToDispose.length;t++)this._viewsToDispose[t].dispose(this.renderer);this._viewsToDispose.length=0,this._startAccumulating()},f.prototype.renderToCanvas=function(e){this._startAccumulating(!0),e.drawImage(this.dom,0,0,e.canvas.width,e.canvas.height)},f.prototype._doRender=function(e){this.clear(),this.renderer.saveViewport();for(var t=0;t<this.views.length;t++)this.views[t].render(this.renderer,e);this.renderer.restoreViewport()},f.prototype._stopAccumulating=function(){this._accumulatingId=0,clearTimeout(this._accumulatingTimeout)};var p=1;function m(e){for(var t=0;t<e.length;t++)e[t].__used__=0}function v(e,t){for(var n=0;n<t.length;n++)t[n].__used__||t[n].dispose(e)}function g(e,t){e.__used__=e.__used__||0,e.__used__++,1===e.__used__&&t.push(e)}function y(e,t,n){var r,i;e.traverse((function(e){if(e.isRenderable()){var o=e.geometry,a=e.material;if(a!==r)for(var l=a.getTextureUniforms(),u=0;u<l.length;u++){var c=l[u],d=a.uniforms[c].value;if(d)if(d instanceof s["a"])g(d,t);else if(d instanceof Array)for(var f=0;f<d.length;f++)d[f]instanceof s["a"]&&g(d[f],t)}o!==i&&g(o,n),r=a,i=o}}));for(var o=0;o<e.lights.length;o++)e.lights[o].cubemap&&g(e.lights[o].cubemap,t)}f.prototype._startAccumulating=function(e){var t=this;this._stopAccumulating();for(var n=!1,r=0;r<this.views.length;r++)n=this.views[r].needsAccumulate()||n;function i(r){if(t._accumulatingId&&r===t._accumulatingId){for(var o=!0,a=0;a<t.views.length;a++)o=t.views[a].isAccumulateFinished()&&n;o||(t._doRender(!0),e?i(r):d()((function(){i(r)})))}}n&&(this._accumulatingId=p++,e?i(t._accumulatingId):this._accumulatingTimeout=setTimeout((function(){i(t._accumulatingId)}),50))},f.prototype._trackAndClean=function(){var e=[],t=[];this._textureList&&(m(this._textureList),m(this._geometriesList));for(var n=0;n<this.views.length;n++)y(this.views[n].scene,e,t);this._textureList&&(v(this.renderer,this._textureList),v(this.renderer,this._geometriesList)),this._textureList=e,this._geometriesList=t},f.prototype.dispose=function(){this._stopAccumulating(),this.renderer.disposeScene(this.scene),this.zr.off("globalout",this.onglobalout)},f.prototype.onmousedown=function(e){if(!e.target||!e.target.__isGLToZRProxy){e=e.event;var t=this.pickObject(e.offsetX,e.offsetY);t&&(this._dispatchEvent("mousedown",e,t),this._dispatchDataEvent("mousedown",e,t)),this._downX=e.offsetX,this._downY=e.offsetY}},f.prototype.onmousemove=function(e){if(!e.target||!e.target.__isGLToZRProxy){e=e.event;var t=this.pickObject(e.offsetX,e.offsetY),n=t&&t.target,r=this._hovered;this._hovered=t,r&&n!==r.target&&(r.relatedTarget=n,this._dispatchEvent("mouseout",e,r),this.zr.setCursorStyle("default")),this._dispatchEvent("mousemove",e,t),t&&(this.zr.setCursorStyle("pointer"),r&&n===r.target||this._dispatchEvent("mouseover",e,t)),this._dispatchDataEvent("mousemove",e,t)}},f.prototype.onmouseup=function(e){if(!e.target||!e.target.__isGLToZRProxy){e=e.event;var t=this.pickObject(e.offsetX,e.offsetY);t&&(this._dispatchEvent("mouseup",e,t),this._dispatchDataEvent("mouseup",e,t)),this._upX=e.offsetX,this._upY=e.offsetY}},f.prototype.onclick=f.prototype.dblclick=function(e){if(!e.target||!e.target.__isGLToZRProxy){var t=this._upX-this._downX,n=this._upY-this._downY;if(!(Math.sqrt(t*t+n*n)>20)){e=e.event;var r=this.pickObject(e.offsetX,e.offsetY);r&&(this._dispatchEvent(e.type,e,r),this._dispatchDataEvent(e.type,e,r));var i=this._clickToSetFocusPoint(e);if(i){var o=i.view.setDOFFocusOnPoint(i.distance);o&&this.zr.refresh()}}}},f.prototype._clickToSetFocusPoint=function(e){for(var t=this.renderer,n=t.viewport,r=this.views.length-1;r>=0;r--){var i=this.views[r];if(i.hasDOF()&&i.containPoint(e.offsetX,e.offsetY)){this._picking.scene=i.scene,this._picking.camera=i.camera,t.viewport=i.viewport;var o=this._picking.pick(e.offsetX,e.offsetY,!0);if(o)return o.view=i,o}}t.viewport=n},f.prototype.onglobalout=function(e){var t=this._hovered;t&&this._dispatchEvent("mouseout",e,{target:t.target})},f.prototype.pickObject=function(e,t){for(var n=[],r=this.renderer,i=r.viewport,o=0;o<this.views.length;o++){var a=this.views[o];a.containPoint(e,t)&&(this._picking.scene=a.scene,this._picking.camera=a.camera,r.viewport=a.viewport,this._picking.pickAll(e,t,n))}return r.viewport=i,n.sort((function(e,t){return e.distance-t.distance})),n[0]},f.prototype._dispatchEvent=function(e,t,n){n||(n={});var r=n.target;n.cancelBubble=!1,n.event=t,n.type=e,n.offsetX=t.offsetX,n.offsetY=t.offsetY;while(r)if(r.trigger(e,n),r=r.getParent(),n.cancelBubble)break;this._dispatchToView(e,n)},f.prototype._dispatchDataEvent=function(e,t,n){var r=n&&n.target,i=r&&r.dataIndex,o=r&&r.seriesIndex,a=r&&r.eventData,s=!1,l=this._zrEventProxy;l.position=[t.offsetX,t.offsetY],l.update();var u={target:l};"mousemove"===e&&(null!=i?i!==this._lastDataIndex&&(parseInt(this._lastDataIndex,10)>=0&&(l.dataIndex=this._lastDataIndex,l.seriesIndex=this._lastSeriesIndex,this.zr.handler.dispatchToElement(u,"mouseout",t)),s=!0):null!=a&&a!==this._lastEventData&&(null!=this._lastEventData&&(l.eventData=this._lastEventData,this.zr.handler.dispatchToElement(u,"mouseout",t)),s=!0),this._lastEventData=a,this._lastDataIndex=i,this._lastSeriesIndex=o),l.eventData=a,l.dataIndex=i,l.seriesIndex=o,(null!=a||parseInt(i,10)>=0&&parseInt(o,10)>=0)&&(this.zr.handler.dispatchToElement(u,e,t),s&&this.zr.handler.dispatchToElement(u,"mouseover",t))},f.prototype._dispatchToView=function(e,t){for(var n=0;n<this.views.length;n++)this.views[n].containPoint(t.offsetX,t.offsetY)&&this.views[n].trigger(e,t)},i.a.util.extend(f.prototype,u["a"]),t["a"]=f},function(e,t,n){"use strict";function r(e,t,n){"object"==typeof t&&(n=t,t=null);var r,a=this;if(!(e instanceof Function))for(var s in r=[],e)e.hasOwnProperty(s)&&r.push(s);var l=function(t){if(a.apply(this,arguments),e instanceof Function?i(this,e.call(this,t)):o(this,e,r),this.constructor===l)for(var n=l.__initializers__,s=0;s<n.length;s++)n[s].apply(this,arguments)};l.__super__=a,a.__initializers__?l.__initializers__=a.__initializers__.slice():l.__initializers__=[],t&&l.__initializers__.push(t);var u=function(){};return u.prototype=a.prototype,l.prototype=new u,l.prototype.constructor=l,i(l.prototype,n),l.extend=a.extend,l.derive=a.extend,l}function i(e,t){if(t)for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])}function o(e,t,n){for(var r=0;r<n.length;r++){var i=n[r];e[i]=t[i]}}t["a"]={extend:r,derive:r}},function(e,t,n){"use strict";var r=["OES_texture_float","OES_texture_half_float","OES_texture_float_linear","OES_texture_half_float_linear","OES_standard_derivatives","OES_vertex_array_object","OES_element_index_uint","WEBGL_compressed_texture_s3tc","WEBGL_depth_texture","EXT_texture_filter_anisotropic","EXT_shader_texture_lod","WEBGL_draw_buffers","EXT_frag_depth","EXT_sRGB"],i=["MAX_TEXTURE_SIZE","MAX_CUBE_MAP_TEXTURE_SIZE"];function o(e){for(var t={},n={},o=0;o<r.length;o++){var a=r[o];l(a)}for(o=0;o<i.length;o++){var s=i[o];n[s]=e.getParameter(e[s])}function l(n){var r=e.getExtension(n);r||(r=e.getExtension("MOZ_"+n)),r||(r=e.getExtension("WEBKIT_"+n)),t[n]=r}this.getExtension=function(e){return e in t||l(e),t[e]},this.getParameter=function(e){return n[e]},this.getMaxJointNumber=function(){return 15}}t["a"]=o},function(e,t,n){"use strict";function r(e){var t=new XMLHttpRequest;t.open("get",e.url),t.responseType=e.responseType||"text",e.onprogress&&(t.onprogress=function(t){if(t.lengthComputable){var n=t.loaded/t.total;e.onprogress(n,t.loaded,t.total)}else e.onprogress(null)}),t.onload=function(n){t.status>=400?e.onerror&&e.onerror():e.onload&&e.onload(t.response)},e.onerror&&(t.onerror=e.onerror),t.send(null)}t["a"]={get:r}},function(e,t,n){"use strict";var r=n(69),i={},o={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function a(e){return e=Math.round(e),e<0?0:e>255?255:e}function s(e){return e=Math.round(e),e<0?0:e>360?360:e}function l(e){return e<0?0:e>1?1:e}function u(e){return e.length&&"%"===e.charAt(e.length-1)?a(parseFloat(e)/100*255):a(parseInt(e,10))}function c(e){return e.length&&"%"===e.charAt(e.length-1)?l(parseFloat(e)/100):l(parseFloat(e))}function d(e,t,n){return n<0?n+=1:n>1&&(n-=1),6*n<1?e+(t-e)*n*6:2*n<1?t:3*n<2?e+(t-e)*(2/3-n)*6:e}function f(e,t,n){return e+(t-e)*n}function h(e,t,n,r,i){return e[0]=t,e[1]=n,e[2]=r,e[3]=i,e}function p(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}var m=new r["a"](20),v=null;function g(e,t){v&&p(v,t),v=m.put(e,v||t.slice())}function y(e,t){var n=(parseFloat(e[0])%360+360)%360/360,r=c(e[1]),i=c(e[2]),o=i<=.5?i*(r+1):i+r-i*r,s=2*i-o;return t=t||[],h(t,a(255*d(s,o,n+1/3)),a(255*d(s,o,n)),a(255*d(s,o,n-1/3)),1),4===e.length&&(t[3]=e[3]),t}function _(e){if(e){var t,n,r=e[0]/255,i=e[1]/255,o=e[2]/255,a=Math.min(r,i,o),s=Math.max(r,i,o),l=s-a,u=(s+a)/2;if(0===l)t=0,n=0;else{n=u<.5?l/(s+a):l/(2-s-a);var c=((s-r)/6+l/2)/l,d=((s-i)/6+l/2)/l,f=((s-o)/6+l/2)/l;r===s?t=f-d:i===s?t=1/3+c-f:o===s&&(t=2/3+d-c),t<0&&(t+=1),t>1&&(t-=1)}var h=[360*t,n,u];return null!=e[3]&&h.push(e[3]),h}}i.parse=function(e,t){if(e){t=t||[];var n=m.get(e);if(n)return p(t,n);e+="";var r=e.replace(/ /g,"").toLowerCase();if(r in o)return p(t,o[r]),g(e,t),t;if("#"!==r.charAt(0)){var i=r.indexOf("("),a=r.indexOf(")");if(-1!==i&&a+1===r.length){var s=r.substr(0,i),l=r.substr(i+1,a-(i+1)).split(","),d=1;switch(s){case"rgba":if(4!==l.length)return void h(t,0,0,0,1);d=c(l.pop());case"rgb":return 3!==l.length?void h(t,0,0,0,1):(h(t,u(l[0]),u(l[1]),u(l[2]),d),g(e,t),t);case"hsla":return 4!==l.length?void h(t,0,0,0,1):(l[3]=c(l[3]),y(l,t),g(e,t),t);case"hsl":return 3!==l.length?void h(t,0,0,0,1):(y(l,t),g(e,t),t);default:return}}h(t,0,0,0,1)}else{if(4===r.length){var f=parseInt(r.substr(1),16);return f>=0&&f<=4095?(h(t,(3840&f)>>4|(3840&f)>>8,240&f|(240&f)>>4,15&f|(15&f)<<4,1),g(e,t),t):void h(t,0,0,0,1)}if(7===r.length){f=parseInt(r.substr(1),16);return f>=0&&f<=16777215?(h(t,(16711680&f)>>16,(65280&f)>>8,255&f,1),g(e,t),t):void h(t,0,0,0,1)}}}},i.parseToFloat=function(e,t){if(t=i.parse(e,t),t)return t[0]/=255,t[1]/=255,t[2]/=255,t},i.lift=function(e,t){var n=i.parse(e);if(n){for(var r=0;r<3;r++)n[r]=t<0?n[r]*(1-t)|0:(255-n[r])*t+n[r]|0;return i.stringify(n,4===n.length?"rgba":"rgb")}},i.toHex=function(e){var t=i.parse(e);if(t)return((1<<24)+(t[0]<<16)+(t[1]<<8)+ +t[2]).toString(16).slice(1)},i.fastLerp=function(e,t,n){if(t&&t.length&&e>=0&&e<=1){n=n||[];var r=e*(t.length-1),i=Math.floor(r),o=Math.ceil(r),s=t[i],u=t[o],c=r-i;return n[0]=a(f(s[0],u[0],c)),n[1]=a(f(s[1],u[1],c)),n[2]=a(f(s[2],u[2],c)),n[3]=l(f(s[3],u[3],c)),n}},i.fastMapToColor=i.fastLerp,i.lerp=function(e,t,n){if(t&&t.length&&e>=0&&e<=1){var r=e*(t.length-1),o=Math.floor(r),s=Math.ceil(r),u=i.parse(t[o]),c=i.parse(t[s]),d=r-o,h=i.stringify([a(f(u[0],c[0],d)),a(f(u[1],c[1],d)),a(f(u[2],c[2],d)),l(f(u[3],c[3],d))],"rgba");return n?{color:h,leftIndex:o,rightIndex:s,value:r}:h}},i.mapToColor=i.lerp,i.modifyHSL=function(e,t,n,r){if(e=i.parse(e),e)return e=_(e),null!=t&&(e[0]=s(t)),null!=n&&(e[1]=c(n)),null!=r&&(e[2]=c(r)),i.stringify(y(e),"rgba")},i.modifyAlpha=function(e,t){if(e=i.parse(e),e&&null!=t)return e[3]=l(t),i.stringify(e,"rgba")},i.stringify=function(e,t){if(e&&e.length){var n=e[0]+","+e[1]+","+e[2];return"rgba"!==t&&"hsva"!==t&&"hsla"!==t||(n+=","+e[3]),t+"("+n+")"}},t["a"]=i},function(e,t,n){"use strict";var r=function(){this.head=null,this.tail=null,this._length=0};r.prototype.insert=function(e){var t=new r.Entry(e);return this.insertEntry(t),t},r.prototype.insertAt=function(e,t){if(!(e<0)){var n=this.head,i=0;while(n&&i!=e)n=n.next,i++;if(n){var o=new r.Entry(t),a=n.prev;a?(a.next=o,o.prev=a):this.head=o,o.next=n,n.prev=o}else this.insert(t)}},r.prototype.insertBeforeEntry=function(e,t){var n=new r.Entry(e),i=t.prev;i?(i.next=n,n.prev=i):this.head=n,n.next=t,t.prev=n,this._length++},r.prototype.insertEntry=function(e){this.head?(this.tail.next=e,e.prev=this.tail,this.tail=e):this.head=this.tail=e,this._length++},r.prototype.remove=function(e){var t=e.prev,n=e.next;t?t.next=n:this.head=n,n?n.prev=t:this.tail=t,e.next=e.prev=null,this._length--},r.prototype.removeAt=function(e){if(!(e<0)){var t=this.head,n=0;while(t&&n!=e)t=t.next,n++;return t?(this.remove(t),t.value):void 0}},r.prototype.getHead=function(){if(this.head)return this.head.value},r.prototype.getTail=function(){if(this.tail)return this.tail.value},r.prototype.getAt=function(e){if(!(e<0)){var t=this.head,n=0;while(t&&n!=e)t=t.next,n++;return t.value}},r.prototype.indexOf=function(e){var t=this.head,n=0;while(t){if(t.value===e)return n;t=t.next,n++}},r.prototype.length=function(){return this._length},r.prototype.isEmpty=function(){return 0===this._length},r.prototype.forEach=function(e,t){var n=this.head,r=0,i="undefined"!=typeof t;while(n)i?e.call(t,n.value,r):e(n.value,r),n=n.next,r++},r.prototype.clear=function(){this.tail=this.head=null,this._length=0},r.Entry=function(e){this.value=e,this.next=null,this.prev=null},t["a"]=r},function(e,t,n){"use strict";var r=n(116),i=/for\s*?\(int\s*?_idx_\s*\=\s*([\w-]+)\;\s*_idx_\s*<\s*([\w-]+);\s*_idx_\s*\+\+\s*\)\s*\{\{([\s\S]+?)(?=\}\})\}\}/g;function o(e,t,n){function r(e,n,r,i){var a="";isNaN(n)&&(n=n in t?t[n]:o[n]),isNaN(r)&&(r=r in t?t[r]:o[r]);for(var s=parseInt(n);s<parseInt(r);s++)a+="{"+i.replace(/float\s*\(\s*_idx_\s*\)/g,s.toFixed(1)).replace(/_idx_/g,s)+"}";return a}var o={};for(var a in n)o[a+"_COUNT"]=n[a];return e.replace(i,r)}function a(e,t,n){var r=[];if(t)for(var i in t){var o=t[i];o>0&&r.push("#define "+i.toUpperCase()+"_COUNT "+o)}if(n)for(var a=0;a<n.length;a++){var s=n[a];r.push("#define "+s.toUpperCase()+"_ENABLED")}for(var s in e){var l=e[s];null===l?r.push("#define "+s):r.push("#define "+s+" "+l.toString())}return r.join("\n")}function s(e){for(var t=[],n=0;n<e.length;n++)t.push("#extension GL_"+e[n]+" : enable");return t.join("\n")}function l(e){return["precision",e,"float"].join(" ")+";\n"+["precision",e,"int"].join(" ")+";\n"+["precision",e,"sampler2D"].join(" ")+";\n"}function u(e){this._renderer=e,this._cache={}}u.prototype.getProgram=function(e,t,n){var i=this._cache,u=e.isSkinnedMesh&&e.isSkinnedMesh(),c="s"+t.shader.shaderID+"m"+t.getProgramKey();n&&(c+="se"+n.getProgramKey(e.lightGroup)),u&&(c+=","+e.joints.length);var d=i[c];if(d)return d;var f=n?n.getLightsNumbers(e.lightGroup):{},h=this._renderer,p=h.gl,m=t.getEnabledTextures(),v="";if(u){var g={SKINNING:null,JOINT_COUNT:e.joints.length};e.joints.length>h.getMaxJointNumber()&&(g.USE_SKIN_MATRICES_TEXTURE=null),v="\n"+a(g)+"\n"}var y=v+a(t.vertexDefines,f,m),_=v+a(t.fragmentDefines,f,m),x=y+"\n"+t.shader.vertex,b=["OES_standard_derivatives","EXT_shader_texture_lod"].filter((function(e){return null!=h.getGLExtension(e)}));b.indexOf("EXT_shader_texture_lod")>=0&&(_+="\n#define SUPPORT_TEXTURE_LOD"),b.indexOf("OES_standard_derivatives")>=0&&(_+="\n#define SUPPORT_STANDARD_DERIVATIVES");var w=s(b)+"\n"+l(t.precision)+"\n"+_+"\n"+t.shader.fragment,A=o(x,t.vertexDefines,f),T=o(w,t.fragmentDefines,f);d=new r["a"];d.uniformSemantics=t.shader.uniformSemantics,d.attributes=t.shader.attributes;var S=d.buildProgram(p,t.shader,A,T);return d.__error=S,i[c]=d,d},t["a"]=u},function(e,t,n){"use strict";var r=n(14),i=n(7),o=1,a=2,s=3,l={};function u(e){for(var t=e.split("\n"),n=0,r=t.length;n<r;n++)t[n]=n+1+": "+t[n];return t.join("\n")}function c(e,t,n){if(!e.getShaderParameter(t,e.COMPILE_STATUS))return[e.getShaderInfoLog(t),u(n)].join("\n")}var d=new r["a"].Float32Array(16),f=i["a"].extend({uniformSemantics:{},attributes:{}},(function(){this._locations={},this._textureSlot=0,this._program=null}),{bind:function(e){this._textureSlot=0,e.gl.useProgram(this._program)},hasUniform:function(e){var t=this._locations[e];return null!==t&&void 0!==t},useTextureSlot:function(e,t,n){t&&(e.gl.activeTexture(e.gl.TEXTURE0+n),t.isRenderable()?t.bind(e):t.unbind(e))},currentTextureSlot:function(){return this._textureSlot},resetTextureSlot:function(e){this._textureSlot=e||0},takeCurrentTextureSlot:function(e,t){var n=this._textureSlot;return this.useTextureSlot(e,t,n),this._textureSlot++,n},setUniform:function(e,t,n,i){var o=this._locations,a=o[n];if(null===a||void 0===a)return!1;switch(t){case"m4":if(!(i instanceof Float32Array)){for(var s=0;s<i.length;s++)d[s]=i[s];i=d}e.uniformMatrix4fv(a,!1,i);break;case"2i":e.uniform2i(a,i[0],i[1]);break;case"2f":e.uniform2f(a,i[0],i[1]);break;case"3i":e.uniform3i(a,i[0],i[1],i[2]);break;case"3f":e.uniform3f(a,i[0],i[1],i[2]);break;case"4i":e.uniform4i(a,i[0],i[1],i[2],i[3]);break;case"4f":e.uniform4f(a,i[0],i[1],i[2],i[3]);break;case"1i":e.uniform1i(a,i);break;case"1f":e.uniform1f(a,i);break;case"1fv":e.uniform1fv(a,i);break;case"1iv":e.uniform1iv(a,i);break;case"2iv":e.uniform2iv(a,i);break;case"2fv":e.uniform2fv(a,i);break;case"3iv":e.uniform3iv(a,i);break;case"3fv":e.uniform3fv(a,i);break;case"4iv":e.uniform4iv(a,i);break;case"4fv":e.uniform4fv(a,i);break;case"m2":case"m2v":e.uniformMatrix2fv(a,!1,i);break;case"m3":case"m3v":e.uniformMatrix3fv(a,!1,i);break;case"m4v":if(Array.isArray(i)&&Array.isArray(i[0])){var l=new r["a"].Float32Array(16*i.length),u=0;for(s=0;s<i.length;s++)for(var c=i[s],f=0;f<16;f++)l[u++]=c[f];e.uniformMatrix4fv(a,!1,l)}else e.uniformMatrix4fv(a,!1,i);break}return!0},setUniformOfSemantic:function(e,t,n){var r=this.uniformSemantics[t];return!!r&&this.setUniform(e,r.type,r.symbol,n)},enableAttributes:function(e,t,n){var r,i=e.gl,u=this._program,c=this._locations;r=n?n.__enabledAttributeList:l[e.__uid__],r||(r=n?n.__enabledAttributeList=[]:l[e.__uid__]=[]);for(var d=[],f=0;f<t.length;f++){var h=t[f];if(this.attributes[h]){var p=c[h];if(null==p){if(p=i.getAttribLocation(u,h),-1===p){d[f]=-1;continue}c[h]=p}d[f]=p,r[p]?r[p]=a:r[p]=o}else d[f]=-1}for(f=0;f<r.length;f++)switch(r[f]){case o:i.enableVertexAttribArray(f),r[f]=s;break;case a:r[f]=s;break;case s:i.disableVertexAttribArray(f),r[f]=0;break}return d},buildProgram:function(e,t,n,r){var i=e.createShader(e.VERTEX_SHADER),o=e.createProgram();e.shaderSource(i,n),e.compileShader(i);var a=e.createShader(e.FRAGMENT_SHADER);e.shaderSource(a,r),e.compileShader(a);var s=c(e,i,n);if(s)return s;if(s=c(e,a,r),s)return s;if(e.attachShader(o,i),e.attachShader(o,a),t.attributeSemantics["POSITION"])e.bindAttribLocation(o,0,t.attributeSemantics["POSITION"].symbol);else{var l=Object.keys(this.attributes);e.bindAttribLocation(o,0,l[0])}if(e.linkProgram(o),!e.getProgramParameter(o,e.LINK_STATUS))return"Could not link program\n"+e.getProgramInfoLog(o);for(var u=0;u<t.uniforms.length;u++){var d=t.uniforms[u];this._locations[d]=e.getUniformLocation(o,d)}e.deleteShader(i),e.deleteShader(a),this._program=o,this.vertexCode=n,this.fragmentCode=r}});t["a"]=f},function(e,t,n){"use strict";var r=n(7),i=n(54),o=n(26),a=n(3),s=n(9),l=n(72),u=n(11),c=n(12),d=r["a"].extend({scene:null,camera:null,renderer:null},(function(){this._ray=new i["a"],this._ndc=new o["a"]}),{pick:function(e,t,n){var r=this.pickAll(e,t,[],n);return r[0]||null},pickAll:function(e,t,n,r){return this.renderer.screenToNDC(e,t,this._ndc),this.camera.castRay(this._ndc,this._ray),n=n||[],this._intersectNode(this.scene,n,r||!1),n.sort(this._intersectionCompareFunc),n},_intersectNode:function(e,t,n){e instanceof l["a"]&&e.isRenderable()&&(e.ignorePicking&&!n||!(e.mode===u["a"].TRIANGLES&&e.geometry.isUseIndices()||e.geometry.pickByRay||e.geometry.pick)||this._intersectRenderable(e,t));for(var r=0;r<e._children.length;r++)this._intersectNode(e._children[r],t,n)},_intersectRenderable:function(){var e=new a["a"],t=new a["a"],n=new a["a"],r=new i["a"],o=new s["a"];return function(i,l){var f=i.isSkinnedMesh();r.copy(this._ray),s["a"].invert(o,i.worldTransform),f||r.applyTransform(o);var h=i.geometry,p=f?i.skeleton.boundingBox:h.boundingBox;if(!p||r.intersectBoundingBox(p))if(h.pick)h.pick(this._ndc.x,this._ndc.y,this.renderer,this.camera,i,l);else if(h.pickByRay)h.pickByRay(r,i,l);else{var m,v,g=i.cullFace===u["a"].BACK&&i.frontFace===u["a"].CCW||i.cullFace===u["a"].FRONT&&i.frontFace===u["a"].CW,y=h.indices,_=h.attributes.position,x=h.attributes.weight,b=h.attributes.joint,w=[];if(_&&_.value&&y){if(f){v=i.skeleton.getSubSkinMatrices(i.__uid__,i.joints);for(var A=0;A<i.joints.length;A++){w[A]=w[A]||[];for(var T=0;T<16;T++)w[A][T]=v[16*A+T]}var S=[],E=[],C=[],M=[],L=[],N=h.attributes.skinnedPosition;N&&N.value||(h.createAttribute("skinnedPosition","f",3),N=h.attributes.skinnedPosition,N.init(h.vertexCount));for(A=0;A<h.vertexCount;A++){_.get(A,S),x.get(A,E),b.get(A,C),E[3]=1-E[0]-E[1]-E[2],c["a"].set(M,0,0,0);for(T=0;T<4;T++)C[T]>=0&&E[T]>1e-4&&(c["a"].transformMat4(L,S,w[C[T]]),c["a"].scaleAndAdd(M,M,L,E[T]));N.set(A,M)}}for(A=0;A<y.length;A+=3){var D=y[A],O=y[A+1],I=y[A+2],R=f?h.attributes.skinnedPosition:_;if(R.get(D,e.array),R.get(O,t.array),R.get(I,n.array),m=g?r.intersectTriangle(e,t,n,i.culling):r.intersectTriangle(e,n,t,i.culling),m){var P=new a["a"];f?a["a"].copy(P,m):a["a"].transformMat4(P,m,i.worldTransform),l.push(new d.Intersection(m,P,i,[D,O,I],A/3,a["a"].dist(P,this._ray.origin)))}}}}}}(),_intersectionCompareFunc:function(e,t){return e.distance-t.distance}});d.Intersection=function(e,t,n,r,i,o){this.point=e,this.pointWorld=t,this.target=n,this.triangle=r,this.triangleIndex=i,this.distance=o},t["a"]=d},function(e,t,n){"use strict";var r=n(7),i=n(11),o=n(57),a=n(14);function s(e){return{byte:a["a"].Int8Array,ubyte:a["a"].Uint8Array,short:a["a"].Int16Array,ushort:a["a"].Uint16Array}[e]||a["a"].Float32Array}function l(e){return"attr_"+e}function u(e,t,n,r){switch(this.name=e,this.type=t,this.size=n,this.semantic=r||"",this.value=null,n){case 1:this.get=function(e){return this.value[e]},this.set=function(e,t){this.value[e]=t},this.copy=function(e,t){this.value[e]=this.value[e]};break;case 2:this.get=function(e,t){var n=this.value;return t[0]=n[2*e],t[1]=n[2*e+1],t},this.set=function(e,t){var n=this.value;n[2*e]=t[0],n[2*e+1]=t[1]},this.copy=function(e,t){var n=this.value;t*=2,e*=2,n[e]=n[t],n[e+1]=n[t+1]};break;case 3:this.get=function(e,t){var n=3*e,r=this.value;return t[0]=r[n],t[1]=r[n+1],t[2]=r[n+2],t},this.set=function(e,t){var n=3*e,r=this.value;r[n]=t[0],r[n+1]=t[1],r[n+2]=t[2]},this.copy=function(e,t){var n=this.value;t*=3,e*=3,n[e]=n[t],n[e+1]=n[t+1],n[e+2]=n[t+2]};break;case 4:this.get=function(e,t){var n=this.value,r=4*e;return t[0]=n[r],t[1]=n[r+1],t[2]=n[r+2],t[3]=n[r+3],t},this.set=function(e,t){var n=this.value,r=4*e;n[r]=t[0],n[r+1]=t[1],n[r+2]=t[2],n[r+3]=t[3]},this.copy=function(e,t){var n=this.value;t*=4,e*=4,n[e]=n[t],n[e+1]=n[t+1],n[e+2]=n[t+2],n[e+3]=n[t+3]}}}function c(e,t,n,r,i){this.name=e,this.type=t,this.buffer=n,this.size=r,this.semantic=i,this.symbol="",this.needsRemove=!1}function d(e){this.buffer=e,this.count=0}u.prototype.init=function(e){if(!this.value||this.value.length!=e*this.size){var t=s(this.type);this.value=new t(e*this.size)}},u.prototype.fromArray=function(e){var t,n=s(this.type);if(e[0]&&e[0].length){var r=0,i=this.size;t=new n(e.length*i);for(var o=0;o<e.length;o++)for(var a=0;a<i;a++)t[r++]=e[o][a]}else t=new n(e);this.value=t},u.prototype.clone=function(e){var t=new u(this.name,this.type,this.size,this.semantic);return e&&console.warn("todo"),t};var f=r["a"].extend((function(){return{attributes:{},indices:null,dynamic:!0,_enabledAttributes:null,__used:0}}),(function(){this._cache=new o["a"],this._attributeList=Object.keys(this.attributes),this.__vaoCache={}}),{mainAttribute:"",pick:null,pickByRay:null,dirty:function(){for(var e=this.getEnabledAttributes(),t=0;t<e.length;t++)this.dirtyAttribute(e[t]);this.dirtyIndices(),this._enabledAttributes=null,this._cache.dirty("any")},dirtyIndices:function(){this._cache.dirtyAll("indices")},dirtyAttribute:function(e){this._cache.dirtyAll(l(e)),this._cache.dirtyAll("attributes")},getTriangleIndices:function(e,t){if(e<this.triangleCount&&e>=0){t||(t=[]);var n=this.indices;return t[0]=n[3*e],t[1]=n[3*e+1],t[2]=n[3*e+2],t}},setTriangleIndices:function(e,t){var n=this.indices;n[3*e]=t[0],n[3*e+1]=t[1],n[3*e+2]=t[2]},isUseIndices:function(){return!!this.indices},initIndicesFromArray:function(e){var t,n=this.vertexCount>65535?a["a"].Uint32Array:a["a"].Uint16Array;if(e[0]&&e[0].length){var r=0,i=3;t=new n(e.length*i);for(var o=0;o<e.length;o++)for(var s=0;s<i;s++)t[r++]=e[o][s]}else t=new n(e);this.indices=t},createAttribute:function(e,t,n,r){var i=new u(e,t,n,r);return this.attributes[e]&&this.removeAttribute(e),this.attributes[e]=i,this._attributeList.push(e),i},removeAttribute:function(e){var t=this._attributeList,n=t.indexOf(e);return n>=0&&(t.splice(n,1),delete this.attributes[e],!0)},getAttribute:function(e){return this.attributes[e]},getEnabledAttributes:function(){var e=this._enabledAttributes,t=this._attributeList;if(e)return e;for(var n=[],r=this.vertexCount,i=0;i<t.length;i++){var o=t[i],a=this.attributes[o];a.value&&a.value.length===r*a.size&&n.push(o)}return this._enabledAttributes=n,n},getBufferChunks:function(e){var t=this._cache;t.use(e.__uid__);var n=t.isDirty("attributes"),r=t.isDirty("indices");if(n||r){this._updateBuffer(e.gl,n,r);for(var i=this.getEnabledAttributes(),o=0;o<i.length;o++)t.fresh(l(i[o]));t.fresh("attributes"),t.fresh("indices")}return t.fresh("any"),t.get("chunks")},_updateBuffer:function(e,t,n){var r=this._cache,o=r.get("chunks"),a=!1;o||(o=[],o[0]={attributeBuffers:[],indicesBuffer:null},r.put("chunks",o),a=!0);var s=o[0],u=s.attributeBuffers,f=s.indicesBuffer;if(t||a){var h=this.getEnabledAttributes(),p={};if(!a)for(var m=0;m<u.length;m++)p[u[m].name]=u[m];for(var v=0;v<h.length;v++){var g,y,_=h[v],x=this.attributes[_];a||(g=p[_]),y=g?g.buffer:e.createBuffer(),r.isDirty(l(_))&&(e.bindBuffer(e.ARRAY_BUFFER,y),e.bufferData(e.ARRAY_BUFFER,x.value,this.dynamic?i["a"].DYNAMIC_DRAW:i["a"].STATIC_DRAW)),u[v]=new c(_,x.type,y,x.size,x.semantic)}for(m=v;m<u.length;m++)e.deleteBuffer(u[m].buffer);u.length=v}this.isUseIndices()&&(n||a)&&(f||(f=new d(e.createBuffer()),s.indicesBuffer=f),f.count=this.indices.length,e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,f.buffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,this.indices,this.dynamic?i["a"].DYNAMIC_DRAW:i["a"].STATIC_DRAW))},dispose:function(e){var t=this._cache;t.use(e.__uid__);var n=t.get("chunks");if(n)for(var r=0;r<n.length;r++){for(var i=n[r],o=0;o<i.attributeBuffers.length;o++){var a=i.attributeBuffers[o];e.gl.deleteBuffer(a.buffer)}i.indicesBuffer&&e.gl.deleteBuffer(i.indicesBuffer.buffer)}if(this.__vaoCache){var s=e.getGLExtension("OES_vertex_array_object");for(var l in this.__vaoCache){var u=this.__vaoCache[l].vao;u&&s.deleteVertexArrayOES(u)}}this.__vaoCache={},t.deleteContext(e.__uid__)}});Object.defineProperty&&(Object.defineProperty(f.prototype,"vertexCount",{enumerable:!1,get:function(){var e=this.attributes[this.mainAttribute];return e||(e=this.attributes[this._attributeList[0]]),e&&e.value?e.value.length/e.size:0}}),Object.defineProperty(f.prototype,"triangleCount",{enumerable:!1,get:function(){var e=this.indices;return e?e.length/3:0}})),f.STATIC_DRAW=i["a"].STATIC_DRAW,f.DYNAMIC_DRAW=i["a"].DYNAMIC_DRAW,f.STREAM_DRAW=i["a"].STREAM_DRAW,f.AttributeBuffer=c,f.IndicesBuffer=d,f.Attribute=u,t["a"]=f},function(e,t,n){"use strict";var r=n(120),i="uniform vec3 ",o="uniform float ",a="@export clay.header.",s="@end",l=":unconfigurable;";t["a"]=[a+"directional_light",i+"directionalLightDirection[DIRECTIONAL_LIGHT_COUNT]"+l,i+"directionalLightColor[DIRECTIONAL_LIGHT_COUNT]"+l,s,a+"ambient_light",i+"ambientLightColor[AMBIENT_LIGHT_COUNT]"+l,s,a+"ambient_sh_light",i+"ambientSHLightColor[AMBIENT_SH_LIGHT_COUNT]"+l,i+"ambientSHLightCoefficients[AMBIENT_SH_LIGHT_COUNT * 9]"+l,r["a"],s,a+"ambient_cubemap_light",i+"ambientCubemapLightColor[AMBIENT_CUBEMAP_LIGHT_COUNT]"+l,"uniform samplerCube ambientCubemapLightCubemap[AMBIENT_CUBEMAP_LIGHT_COUNT]"+l,"uniform sampler2D ambientCubemapLightBRDFLookup[AMBIENT_CUBEMAP_LIGHT_COUNT]"+l,s,a+"point_light",i+"pointLightPosition[POINT_LIGHT_COUNT]"+l,o+"pointLightRange[POINT_LIGHT_COUNT]"+l,i+"pointLightColor[POINT_LIGHT_COUNT]"+l,s,a+"spot_light",i+"spotLightPosition[SPOT_LIGHT_COUNT]"+l,i+"spotLightDirection[SPOT_LIGHT_COUNT]"+l,o+"spotLightRange[SPOT_LIGHT_COUNT]"+l,o+"spotLightUmbraAngleCosine[SPOT_LIGHT_COUNT]"+l,o+"spotLightPenumbraAngleCosine[SPOT_LIGHT_COUNT]"+l,o+"spotLightFalloffFactor[SPOT_LIGHT_COUNT]"+l,i+"spotLightColor[SPOT_LIGHT_COUNT]"+l,s].join("\n")},function(e,t,n){"use strict";t["a"]="vec3 calcAmbientSHLight(int idx, vec3 N) {\n int offset = 9 * idx;\n return ambientSHLightCoefficients[0]\n + ambientSHLightCoefficients[1] * N.x\n + ambientSHLightCoefficients[2] * N.y\n + ambientSHLightCoefficients[3] * N.z\n + ambientSHLightCoefficients[4] * N.x * N.z\n + ambientSHLightCoefficients[5] * N.z * N.y\n + ambientSHLightCoefficients[6] * N.y * N.x\n + ambientSHLightCoefficients[7] * (3.0 * N.z * N.z - 1.0)\n + ambientSHLightCoefficients[8] * (N.x * N.x - N.y * N.y);\n}"},function(e,t,n){"use strict";t["a"]="@export clay.skybox.vertex\n#define SHADER_NAME skybox\nuniform mat4 world : WORLD;\nuniform mat4 worldViewProjection : WORLDVIEWPROJECTION;\nattribute vec3 position : POSITION;\nvarying vec3 v_WorldPosition;\nvoid main()\n{\n v_WorldPosition = (world * vec4(position, 1.0)).xyz;\n gl_Position = worldViewProjection * vec4(position, 1.0);\n}\n@end\n@export clay.skybox.fragment\n#define PI 3.1415926\nuniform mat4 viewInverse : VIEWINVERSE;\n#ifdef EQUIRECTANGULAR\nuniform sampler2D environmentMap;\n#else\nuniform samplerCube environmentMap;\n#endif\nuniform float lod: 0.0;\nvarying vec3 v_WorldPosition;\n@import clay.util.rgbm\n@import clay.util.srgb\n@import clay.util.ACES\nvoid main()\n{\n vec3 eyePos = viewInverse[3].xyz;\n vec3 V = normalize(v_WorldPosition - eyePos);\n#ifdef EQUIRECTANGULAR\n float phi = acos(V.y);\n float theta = atan(-V.x, V.z) + PI * 0.5;\n vec2 uv = vec2(theta / 2.0 / PI, phi / PI);\n vec4 texel = decodeHDR(texture2D(environmentMap, fract(uv)));\n#else\n #if defined(LOD) || defined(SUPPORT_TEXTURE_LOD)\n vec4 texel = decodeHDR(textureCubeLodEXT(environmentMap, V, lod));\n #else\n vec4 texel = decodeHDR(textureCube(environmentMap, V));\n #endif\n#endif\n#ifdef SRGB_DECODE\n texel = sRGBToLinear(texel);\n#endif\n#ifdef TONEMAPPING\n texel.rgb = ACESToneMapping(texel.rgb);\n#endif\n#ifdef SRGB_ENCODE\n texel = linearTosRGB(texel);\n#endif\n gl_FragColor = encodeHDR(vec4(texel.rgb, 1.0));\n}\n@end"},function(e,t,n){"use strict";var r=n(4),i=n(5),o=(n(27),542327876),a=131072,s=512,l=4;function u(e){return e.charCodeAt(0)+(e.charCodeAt(1)<<8)+(e.charCodeAt(2)<<16)+(e.charCodeAt(3)<<24)}var c=31,d=u("DXT1"),f=u("DXT3"),h=u("DXT5"),p=0,m=1,v=2,g=3,y=4,_=7,x=20,b=21,w=28,A={parse:function(e,t){var n=new Int32Array(e,0,c);if(n[p]!==o)return null;if(!n(x)&l)return null;var u,A,T=n(b),S=n[y],E=n[g],C=n[w]&s,M=n[v]&a;switch(T){case d:u=8,A=r["a"].COMPRESSED_RGB_S3TC_DXT1_EXT;break;case f:u=16,A=r["a"].COMPRESSED_RGBA_S3TC_DXT3_EXT;break;case h:u=16,A=r["a"].COMPRESSED_RGBA_S3TC_DXT5_EXT;break;default:return null}var L=n[m]+4,N=C?6:1,D=1;M&&(D=Math.max(1,n[_]));for(var O=[],I=0;I<N;I++){var R=S,P=E;O[I]=new i["a"]({width:R,height:P,format:A});for(var k=[],B=0;B<D;B++){var F=Math.max(4,R)/4*Math.max(4,P)/4*u,z=new Uint8Array(e,L,F);L+=F,R*=.5,P*=.5,k[B]=z}O[I].pixels=k[0],M&&(O[I].mipmaps=k)}if(!t)return O[0];t.width=O[0].width,t.height=O[0].height,t.format=O[0].format,t.pixels=O[0].pixels,t.mipmaps=O[0].mipmaps}};t["a"]=A},function(e,t,n){"use strict";var r=n(4),i=n(5),o=String.fromCharCode,a=8,s=32767;function l(e,t,n,r){if(e[3]>0){var i=Math.pow(2,e[3]-128-8+r);t[n+0]=e[0]*i,t[n+1]=e[1]*i,t[n+2]=e[2]*i}else t[n+0]=0,t[n+1]=0,t[n+2]=0;return t[n+3]=1,t}function u(e,t,n){for(var r="",i=t;i<n;i++)r+=o(e[i]);return r}function c(e,t){t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3]}function d(e,t,n,r){var i=0,o=0,a=r;while(a>0)if(e[o][0]=t[n++],e[o][1]=t[n++],e[o][2]=t[n++],e[o][3]=t[n++],1===e[o][0]&&1===e[o][1]&&1===e[o][2]){for(var s=e[o][3]<<i>>>0;s>0;s--)c(e[o-1],e[o]),o++,a--;i+=8}else o++,a--,i=0;return n}function f(e,t,n,r){if(r<a|r>s)return d(e,t,n,r);var i=t[n++];if(2!=i)return d(e,t,n-1,r);if(e[0][1]=t[n++],e[0][2]=t[n++],i=t[n++],(e[0][2]<<8>>>0|i)>>>0!==r)return null;for(i=0;i<4;i++)for(var o=0;o<r;){var l=t[n++];if(l>128){l=(127&l)>>>0;var u=t[n++];while(l--)e[o++][i]=u}else while(l--)e[o++][i]=t[n++]}return n}var h={parseRGBE:function(e,t,n){null==n&&(n=0);var a=new Uint8Array(e),s=a.length;if("#?"===u(a,0,2)){for(var c=2;c<s;c++)if("\n"===o(a[c])&&"\n"===o(a[c+1]))break;if(!(c>=s)){c+=2;for(var d="";c<s;c++){var h=o(a[c]);if("\n"===h)break;d+=h}var p=d.split(" "),m=parseInt(p[1]),v=parseInt(p[3]);if(v&&m){for(var g=c+1,y=[],_=0;_<v;_++){y[_]=[];for(var x=0;x<4;x++)y[_][x]=0}for(var b=new Float32Array(v*m*4),w=0,A=0;A<m;A++){g=f(y,a,g,v);if(!g)return null;for(_=0;_<v;_++)l(y[_],b,w,n),w+=4}return t||(t=new i["a"]),t.width=v,t.height=m,t.pixels=b,t.type=r["a"].FLOAT,t}}}},parseRGBEFromPNG:function(e){}};t["a"]=h},function(e,t,n){"use strict";var r=n(5),i=n(3),o=n(26),a=["mousedown","mouseup","mousemove","mouseover","mouseout","click","dblclick","contextmenu"];function s(e){return"_on"+e}var l=function(e){var t=this;this._texture=new r["a"]({anisotropic:32,flipY:!1,surface:this,dispose:function(e){t.dispose(),r["a"].prototype.dispose.call(this,e)}}),a.forEach((function(e){this[s(e)]=function(t){t.triangle&&this._meshes.forEach((function(n){this.dispatchEvent(e,n,t.triangle,t.point)}),this)}}),this),this._meshes=[],e&&this.setECharts(e),this.onupdate=null};l.prototype={constructor:l,getTexture:function(){return this._texture},setECharts:function(e){this._chart=e;var t=e.getDom();if(t instanceof HTMLCanvasElement){var n=this,r=e.getZr(),i=r.__oldRefreshImmediately||r.refreshImmediately;r.refreshImmediately=function(){i.call(this),n._texture.dirty(),n.onupdate&&n.onupdate()},r.__oldRefreshImmediately=i}else console.error("ECharts must init on canvas if it is used as texture."),t=document.createElement("canvas");this._texture.image=t,this._texture.dirty(),this.onupdate&&this.onupdate()},dispatchEvent:function(){var e=new i["a"],t=new i["a"],n=new i["a"],r=new o["a"],a=new o["a"],s=new o["a"],l=new o["a"],u=new i["a"];return function(c,d,f,h){var p=d.geometry,m=p.attributes.position,v=p.attributes.texcoord0,g=i["a"].dot,y=i["a"].cross;m.get(f[0],e.array),m.get(f[1],t.array),m.get(f[2],n.array),v.get(f[0],r.array),v.get(f[1],a.array),v.get(f[2],s.array),y(u,t,n);var _=g(e,u),x=g(h,u)/_;y(u,n,e);var b=g(h,u)/_;y(u,e,t);var w=g(h,u)/_;o["a"].scale(l,r,x),o["a"].scaleAndAdd(l,l,a,b),o["a"].scaleAndAdd(l,l,s,w);var A=l.x*this._chart.getWidth(),T=l.y*this._chart.getHeight();this._chart.getZr().handler.dispatch(c,{zrX:A,zrY:T})}}(),attachToMesh:function(e){this._meshes.indexOf(e)>=0||(a.forEach((function(t){e.on(t,this[s(t)],this)}),this),this._meshes.push(e))},detachFromMesh:function(e){var t=this._meshes.indexOf(e);t>=0&&this._meshes.splice(t,1),a.forEach((function(t){e.off(t,this[s(t)])}),this)},dispose:function(){this._meshes.forEach((function(e){this.detachFromMesh(e)}),this)}},t["a"]=l},function(e,t,n){"use strict";var r=n(24),i=n(77),o=r["a"].extend({cubemap:null,castShadow:!1,_normalDistribution:null,_brdfLookup:null},{type:"AMBIENT_CUBEMAP_LIGHT",prefilter:function(e,t){if(e.getGLExtension("EXT_shader_texture_lod")){this._brdfLookup||(this._normalDistribution=i["a"].generateNormalDistribution(),this._brdfLookup=i["a"].integrateBRDF(e,this._normalDistribution));var n=this.cubemap;if(!n.__prefiltered){var r=i["a"].prefilterEnvironmentMap(e,n,{encodeRGBM:!0,width:t,height:t},this._normalDistribution,this._brdfLookup);this.cubemap=r.environmentMap,this.cubemap.__prefiltered=!0,n.dispose(e)}}else console.warn("Device not support textureCubeLodEXT")},getBRDFLookup:function(){return this._brdfLookup},uniformTemplates:{ambientCubemapLightColor:{type:"3f",value:function(e){var t=e.color,n=e.intensity;return[t[0]*n,t[1]*n,t[2]*n]}},ambientCubemapLightCubemap:{type:"t",value:function(e){return e.cubemap}},ambientCubemapLightBRDFLookup:{type:"t",value:function(e){return e._brdfLookup}}}});t["a"]=o},function(e,t,n){"use strict";t["a"]="\n@export clay.compositor.vertex\nuniform mat4 worldViewProjection : WORLDVIEWPROJECTION;\nattribute vec3 position : POSITION;\nattribute vec2 texcoord : TEXCOORD_0;\nvarying vec2 v_Texcoord;\nvoid main()\n{\n v_Texcoord = texcoord;\n gl_Position = worldViewProjection * vec4(position, 1.0);\n}\n@end"},function(e,t,n){"use strict";t["a"]="#define SAMPLE_NUMBER 1024\n#define PI 3.14159265358979\nuniform sampler2D normalDistribution;\nuniform vec2 viewportSize : [512, 256];\nconst vec3 N = vec3(0.0, 0.0, 1.0);\nconst float fSampleNumber = float(SAMPLE_NUMBER);\nvec3 importanceSampleNormal(float i, float roughness, vec3 N) {\n vec3 H = texture2D(normalDistribution, vec2(roughness, i)).rgb;\n vec3 upVector = abs(N.y) > 0.999 ? vec3(1.0, 0.0, 0.0) : vec3(0.0, 1.0, 0.0);\n vec3 tangentX = normalize(cross(N, upVector));\n vec3 tangentZ = cross(N, tangentX);\n return normalize(tangentX * H.x + N * H.y + tangentZ * H.z);\n}\nfloat G_Smith(float roughness, float NoV, float NoL) {\n float k = roughness * roughness / 2.0;\n float G1V = NoV / (NoV * (1.0 - k) + k);\n float G1L = NoL / (NoL * (1.0 - k) + k);\n return G1L * G1V;\n}\nvoid main() {\n vec2 uv = gl_FragCoord.xy / viewportSize;\n float NoV = uv.x;\n float roughness = uv.y;\n vec3 V;\n V.x = sqrt(1.0 - NoV * NoV);\n V.y = 0.0;\n V.z = NoV;\n float A = 0.0;\n float B = 0.0;\n for (int i = 0; i < SAMPLE_NUMBER; i++) {\n vec3 H = importanceSampleNormal(float(i) / fSampleNumber, roughness, N);\n vec3 L = reflect(-V, H);\n float NoL = clamp(L.z, 0.0, 1.0);\n float NoH = clamp(H.z, 0.0, 1.0);\n float VoH = clamp(dot(V, H), 0.0, 1.0);\n if (NoL > 0.0) {\n float G = G_Smith(roughness, NoV, NoL);\n float G_Vis = G * VoH / (NoH * NoV);\n float Fc = pow(1.0 - VoH, 5.0);\n A += (1.0 - Fc) * G_Vis;\n B += Fc * G_Vis;\n }\n }\n gl_FragColor = vec4(vec2(A, B) / fSampleNumber, 0.0, 1.0);\n}\n"},function(e,t,n){"use strict";t["a"]="#define SHADER_NAME prefilter\n#define SAMPLE_NUMBER 1024\n#define PI 3.14159265358979\nuniform mat4 viewInverse : VIEWINVERSE;\nuniform samplerCube environmentMap;\nuniform sampler2D normalDistribution;\nuniform float roughness : 0.5;\nvarying vec2 v_Texcoord;\nvarying vec3 v_WorldPosition;\n@import clay.util.rgbm\nvec3 importanceSampleNormal(float i, float roughness, vec3 N) {\n vec3 H = texture2D(normalDistribution, vec2(roughness, i)).rgb;\n vec3 upVector = abs(N.y) > 0.999 ? vec3(1.0, 0.0, 0.0) : vec3(0.0, 1.0, 0.0);\n vec3 tangentX = normalize(cross(N, upVector));\n vec3 tangentZ = cross(N, tangentX);\n return normalize(tangentX * H.x + N * H.y + tangentZ * H.z);\n}\nvoid main() {\n vec3 eyePos = viewInverse[3].xyz;\n vec3 V = normalize(v_WorldPosition - eyePos);\n vec3 N = V;\n vec3 prefilteredColor = vec3(0.0);\n float totalWeight = 0.0;\n float fMaxSampleNumber = float(SAMPLE_NUMBER);\n for (int i = 0; i < SAMPLE_NUMBER; i++) {\n vec3 H = importanceSampleNormal(float(i) / fMaxSampleNumber, roughness, N);\n vec3 L = reflect(-V, H);\n float NoL = clamp(dot(N, L), 0.0, 1.0);\n if (NoL > 0.0) {\n prefilteredColor += decodeHDR(textureCube(environmentMap, L)).rgb * NoL;\n totalWeight += NoL;\n }\n }\n gl_FragColor = encodeHDR(vec4(prefilteredColor / totalWeight, 1.0));\n}\n"},function(e,t,n){"use strict";var r=n(24),i=n(14),o=r["a"].extend({castShadow:!1,coefficients:[]},(function(){this._coefficientsTmpArr=new i["a"].Float32Array(27)}),{type:"AMBIENT_SH_LIGHT",uniformTemplates:{ambientSHLightColor:{type:"3f",value:function(e){var t=e.color,n=e.intensity;return[t[0]*n,t[1]*n,t[2]*n]}},ambientSHLightCoefficients:{type:"3f",value:function(e){for(var t=e._coefficientsTmpArr,n=0;n<e.coefficients.length;n++)t[n]=e.coefficients[n];return t}}}});t["a"]=o},function(e,t,n){"use strict";var r=n(4),i=n(10),o=n(5),a=(n(16),n(14)),s=n(42),l=n(75),u=n(62),c=n(36),d=n(12),f=(n(131),{}),h=["px","nx","py","ny","pz","nz"];function p(e,t){var n=e[0],r=e[1],i=e[2];return 0===t?1:1===t?n:2===t?r:3===t?i:4===t?n*i:5===t?r*i:6===t?n*r:7===t?3*i*i-1:n*n-r*r}var m={px:[2,1,0,-1,-1,1],nx:[2,1,0,1,-1,-1],py:[0,2,1,1,-1,-1],ny:[0,2,1,1,1,1],pz:[0,1,2,-1,-1,-1],nz:[0,1,2,1,-1,1]};function v(e,t,n,r){for(var i=new a["a"].Float32Array(27),o=d["a"].create(),s=d["a"].create(),l=d["a"].create(),u=0;u<9;u++){for(var c=d["a"].create(),f=0;f<h.length;f++){for(var v=t[h[f]],g=d["a"].create(),y=0,_=0,x=m[h[f]],b=0;b<r;b++)for(var w=0;w<n;w++){o[0]=w/(n-1)*2-1,o[1]=b/(r-1)*2-1,o[2]=-1,d["a"].normalize(o,o),l[0]=o[x[0]]*x[3],l[1]=o[x[1]]*x[4],l[2]=o[x[2]]*x[5],s[0]=v[_++]/255,s[1]=v[_++]/255,s[2]=v[_++]/255;var A=v[_++]/255*8.12;s[0]*=A,s[1]*=A,s[2]*=A,d["a"].scaleAndAdd(g,g,s,p(l,u)*-o[2]),y+=-o[2]}d["a"].scaleAndAdd(c,c,g,1/y)}i[3*u]=c[0]/6,i[3*u+1]=c[1]/6,i[3*u+2]=c[2]/6}return i}f.projectEnvironmentMap=function(e,t,n){var a;n=n||{},n.lod=n.lod||0;var d=new c["a"],f=64;"texture2D"===t.textureType?a=new l["a"]({scene:d,environmentMap:t}):(f=t.image&&t.image.px?t.image.px.width:t.width,a=new s["a"]({scene:d,environmentMap:t}));var p=Math.ceil(f/Math.pow(2,n.lod)),m=Math.ceil(f/Math.pow(2,n.lod)),g=new o["a"]({width:p,height:m}),y=new i["a"];a.material.define("fragment","RGBM_ENCODE"),n.decodeRGBM&&a.material.define("fragment","RGBM_DECODE"),a.material.set("lod",n.lod);for(var _=new u["a"]({texture:g}),x={},b=0;b<h.length;b++){x[h[b]]=new Uint8Array(p*m*4);var w=_.getCamera(h[b]);w.fov=90,y.attach(g),y.bind(e),e.render(d,w),e.gl.readPixels(0,0,p,m,r["a"].RGBA,r["a"].UNSIGNED_BYTE,x[h[b]]),y.unbind(e)}return a.dispose(e),y.dispose(e),g.dispose(e),v(e,x,p,m)},t["a"]=f},function(e,t,n){"use strict";t["a"]="uniform samplerCube environmentMap;\nvarying vec2 v_Texcoord;\n#define TEXTURE_SIZE 16\nmat3 front = mat3(\n 1.0, 0.0, 0.0,\n 0.0, 1.0, 0.0,\n 0.0, 0.0, 1.0\n);\nmat3 back = mat3(\n -1.0, 0.0, 0.0,\n 0.0, 1.0, 0.0,\n 0.0, 0.0, -1.0\n);\nmat3 left = mat3(\n 0.0, 0.0, -1.0,\n 0.0, 1.0, 0.0,\n 1.0, 0.0, 0.0\n);\nmat3 right = mat3(\n 0.0, 0.0, 1.0,\n 0.0, 1.0, 0.0,\n -1.0, 0.0, 0.0\n);\nmat3 up = mat3(\n 1.0, 0.0, 0.0,\n 0.0, 0.0, 1.0,\n 0.0, -1.0, 0.0\n);\nmat3 down = mat3(\n 1.0, 0.0, 0.0,\n 0.0, 0.0, -1.0,\n 0.0, 1.0, 0.0\n);\nfloat harmonics(vec3 normal){\n int index = int(gl_FragCoord.x);\n float x = normal.x;\n float y = normal.y;\n float z = normal.z;\n if(index==0){\n return 1.0;\n }\n else if(index==1){\n return x;\n }\n else if(index==2){\n return y;\n }\n else if(index==3){\n return z;\n }\n else if(index==4){\n return x*z;\n }\n else if(index==5){\n return y*z;\n }\n else if(index==6){\n return x*y;\n }\n else if(index==7){\n return 3.0*z*z - 1.0;\n }\n else{\n return x*x - y*y;\n }\n}\nvec3 sampleSide(mat3 rot)\n{\n vec3 result = vec3(0.0);\n float divider = 0.0;\n for (int i = 0; i < TEXTURE_SIZE * TEXTURE_SIZE; i++) {\n float x = mod(float(i), float(TEXTURE_SIZE));\n float y = float(i / TEXTURE_SIZE);\n vec2 sidecoord = ((vec2(x, y) + vec2(0.5, 0.5)) / vec2(TEXTURE_SIZE)) * 2.0 - 1.0;\n vec3 normal = normalize(vec3(sidecoord, -1.0));\n vec3 fetchNormal = rot * normal;\n vec3 texel = textureCube(environmentMap, fetchNormal).rgb;\n result += harmonics(fetchNormal) * texel * -normal.z;\n divider += -normal.z;\n }\n return result / divider;\n}\nvoid main()\n{\n vec3 result = (\n sampleSide(front) +\n sampleSide(back) +\n sampleSide(left) +\n sampleSide(right) +\n sampleSide(up) +\n sampleSide(down)\n ) / 6.0;\n gl_FragColor = vec4(result, 1.0);\n}"},function(e,t,n){"use strict";var r=n(15),i=n(18),o=r["a"].extend({dynamic:!1,widthSegments:40,heightSegments:20,phiStart:0,phiLength:2*Math.PI,thetaStart:0,thetaLength:Math.PI,radius:1},(function(){this.build()}),{build:function(){var e=this.heightSegments,t=this.widthSegments,n=this.attributes.position,r=this.attributes.texcoord0,o=this.attributes.normal,a=(t+1)*(e+1);n.init(a),r.init(a),o.init(a);var s,l,u,c,d,f,h,p,m,v,g,y=a>65535?Uint32Array:Uint16Array,_=this.indices=new y(t*e*6),x=this.radius,b=this.phiStart,w=this.phiLength,A=this.thetaStart,T=this.thetaLength,S=(x=this.radius,[]),E=[],C=0,M=1/x;for(h=0;h<=e;h++)for(f=0;f<=t;f++)c=f/t,d=h/e,s=-x*Math.cos(b+c*w)*Math.sin(A+d*T),l=x*Math.cos(A+d*T),u=x*Math.sin(b+c*w)*Math.sin(A+d*T),S[0]=s,S[1]=l,S[2]=u,E[0]=c,E[1]=d,n.set(C,S),r.set(C,E),S[0]*=M,S[1]*=M,S[2]*=M,o.set(C,S),C++;var L=t+1,N=0;for(h=0;h<e;h++)for(f=0;f<t;f++)m=h*L+f,p=h*L+f+1,g=(h+1)*L+f+1,v=(h+1)*L+f,_[N++]=p,_[N++]=m,_[N++]=g,_[N++]=m,_[N++]=v,_[N++]=g;this.boundingBox=new i["a"],this.boundingBox.max.set(x,x,x),this.boundingBox.min.set(-x,-x,-x)}});t["a"]=o},function(e,t,n){"use strict";var r=n(24),i=r["a"].extend({castShadow:!1},{type:"AMBIENT_LIGHT",uniformTemplates:{ambientLightColor:{type:"3f",value:function(e){var t=e.color,n=e.intensity;return[t[0]*n,t[1]*n,t[2]*n]}}}});t["a"]=i},function(e,t,n){"use strict";var r=n(24),i=n(3),o=r["a"].extend({shadowBias:.001,shadowSlopeScale:2,shadowCascade:1,cascadeSplitLogFactor:.2},{type:"DIRECTIONAL_LIGHT",uniformTemplates:{directionalLightDirection:{type:"3f",value:function(e){return e.__dir=e.__dir||new i["a"],e.__dir.copy(e.worldTransform.z).normalize().negate().array}},directionalLightColor:{type:"3f",value:function(e){var t=e.color,n=e.intensity;return[t[0]*n,t[1]*n,t[2]*n]}}},clone:function(){var e=r["a"].prototype.clone.call(this);return e.shadowBias=this.shadowBias,e.shadowSlopeScale=this.shadowSlopeScale,e}});t["a"]=o},function(e,t,n){"use strict";var r=n(24),i=r["a"].extend({range:100,castShadow:!1},{type:"POINT_LIGHT",uniformTemplates:{pointLightPosition:{type:"3f",value:function(e){return e.getWorldPosition().array}},pointLightRange:{type:"1f",value:function(e){return e.range}},pointLightColor:{type:"3f",value:function(e){var t=e.color,n=e.intensity;return[t[0]*n,t[1]*n,t[2]*n]}}},clone:function(){var e=r["a"].prototype.clone.call(this);return e.range=this.range,e}});t["a"]=i},function(e,t,n){"use strict";var r=n(24),i=n(3),o=r["a"].extend({range:20,umbraAngle:30,penumbraAngle:45,falloffFactor:2,shadowBias:.001,shadowSlopeScale:2},{type:"SPOT_LIGHT",uniformTemplates:{spotLightPosition:{type:"3f",value:function(e){return e.getWorldPosition().array}},spotLightRange:{type:"1f",value:function(e){return e.range}},spotLightUmbraAngleCosine:{type:"1f",value:function(e){return Math.cos(e.umbraAngle*Math.PI/180)}},spotLightPenumbraAngleCosine:{type:"1f",value:function(e){return Math.cos(e.penumbraAngle*Math.PI/180)}},spotLightFalloffFactor:{type:"1f",value:function(e){return e.falloffFactor}},spotLightDirection:{type:"3f",value:function(e){return e.__dir=e.__dir||new i["a"],e.__dir.copy(e.worldTransform.z).negate().array}},spotLightColor:{type:"3f",value:function(e){var t=e.color,n=e.intensity;return[t[0]*n,t[1]*n,t[2]*n]}}},clone:function(){var e=r["a"].prototype.clone.call(this);return e.range=this.range,e.umbraAngle=this.umbraAngle,e.penumbraAngle=this.penumbraAngle,e.falloffFactor=this.falloffFactor,e.shadowBias=this.shadowBias,e.shadowSlopeScale=this.shadowSlopeScale,e}});t["a"]=o},function(e,t,n){"use strict";var r=n(33),i=function(e,t,n,i){e=e||0,t=t||0,n=n||0,i=i||0,this.array=r["a"].fromValues(e,t,n,i),this._dirty=!0};i.prototype={constructor:i,add:function(e){return r["a"].add(this.array,this.array,e.array),this._dirty=!0,this},set:function(e,t,n,r){return this.array[0]=e,this.array[1]=t,this.array[2]=n,this.array[3]=r,this._dirty=!0,this},setArray:function(e){return this.array[0]=e[0],this.array[1]=e[1],this.array[2]=e[2],this.array[3]=e[3],this._dirty=!0,this},clone:function(){return new i(this.x,this.y,this.z,this.w)},copy:function(e){return r["a"].copy(this.array,e.array),this._dirty=!0,this},dist:function(e){return r["a"].dist(this.array,e.array)},distance:function(e){return r["a"].distance(this.array,e.array)},div:function(e){return r["a"].div(this.array,this.array,e.array),this._dirty=!0,this},divide:function(e){return r["a"].divide(this.array,this.array,e.array),this._dirty=!0,this},dot:function(e){return r["a"].dot(this.array,e.array)},len:function(){return r["a"].len(this.array)},length:function(){return r["a"].length(this.array)},lerp:function(e,t,n){return r["a"].lerp(this.array,e.array,t.array,n),this._dirty=!0,this},min:function(e){return r["a"].min(this.array,this.array,e.array),this._dirty=!0,this},max:function(e){return r["a"].max(this.array,this.array,e.array),this._dirty=!0,this},mul:function(e){return r["a"].mul(this.array,this.array,e.array),this._dirty=!0,this},multiply:function(e){return r["a"].multiply(this.array,this.array,e.array),this._dirty=!0,this},negate:function(){return r["a"].negate(this.array,this.array),this._dirty=!0,this},normalize:function(){return r["a"].normalize(this.array,this.array),this._dirty=!0,this},random:function(e){return r["a"].random(this.array,e),this._dirty=!0,this},scale:function(e){return r["a"].scale(this.array,this.array,e),this._dirty=!0,this},scaleAndAdd:function(e,t){return r["a"].scaleAndAdd(this.array,this.array,e.array,t),this._dirty=!0,this},sqrDist:function(e){return r["a"].sqrDist(this.array,e.array)},squaredDistance:function(e){return r["a"].squaredDistance(this.array,e.array)},sqrLen:function(){return r["a"].sqrLen(this.array)},squaredLength:function(){return r["a"].squaredLength(this.array)},sub:function(e){return r["a"].sub(this.array,this.array,e.array),this._dirty=!0,this},subtract:function(e){return r["a"].subtract(this.array,this.array,e.array),this._dirty=!0,this},transformMat4:function(e){return r["a"].transformMat4(this.array,this.array,e.array),this._dirty=!0,this},transformQuat:function(e){return r["a"].transformQuat(this.array,this.array,e.array),this._dirty=!0,this},toString:function(){return"["+Array.prototype.join.call(this.array,",")+"]"},toArray:function(){return Array.prototype.slice.call(this.array)}};var o=Object.defineProperty;if(o){var a=i.prototype;o(a,"x",{get:function(){return this.array[0]},set:function(e){this.array[0]=e,this._dirty=!0}}),o(a,"y",{get:function(){return this.array[1]},set:function(e){this.array[1]=e,this._dirty=!0}}),o(a,"z",{get:function(){return this.array[2]},set:function(e){this.array[2]=e,this._dirty=!0}}),o(a,"w",{get:function(){return this.array[3]},set:function(e){this.array[3]=e,this._dirty=!0}})}i.add=function(e,t,n){return r["a"].add(e.array,t.array,n.array),e._dirty=!0,e},i.set=function(e,t,n,i,o){r["a"].set(e.array,t,n,i,o),e._dirty=!0},i.copy=function(e,t){return r["a"].copy(e.array,t.array),e._dirty=!0,e},i.dist=function(e,t){return r["a"].distance(e.array,t.array)},i.distance=i.dist,i.div=function(e,t,n){return r["a"].divide(e.array,t.array,n.array),e._dirty=!0,e},i.divide=i.div,i.dot=function(e,t){return r["a"].dot(e.array,t.array)},i.len=function(e){return r["a"].length(e.array)},i.lerp=function(e,t,n,i){return r["a"].lerp(e.array,t.array,n.array,i),e._dirty=!0,e},i.min=function(e,t,n){return r["a"].min(e.array,t.array,n.array),e._dirty=!0,e},i.max=function(e,t,n){return r["a"].max(e.array,t.array,n.array),e._dirty=!0,e},i.mul=function(e,t,n){return r["a"].multiply(e.array,t.array,n.array),e._dirty=!0,e},i.multiply=i.mul,i.negate=function(e,t){return r["a"].negate(e.array,t.array),e._dirty=!0,e},i.normalize=function(e,t){return r["a"].normalize(e.array,t.array),e._dirty=!0,e},i.random=function(e,t){return r["a"].random(e.array,t),e._dirty=!0,e},i.scale=function(e,t,n){return r["a"].scale(e.array,t.array,n),e._dirty=!0,e},i.scaleAndAdd=function(e,t,n,i){return r["a"].scaleAndAdd(e.array,t.array,n.array,i),e._dirty=!0,e},i.sqrDist=function(e,t){return r["a"].sqrDist(e.array,t.array)},i.squaredDistance=i.sqrDist,i.sqrLen=function(e){return r["a"].sqrLen(e.array)},i.squaredLength=i.sqrLen,i.sub=function(e,t,n){return r["a"].subtract(e.array,t.array,n.array),e._dirty=!0,e},i.subtract=i.sub,i.transformMat4=function(e,t,n){return r["a"].transformMat4(e.array,t.array,n.array),e._dirty=!0,e},i.transformQuat=function(e,t,n){return r["a"].transformQuat(e.array,t.array,n.array),e._dirty=!0,e},t["a"]=i},function(e,t,n){"use strict";var r=n(78),i=function(){this.array=r["a"].create(),this._dirty=!0};i.prototype={constructor:i,setArray:function(e){for(var t=0;t<this.array.length;t++)this.array[t]=e[t];return this._dirty=!0,this},clone:function(){return(new i).copy(this)},copy:function(e){return r["a"].copy(this.array,e.array),this._dirty=!0,this},adjoint:function(){return r["a"].adjoint(this.array,this.array),this._dirty=!0,this},determinant:function(){return r["a"].determinant(this.array)},identity:function(){return r["a"].identity(this.array),this._dirty=!0,this},invert:function(){return r["a"].invert(this.array,this.array),this._dirty=!0,this},mul:function(e){return r["a"].mul(this.array,this.array,e.array),this._dirty=!0,this},mulLeft:function(e){return r["a"].mul(this.array,e.array,this.array),this._dirty=!0,this},multiply:function(e){return r["a"].multiply(this.array,this.array,e.array),this._dirty=!0,this},multiplyLeft:function(e){return r["a"].multiply(this.array,e.array,this.array),this._dirty=!0,this},rotate:function(e){return r["a"].rotate(this.array,this.array,e),this._dirty=!0,this},scale:function(e){return r["a"].scale(this.array,this.array,e.array),this._dirty=!0,this},transpose:function(){return r["a"].transpose(this.array,this.array),this._dirty=!0,this},toString:function(){return"["+Array.prototype.join.call(this.array,",")+"]"},toArray:function(){return Array.prototype.slice.call(this.array)}},i.adjoint=function(e,t){return r["a"].adjoint(e.array,t.array),e._dirty=!0,e},i.copy=function(e,t){return r["a"].copy(e.array,t.array),e._dirty=!0,e},i.determinant=function(e){return r["a"].determinant(e.array)},i.identity=function(e){return r["a"].identity(e.array),e._dirty=!0,e},i.invert=function(e,t){return r["a"].invert(e.array,t.array),e._dirty=!0,e},i.mul=function(e,t,n){return r["a"].mul(e.array,t.array,n.array),e._dirty=!0,e},i.multiply=i.mul,i.rotate=function(e,t,n){return r["a"].rotate(e.array,t.array,n),e._dirty=!0,e},i.scale=function(e,t,n){return r["a"].scale(e.array,t.array,n.array),e._dirty=!0,e},i.transpose=function(e,t){return r["a"].transpose(e.array,t.array),e._dirty=!0,e},t["a"]=i},function(e,t,n){"use strict";var r=n(79),i=function(){this.array=r["a"].create(),this._dirty=!0};i.prototype={constructor:i,setArray:function(e){for(var t=0;t<this.array.length;t++)this.array[t]=e[t];return this._dirty=!0,this},clone:function(){return(new i).copy(this)},copy:function(e){return r["a"].copy(this.array,e.array),this._dirty=!0,this},determinant:function(){return r["a"].determinant(this.array)},identity:function(){return r["a"].identity(this.array),this._dirty=!0,this},invert:function(){return r["a"].invert(this.array,this.array),this._dirty=!0,this},mul:function(e){return r["a"].mul(this.array,this.array,e.array),this._dirty=!0,this},mulLeft:function(e){return r["a"].mul(this.array,e.array,this.array),this._dirty=!0,this},multiply:function(e){return r["a"].multiply(this.array,this.array,e.array),this._dirty=!0,this},multiplyLeft:function(e){return r["a"].multiply(this.array,e.array,this.array),this._dirty=!0,this},rotate:function(e){return r["a"].rotate(this.array,this.array,e),this._dirty=!0,this},scale:function(e){return r["a"].scale(this.array,this.array,e.array),this._dirty=!0,this},translate:function(e){return r["a"].translate(this.array,this.array,e.array),this._dirty=!0,this},toString:function(){return"["+Array.prototype.join.call(this.array,",")+"]"},toArray:function(){return Array.prototype.slice.call(this.array)}},i.copy=function(e,t){return r["a"].copy(e.array,t.array),e._dirty=!0,e},i.determinant=function(e){return r["a"].determinant(e.array)},i.identity=function(e){return r["a"].identity(e.array),e._dirty=!0,e},i.invert=function(e,t){return r["a"].invert(e.array,t.array),e._dirty=!0,e},i.mul=function(e,t,n){return r["a"].mul(e.array,t.array,n.array),e._dirty=!0,e},i.multiply=i.mul,i.rotate=function(e,t,n){return r["a"].rotate(e.array,t.array,n),e._dirty=!0,e},i.scale=function(e,t,n){return r["a"].scale(e.array,t.array,n.array),e._dirty=!0,e},i.translate=function(e,t,n){return r["a"].translate(e.array,t.array,n.array),e._dirty=!0,e},t["a"]=i},function(e,t,n){"use strict";var r=n(34),i=function(){this.array=r["a"].create(),this._dirty=!0};i.prototype={constructor:i,setArray:function(e){for(var t=0;t<this.array.length;t++)this.array[t]=e[t];return this._dirty=!0,this},adjoint:function(){return r["a"].adjoint(this.array,this.array),this._dirty=!0,this},clone:function(){return(new i).copy(this)},copy:function(e){return r["a"].copy(this.array,e.array),this._dirty=!0,this},determinant:function(){return r["a"].determinant(this.array)},fromMat2d:function(e){return r["a"].fromMat2d(this.array,e.array),this._dirty=!0,this},fromMat4:function(e){return r["a"].fromMat4(this.array,e.array),this._dirty=!0,this},fromQuat:function(e){return r["a"].fromQuat(this.array,e.array),this._dirty=!0,this},identity:function(){return r["a"].identity(this.array),this._dirty=!0,this},invert:function(){return r["a"].invert(this.array,this.array),this._dirty=!0,this},mul:function(e){return r["a"].mul(this.array,this.array,e.array),this._dirty=!0,this},mulLeft:function(e){return r["a"].mul(this.array,e.array,this.array),this._dirty=!0,this},multiply:function(e){return r["a"].multiply(this.array,this.array,e.array),this._dirty=!0,this},multiplyLeft:function(e){return r["a"].multiply(this.array,e.array,this.array),this._dirty=!0,this},rotate:function(e){return r["a"].rotate(this.array,this.array,e),this._dirty=!0,this},scale:function(e){return r["a"].scale(this.array,this.array,e.array),this._dirty=!0,this},translate:function(e){return r["a"].translate(this.array,this.array,e.array),this._dirty=!0,this},normalFromMat4:function(e){return r["a"].normalFromMat4(this.array,e.array),this._dirty=!0,this},transpose:function(){return r["a"].transpose(this.array,this.array),this._dirty=!0,this},toString:function(){return"["+Array.prototype.join.call(this.array,",")+"]"},toArray:function(){return Array.prototype.slice.call(this.array)}},i.adjoint=function(e,t){return r["a"].adjoint(e.array,t.array),e._dirty=!0,e},i.copy=function(e,t){return r["a"].copy(e.array,t.array),e._dirty=!0,e},i.determinant=function(e){return r["a"].determinant(e.array)},i.identity=function(e){return r["a"].identity(e.array),e._dirty=!0,e},i.invert=function(e,t){return r["a"].invert(e.array,t.array),e},i.mul=function(e,t,n){return r["a"].mul(e.array,t.array,n.array),e._dirty=!0,e},i.multiply=i.mul,i.fromMat2d=function(e,t){return r["a"].fromMat2d(e.array,t.array),e._dirty=!0,e},i.fromMat4=function(e,t){return r["a"].fromMat4(e.array,t.array),e._dirty=!0,e},i.fromQuat=function(e,t){return r["a"].fromQuat(e.array,t.array),e._dirty=!0,e},i.normalFromMat4=function(e,t){return r["a"].normalFromMat4(e.array,t.array),e._dirty=!0,e},i.rotate=function(e,t,n){return r["a"].rotate(e.array,t.array,n),e._dirty=!0,e},i.scale=function(e,t,n){return r["a"].scale(e.array,t.array,n.array),e._dirty=!0,e},i.transpose=function(e,t){return r["a"].transpose(e.array,t.array),e._dirty=!0,e},i.translate=function(e,t,n){return r["a"].translate(e.array,t.array,n.array),e._dirty=!0,e},t["a"]=i},function(e,t,n){"use strict";var r=n(142),i=n.n(r),o={_animators:null,getAnimators:function(){return this._animators=this._animators||[],this._animators},animate:function(e,t){this._animators=this._animators||[];var n,r=this;if(e){for(var o=e.split("."),a=r,s=0,l=o.length;s<l;s++)a&&(a=a[o[s]]);a&&(n=a)}else n=r;if(null==n)throw new Error("Target "+e+" not exists");var u=this._animators,c=new i.a(n,t),d=this;return c.during((function(){d.__zr&&d.__zr.refresh()})).done((function(){var e=u.indexOf(c);e>=0&&u.splice(e,1)})),u.push(c),this.__zr&&this.__zr.animation.addAnimator(c),c},stopAnimation:function(e){this._animators=this._animators||[];for(var t=this._animators,n=t.length,r=0;r<n;r++)t[r].stop(e);return t.length=0,this},addAnimatorsToZr:function(e){if(this._animators)for(var t=0;t<this._animators.length;t++)e.animation.addAnimator(this._animators[t])},removeAnimatorsFromZr:function(e){if(this._animators)for(var t=0;t<this._animators.length;t++)e.animation.removeAnimator(this._animators[t])}};t["a"]=o},function(e,t,n){var r=n(143),i=n(145),o=n(13),a=o.isArrayLike,s=Array.prototype.slice;function l(e,t){return e[t]}function u(e,t,n){e[t]=n}function c(e,t,n){return(t-e)*n+e}function d(e,t,n){return n>.5?t:e}function f(e,t,n,r,i){var o=e.length;if(1==i)for(var a=0;a<o;a++)r[a]=c(e[a],t[a],n);else{var s=o&&e[0].length;for(a=0;a<o;a++)for(var l=0;l<s;l++)r[a][l]=c(e[a][l],t[a][l],n)}}function h(e,t,n){var r=e.length,i=t.length;if(r!==i){var o=r>i;if(o)e.length=i;else for(var a=r;a<i;a++)e.push(1===n?t[a]:s.call(t[a]))}var l=e[0]&&e[0].length;for(a=0;a<e.length;a++)if(1===n)isNaN(e[a])&&(e[a]=t[a]);else for(var u=0;u<l;u++)isNaN(e[a][u])&&(e[a][u]=t[a][u])}function p(e,t,n){if(e===t)return!0;var r=e.length;if(r!==t.length)return!1;if(1===n){for(var i=0;i<r;i++)if(e[i]!==t[i])return!1}else{var o=e[0].length;for(i=0;i<r;i++)for(var a=0;a<o;a++)if(e[i][a]!==t[i][a])return!1}return!0}function m(e,t,n,r,i,o,a,s,l){var u=e.length;if(1==l)for(var c=0;c<u;c++)s[c]=v(e[c],t[c],n[c],r[c],i,o,a);else{var d=e[0].length;for(c=0;c<u;c++)for(var f=0;f<d;f++)s[c][f]=v(e[c][f],t[c][f],n[c][f],r[c][f],i,o,a)}}function v(e,t,n,r,i,o,a){var s=.5*(n-e),l=.5*(r-t);return(2*(t-n)+s+l)*a+(-3*(t-n)-2*s-l)*o+s*i+t}function g(e){if(a(e)){var t=e.length;if(a(e[0])){for(var n=[],r=0;r<t;r++)n.push(s.call(e[r]));return n}return s.call(e)}return e}function y(e){return e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.floor(e[2]),"rgba("+e.join(",")+")"}function _(e){var t=e[e.length-1].value;return a(t&&t[0])?2:1}function x(e,t,n,o,s,l){var u=e._getter,g=e._setter,x="spline"===t,b=o.length;if(b){var w,A=o[0].value,T=a(A),S=!1,E=!1,C=T?_(o):0;o.sort((function(e,t){return e.time-t.time})),w=o[b-1].time;for(var M=[],L=[],N=o[0].value,D=!0,O=0;O<b;O++){M.push(o[O].time/w);var I=o[O].value;if(T&&p(I,N,C)||!T&&I===N||(D=!1),N=I,"string"==typeof I){var R=i.parse(I);R?(I=R,S=!0):E=!0}L.push(I)}if(l||!D){var P=L[b-1];for(O=0;O<b-1;O++)T?h(L[O],P,C):!isNaN(L[O])||isNaN(P)||E||S||(L[O]=P);T&&h(u(e._target,s),P,C);var k,B,F,z,H,U,G=0,V=0;if(S)var j=[0,0,0,0];var W=function(e,t){var n;if(t<0)n=0;else if(t<V){for(k=Math.min(G+1,b-1),n=k;n>=0;n--)if(M[n]<=t)break;n=Math.min(n,b-2)}else{for(n=G;n<b;n++)if(M[n]>t)break;n=Math.min(n-1,b-2)}G=n,V=t;var r=M[n+1]-M[n];if(0!==r)if(B=(t-M[n])/r,x)if(z=L[n],F=L[0===n?n:n-1],H=L[n>b-2?b-1:n+1],U=L[n>b-3?b-1:n+2],T)m(F,z,H,U,B,B*B,B*B*B,u(e,s),C);else{if(S)i=m(F,z,H,U,B,B*B,B*B*B,j,1),i=y(j);else{if(E)return d(z,H,B);i=v(F,z,H,U,B,B*B,B*B*B)}g(e,s,i)}else if(T)f(L[n],L[n+1],B,u(e,s),C);else{var i;if(S)f(L[n],L[n+1],B,j,1),i=y(j);else{if(E)return d(L[n],L[n+1],B);i=c(L[n],L[n+1],B)}g(e,s,i)}},X=new r({target:e._target,life:w,loop:e._loop,delay:e._delay,onframe:W,ondestroy:n});return t&&"spline"!==t&&(X.easing=t),X}}}var b=function(e,t,n,r){this._tracks={},this._target=e,this._loop=t||!1,this._getter=n||l,this._setter=r||u,this._clipCount=0,this._delay=0,this._doneList=[],this._onframeList=[],this._clipList=[]};b.prototype={when:function(e,t){var n=this._tracks;for(var r in t)if(t.hasOwnProperty(r)){if(!n[r]){n[r]=[];var i=this._getter(this._target,r);if(null==i)continue;0!==e&&n[r].push({time:0,value:g(i)})}n[r].push({time:e,value:t[r]})}return this},during:function(e){return this._onframeList.push(e),this},pause:function(){for(var e=0;e<this._clipList.length;e++)this._clipList[e].pause();this._paused=!0},resume:function(){for(var e=0;e<this._clipList.length;e++)this._clipList[e].resume();this._paused=!1},isPaused:function(){return!!this._paused},_doneCallback:function(){this._tracks={},this._clipList.length=0;for(var e=this._doneList,t=e.length,n=0;n<t;n++)e[n].call(this)},start:function(e,t){var n,r=this,i=0,o=function(){i--,i||r._doneCallback()};for(var a in this._tracks)if(this._tracks.hasOwnProperty(a)){var s=x(this,e,o,this._tracks[a],a,t);s&&(this._clipList.push(s),i++,this.animation&&this.animation.addClip(s),n=s)}if(n){var l=n.onframe;n.onframe=function(e,t){l(e,t);for(var n=0;n<r._onframeList.length;n++)r._onframeList[n](e,t)}}return i||this._doneCallback(),this},stop:function(e){for(var t=this._clipList,n=this.animation,r=0;r<t.length;r++){var i=t[r];e&&i.onframe(this._target,1),n&&n.removeClip(i)}t.length=0},delay:function(e){return this._delay=e,this},done:function(e){return e&&this._doneList.push(e),this},getClips:function(){return this._clipList}};var w=b;e.exports=w},function(e,t,n){var r=n(144);function i(e){this._target=e.target,this._life=e.life||1e3,this._delay=e.delay||0,this._initialized=!1,this.loop=null!=e.loop&&e.loop,this.gap=e.gap||0,this.easing=e.easing||"Linear",this.onframe=e.onframe,this.ondestroy=e.ondestroy,this.onrestart=e.onrestart,this._pausedTime=0,this._paused=!1}i.prototype={constructor:i,step:function(e,t){if(this._initialized||(this._startTime=e+this._delay,this._initialized=!0),this._paused)this._pausedTime+=t;else{var n=(e-this._startTime-this._pausedTime)/this._life;if(!(n<0)){n=Math.min(n,1);var i=this.easing,o="string"==typeof i?r[i]:i,a="function"===typeof o?o(n):n;return this.fire("frame",a),1==n?this.loop?(this.restart(e),"restart"):(this._needsRemove=!0,"destroy"):null}}},restart:function(e){var t=(e-this._startTime-this._pausedTime)%this._life;this._startTime=e-t+this.gap,this._pausedTime=0,this._needsRemove=!1},fire:function(e,t){e="on"+e,this[e]&&this[e](this._target,t)},pause:function(){this._paused=!0},resume:function(){this._paused=!1}};var o=i;e.exports=o},function(e,t){var n={linear:function(e){return e},quadraticIn:function(e){return e*e},quadraticOut:function(e){return e*(2-e)},quadraticInOut:function(e){return(e*=2)<1?.5*e*e:-.5*(--e*(e-2)-1)},cubicIn:function(e){return e*e*e},cubicOut:function(e){return--e*e*e+1},cubicInOut:function(e){return(e*=2)<1?.5*e*e*e:.5*((e-=2)*e*e+2)},quarticIn:function(e){return e*e*e*e},quarticOut:function(e){return 1- --e*e*e*e},quarticInOut:function(e){return(e*=2)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2)},quinticIn:function(e){return e*e*e*e*e},quinticOut:function(e){return--e*e*e*e*e+1},quinticInOut:function(e){return(e*=2)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)},sinusoidalIn:function(e){return 1-Math.cos(e*Math.PI/2)},sinusoidalOut:function(e){return Math.sin(e*Math.PI/2)},sinusoidalInOut:function(e){return.5*(1-Math.cos(Math.PI*e))},exponentialIn:function(e){return 0===e?0:Math.pow(1024,e-1)},exponentialOut:function(e){return 1===e?1:1-Math.pow(2,-10*e)},exponentialInOut:function(e){return 0===e?0:1===e?1:(e*=2)<1?.5*Math.pow(1024,e-1):.5*(2-Math.pow(2,-10*(e-1)))},circularIn:function(e){return 1-Math.sqrt(1-e*e)},circularOut:function(e){return Math.sqrt(1- --e*e)},circularInOut:function(e){return(e*=2)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)},elasticIn:function(e){var t,n=.1,r=.4;return 0===e?0:1===e?1:(!n||n<1?(n=1,t=r/4):t=r*Math.asin(1/n)/(2*Math.PI),-n*Math.pow(2,10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/r))},elasticOut:function(e){var t,n=.1,r=.4;return 0===e?0:1===e?1:(!n||n<1?(n=1,t=r/4):t=r*Math.asin(1/n)/(2*Math.PI),n*Math.pow(2,-10*e)*Math.sin((e-t)*(2*Math.PI)/r)+1)},elasticInOut:function(e){var t,n=.1,r=.4;return 0===e?0:1===e?1:(!n||n<1?(n=1,t=r/4):t=r*Math.asin(1/n)/(2*Math.PI),(e*=2)<1?n*Math.pow(2,10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/r)*-.5:n*Math.pow(2,-10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/r)*.5+1)},backIn:function(e){var t=1.70158;return e*e*((t+1)*e-t)},backOut:function(e){var t=1.70158;return--e*e*((t+1)*e+t)+1},backInOut:function(e){var t=2.5949095;return(e*=2)<1?e*e*((t+1)*e-t)*.5:.5*((e-=2)*e*((t+1)*e+t)+2)},bounceIn:function(e){return 1-n.bounceOut(1-e)},bounceOut:function(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},bounceInOut:function(e){return e<.5?.5*n.bounceIn(2*e):.5*n.bounceOut(2*e-1)+.5}},r=n;e.exports=r},function(e,t,n){var r=n(60),i={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function o(e){return e=Math.round(e),e<0?0:e>255?255:e}function a(e){return e=Math.round(e),e<0?0:e>360?360:e}function s(e){return e<0?0:e>1?1:e}function l(e){return e.length&&"%"===e.charAt(e.length-1)?o(parseFloat(e)/100*255):o(parseInt(e,10))}function u(e){return e.length&&"%"===e.charAt(e.length-1)?s(parseFloat(e)/100):s(parseFloat(e))}function c(e,t,n){return n<0?n+=1:n>1&&(n-=1),6*n<1?e+(t-e)*n*6:2*n<1?t:3*n<2?e+(t-e)*(2/3-n)*6:e}function d(e,t,n){return e+(t-e)*n}function f(e,t,n,r,i){return e[0]=t,e[1]=n,e[2]=r,e[3]=i,e}function h(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}var p=new r(20),m=null;function v(e,t){m&&h(m,t),m=p.put(e,m||t.slice())}function g(e,t){if(e){t=t||[];var n=p.get(e);if(n)return h(t,n);e+="";var r=e.replace(/ /g,"").toLowerCase();if(r in i)return h(t,i[r]),v(e,t),t;if("#"!==r.charAt(0)){var o=r.indexOf("("),a=r.indexOf(")");if(-1!==o&&a+1===r.length){var s=r.substr(0,o),c=r.substr(o+1,a-(o+1)).split(","),d=1;switch(s){case"rgba":if(4!==c.length)return void f(t,0,0,0,1);d=u(c.pop());case"rgb":return 3!==c.length?void f(t,0,0,0,1):(f(t,l(c[0]),l(c[1]),l(c[2]),d),v(e,t),t);case"hsla":return 4!==c.length?void f(t,0,0,0,1):(c[3]=u(c[3]),y(c,t),v(e,t),t);case"hsl":return 3!==c.length?void f(t,0,0,0,1):(y(c,t),v(e,t),t);default:return}}f(t,0,0,0,1)}else{if(4===r.length){var m=parseInt(r.substr(1),16);return m>=0&&m<=4095?(f(t,(3840&m)>>4|(3840&m)>>8,240&m|(240&m)>>4,15&m|(15&m)<<4,1),v(e,t),t):void f(t,0,0,0,1)}if(7===r.length){m=parseInt(r.substr(1),16);return m>=0&&m<=16777215?(f(t,(16711680&m)>>16,(65280&m)>>8,255&m,1),v(e,t),t):void f(t,0,0,0,1)}}}}function y(e,t){var n=(parseFloat(e[0])%360+360)%360/360,r=u(e[1]),i=u(e[2]),a=i<=.5?i*(r+1):i+r-i*r,s=2*i-a;return t=t||[],f(t,o(255*c(s,a,n+1/3)),o(255*c(s,a,n)),o(255*c(s,a,n-1/3)),1),4===e.length&&(t[3]=e[3]),t}function _(e){if(e){var t,n,r=e[0]/255,i=e[1]/255,o=e[2]/255,a=Math.min(r,i,o),s=Math.max(r,i,o),l=s-a,u=(s+a)/2;if(0===l)t=0,n=0;else{n=u<.5?l/(s+a):l/(2-s-a);var c=((s-r)/6+l/2)/l,d=((s-i)/6+l/2)/l,f=((s-o)/6+l/2)/l;r===s?t=f-d:i===s?t=1/3+c-f:o===s&&(t=2/3+d-c),t<0&&(t+=1),t>1&&(t-=1)}var h=[360*t,n,u];return null!=e[3]&&h.push(e[3]),h}}function x(e,t){var n=g(e);if(n){for(var r=0;r<3;r++)n[r]=t<0?n[r]*(1-t)|0:(255-n[r])*t+n[r]|0,n[r]>255?n[r]=255:e[r]<0&&(n[r]=0);return M(n,4===n.length?"rgba":"rgb")}}function b(e){var t=g(e);if(t)return((1<<24)+(t[0]<<16)+(t[1]<<8)+ +t[2]).toString(16).slice(1)}function w(e,t,n){if(t&&t.length&&e>=0&&e<=1){n=n||[];var r=e*(t.length-1),i=Math.floor(r),a=Math.ceil(r),l=t[i],u=t[a],c=r-i;return n[0]=o(d(l[0],u[0],c)),n[1]=o(d(l[1],u[1],c)),n[2]=o(d(l[2],u[2],c)),n[3]=s(d(l[3],u[3],c)),n}}var A=w;function T(e,t,n){if(t&&t.length&&e>=0&&e<=1){var r=e*(t.length-1),i=Math.floor(r),a=Math.ceil(r),l=g(t[i]),u=g(t[a]),c=r-i,f=M([o(d(l[0],u[0],c)),o(d(l[1],u[1],c)),o(d(l[2],u[2],c)),s(d(l[3],u[3],c))],"rgba");return n?{color:f,leftIndex:i,rightIndex:a,value:r}:f}}var S=T;function E(e,t,n,r){if(e=g(e),e)return e=_(e),null!=t&&(e[0]=a(t)),null!=n&&(e[1]=u(n)),null!=r&&(e[2]=u(r)),M(y(e),"rgba")}function C(e,t){if(e=g(e),e&&null!=t)return e[3]=s(t),M(e,"rgba")}function M(e,t){if(e&&e.length){var n=e[0]+","+e[1]+","+e[2];return"rgba"!==t&&"hsva"!==t&&"hsla"!==t||(n+=","+e[3]),t+"("+n+")"}}t.parse=g,t.lift=x,t.toHex=b,t.fastLerp=w,t.fastMapToColor=A,t.lerp=T,t.mapToColor=S,t.modifyHSL=E,t.modifyAlpha=C,t.stringify=M},function(e,t,n){"use strict";t["a"]="\n@export clay.util.rand\nhighp float rand(vec2 uv) {\n const highp float a = 12.9898, b = 78.233, c = 43758.5453;\n highp float dt = dot(uv.xy, vec2(a,b)), sn = mod(dt, 3.141592653589793);\n return fract(sin(sn) * c);\n}\n@end\n@export clay.util.calculate_attenuation\nuniform float attenuationFactor : 5.0;\nfloat lightAttenuation(float dist, float range)\n{\n float attenuation = 1.0;\n attenuation = dist*dist/(range*range+1.0);\n float att_s = attenuationFactor;\n attenuation = 1.0/(attenuation*att_s+1.0);\n att_s = 1.0/(att_s+1.0);\n attenuation = attenuation - att_s;\n attenuation /= 1.0 - att_s;\n return clamp(attenuation, 0.0, 1.0);\n}\n@end\n@export clay.util.edge_factor\n#ifdef SUPPORT_STANDARD_DERIVATIVES\nfloat edgeFactor(float width)\n{\n vec3 d = fwidth(v_Barycentric);\n vec3 a3 = smoothstep(vec3(0.0), d * width, v_Barycentric);\n return min(min(a3.x, a3.y), a3.z);\n}\n#else\nfloat edgeFactor(float width)\n{\n return 1.0;\n}\n#endif\n@end\n@export clay.util.encode_float\nvec4 encodeFloat(const in float depth)\n{\n const vec4 bitShifts = vec4(256.0*256.0*256.0, 256.0*256.0, 256.0, 1.0);\n const vec4 bit_mask = vec4(0.0, 1.0/256.0, 1.0/256.0, 1.0/256.0);\n vec4 res = fract(depth * bitShifts);\n res -= res.xxyz * bit_mask;\n return res;\n}\n@end\n@export clay.util.decode_float\nfloat decodeFloat(const in vec4 color)\n{\n const vec4 bitShifts = vec4(1.0/(256.0*256.0*256.0), 1.0/(256.0*256.0), 1.0/256.0, 1.0);\n return dot(color, bitShifts);\n}\n@end\n@export clay.util.float\n@import clay.util.encode_float\n@import clay.util.decode_float\n@end\n@export clay.util.rgbm_decode\nvec3 RGBMDecode(vec4 rgbm, float range) {\n return range * rgbm.rgb * rgbm.a;\n}\n@end\n@export clay.util.rgbm_encode\nvec4 RGBMEncode(vec3 color, float range) {\n if (dot(color, color) == 0.0) {\n return vec4(0.0);\n }\n vec4 rgbm;\n color /= range;\n rgbm.a = clamp(max(max(color.r, color.g), max(color.b, 1e-6)), 0.0, 1.0);\n rgbm.a = ceil(rgbm.a * 255.0) / 255.0;\n rgbm.rgb = color / rgbm.a;\n return rgbm;\n}\n@end\n@export clay.util.rgbm\n@import clay.util.rgbm_decode\n@import clay.util.rgbm_encode\nvec4 decodeHDR(vec4 color)\n{\n#if defined(RGBM_DECODE) || defined(RGBM)\n return vec4(RGBMDecode(color, 8.12), 1.0);\n#else\n return color;\n#endif\n}\nvec4 encodeHDR(vec4 color)\n{\n#if defined(RGBM_ENCODE) || defined(RGBM)\n return RGBMEncode(color.xyz, 8.12);\n#else\n return color;\n#endif\n}\n@end\n@export clay.util.srgb\nvec4 sRGBToLinear(in vec4 value) {\n return vec4(mix(pow(value.rgb * 0.9478672986 + vec3(0.0521327014), vec3(2.4)), value.rgb * 0.0773993808, vec3(lessThanEqual(value.rgb, vec3(0.04045)))), value.w);\n}\nvec4 linearTosRGB(in vec4 value) {\n return vec4(mix(pow(value.rgb, vec3(0.41666)) * 1.055 - vec3(0.055), value.rgb * 12.92, vec3(lessThanEqual(value.rgb, vec3(0.0031308)))), value.w);\n}\n@end\n@export clay.chunk.skinning_header\n#ifdef SKINNING\nattribute vec3 weight : WEIGHT;\nattribute vec4 joint : JOINT;\n#ifdef USE_SKIN_MATRICES_TEXTURE\nuniform sampler2D skinMatricesTexture : ignore;\nuniform float skinMatricesTextureSize: ignore;\nmat4 getSkinMatrix(sampler2D tex, float idx) {\n float j = idx * 4.0;\n float x = mod(j, skinMatricesTextureSize);\n float y = floor(j / skinMatricesTextureSize) + 0.5;\n vec2 scale = vec2(skinMatricesTextureSize);\n return mat4(\n texture2D(tex, vec2(x + 0.5, y) / scale),\n texture2D(tex, vec2(x + 1.5, y) / scale),\n texture2D(tex, vec2(x + 2.5, y) / scale),\n texture2D(tex, vec2(x + 3.5, y) / scale)\n );\n}\nmat4 getSkinMatrix(float idx) {\n return getSkinMatrix(skinMatricesTexture, idx);\n}\n#else\nuniform mat4 skinMatrix[JOINT_COUNT] : SKIN_MATRIX;\nmat4 getSkinMatrix(float idx) {\n return skinMatrix[int(idx)];\n}\n#endif\n#endif\n@end\n@export clay.chunk.skin_matrix\nmat4 skinMatrixWS = getSkinMatrix(joint.x) * weight.x;\nif (weight.y > 1e-4)\n{\n skinMatrixWS += getSkinMatrix(joint.y) * weight.y;\n}\nif (weight.z > 1e-4)\n{\n skinMatrixWS += getSkinMatrix(joint.z) * weight.z;\n}\nfloat weightW = 1.0-weight.x-weight.y-weight.z;\nif (weightW > 1e-4)\n{\n skinMatrixWS += getSkinMatrix(joint.w) * weightW;\n}\n@end\n@export clay.util.parallax_correct\nvec3 parallaxCorrect(in vec3 dir, in vec3 pos, in vec3 boxMin, in vec3 boxMax) {\n vec3 first = (boxMax - pos) / dir;\n vec3 second = (boxMin - pos) / dir;\n vec3 further = max(first, second);\n float dist = min(further.x, min(further.y, further.z));\n vec3 fixedPos = pos + dir * dist;\n vec3 boxCenter = (boxMax + boxMin) * 0.5;\n return normalize(fixedPos - boxCenter);\n}\n@end\n@export clay.util.clamp_sample\nvec4 clampSample(const in sampler2D texture, const in vec2 coord)\n{\n#ifdef STEREO\n float eye = step(0.5, coord.x) * 0.5;\n vec2 coordClamped = clamp(coord, vec2(eye, 0.0), vec2(0.5 + eye, 1.0));\n#else\n vec2 coordClamped = clamp(coord, vec2(0.0), vec2(1.0));\n#endif\n return texture2D(texture, coordClamped);\n}\n@end\n@export clay.util.ACES\nvec3 ACESToneMapping(vec3 color)\n{\n const float A = 2.51;\n const float B = 0.03;\n const float C = 2.43;\n const float D = 0.59;\n const float E = 0.14;\n return (color * (A * color + B)) / (color * (C * color + D) + E);\n}\n@end"},function(e,t,n){"use strict";t["a"]="\n@export ecgl.common.transformUniforms\nuniform mat4 worldViewProjection : WORLDVIEWPROJECTION;\nuniform mat4 worldInverseTranspose : WORLDINVERSETRANSPOSE;\nuniform mat4 world : WORLD;\n@end\n\n@export ecgl.common.attributes\nattribute vec3 position : POSITION;\nattribute vec2 texcoord : TEXCOORD_0;\nattribute vec3 normal : NORMAL;\n@end\n\n@export ecgl.common.uv.header\nuniform vec2 uvRepeat : [1.0, 1.0];\nuniform vec2 uvOffset : [0.0, 0.0];\nuniform vec2 detailUvRepeat : [1.0, 1.0];\nuniform vec2 detailUvOffset : [0.0, 0.0];\n\nvarying vec2 v_Texcoord;\nvarying vec2 v_DetailTexcoord;\n@end\n\n@export ecgl.common.uv.main\nv_Texcoord = texcoord * uvRepeat + uvOffset;\nv_DetailTexcoord = texcoord * detailUvRepeat + detailUvOffset;\n@end\n\n@export ecgl.common.uv.fragmentHeader\nvarying vec2 v_Texcoord;\nvarying vec2 v_DetailTexcoord;\n@end\n\n\n@export ecgl.common.albedo.main\n\n vec4 albedoTexel = vec4(1.0);\n#ifdef DIFFUSEMAP_ENABLED\n albedoTexel = texture2D(diffuseMap, v_Texcoord);\n #ifdef SRGB_DECODE\n albedoTexel = sRGBToLinear(albedoTexel);\n #endif\n#endif\n\n#ifdef DETAILMAP_ENABLED\n vec4 detailTexel = texture2D(detailMap, v_DetailTexcoord);\n #ifdef SRGB_DECODE\n detailTexel = sRGBToLinear(detailTexel);\n #endif\n albedoTexel.rgb = mix(albedoTexel.rgb, detailTexel.rgb, detailTexel.a);\n albedoTexel.a = detailTexel.a + (1.0 - detailTexel.a) * albedoTexel.a;\n#endif\n\n@end\n\n@export ecgl.common.wireframe.vertexHeader\n\n#ifdef WIREFRAME_QUAD\nattribute vec4 barycentric;\nvarying vec4 v_Barycentric;\n#elif defined(WIREFRAME_TRIANGLE)\nattribute vec3 barycentric;\nvarying vec3 v_Barycentric;\n#endif\n\n@end\n\n@export ecgl.common.wireframe.vertexMain\n\n#if defined(WIREFRAME_QUAD) || defined(WIREFRAME_TRIANGLE)\n v_Barycentric = barycentric;\n#endif\n\n@end\n\n\n@export ecgl.common.wireframe.fragmentHeader\n\nuniform float wireframeLineWidth : 1;\nuniform vec4 wireframeLineColor: [0, 0, 0, 0.5];\n\n#ifdef WIREFRAME_QUAD\nvarying vec4 v_Barycentric;\nfloat edgeFactor () {\n vec4 d = fwidth(v_Barycentric);\n vec4 a4 = smoothstep(vec4(0.0), d * wireframeLineWidth, v_Barycentric);\n return min(min(min(a4.x, a4.y), a4.z), a4.w);\n}\n#elif defined(WIREFRAME_TRIANGLE)\nvarying vec3 v_Barycentric;\nfloat edgeFactor () {\n vec3 d = fwidth(v_Barycentric);\n vec3 a3 = smoothstep(vec3(0.0), d * wireframeLineWidth, v_Barycentric);\n return min(min(a3.x, a3.y), a3.z);\n}\n#endif\n\n@end\n\n\n@export ecgl.common.wireframe.fragmentMain\n\n#if defined(WIREFRAME_QUAD) || defined(WIREFRAME_TRIANGLE)\n if (wireframeLineWidth > 0.) {\n vec4 lineColor = wireframeLineColor;\n#ifdef SRGB_DECODE\n lineColor = sRGBToLinear(lineColor);\n#endif\n\n gl_FragColor.rgb = mix(gl_FragColor.rgb, lineColor.rgb, (1.0 - edgeFactor()) * lineColor.a);\n }\n#endif\n@end\n\n\n\n\n@export ecgl.common.bumpMap.header\n\n#ifdef BUMPMAP_ENABLED\nuniform sampler2D bumpMap;\nuniform float bumpScale : 1.0;\n\n\nvec3 bumpNormal(vec3 surfPos, vec3 surfNormal, vec3 baseNormal)\n{\n vec2 dSTdx = dFdx(v_Texcoord);\n vec2 dSTdy = dFdy(v_Texcoord);\n\n float Hll = bumpScale * texture2D(bumpMap, v_Texcoord).x;\n float dHx = bumpScale * texture2D(bumpMap, v_Texcoord + dSTdx).x - Hll;\n float dHy = bumpScale * texture2D(bumpMap, v_Texcoord + dSTdy).x - Hll;\n\n vec3 vSigmaX = dFdx(surfPos);\n vec3 vSigmaY = dFdy(surfPos);\n vec3 vN = surfNormal;\n\n vec3 R1 = cross(vSigmaY, vN);\n vec3 R2 = cross(vN, vSigmaX);\n\n float fDet = dot(vSigmaX, R1);\n\n vec3 vGrad = sign(fDet) * (dHx * R1 + dHy * R2);\n return normalize(abs(fDet) * baseNormal - vGrad);\n\n}\n#endif\n\n@end\n\n@export ecgl.common.normalMap.vertexHeader\n\n#ifdef NORMALMAP_ENABLED\nattribute vec4 tangent : TANGENT;\nvarying vec3 v_Tangent;\nvarying vec3 v_Bitangent;\n#endif\n\n@end\n\n@export ecgl.common.normalMap.vertexMain\n\n#ifdef NORMALMAP_ENABLED\n if (dot(tangent, tangent) > 0.0) {\n v_Tangent = normalize((worldInverseTranspose * vec4(tangent.xyz, 0.0)).xyz);\n v_Bitangent = normalize(cross(v_Normal, v_Tangent) * tangent.w);\n }\n#endif\n\n@end\n\n\n@export ecgl.common.normalMap.fragmentHeader\n\n#ifdef NORMALMAP_ENABLED\nuniform sampler2D normalMap;\nvarying vec3 v_Tangent;\nvarying vec3 v_Bitangent;\n#endif\n\n@end\n\n@export ecgl.common.normalMap.fragmentMain\n#ifdef NORMALMAP_ENABLED\n if (dot(v_Tangent, v_Tangent) > 0.0) {\n vec3 normalTexel = texture2D(normalMap, v_DetailTexcoord).xyz;\n if (dot(normalTexel, normalTexel) > 0.0) { N = normalTexel * 2.0 - 1.0;\n mat3 tbn = mat3(v_Tangent, v_Bitangent, v_Normal);\n N = normalize(tbn * N);\n }\n }\n#endif\n@end\n\n\n\n@export ecgl.common.vertexAnimation.header\n\n#ifdef VERTEX_ANIMATION\nattribute vec3 prevPosition;\nattribute vec3 prevNormal;\nuniform float percent;\n#endif\n\n@end\n\n@export ecgl.common.vertexAnimation.main\n\n#ifdef VERTEX_ANIMATION\n vec3 pos = mix(prevPosition, position, percent);\n vec3 norm = mix(prevNormal, normal, percent);\n#else\n vec3 pos = position;\n vec3 norm = normal;\n#endif\n\n@end\n\n\n@export ecgl.common.ssaoMap.header\n#ifdef SSAOMAP_ENABLED\nuniform sampler2D ssaoMap;\nuniform vec4 viewport : VIEWPORT;\n#endif\n@end\n\n@export ecgl.common.ssaoMap.main\n float ao = 1.0;\n#ifdef SSAOMAP_ENABLED\n ao = texture2D(ssaoMap, (gl_FragCoord.xy - viewport.xy) / viewport.zw).r;\n#endif\n@end\n\n\n\n\n@export ecgl.common.diffuseLayer.header\n\n#if (LAYER_DIFFUSEMAP_COUNT > 0)\nuniform float layerDiffuseIntensity[LAYER_DIFFUSEMAP_COUNT];\nuniform sampler2D layerDiffuseMap[LAYER_DIFFUSEMAP_COUNT];\n#endif\n\n@end\n\n@export ecgl.common.emissiveLayer.header\n\n#if (LAYER_EMISSIVEMAP_COUNT > 0)\nuniform float layerEmissionIntensity[LAYER_EMISSIVEMAP_COUNT];\nuniform sampler2D layerEmissiveMap[LAYER_EMISSIVEMAP_COUNT];\n#endif\n\n@end\n\n@export ecgl.common.layers.header\n@import ecgl.common.diffuseLayer.header\n@import ecgl.common.emissiveLayer.header\n@end\n\n@export ecgl.common.diffuseLayer.main\n\n#if (LAYER_DIFFUSEMAP_COUNT > 0)\n for (int _idx_ = 0; _idx_ < LAYER_DIFFUSEMAP_COUNT; _idx_++) {{\n float intensity = layerDiffuseIntensity[_idx_];\n vec4 texel2 = texture2D(layerDiffuseMap[_idx_], v_Texcoord);\n #ifdef SRGB_DECODE\n texel2 = sRGBToLinear(texel2);\n #endif\n albedoTexel.rgb = mix(albedoTexel.rgb, texel2.rgb * intensity, texel2.a);\n albedoTexel.a = texel2.a + (1.0 - texel2.a) * albedoTexel.a;\n }}\n#endif\n\n@end\n\n@export ecgl.common.emissiveLayer.main\n\n#if (LAYER_EMISSIVEMAP_COUNT > 0)\n for (int _idx_ = 0; _idx_ < LAYER_EMISSIVEMAP_COUNT; _idx_++)\n {{\n vec4 texel2 = texture2D(layerEmissiveMap[_idx_], v_Texcoord) * layerEmissionIntensity[_idx_];\n #ifdef SRGB_DECODE\n texel2 = sRGBToLinear(texel2);\n #endif\n float intensity = layerEmissionIntensity[_idx_];\n gl_FragColor.rgb += texel2.rgb * texel2.a * intensity;\n }}\n#endif\n\n@end\n"},function(e,t,n){"use strict";t["a"]="@export ecgl.color.vertex\n\nuniform mat4 worldViewProjection : WORLDVIEWPROJECTION;\n\n@import ecgl.common.uv.header\n\nattribute vec2 texcoord : TEXCOORD_0;\nattribute vec3 position: POSITION;\n\n@import ecgl.common.wireframe.vertexHeader\n\n#ifdef VERTEX_COLOR\nattribute vec4 a_Color : COLOR;\nvarying vec4 v_Color;\n#endif\n\n#ifdef VERTEX_ANIMATION\nattribute vec3 prevPosition;\nuniform float percent : 1.0;\n#endif\n\nvoid main()\n{\n#ifdef VERTEX_ANIMATION\n vec3 pos = mix(prevPosition, position, percent);\n#else\n vec3 pos = position;\n#endif\n\n gl_Position = worldViewProjection * vec4(pos, 1.0);\n\n @import ecgl.common.uv.main\n\n#ifdef VERTEX_COLOR\n v_Color = a_Color;\n#endif\n\n @import ecgl.common.wireframe.vertexMain\n\n}\n\n@end\n\n@export ecgl.color.fragment\n\n#define LAYER_DIFFUSEMAP_COUNT 0\n#define LAYER_EMISSIVEMAP_COUNT 0\n\nuniform sampler2D diffuseMap;\nuniform sampler2D detailMap;\n\nuniform vec4 color : [1.0, 1.0, 1.0, 1.0];\n\n#ifdef VERTEX_COLOR\nvarying vec4 v_Color;\n#endif\n\n@import ecgl.common.layers.header\n\n@import ecgl.common.uv.fragmentHeader\n\n@import ecgl.common.wireframe.fragmentHeader\n\n@import clay.util.srgb\n\nvoid main()\n{\n#ifdef SRGB_DECODE\n gl_FragColor = sRGBToLinear(color);\n#else\n gl_FragColor = color;\n#endif\n\n#ifdef VERTEX_COLOR\n gl_FragColor *= v_Color;\n#endif\n\n @import ecgl.common.albedo.main\n\n @import ecgl.common.diffuseLayer.main\n\n gl_FragColor *= albedoTexel;\n\n @import ecgl.common.emissiveLayer.main\n\n @import ecgl.common.wireframe.fragmentMain\n\n}\n@end"},function(e,t,n){"use strict";t["a"]="/**\n * http: */\n\n@export ecgl.lambert.vertex\n\n@import ecgl.common.transformUniforms\n\n@import ecgl.common.uv.header\n\n\n@import ecgl.common.attributes\n\n@import ecgl.common.wireframe.vertexHeader\n\n#ifdef VERTEX_COLOR\nattribute vec4 a_Color : COLOR;\nvarying vec4 v_Color;\n#endif\n\n\n@import ecgl.common.vertexAnimation.header\n\n\nvarying vec3 v_Normal;\nvarying vec3 v_WorldPosition;\n\nvoid main()\n{\n @import ecgl.common.uv.main\n\n @import ecgl.common.vertexAnimation.main\n\n\n gl_Position = worldViewProjection * vec4(pos, 1.0);\n\n v_Normal = normalize((worldInverseTranspose * vec4(norm, 0.0)).xyz);\n v_WorldPosition = (world * vec4(pos, 1.0)).xyz;\n\n#ifdef VERTEX_COLOR\n v_Color = a_Color;\n#endif\n\n @import ecgl.common.wireframe.vertexMain\n}\n\n@end\n\n\n@export ecgl.lambert.fragment\n\n#define LAYER_DIFFUSEMAP_COUNT 0\n#define LAYER_EMISSIVEMAP_COUNT 0\n\n#define NORMAL_UP_AXIS 1\n#define NORMAL_FRONT_AXIS 2\n\n@import ecgl.common.uv.fragmentHeader\n\nvarying vec3 v_Normal;\nvarying vec3 v_WorldPosition;\n\nuniform sampler2D diffuseMap;\nuniform sampler2D detailMap;\n\n@import ecgl.common.layers.header\n\nuniform float emissionIntensity: 1.0;\n\nuniform vec4 color : [1.0, 1.0, 1.0, 1.0];\n\nuniform mat4 viewInverse : VIEWINVERSE;\n\n#ifdef AMBIENT_LIGHT_COUNT\n@import clay.header.ambient_light\n#endif\n#ifdef AMBIENT_SH_LIGHT_COUNT\n@import clay.header.ambient_sh_light\n#endif\n\n#ifdef DIRECTIONAL_LIGHT_COUNT\n@import clay.header.directional_light\n#endif\n\n#ifdef VERTEX_COLOR\nvarying vec4 v_Color;\n#endif\n\n\n@import ecgl.common.ssaoMap.header\n\n@import ecgl.common.bumpMap.header\n\n@import clay.util.srgb\n\n@import ecgl.common.wireframe.fragmentHeader\n\n@import clay.plugin.compute_shadow_map\n\nvoid main()\n{\n#ifdef SRGB_DECODE\n gl_FragColor = sRGBToLinear(color);\n#else\n gl_FragColor = color;\n#endif\n\n#ifdef VERTEX_COLOR\n #ifdef SRGB_DECODE\n gl_FragColor *= sRGBToLinear(v_Color);\n #else\n gl_FragColor *= v_Color;\n #endif\n#endif\n\n @import ecgl.common.albedo.main\n\n @import ecgl.common.diffuseLayer.main\n\n gl_FragColor *= albedoTexel;\n\n vec3 N = v_Normal;\n#ifdef DOUBLE_SIDED\n vec3 eyePos = viewInverse[3].xyz;\n vec3 V = normalize(eyePos - v_WorldPosition);\n\n if (dot(N, V) < 0.0) {\n N = -N;\n }\n#endif\n\n float ambientFactor = 1.0;\n\n#ifdef BUMPMAP_ENABLED\n N = bumpNormal(v_WorldPosition, v_Normal, N);\n ambientFactor = dot(v_Normal, N);\n#endif\n\n vec3 N2 = vec3(N.x, N[NORMAL_UP_AXIS], N[NORMAL_FRONT_AXIS]);\n\n vec3 diffuseColor = vec3(0.0, 0.0, 0.0);\n\n @import ecgl.common.ssaoMap.main\n\n#ifdef AMBIENT_LIGHT_COUNT\n for(int i = 0; i < AMBIENT_LIGHT_COUNT; i++)\n {\n diffuseColor += ambientLightColor[i] * ambientFactor * ao;\n }\n#endif\n#ifdef AMBIENT_SH_LIGHT_COUNT\n for(int _idx_ = 0; _idx_ < AMBIENT_SH_LIGHT_COUNT; _idx_++)\n {{\n diffuseColor += calcAmbientSHLight(_idx_, N2) * ambientSHLightColor[_idx_] * ao;\n }}\n#endif\n#ifdef DIRECTIONAL_LIGHT_COUNT\n#if defined(DIRECTIONAL_LIGHT_SHADOWMAP_COUNT)\n float shadowContribsDir[DIRECTIONAL_LIGHT_COUNT];\n if(shadowEnabled)\n {\n computeShadowOfDirectionalLights(v_WorldPosition, shadowContribsDir);\n }\n#endif\n for(int i = 0; i < DIRECTIONAL_LIGHT_COUNT; i++)\n {\n vec3 lightDirection = -directionalLightDirection[i];\n vec3 lightColor = directionalLightColor[i];\n\n float shadowContrib = 1.0;\n#if defined(DIRECTIONAL_LIGHT_SHADOWMAP_COUNT)\n if (shadowEnabled)\n {\n shadowContrib = shadowContribsDir[i];\n }\n#endif\n\n float ndl = dot(N, normalize(lightDirection)) * shadowContrib;\n\n diffuseColor += lightColor * clamp(ndl, 0.0, 1.0);\n }\n#endif\n\n gl_FragColor.rgb *= diffuseColor;\n\n @import ecgl.common.emissiveLayer.main\n\n @import ecgl.common.wireframe.fragmentMain\n}\n\n@end"},function(e,t,n){"use strict";t["a"]="@export ecgl.realistic.vertex\n\n@import ecgl.common.transformUniforms\n\n@import ecgl.common.uv.header\n\n@import ecgl.common.attributes\n\n\n@import ecgl.common.wireframe.vertexHeader\n\n#ifdef VERTEX_COLOR\nattribute vec4 a_Color : COLOR;\nvarying vec4 v_Color;\n#endif\n\n#ifdef NORMALMAP_ENABLED\nattribute vec4 tangent : TANGENT;\nvarying vec3 v_Tangent;\nvarying vec3 v_Bitangent;\n#endif\n\n@import ecgl.common.vertexAnimation.header\n\nvarying vec3 v_Normal;\nvarying vec3 v_WorldPosition;\n\nvoid main()\n{\n\n @import ecgl.common.uv.main\n\n @import ecgl.common.vertexAnimation.main\n\n gl_Position = worldViewProjection * vec4(pos, 1.0);\n\n v_Normal = normalize((worldInverseTranspose * vec4(norm, 0.0)).xyz);\n v_WorldPosition = (world * vec4(pos, 1.0)).xyz;\n\n#ifdef VERTEX_COLOR\n v_Color = a_Color;\n#endif\n\n#ifdef NORMALMAP_ENABLED\n v_Tangent = normalize((worldInverseTranspose * vec4(tangent.xyz, 0.0)).xyz);\n v_Bitangent = normalize(cross(v_Normal, v_Tangent) * tangent.w);\n#endif\n\n @import ecgl.common.wireframe.vertexMain\n\n}\n\n@end\n\n\n\n@export ecgl.realistic.fragment\n\n#define LAYER_DIFFUSEMAP_COUNT 0\n#define LAYER_EMISSIVEMAP_COUNT 0\n#define PI 3.14159265358979\n#define ROUGHNESS_CHANEL 0\n#define METALNESS_CHANEL 1\n\n#define NORMAL_UP_AXIS 1\n#define NORMAL_FRONT_AXIS 2\n\n#ifdef VERTEX_COLOR\nvarying vec4 v_Color;\n#endif\n\n@import ecgl.common.uv.fragmentHeader\n\nvarying vec3 v_Normal;\nvarying vec3 v_WorldPosition;\n\nuniform sampler2D diffuseMap;\n\nuniform sampler2D detailMap;\nuniform sampler2D metalnessMap;\nuniform sampler2D roughnessMap;\n\n@import ecgl.common.layers.header\n\nuniform float emissionIntensity: 1.0;\n\nuniform vec4 color : [1.0, 1.0, 1.0, 1.0];\n\nuniform float metalness : 0.0;\nuniform float roughness : 0.5;\n\nuniform mat4 viewInverse : VIEWINVERSE;\n\n#ifdef AMBIENT_LIGHT_COUNT\n@import clay.header.ambient_light\n#endif\n\n#ifdef AMBIENT_SH_LIGHT_COUNT\n@import clay.header.ambient_sh_light\n#endif\n\n#ifdef AMBIENT_CUBEMAP_LIGHT_COUNT\n@import clay.header.ambient_cubemap_light\n#endif\n\n#ifdef DIRECTIONAL_LIGHT_COUNT\n@import clay.header.directional_light\n#endif\n\n@import ecgl.common.normalMap.fragmentHeader\n\n@import ecgl.common.ssaoMap.header\n\n@import ecgl.common.bumpMap.header\n\n@import clay.util.srgb\n\n@import clay.util.rgbm\n\n@import ecgl.common.wireframe.fragmentHeader\n\n@import clay.plugin.compute_shadow_map\n\nvec3 F_Schlick(float ndv, vec3 spec) {\n return spec + (1.0 - spec) * pow(1.0 - ndv, 5.0);\n}\n\nfloat D_Phong(float g, float ndh) {\n float a = pow(8192.0, g);\n return (a + 2.0) / 8.0 * pow(ndh, a);\n}\n\nvoid main()\n{\n vec4 albedoColor = color;\n\n vec3 eyePos = viewInverse[3].xyz;\n vec3 V = normalize(eyePos - v_WorldPosition);\n#ifdef VERTEX_COLOR\n #ifdef SRGB_DECODE\n albedoColor *= sRGBToLinear(v_Color);\n #else\n albedoColor *= v_Color;\n #endif\n#endif\n\n @import ecgl.common.albedo.main\n\n @import ecgl.common.diffuseLayer.main\n\n albedoColor *= albedoTexel;\n\n float m = metalness;\n\n#ifdef METALNESSMAP_ENABLED\n float m2 = texture2D(metalnessMap, v_DetailTexcoord)[METALNESS_CHANEL];\n m = clamp(m2 + (m - 0.5) * 2.0, 0.0, 1.0);\n#endif\n\n vec3 baseColor = albedoColor.rgb;\n albedoColor.rgb = baseColor * (1.0 - m);\n vec3 specFactor = mix(vec3(0.04), baseColor, m);\n\n float g = 1.0 - roughness;\n\n#ifdef ROUGHNESSMAP_ENABLED\n float g2 = 1.0 - texture2D(roughnessMap, v_DetailTexcoord)[ROUGHNESS_CHANEL];\n g = clamp(g2 + (g - 0.5) * 2.0, 0.0, 1.0);\n#endif\n\n vec3 N = v_Normal;\n\n#ifdef DOUBLE_SIDED\n if (dot(N, V) < 0.0) {\n N = -N;\n }\n#endif\n\n float ambientFactor = 1.0;\n\n#ifdef BUMPMAP_ENABLED\n N = bumpNormal(v_WorldPosition, v_Normal, N);\n ambientFactor = dot(v_Normal, N);\n#endif\n\n@import ecgl.common.normalMap.fragmentMain\n\n vec3 N2 = vec3(N.x, N[NORMAL_UP_AXIS], N[NORMAL_FRONT_AXIS]);\n\n vec3 diffuseTerm = vec3(0.0);\n vec3 specularTerm = vec3(0.0);\n\n float ndv = clamp(dot(N, V), 0.0, 1.0);\n vec3 fresnelTerm = F_Schlick(ndv, specFactor);\n\n @import ecgl.common.ssaoMap.main\n\n#ifdef AMBIENT_LIGHT_COUNT\n for(int _idx_ = 0; _idx_ < AMBIENT_LIGHT_COUNT; _idx_++)\n {{\n diffuseTerm += ambientLightColor[_idx_] * ambientFactor * ao;\n }}\n#endif\n\n#ifdef AMBIENT_SH_LIGHT_COUNT\n for(int _idx_ = 0; _idx_ < AMBIENT_SH_LIGHT_COUNT; _idx_++)\n {{\n diffuseTerm += calcAmbientSHLight(_idx_, N2) * ambientSHLightColor[_idx_] * ao;\n }}\n#endif\n\n#ifdef DIRECTIONAL_LIGHT_COUNT\n#if defined(DIRECTIONAL_LIGHT_SHADOWMAP_COUNT)\n float shadowContribsDir[DIRECTIONAL_LIGHT_COUNT];\n if(shadowEnabled)\n {\n computeShadowOfDirectionalLights(v_WorldPosition, shadowContribsDir);\n }\n#endif\n for(int _idx_ = 0; _idx_ < DIRECTIONAL_LIGHT_COUNT; _idx_++)\n {{\n vec3 L = -directionalLightDirection[_idx_];\n vec3 lc = directionalLightColor[_idx_];\n\n vec3 H = normalize(L + V);\n float ndl = clamp(dot(N, normalize(L)), 0.0, 1.0);\n float ndh = clamp(dot(N, H), 0.0, 1.0);\n\n float shadowContrib = 1.0;\n#if defined(DIRECTIONAL_LIGHT_SHADOWMAP_COUNT)\n if (shadowEnabled)\n {\n shadowContrib = shadowContribsDir[_idx_];\n }\n#endif\n\n vec3 li = lc * ndl * shadowContrib;\n\n diffuseTerm += li;\n specularTerm += li * fresnelTerm * D_Phong(g, ndh);\n }}\n#endif\n\n\n#ifdef AMBIENT_CUBEMAP_LIGHT_COUNT\n vec3 L = reflect(-V, N);\n L = vec3(L.x, L[NORMAL_UP_AXIS], L[NORMAL_FRONT_AXIS]);\n float rough2 = clamp(1.0 - g, 0.0, 1.0);\n float bias2 = rough2 * 5.0;\n vec2 brdfParam2 = texture2D(ambientCubemapLightBRDFLookup[0], vec2(rough2, ndv)).xy;\n vec3 envWeight2 = specFactor * brdfParam2.x + brdfParam2.y;\n vec3 envTexel2;\n for(int _idx_ = 0; _idx_ < AMBIENT_CUBEMAP_LIGHT_COUNT; _idx_++)\n {{\n envTexel2 = RGBMDecode(textureCubeLodEXT(ambientCubemapLightCubemap[_idx_], L, bias2), 8.12);\n specularTerm += ambientCubemapLightColor[_idx_] * envTexel2 * envWeight2 * ao;\n }}\n#endif\n\n gl_FragColor.rgb = albedoColor.rgb * diffuseTerm + specularTerm;\n gl_FragColor.a = albedoColor.a;\n\n#ifdef SRGB_ENCODE\n gl_FragColor = linearTosRGB(gl_FragColor);\n#endif\n\n @import ecgl.common.emissiveLayer.main\n\n @import ecgl.common.wireframe.fragmentMain\n}\n\n@end"},function(e,t,n){"use strict";t["a"]="@export ecgl.hatching.vertex\n\n@import ecgl.realistic.vertex\n\n@end\n\n\n@export ecgl.hatching.fragment\n\n#define NORMAL_UP_AXIS 1\n#define NORMAL_FRONT_AXIS 2\n\n@import ecgl.common.uv.fragmentHeader\n\nvarying vec3 v_Normal;\nvarying vec3 v_WorldPosition;\n\nuniform vec4 color : [0.0, 0.0, 0.0, 1.0];\nuniform vec4 paperColor : [1.0, 1.0, 1.0, 1.0];\n\nuniform mat4 viewInverse : VIEWINVERSE;\n\n#ifdef AMBIENT_LIGHT_COUNT\n@import clay.header.ambient_light\n#endif\n#ifdef AMBIENT_SH_LIGHT_COUNT\n@import clay.header.ambient_sh_light\n#endif\n\n#ifdef DIRECTIONAL_LIGHT_COUNT\n@import clay.header.directional_light\n#endif\n\n#ifdef VERTEX_COLOR\nvarying vec4 v_Color;\n#endif\n\n\n@import ecgl.common.ssaoMap.header\n\n@import ecgl.common.bumpMap.header\n\n@import clay.util.srgb\n\n@import ecgl.common.wireframe.fragmentHeader\n\n@import clay.plugin.compute_shadow_map\n\nuniform sampler2D hatch1;\nuniform sampler2D hatch2;\nuniform sampler2D hatch3;\nuniform sampler2D hatch4;\nuniform sampler2D hatch5;\nuniform sampler2D hatch6;\n\nfloat shade(in float tone) {\n vec4 c = vec4(1. ,1., 1., 1.);\n float step = 1. / 6.;\n vec2 uv = v_DetailTexcoord;\n if (tone <= step / 2.0) {\n c = mix(vec4(0.), texture2D(hatch6, uv), 12. * tone);\n }\n else if (tone <= step) {\n c = mix(texture2D(hatch6, uv), texture2D(hatch5, uv), 6. * tone);\n }\n if(tone > step && tone <= 2. * step){\n c = mix(texture2D(hatch5, uv), texture2D(hatch4, uv) , 6. * (tone - step));\n }\n if(tone > 2. * step && tone <= 3. * step){\n c = mix(texture2D(hatch4, uv), texture2D(hatch3, uv), 6. * (tone - 2. * step));\n }\n if(tone > 3. * step && tone <= 4. * step){\n c = mix(texture2D(hatch3, uv), texture2D(hatch2, uv), 6. * (tone - 3. * step));\n }\n if(tone > 4. * step && tone <= 5. * step){\n c = mix(texture2D(hatch2, uv), texture2D(hatch1, uv), 6. * (tone - 4. * step));\n }\n if(tone > 5. * step){\n c = mix(texture2D(hatch1, uv), vec4(1.), 6. * (tone - 5. * step));\n }\n\n return c.r;\n}\n\nconst vec3 w = vec3(0.2125, 0.7154, 0.0721);\n\nvoid main()\n{\n#ifdef SRGB_DECODE\n vec4 inkColor = sRGBToLinear(color);\n#else\n vec4 inkColor = color;\n#endif\n\n#ifdef VERTEX_COLOR\n #ifdef SRGB_DECODE\n inkColor *= sRGBToLinear(v_Color);\n #else\n inkColor *= v_Color;\n #endif\n#endif\n\n vec3 N = v_Normal;\n#ifdef DOUBLE_SIDED\n vec3 eyePos = viewInverse[3].xyz;\n vec3 V = normalize(eyePos - v_WorldPosition);\n\n if (dot(N, V) < 0.0) {\n N = -N;\n }\n#endif\n\n float tone = 0.0;\n\n float ambientFactor = 1.0;\n\n#ifdef BUMPMAP_ENABLED\n N = bumpNormal(v_WorldPosition, v_Normal, N);\n ambientFactor = dot(v_Normal, N);\n#endif\n\n vec3 N2 = vec3(N.x, N[NORMAL_UP_AXIS], N[NORMAL_FRONT_AXIS]);\n\n @import ecgl.common.ssaoMap.main\n\n#ifdef AMBIENT_LIGHT_COUNT\n for(int i = 0; i < AMBIENT_LIGHT_COUNT; i++)\n {\n tone += dot(ambientLightColor[i], w) * ambientFactor * ao;\n }\n#endif\n#ifdef AMBIENT_SH_LIGHT_COUNT\n for(int _idx_ = 0; _idx_ < AMBIENT_SH_LIGHT_COUNT; _idx_++)\n {{\n tone += dot(calcAmbientSHLight(_idx_, N2) * ambientSHLightColor[_idx_], w) * ao;\n }}\n#endif\n#ifdef DIRECTIONAL_LIGHT_COUNT\n#if defined(DIRECTIONAL_LIGHT_SHADOWMAP_COUNT)\n float shadowContribsDir[DIRECTIONAL_LIGHT_COUNT];\n if(shadowEnabled)\n {\n computeShadowOfDirectionalLights(v_WorldPosition, shadowContribsDir);\n }\n#endif\n for(int i = 0; i < DIRECTIONAL_LIGHT_COUNT; i++)\n {\n vec3 lightDirection = -directionalLightDirection[i];\n float lightTone = dot(directionalLightColor[i], w);\n\n float shadowContrib = 1.0;\n#if defined(DIRECTIONAL_LIGHT_SHADOWMAP_COUNT)\n if (shadowEnabled)\n {\n shadowContrib = shadowContribsDir[i];\n }\n#endif\n\n float ndl = dot(N, normalize(lightDirection)) * shadowContrib;\n\n tone += lightTone * clamp(ndl, 0.0, 1.0);\n }\n#endif\n\n gl_FragColor = mix(inkColor, paperColor, shade(clamp(tone, 0.0, 1.0)));\n }\n@end\n"},function(e,t,n){"use strict";t["a"]="@export ecgl.sm.depth.vertex\n\nuniform mat4 worldViewProjection : WORLDVIEWPROJECTION;\n\nattribute vec3 position : POSITION;\nattribute vec2 texcoord : TEXCOORD_0;\n\n#ifdef VERTEX_ANIMATION\nattribute vec3 prevPosition;\nuniform float percent : 1.0;\n#endif\n\nvarying vec4 v_ViewPosition;\nvarying vec2 v_Texcoord;\n\nvoid main(){\n\n#ifdef VERTEX_ANIMATION\n vec3 pos = mix(prevPosition, position, percent);\n#else\n vec3 pos = position;\n#endif\n\n v_ViewPosition = worldViewProjection * vec4(pos, 1.0);\n gl_Position = v_ViewPosition;\n\n v_Texcoord = texcoord;\n\n}\n@end\n\n\n\n@export ecgl.sm.depth.fragment\n\n@import clay.sm.depth.fragment\n\n@end"},function(e,t,n){"use strict";var r=n(0),i=n.n(r),o=["bar3D","line3D","map3D","scatter3D","surface","lines3D","scatterGL","scatter3D"];function a(e,t){if(e&&e[t]&&(e[t].normal||e[t].emphasis)){var n=e[t].normal,r=e[t].emphasis;n&&(e[t]=n),r&&(e.emphasis=e.emphasis||{},e.emphasis[t]=r)}}function s(e){a(e,"itemStyle"),a(e,"lineStyle"),a(e,"areaStyle"),a(e,"label")}function l(e){e&&(e instanceof Array||(e=[e]),i.a.util.each(e,(function(e){if(e.axisLabel){var t=e.axisLabel;i.a.util.extend(t,t.textStyle),t.textStyle=null}})))}t["a"]=function(e){i.a.util.each(e.series,(function(t){i.a.util.indexOf(o,t.type)>=0&&(s(t),"mapbox"===t.coordinateSystem&&(t.coordinateSystem="mapbox3D",e.mapbox3D=e.mapbox))})),l(e.xAxis3D),l(e.yAxis3D),l(e.zAxis3D),l(e.grid3D),a(e.geo3D)}},function(e,t,n){"use strict";n(155),n(159),n(160),n(167);var r=n(0),i=n.n(r);i.a.registerAction({type:"grid3DChangeCamera",event:"grid3dcamerachanged",update:"series:updateCamera"},(function(e,t){t.eachComponent({mainType:"grid3D",query:e},(function(t){t.setView(e)}))})),i.a.registerAction({type:"grid3DShowAxisPointer",event:"grid3dshowaxispointer",update:"grid3D:showAxisPointer"},(function(e,t){})),i.a.registerAction({type:"grid3DHideAxisPointer",event:"grid3dhideaxispointer",update:"grid3D:hideAxisPointer"},(function(e,t){}))},function(e,t,n){"use strict";var r=n(0),i=n.n(r),o=n(156),a=i.a.extendComponentModel({type:"cartesian3DAxis",axis:null,getCoordSysModel:function(){return this.ecModel.queryComponents({mainType:"grid3D",index:this.option.gridIndex,id:this.option.gridId})[0]}});function s(e,t){return t.type||(t.data?"category":"value")}i.a.helper.mixinAxisModelCommonMethods(a),Object(o["a"])("x",a,s,{name:"X"}),Object(o["a"])("y",a,s,{name:"Y"}),Object(o["a"])("z",a,s,{name:"Z"})},function(e,t,n){"use strict";var r=n(0),i=n.n(r),o=n(157),a=n(158),s=n.n(a),l=["value","category","time","log"];t["a"]=function(e,t,n,r){i.a.util.each(l,(function(a){t.extend({type:e+"Axis3D."+a,__ordinalMeta:null,mergeDefaultAndTheme:function(t,r){var o=r.getTheme();i.a.util.merge(t,o.get(a+"Axis3D")),i.a.util.merge(t,this.getDefaultOption()),t.type=n(e,t)},optionUpdated:function(){var e=this.option;"category"===e.type&&(this.__ordinalMeta=s.a.createByAxisModel(this))},getCategories:function(){if("category"===this.option.type)return this.__ordinalMeta.categories},getOrdinalMeta:function(){return this.__ordinalMeta},defaultOption:i.a.util.merge(i.a.util.clone(o["a"][a+"Axis3D"]),r||{},!0)})})),t.superClass.registerSubTypeDefaulter(e+"Axis3D",i.a.util.curry(n,e))}},function(e,t,n){"use strict";var r=n(0),i=n.n(r),o={show:!0,grid3DIndex:0,inverse:!1,name:"",nameLocation:"middle",nameTextStyle:{fontSize:16},nameGap:20,axisPointer:{},axisLine:{},axisTick:{},axisLabel:{},splitArea:{}},a=i.a.util.merge({boundaryGap:!0,axisTick:{alignWithLabel:!1,interval:"auto"},axisLabel:{interval:"auto"},axisPointer:{label:{show:!1}}},o),s=i.a.util.merge({boundaryGap:[0,0],splitNumber:5,axisPointer:{label:{}}},o),l=i.a.util.defaults({scale:!0,min:"dataMin",max:"dataMax"},s),u=i.a.util.defaults({logBase:10},s);u.scale=!0,t["a"]={categoryAxis3D:a,valueAxis3D:s,timeAxis3D:l,logAxis3D:u}},function(e,t,n){var r=n(13),i=r.createHashMap,o=r.isObject,a=r.map;function s(e){this.categories=e.categories||[],this._needCollect=e.needCollect,this._deduplication=e.deduplication,this._map}s.createByAxisModel=function(e){var t=e.option,n=t.data,r=n&&a(n,c);return new s({categories:r,needCollect:!r,deduplication:!1!==t.dedplication})};var l=s.prototype;function u(e){return e._map||(e._map=i(e.categories))}function c(e){return o(e)&&null!=e.value?e.value:e+""}l.getOrdinal=function(e){return u(this).get(e)},l.parseAndCollect=function(e){var t,n=this._needCollect;if("string"!==typeof e&&!n)return e;if(n&&!this._deduplication)return t=this.categories.length,this.categories[t]=e,t;var r=u(this);return t=r.get(e),null==t&&(n?(t=this.categories.length,this.categories[t]=e,r.set(e,t)):t=NaN),t};var d=s;e.exports=d},function(e,t,n){"use strict";var r=n(0),i=n.n(r),o=n(44),a=n(28),s=n(29),l=i.a.extendComponentModel({type:"grid3D",dependencies:["xAxis3D","yAxis3D","zAxis3D"],defaultOption:{show:!0,zlevel:-10,left:0,top:0,width:"100%",height:"100%",environment:"auto",boxWidth:100,boxHeight:100,boxDepth:100,axisPointer:{show:!0,lineStyle:{color:"rgba(0, 0, 0, 0.8)",width:1},label:{show:!0,formatter:null,margin:8,textStyle:{fontSize:14,color:"#fff",backgroundColor:"rgba(0,0,0,0.5)",padding:3,borderRadius:3}}},axisLine:{show:!0,lineStyle:{color:"#333",width:2,type:"solid"}},axisTick:{show:!0,inside:!1,length:3,lineStyle:{width:1}},axisLabel:{show:!0,inside:!1,rotate:0,margin:8,textStyle:{fontSize:12}},splitLine:{show:!0,lineStyle:{color:["#ccc"],width:1,type:"solid"}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]}},light:{main:{alpha:30,beta:40},ambient:{intensity:.4}},viewControl:{alpha:20,beta:40,autoRotate:!1,distance:200,minDistance:40,maxDistance:400}}});i.a.util.merge(l.prototype,o["a"]),i.a.util.merge(l.prototype,a["a"]),i.a.util.merge(l.prototype,s["a"])},function(e,t,n){"use strict";var r=n(0),i=n.n(r),o=n(1),a=n(45),s=n(25),l=n(2),u=n(81),c=n(30),d=n(162),f=n(164),h=n(63),p=n(46),m=l["a"].firstNotNull;o["a"].Shader.import(p["a"]),["x","y","z"].forEach((function(e){i.a.extendComponentView({type:e+"Axis3D"})}));var v={x:0,y:2,z:1};i.a.extendComponentView({type:"grid3D",__ecgl__:!0,init:function(e,t){var n=[["y","z","x",-1,"left"],["y","z","x",1,"right"],["x","y","z",-1,"bottom"],["x","y","z",1,"top"],["x","z","y",-1,"far"],["x","z","y",1,"near"]],r=["x","y","z"],i=new o["a"].Material({shader:o["a"].createShader("ecgl.color"),depthMask:!1,transparent:!0}),l=new o["a"].Material({shader:o["a"].createShader("ecgl.meshLines3D"),depthMask:!1,transparent:!0});i.define("fragment","DOUBLE_SIDED"),i.define("both","VERTEX_COLOR"),this.groupGL=new o["a"].Node,this._control=new a["a"]({zr:t.getZr()}),this._control.init(),this._faces=n.map((function(e){var t=new d["a"](e,l,i);return this.groupGL.add(t.rootNode),t}),this),this._axes=r.map((function(e){var t=new f["a"](e,l);return this.groupGL.add(t.rootNode),t}),this);var p=t.getDevicePixelRatio();this._axisLabelSurface=new u["a"]({width:256,height:256,devicePixelRatio:p}),this._axisLabelSurface.onupdate=function(){t.getZr().refresh()},this._axisPointerLineMesh=new o["a"].Mesh({geometry:new s["a"]({useNativeLine:!1}),material:l,castShadow:!1,ignorePicking:!0,renderOrder:3}),this.groupGL.add(this._axisPointerLineMesh),this._axisPointerLabelsSurface=new u["a"]({width:128,height:128,devicePixelRatio:p}),this._axisPointerLabelsMesh=new h["a"]({ignorePicking:!0,renderOrder:4,castShadow:!1}),this._axisPointerLabelsMesh.material.set("textureAtlas",this._axisPointerLabelsSurface.getTexture()),this.groupGL.add(this._axisPointerLabelsMesh),this._lightRoot=new o["a"].Node,this._sceneHelper=new c["a"],this._sceneHelper.initLight(this._lightRoot)},render:function(e,t,n){this._model=e,this._api=n;var r=e.coordinateSystem;r.viewGL.add(this._lightRoot),e.get("show")?r.viewGL.add(this.groupGL):r.viewGL.remove(this.groupGL);var i=this._control;i.setViewGL(r.viewGL);var o=e.getModel("viewControl");i.setFromViewControlModel(o,0),this._axisLabelSurface.clear(),i.off("update"),e.get("show")&&(this._faces.forEach((function(r){r.update(e,t,n)}),this),this._axes.forEach((function(t){t.update(e,this._axisLabelSurface,n)}),this)),i.on("update",this._onCameraChange.bind(this,e,n),this),this._sceneHelper.setScene(r.viewGL.scene),this._sceneHelper.updateLight(e),r.viewGL.setPostEffect(e.getModel("postEffect"),n),r.viewGL.setTemporalSuperSampling(e.getModel("temporalSuperSampling")),this._initMouseHandler(e)},afterRender:function(e,t,n,r){var i=r.renderer;this._sceneHelper.updateAmbientCubemap(i,e,n),this._sceneHelper.updateSkybox(i,e,n)},showAxisPointer:function(e,t,n,r){this._doShowAxisPointer(),this._updateAxisPointer(r.value)},hideAxisPointer:function(e,t,n,r){this._doHideAxisPointer()},_initMouseHandler:function(e){var t=e.coordinateSystem,n=t.viewGL;e.get("show")&&e.get("axisPointer.show")?n.on("mousemove",this._updateAxisPointerOnMousePosition,this):n.off("mousemove",this._updateAxisPointerOnMousePosition)},_updateAxisPointerOnMousePosition:function(e){if(!e.target){for(var t,n=this._model,r=n.coordinateSystem,i=r.viewGL,a=i.castRay(e.offsetX,e.offsetY,new o["a"].Ray),s=0;s<this._faces.length;s++){var l=this._faces[s];if(!l.rootNode.invisible){l.plane.normal.dot(i.camera.worldTransform.z)<0&&l.plane.normal.negate();var u=a.intersectPlane(l.plane);if(u){var c=r.getAxis(l.faceInfo[0]),d=r.getAxis(l.faceInfo[1]),f=v[l.faceInfo[0]],h=v[l.faceInfo[1]];c.contain(u.array[f])&&d.contain(u.array[h])&&(t=u)}}}if(t){var p=r.pointToData(t.array,[],!0);this._updateAxisPointer(p),this._doShowAxisPointer()}else this._doHideAxisPointer()}},_onCameraChange:function(e,t){e.get("show")&&(this._updateFaceVisibility(),this._updateAxisLinePosition());var n=this._control;t.dispatchAction({type:"grid3DChangeCamera",alpha:n.getAlpha(),beta:n.getBeta(),distance:n.getDistance(),center:n.getCenter(),from:this.uid,grid3DId:e.id})},_updateFaceVisibility:function(){var e=this._control.getCamera(),t=new o["a"].Vector3;e.update();for(var n=0;n<this._faces.length/2;n++){for(var r=[],i=0;i<2;i++){var a=this._faces[2*n+i];a.rootNode.getWorldPosition(t),t.transformMat4(e.viewMatrix),r[i]=t.z}var s=r[0]>r[1]?0:1,l=this._faces[2*n+s],u=this._faces[2*n+1-s];l.rootNode.invisible=!0,u.rootNode.invisible=!1}},_updateAxisLinePosition:function(){var e=this._model.coordinateSystem,t=e.getAxis("x"),n=e.getAxis("y"),r=e.getAxis("z"),i=r.getExtentMax(),o=r.getExtentMin(),a=t.getExtentMin(),s=t.getExtentMax(),l=n.getExtentMax(),u=n.getExtentMin(),c=this._axes[0].rootNode,d=this._axes[1].rootNode,f=this._axes[2].rootNode,h=this._faces,p=h[4].rootNode.invisible?u:l,m=h[2].rootNode.invisible?i:o,v=h[0].rootNode.invisible?a:s,g=h[2].rootNode.invisible?i:o,y=h[0].rootNode.invisible?s:a,_=h[4].rootNode.invisible?u:l;c.rotation.identity(),d.rotation.identity(),f.rotation.identity(),h[4].rootNode.invisible&&(this._axes[0].flipped=!0,c.rotation.rotateX(Math.PI)),h[0].rootNode.invisible&&(this._axes[1].flipped=!0,d.rotation.rotateZ(Math.PI)),h[4].rootNode.invisible&&(this._axes[2].flipped=!0,f.rotation.rotateY(Math.PI)),c.position.set(0,m,p),d.position.set(v,g,0),f.position.set(y,0,_),c.update(),d.update(),f.update(),this._updateAxisLabelAlign()},_updateAxisLabelAlign:function(){var e=this._control.getCamera(),t=[new o["a"].Vector4,new o["a"].Vector4],n=new o["a"].Vector4;this.groupGL.getWorldPosition(n),n.w=1,n.transformMat4(e.viewMatrix).transformMat4(e.projectionMatrix),n.x/=n.w,n.y/=n.w,this._axes.forEach((function(r){for(var i=r.axisLineCoords,o=(r.labelsMesh.geometry,0);o<t.length;o++)t[o].setArray(i[o]),t[o].w=1,t[o].transformMat4(r.rootNode.worldTransform).transformMat4(e.viewMatrix).transformMat4(e.projectionMatrix),t[o].x/=t[o].w,t[o].y/=t[o].w;var a,s,l=t[1].x-t[0].x,u=t[1].y-t[0].y,c=(t[1].x+t[0].x)/2,d=(t[1].y+t[0].y)/2;Math.abs(u/l)<.5?(a="center",s=d>n.y?"bottom":"top"):(s="middle",a=c>n.x?"left":"right"),r.setSpriteAlign(a,s,this._api)}),this)},_doShowAxisPointer:function(){this._axisPointerLineMesh.invisible&&(this._axisPointerLineMesh.invisible=!1,this._axisPointerLabelsMesh.invisible=!1,this._api.getZr().refresh())},_doHideAxisPointer:function(){this._axisPointerLineMesh.invisible||(this._axisPointerLineMesh.invisible=!0,this._axisPointerLabelsMesh.invisible=!0,this._api.getZr().refresh())},_updateAxisPointer:function(e){var t=this._model.coordinateSystem,n=t.dataToPoint(e),r=this._axisPointerLineMesh,i=r.geometry,a=this._model.getModel("axisPointer"),s=this._api.getDevicePixelRatio();function u(e){return l["a"].firstNotNull(e.model.get("axisPointer.show"),a.get("show"))}function c(e){var t=e.model.getModel("axisPointer",a),n=t.getModel("lineStyle"),r=o["a"].parseColor(n.get("color")),i=m(n.get("width"),1),s=m(n.get("opacity"),1);return r[3]*=s,{color:r,lineWidth:i}}i.convertToDynamicArray(!0);for(var d=0;d<this._faces.length;d++){var f=this._faces[d];if(!f.rootNode.invisible){for(var h=f.faceInfo,p=h[3]<0?t.getAxis(h[2]).getExtentMin():t.getAxis(h[2]).getExtentMax(),g=v[h[2]],y=0;y<2;y++){var _=h[y],x=h[1-y],b=t.getAxis(_),w=t.getAxis(x);if(u(b)){var A=[0,0,0],T=[0,0,0],S=v[_],E=v[x];A[S]=T[S]=n[S],A[g]=T[g]=p,A[E]=w.getExtentMin(),T[E]=w.getExtentMax();var C=c(b);i.addLine(A,T,C.color,C.lineWidth*s)}}if(u(t.getAxis(h[2]))){A=n.slice(),T=n.slice();T[g]=p;C=c(t.getAxis(h[2]));i.addLine(A,T,C.color,C.lineWidth*s)}}}i.convertToTypedArray(),this._updateAxisPointerLabelsMesh(e),this._api.getZr().refresh()},_updateAxisPointerLabelsMesh:function(e){var t=this._model,n=this._axisPointerLabelsMesh,r=this._axisPointerLabelsSurface,o=t.coordinateSystem,a=t.getModel("axisPointer");n.geometry.convertToDynamicArray(!0),r.clear();var s={x:"y",y:"x",z:"y"};this._axes.forEach((function(t,l){var u=o.getAxis(t.dim),c=u.model,d=c.getModel("axisPointer",a),f=d.getModel("label"),h=d.get("lineStyle.color");if(f.get("show")&&d.get("show")){var p=e[l],m=f.get("formatter"),g=u.scale.getLabel(p);if(null!=m)g=m(g,e);else if("interval"===u.scale.type||"log"===u.scale.type){var y=i.a.number.getPrecisionSafe(u.scale.getTicks()[0]);g=p.toFixed(y+2)}var _=f.getModel("textStyle"),x=_.get("color"),b=new i.a.graphic.Text;i.a.graphic.setTextStyle(b.style,_,{text:g,textFill:x||h,textAlign:"left",textVerticalAlign:"top"});var w=r.add(b),A=b.getBoundingRect(),T=this._api.getDevicePixelRatio(),S=t.rootNode.position.toArray(),E=v[s[t.dim]];S[E]+=(t.flipped?-1:1)*f.get("margin"),S[v[t.dim]]=u.dataToCoord(e[l]),n.geometry.addSprite(S,[A.width*T,A.height*T],w,t.textAlign,t.textVerticalAlign)}}),this),r.getZr().refreshImmediately(),n.material.set("uvScale",r.getCoordsScale()),n.geometry.convertToTypedArray()},dispose:function(){this.groupGL.removeAll(),this._control.dispose()}})},function(e,t,n){"use strict";var r=n(70),i=n(12),o=n(33),a=n(78),s=n(79),l=n(34),u=n(21),c=n(55);t["a"]={vec2:r["a"],vec3:i["a"],vec4:o["a"],mat2:a["a"],mat2d:s["a"],mat3:l["a"],mat4:u["a"],quat:c["a"]}},function(e,t,n){"use strict";var r=n(0),i=n.n(r),o=n(1),a=n(2),s=n(25),l=n(163),u=a["a"].firstNotNull,c={x:0,y:2,z:1};function d(e,t,n,r){var i=[0,0,0],o=r<0?n.getExtentMin():n.getExtentMax();i[c[n.dim]]=o,e.position.setArray(i),e.rotation.identity(),t.distance=-Math.abs(o),t.normal.set(0,0,0),"x"===n.dim?(e.rotation.rotateY(r*Math.PI/2),t.normal.x=-r):"z"===n.dim?(e.rotation.rotateX(-r*Math.PI/2),t.normal.y=-r):(r>0&&e.rotation.rotateY(Math.PI),t.normal.z=-r)}function f(e,t,n){this.rootNode=new o["a"].Node;var r=new o["a"].Mesh({geometry:new s["a"]({useNativeLine:!1}),material:t,castShadow:!1,ignorePicking:!0,$ignorePicking:!0,renderOrder:1}),i=new o["a"].Mesh({geometry:new l["a"],material:n,castShadow:!1,culling:!1,ignorePicking:!0,$ignorePicking:!0,renderOrder:0});this.rootNode.add(i),this.rootNode.add(r),this.faceInfo=e,this.plane=new o["a"].Plane,this.linesMesh=r,this.quadsMesh=i}f.prototype.update=function(e,t,n){var r=e.coordinateSystem,i=[r.getAxis(this.faceInfo[0]),r.getAxis(this.faceInfo[1])],o=this.linesMesh.geometry,a=this.quadsMesh.geometry;o.convertToDynamicArray(!0),a.convertToDynamicArray(!0),this._updateSplitLines(o,i,e,n),this._udpateSplitAreas(a,i,e,n),o.convertToTypedArray(),a.convertToTypedArray();var s=r.getAxis(this.faceInfo[2]);d(this.rootNode,this.plane,s,this.faceInfo[3])},f.prototype._updateSplitLines=function(e,t,n,r){var a=r.getDevicePixelRatio();t.forEach((function(r,s){var l=r.model,c=t[1-s].getExtent();if(!r.scale.isBlank()){var d=l.getModel("splitLine",n.getModel("splitLine"));if(d.get("show")){var f=d.getModel("lineStyle"),h=f.get("color"),p=u(f.get("opacity"),1),m=u(f.get("width"),1);h=i.a.util.isArray(h)?h:[h];for(var v=r.getTicksCoords({tickModel:d}),g=0,y=0;y<v.length;y++){var _=v[y].coord,x=o["a"].parseColor(h[g%h.length]);x[3]*=p;var b=[0,0,0],w=[0,0,0];b[s]=w[s]=_,b[1-s]=c[0],w[1-s]=c[1],e.addLine(b,w,x,m*a),g++}}}}))},f.prototype._udpateSplitAreas=function(e,t,n,r){t.forEach((function(r,a){var s=r.model,l=t[1-a].getExtent();if(!r.scale.isBlank()){var c=s.getModel("splitArea",n.getModel("splitArea"));if(c.get("show")){var d=c.getModel("areaStyle"),f=d.get("color"),h=u(d.get("opacity"),1);f=i.a.util.isArray(f)?f:[f];for(var p=r.getTicksCoords({tickModel:c,clamp:!0}),m=0,v=[0,0,0],g=[0,0,0],y=0;y<p.length;y++){var _=p[y].coord,x=[0,0,0],b=[0,0,0];if(x[a]=b[a]=_,x[1-a]=l[0],b[1-a]=l[1],0!==y){var w=o["a"].parseColor(f[m%f.length]);w[3]*=h,e.addQuad([v,x,b,g],w),v=x,g=b,m++}else v=x,g=b}}}}))},t["a"]=f},function(e,t,n){"use strict";var r=n(15),i=n(0),o=n.n(i),a=n(38),s=n(6),l=s["a"].vec3,u=r["a"].extend((function(){return{segmentScale:1,useNativeLine:!0,attributes:{position:new r["a"].Attribute("position","float",3,"POSITION"),normal:new r["a"].Attribute("normal","float",3,"NORMAL"),color:new r["a"].Attribute("color","float",4,"COLOR")}}}),{resetOffset:function(){this._vertexOffset=0,this._faceOffset=0},setQuadCount:function(e){var t=this.attributes,n=this.getQuadVertexCount()*e,r=this.getQuadTriangleCount()*e;this.vertexCount!==n&&(t.position.init(n),t.normal.init(n),t.color.init(n)),this.triangleCount!==r&&(this.indices=n>65535?new Uint32Array(3*r):new Uint16Array(3*r))},getQuadVertexCount:function(){return 4},getQuadTriangleCount:function(){return 2},addQuad:function(){var e=l.create(),t=l.create(),n=l.create(),r=[0,3,1,3,2,1];return function(i,o){var a=this.attributes.position,s=this.attributes.normal,u=this.attributes.color;l.sub(e,i[1],i[0]),l.sub(t,i[2],i[1]),l.cross(n,e,t),l.normalize(n,n);for(var c=0;c<4;c++)a.set(this._vertexOffset+c,i[c]),u.set(this._vertexOffset+c,o),s.set(this._vertexOffset+c,n);var d=3*this._faceOffset;for(c=0;c<6;c++)this.indices[d+c]=r[c]+this._vertexOffset;this._vertexOffset+=4,this._faceOffset+=2}}()});o.a.util.defaults(u.prototype,a["a"]),t["a"]=u},function(e,t,n){"use strict";var r=n(0),i=n.n(r),o=n(1),a=n(25),s=n(2),l=n(63),u=s["a"].firstNotNull,c={x:0,y:2,z:1};function d(e,t){var n=new o["a"].Mesh({geometry:new a["a"]({useNativeLine:!1}),material:t,castShadow:!1,ignorePicking:!0,renderOrder:2}),r=new l["a"];r.material.depthMask=!1;var i=new o["a"].Node;i.add(n),i.add(r),this.rootNode=i,this.dim=e,this.linesMesh=n,this.labelsMesh=r,this.axisLineCoords=null,this.labelElements=[]}var f={x:"y",y:"x",z:"y"};d.prototype.update=function(e,t,n){var r=e.coordinateSystem,a=r.getAxis(this.dim),s=this.linesMesh.geometry,l=this.labelsMesh.geometry;s.convertToDynamicArray(!0),l.convertToDynamicArray(!0);var d=a.model,h=a.getExtent(),p=n.getDevicePixelRatio(),m=d.getModel("axisLine",e.getModel("axisLine")),v=d.getModel("axisTick",e.getModel("axisTick")),g=d.getModel("axisLabel",e.getModel("axisLabel")),y=m.get("lineStyle.color");if(m.get("show")){var _=m.getModel("lineStyle"),x=[0,0,0],b=[0,0,0],w=c[a.dim];x[w]=h[0],b[w]=h[1],this.axisLineCoords=[x,b];var A=o["a"].parseColor(y),T=u(_.get("width"),1),S=u(_.get("opacity"),1);A[3]*=S,s.addLine(x,b,A,T*p)}if(v.get("show")){var E=v.getModel("lineStyle"),C=o["a"].parseColor(u(E.get("color"),y));T=u(E.get("width"),1);C[3]*=u(E.get("opacity"),1);for(var M=a.getTicksCoords(),L=v.get("length"),N=0;N<M.length;N++){var D=M[N].coord,O=(x=[0,0,0],b=[0,0,0],w=c[a.dim],c[f[a.dim]]);x[w]=b[w]=D,b[O]=L,s.addLine(x,b,C,T*p)}}this.labelElements=[];p=n.getDevicePixelRatio();if(g.get("show")){M=a.getTicksCoords();var I=d.get("data"),R=g.get("margin"),P=a.getViewLabels();for(N=0;N<P.length;N++){var k=P[N].tickValue,B=P[N].formattedLabel,F=P[N].rawLabel,z=(D=a.dataToCoord(k),[0,0,0]);w=c[a.dim],O=c[f[a.dim]];z[w]=z[w]=D,z[O]=R;var H=g;I&&I[k]&&I[k].textStyle&&(H=new i.a.Model(I[k].textStyle,g,d.ecModel));var U=u(H.get("color"),y),G=new i.a.graphic.Text;i.a.graphic.setTextStyle(G.style,H,{text:B,textFill:"function"===typeof U?U("category"===a.type?F:"value"===a.type?k+"":k,N):U,textVerticalAlign:"top",textAlign:"left"});var V=t.add(G),j=G.getBoundingRect();l.addSprite(z,[j.width*p,j.height*p],V),this.labelElements.push(G)}}if(d.get("name")){var W=d.getModel("nameTextStyle"),X=(z=[0,0,0],w=c[a.dim],O=c[f[a.dim]],u(W.get("color"),y)),Y=W.get("borderColor");T=W.get("borderWidth");z[w]=z[w]=(h[0]+h[1])/2,z[O]=d.get("nameGap");G=new i.a.graphic.Text;i.a.graphic.setTextStyle(G.style,W,{text:d.get("name"),textFill:X,textStroke:Y,lineWidth:T});V=t.add(G),j=G.getBoundingRect();l.addSprite(z,[j.width*p,j.height*p],V),G.__idx=this.labelElements.length,this.nameLabelElement=G}this.labelsMesh.material.set("textureAtlas",t.getTexture()),this.labelsMesh.material.set("uvScale",t.getCoordsScale()),s.convertToTypedArray(),l.convertToTypedArray()},d.prototype.setSpriteAlign=function(e,t,n){for(var r=n.getDevicePixelRatio(),i=this.labelsMesh.geometry,o=0;o<this.labelElements.length;o++){var a=this.labelElements[o],s=a.getBoundingRect();i.setSpriteAlign(o,[s.width*r,s.height*r],e,t)}var l=this.nameLabelElement;if(l){s=l.getBoundingRect();i.setSpriteAlign(l.__idx,[s.width*r,s.height*r],e,t),i.dirty()}this.textAlign=e,this.textVerticalAlign=t},t["a"]=d},function(e,t,n){"use strict";var r=n(0),i=n.n(r),o=n(15),a=n(38),s=[0,1,2,0,2,3],l=o["a"].extend((function(){return{attributes:{position:new o["a"].Attribute("position","float",3,"POSITION"),texcoord:new o["a"].Attribute("texcoord","float",2,"TEXCOORD_0"),offset:new o["a"].Attribute("offset","float",2),color:new o["a"].Attribute("color","float",4,"COLOR")}}}),{resetOffset:function(){this._vertexOffset=0,this._faceOffset=0},setSpriteCount:function(e){this._spriteCount=e;var t=4*e,n=2*e;this.vertexCount!==t&&(this.attributes.position.init(t),this.attributes.offset.init(t),this.attributes.color.init(t)),this.triangleCount!==n&&(this.indices=t>65535?new Uint32Array(3*n):new Uint16Array(3*n))},setSpriteAlign:function(e,t,n,r,i){var o,a,s,l;switch(null==n&&(n="left"),null==r&&(r="top"),i=i||0,n){case"left":o=i,s=t[0]+i;break;case"center":case"middle":o=-t[0]/2,s=t[0]/2;break;case"right":o=-t[0]-i,s=-i;break}switch(r){case"bottom":a=i,l=t[1]+i;break;case"middle":a=-t[1]/2,l=t[1]/2;break;case"top":a=-t[1]-i,l=-i;break}var u=4*e,c=this.attributes.offset;c.set(u,[o,l]),c.set(u+1,[s,l]),c.set(u+2,[s,a]),c.set(u+3,[o,a])},addSprite:function(e,t,n,r,i,o){var a=this._vertexOffset;this.setSprite(this._vertexOffset/4,e,t,n,r,i,o);for(var l=0;l<s.length;l++)this.indices[3*this._faceOffset+l]=s[l]+a;return this._faceOffset+=2,this._vertexOffset+=4,a/4},setSprite:function(e,t,n,r,i,o,a){for(var s=4*e,l=this.attributes,u=0;u<4;u++)l.position.set(s+u,t);var c=l.texcoord;c.set(s,[r[0][0],r[0][1]]),c.set(s+1,[r[1][0],r[0][1]]),c.set(s+2,[r[1][0],r[1][1]]),c.set(s+3,[r[0][0],r[1][1]]),this.setSpriteAlign(e,n,i,o,a)}});i.a.util.defaults(l.prototype,a["a"]),t["a"]=l},function(e,t,n){"use strict";t["a"]="@export ecgl.labels.vertex\n\nattribute vec3 position: POSITION;\nattribute vec2 texcoord: TEXCOORD_0;\nattribute vec2 offset;\n#ifdef VERTEX_COLOR\nattribute vec4 a_Color : COLOR;\nvarying vec4 v_Color;\n#endif\n\nuniform mat4 worldViewProjection : WORLDVIEWPROJECTION;\nuniform vec4 viewport : VIEWPORT;\n\nvarying vec2 v_Texcoord;\n\nvoid main()\n{\n vec4 proj = worldViewProjection * vec4(position, 1.0);\n\n vec2 screen = (proj.xy / abs(proj.w) + 1.0) * 0.5 * viewport.zw;\n\n screen += offset;\n\n proj.xy = (screen / viewport.zw - 0.5) * 2.0 * abs(proj.w);\n gl_Position = proj;\n#ifdef VERTEX_COLOR\n v_Color = a_Color;\n#endif\n v_Texcoord = texcoord;\n}\n@end\n\n\n@export ecgl.labels.fragment\n\nuniform vec3 color : [1.0, 1.0, 1.0];\nuniform float alpha : 1.0;\nuniform sampler2D textureAtlas;\nuniform vec2 uvScale: [1.0, 1.0];\n\n#ifdef VERTEX_COLOR\nvarying vec4 v_Color;\n#endif\nvarying float v_Miter;\n\nvarying vec2 v_Texcoord;\n\nvoid main()\n{\n gl_FragColor = vec4(color, alpha) * texture2D(textureAtlas, v_Texcoord * uvScale);\n#ifdef VERTEX_COLOR\n gl_FragColor *= v_Color;\n#endif\n}\n\n@end"},function(e,t,n){"use strict";var r=n(168),i=n(170),o=n(0),a=n.n(o),s=n(47),l=n.n(s),u=n(22),c=n(2);function d(e,t){var n=e.getBoxLayoutParams(),r=l.a.getLayoutRect(n,{width:t.getWidth(),height:t.getHeight()});r.y=t.getHeight()-r.y-r.height,this.viewGL.setViewport(r.x,r.y,r.width,r.height,t.getDevicePixelRatio());var i=e.get("boxWidth"),o=e.get("boxHeight"),a=e.get("boxDepth");["x","y","z"].forEach((function(t){if(!this.getAxis(t))throw new Error("Grid"+e.id+" don't have "+t+"Axis")}),this),this.getAxis("x").setExtent(-i/2,i/2),this.getAxis("y").setExtent(a/2,-a/2),this.getAxis("z").setExtent(-o/2,o/2),this.size=[i,o,a]}function f(e,t){var n={};function r(e,t){n[e]=n[e]||[1/0,-1/0],n[e][0]=Math.min(t[0],n[e][0]),n[e][1]=Math.max(t[1],n[e][1])}e.eachSeries((function(e){if(e.coordinateSystem===this){var t=e.getData();["x","y","z"].forEach((function(e){t.mapDimension(e,!0).forEach((function(n){r(e,t.getDataExtent(n,!0))}))}))}}),this),["xAxis3D","yAxis3D","zAxis3D"].forEach((function(t){e.eachComponent(t,(function(e){var r=t.charAt(0),o=e.getReferringComponents("grid3D")[0],s=o.coordinateSystem;if(s===this){var l=s.getAxis(r);if(l)console.warn("Can't have two %s in one grid3D",t);else{var u=a.a.helper.createScale(n[r]||[1/0,-1/0],e);l=new i["a"](r,u),l.type=e.get("type");var c="category"===l.type;l.onBand=c&&e.get("boundaryGap"),l.inverse=e.get("inverse"),e.axis=l,l.model=e,l.getLabelModel=function(){return e.getModel("axisLabel",o.getModel("axisLabel"))},l.getTickModel=function(){return e.getModel("axisTick",o.getModel("axisTick"))},s.addAxis(l)}}}),this)}),this),this.resize(this.model,t)}var h={dimensions:r["a"].prototype.dimensions,create:function(e,t){var n=[];e.eachComponent("grid3D",(function(e){e.__viewGL=e.__viewGL||new u["a"];var t=new r["a"];t.model=e,t.viewGL=e.__viewGL,e.coordinateSystem=t,n.push(t),t.resize=d,t.update=f}));var i=["xAxis3D","yAxis3D","zAxis3D"];function o(e,t){return i.map((function(n){var r=e.getReferringComponents(n)[0];if(null==r&&(r=t.getComponent(n)),!r)throw new Error(n+' "'+c["a"].firstNotNull(e.get(n+"Index"),e.get(n+"Id"),0)+'" not found');return r}))}return e.eachSeries((function(t){if("cartesian3D"===t.get("coordinateSystem")){var n=t.getReferringComponents("grid3D")[0];if(null==n){var r=o(t,e);n=r[0].getCoordSysModel();r.forEach((function(e){var t=e.getCoordSysModel();if(!t)throw new Error('grid3D "'+c["a"].firstNotNull(e.get("gridIndex"),e.get("gridId"),0)+'" not found');if(t!==n)throw new Error("xAxis3D, yAxis3D, zAxis3D must use the same grid")}))}var i=n.coordinateSystem;t.coordinateSystem=i}})),n}};a.a.registerCoordinateSystem("grid3D",h)},function(e,t,n){"use strict";var r=n(0),i=n.n(r),o=n(169),a=n.n(o);function s(e){a.a.call(this,e),this.size=[0,0,0]}s.prototype={constructor:s,type:"cartesian3D",dimensions:["x","y","z"],model:null,containPoint:function(e){return this.getAxis("x").contain(e[0])&&this.getAxis("y").contain(e[2])&&this.getAxis("z").contain(e[1])},containData:function(e){return this.getAxis("x").containData(e[0])&&this.getAxis("y").containData(e[1])&&this.getAxis("z").containData(e[2])},dataToPoint:function(e,t,n){return t=t||[],t[0]=this.getAxis("x").dataToCoord(e[0],n),t[2]=this.getAxis("y").dataToCoord(e[1],n),t[1]=this.getAxis("z").dataToCoord(e[2],n),t},pointToData:function(e,t,n){return t=t||[],t[0]=this.getAxis("x").coordToData(e[0],n),t[1]=this.getAxis("y").coordToData(e[2],n),t[2]=this.getAxis("z").coordToData(e[1],n),t}},i.a.util.inherits(s,a.a),t["a"]=s},function(e,t,n){var r=n(13);function i(e){return this._axes[e]}var o=function(e){this._axes={},this._dimList=[],this.name=e||""};o.prototype={constructor:o,type:"cartesian",getAxis:function(e){return this._axes[e]},getAxes:function(){return r.map(this._dimList,i,this)},getAxesByScale:function(e){return e=e.toLowerCase(),r.filter(this.getAxes(),(function(t){return t.scale.type===e}))},addAxis:function(e){var t=e.dim;this._axes[t]=e,this._dimList.push(t)},dataToCoord:function(e){return this._dataCoordConvert(e,"dataToCoord")},coordToData:function(e){return this._dataCoordConvert(e,"coordToData")},_dataCoordConvert:function(e,t){for(var n=this._dimList,r=e instanceof Array?[]:{},i=0;i<n.length;i++){var o=n[i],a=this._axes[o];r[o]=a[t](e[o])}return r}};var a=o;e.exports=a},function(e,t,n){"use strict";var r=n(0),i=n.n(r);function o(e,t,n){i.a.Axis.call(this,e,t,n)}o.prototype={constructor:o,getExtentMin:function(){var e=this._extent;return Math.min(e[0],e[1])},getExtentMax:function(){var e=this._extent;return Math.max(e[0],e[1])},calculateCategoryInterval:function(){return Math.floor(this.scale.count()/8)}},i.a.util.inherits(o,i.a.Axis),t["a"]=o},function(e,t,n){var r=n(13),i=n(172),o=n(85);function a(e){return isNaN(e)?"-":(e=(e+"").split("."),e[0].replace(/(\d{1,3})(?=(?:\d{3})+(?!\d))/g,"$1,")+(e.length>1?"."+e[1]:""))}function s(e,t){return e=(e||"").toLowerCase().replace(/-(.)/g,(function(e,t){return t.toUpperCase()})),t&&e&&(e=e.charAt(0).toUpperCase()+e.slice(1)),e}var l=r.normalizeCssArray,u=/([&<>"'])/g,c={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function d(e){return null==e?"":(e+"").replace(u,(function(e,t){return c[t]}))}var f=["a","b","c","d","e","f","g"],h=function(e,t){return"{"+e+(null==t?"":t)+"}"};function p(e,t,n){r.isArray(t)||(t=[t]);var i=t.length;if(!i)return"";for(var o=t[0].$vars||[],a=0;a<o.length;a++){var s=f[a];e=e.replace(h(s),h(s,0))}for(var l=0;l<i;l++)for(var u=0;u<o.length;u++){var c=t[l][o[u]];e=e.replace(h(f[u],l),n?d(c):c)}return e}function m(e,t,n){return r.each(t,(function(t,r){e=e.replace("{"+r+"}",n?d(t):t)})),e}function v(e,t){e=r.isString(e)?{color:e,extraCssText:t}:e||{};var n=e.color,i=e.type;t=e.extraCssText;return n?"subItem"===i?'<span style="display:inline-block;vertical-align:middle;margin-right:8px;margin-left:3px;border-radius:4px;width:4px;height:4px;background-color:'+d(n)+";"+(t||"")+'"></span>':'<span style="display:inline-block;margin-right:5px;border-radius:10px;width:10px;height:10px;background-color:'+d(n)+";"+(t||"")+'"></span>':""}function g(e,t){return e+="","0000".substr(0,t-e.length)+e}function y(e,t,n){"week"!==e&&"month"!==e&&"quarter"!==e&&"half-year"!==e&&"year"!==e||(e="MM-dd\nyyyy");var r=o.parseDate(t),i=n?"UTC":"",a=r["get"+i+"FullYear"](),s=r["get"+i+"Month"]()+1,l=r["get"+i+"Date"](),u=r["get"+i+"Hours"](),c=r["get"+i+"Minutes"](),d=r["get"+i+"Seconds"](),f=r["get"+i+"Milliseconds"]();return e=e.replace("MM",g(s,2)).replace("M",s).replace("yyyy",a).replace("yy",a%100).replace("dd",g(l,2)).replace("d",l).replace("hh",g(u,2)).replace("h",u).replace("mm",g(c,2)).replace("m",c).replace("ss",g(d,2)).replace("s",d).replace("SSS",g(f,3)),e}function _(e){return e?e.charAt(0).toUpperCase()+e.substr(1):e}var x=i.truncateText,b=i.getBoundingRect;t.addCommas=a,t.toCamelCase=s,t.normalizeCssArray=l,t.encodeHTML=d,t.formatTpl=p,t.formatTplSimple=m,t.getTooltipMarker=v,t.formatTime=y,t.capitalFirst=_,t.truncateText=x,t.getTextRect=b},function(e,t,n){var r=n(82),i=n(173),o=n(13),a=o.getContext,s=o.extend,l=o.retrieve2,u=o.retrieve3,c=o.trim,d={},f=0,h=5e3,p=/\{([a-zA-Z0-9_]+)\|([^}]*)\}/g,m="12px sans-serif",v={};function g(e,t){v[e]=t}function y(e,t){t=t||m;var n=e+":"+t;if(d[n])return d[n];for(var r=(e+"").split("\n"),i=0,o=0,a=r.length;o<a;o++)i=Math.max(N(r[o],t).width,i);return f>h&&(f=0,d={}),f++,d[n]=i,i}function _(e,t,n,r,i,o,a){return o?b(e,t,n,r,i,o,a):x(e,t,n,r,i,a)}function x(e,t,n,i,o,a){var s=D(e,t,o,a),l=y(e,t);o&&(l+=o[1]+o[3]);var u=s.outerHeight,c=w(0,l,n),d=A(0,u,i),f=new r(c,d,l,u);return f.lineHeight=s.lineHeight,f}function b(e,t,n,i,o,a,s){var l=O(e,{rich:a,truncate:s,font:t,textAlign:n,textPadding:o}),u=l.outerWidth,c=l.outerHeight,d=w(0,u,n),f=A(0,c,i);return new r(d,f,u,c)}function w(e,t,n){return"right"===n?e-=t:"center"===n&&(e-=t/2),e}function A(e,t,n){return"middle"===n?e-=t/2:"bottom"===n&&(e-=t),e}function T(e,t,n){var r=t.x,i=t.y,o=t.height,a=t.width,s=o/2,l="left",u="top";switch(e){case"left":r-=n,i+=s,l="right",u="middle";break;case"right":r+=n+a,i+=s,u="middle";break;case"top":r+=a/2,i-=n,l="center",u="bottom";break;case"bottom":r+=a/2,i+=o+n,l="center";break;case"inside":r+=a/2,i+=s,l="center",u="middle";break;case"insideLeft":r+=n,i+=s,u="middle";break;case"insideRight":r+=a-n,i+=s,l="right",u="middle";break;case"insideTop":r+=a/2,i+=n,l="center";break;case"insideBottom":r+=a/2,i+=o-n,l="center",u="bottom";break;case"insideTopLeft":r+=n,i+=n;break;case"insideTopRight":r+=a-n,i+=n,l="right";break;case"insideBottomLeft":r+=n,i+=o-n,u="bottom";break;case"insideBottomRight":r+=a-n,i+=o-n,l="right",u="bottom";break}return{x:r,y:i,textAlign:l,textVerticalAlign:u}}function S(e,t,n,r,i){if(!t)return"";var o=(e+"").split("\n");i=E(t,n,r,i);for(var a=0,s=o.length;a<s;a++)o[a]=C(o[a],i);return o.join("\n")}function E(e,t,n,r){r=s({},r),r.font=t;n=l(n,"...");r.maxIterations=l(r.maxIterations,2);var i=r.minChar=l(r.minChar,0);r.cnCharWidth=y("国",t);var o=r.ascCharWidth=y("a",t);r.placeholder=l(r.placeholder,"");for(var a=e=Math.max(0,e-1),u=0;u<i&&a>=o;u++)a-=o;var c=y(n);return c>a&&(n="",c=0),a=e-c,r.ellipsis=n,r.ellipsisWidth=c,r.contentWidth=a,r.containerWidth=e,r}function C(e,t){var n=t.containerWidth,r=t.font,i=t.contentWidth;if(!n)return"";var o=y(e,r);if(o<=n)return e;for(var a=0;;a++){if(o<=i||a>=t.maxIterations){e+=t.ellipsis;break}var s=0===a?M(e,i,t.ascCharWidth,t.cnCharWidth):o>0?Math.floor(e.length*i/o):0;e=e.substr(0,s),o=y(e,r)}return""===e&&(e=t.placeholder),e}function M(e,t,n,r){for(var i=0,o=0,a=e.length;o<a&&i<t;o++){var s=e.charCodeAt(o);i+=0<=s&&s<=127?n:r}return o}function L(e){return y("国",e)}function N(e,t){return v.measureText(e,t)}function D(e,t,n,r){null!=e&&(e+="");var i=L(t),o=e?e.split("\n"):[],a=o.length*i,s=a;if(n&&(s+=n[0]+n[2]),e&&r){var l=r.outerHeight,u=r.outerWidth;if(null!=l&&s>l)e="",o=[];else if(null!=u)for(var c=E(u-(n?n[1]+n[3]:0),t,r.ellipsis,{minChar:r.minChar,placeholder:r.placeholder}),d=0,f=o.length;d<f;d++)o[d]=C(o[d],c)}return{lines:o,height:a,outerHeight:s,lineHeight:i}}function O(e,t){var n={lines:[],width:0,height:0};if(null!=e&&(e+=""),!e)return n;var r,o=p.lastIndex=0;while(null!=(r=p.exec(e))){var a=r.index;a>o&&I(n,e.substring(o,a)),I(n,r[2],r[1]),o=p.lastIndex}o<e.length&&I(n,e.substring(o,e.length));var s=n.lines,c=0,d=0,f=[],h=t.textPadding,m=t.truncate,v=m&&m.outerWidth,g=m&&m.outerHeight;h&&(null!=v&&(v-=h[1]+h[3]),null!=g&&(g-=h[0]+h[2]));for(var _=0;_<s.length;_++){for(var x=s[_],b=0,w=0,A=0;A<x.tokens.length;A++){var T=x.tokens[A],E=T.styleName&&t.rich[T.styleName]||{},C=T.textPadding=E.textPadding,M=T.font=E.font||t.font,N=T.textHeight=l(E.textHeight,L(M));if(C&&(N+=C[0]+C[2]),T.height=N,T.lineHeight=u(E.textLineHeight,t.textLineHeight,N),T.textAlign=E&&E.textAlign||t.textAlign,T.textVerticalAlign=E&&E.textVerticalAlign||"middle",null!=g&&c+T.lineHeight>g)return{lines:[],width:0,height:0};T.textWidth=y(T.text,M);var D=E.textWidth,O=null==D||"auto"===D;if("string"===typeof D&&"%"===D.charAt(D.length-1))T.percentWidth=D,f.push(T),D=0;else{if(O){D=T.textWidth;var R=E.textBackgroundColor,P=R&&R.image;P&&(P=i.findExistImage(P),i.isImageReady(P)&&(D=Math.max(D,P.width*N/P.height)))}var k=C?C[1]+C[3]:0;D+=k;var B=null!=v?v-w:null;null!=B&&B<D&&(!O||B<k?(T.text="",T.textWidth=D=0):(T.text=S(T.text,B-k,M,m.ellipsis,{minChar:m.minChar}),T.textWidth=y(T.text,M),D=T.textWidth+k))}w+=T.width=D,E&&(b=Math.max(b,T.lineHeight))}x.width=w,x.lineHeight=b,c+=b,d=Math.max(d,w)}n.outerWidth=n.width=l(t.textWidth,d),n.outerHeight=n.height=l(t.textHeight,c),h&&(n.outerWidth+=h[1]+h[3],n.outerHeight+=h[0]+h[2]);for(_=0;_<f.length;_++){T=f[_];var F=T.percentWidth;T.width=parseInt(F,10)/100*d}return n}function I(e,t,n){for(var r=""===t,i=t.split("\n"),o=e.lines,a=0;a<i.length;a++){var s=i[a],l={styleName:n,text:s,isLineHolder:!s&&!r};if(a)o.push({tokens:[l]});else{var u=(o[o.length-1]||(o[0]={tokens:[]})).tokens,c=u.length;1===c&&u[0].isLineHolder?u[0]=l:(s||!c||r)&&u.push(l)}}}function R(e){var t=(e.fontSize||e.fontFamily)&&[e.fontStyle,e.fontWeight,(e.fontSize||12)+"px",e.fontFamily||"sans-serif"].join(" ");return t&&c(t)||e.textFont||e.font}v.measureText=function(e,t){var n=a();return n.font=t||m,n.measureText(e)},t.DEFAULT_FONT=m,t.$override=g,t.getWidth=y,t.getBoundingRect=_,t.adjustTextX=w,t.adjustTextY=A,t.adjustTextPositionOnRect=T,t.truncateText=S,t.getLineHeight=L,t.measureText=N,t.parsePlainText=D,t.parseRichText=O,t.makeFont=R},function(e,t,n){var r=n(60),i=new r(50);function o(e){if("string"===typeof e){var t=i.get(e);return t&&t.image}return e}function a(e,t,n,r,o){if(e){if("string"===typeof e){if(t&&t.__zrImageSrc===e||!n)return t;var a=i.get(e),u={hostEl:n,cb:r,cbPayload:o};return a?(t=a.image,!l(t)&&a.pending.push(u)):(!t&&(t=new Image),t.onload=s,i.put(e,t.__cachedImgObj={image:t,pending:[u]}),t.src=t.__zrImageSrc=e),t}return e}return t}function s(){var e=this.__cachedImgObj;this.onload=this.__cachedImgObj=null;for(var t=0;t<e.pending.length;t++){var n=e.pending[t],r=n.cb;r&&r(this,n.cbPayload),n.hostEl.dirty()}e.pending.length=0}function l(e){return e&&e.width&&e.height}t.findExistImage=o,t.createOrUpdateImage=a,t.isImageReady=l},function(e,t,n){"use strict";var r=n(7),i=n(11),o=n(3),a=n(18),s=n(59),l=n(9),u=n(52),c=n(8),d=n(19),f=n(10),h=n(4),p=n(5),m=n(27),v=n(41),g=n(37),y=n(16),_=n(86),x=n(21),b=n(175),w=["px","nx","py","ny","pz","nz"];function A(e,t,n){if("alphaMap"===n)return e.material.get("diffuseMap");if("alphaCutoff"===n){if(e.material.isDefined("fragment","ALPHA_TEST")&&e.material.get("diffuseMap")){var r=e.material.get("alphaCutoff");return r||0}return 0}return t.get(n)}function T(e,t){var n=e.material,r=t.material;return n.get("diffuseMap")!==r.get("diffuseMap")||(n.get("alphaCutoff")||0)!==(r.get("alphaCutoff")||0)}c["a"]["import"](b["a"]);var S=r["a"].extend((function(){return{softShadow:S.PCF,shadowBlur:1,lightFrustumBias:"auto",kernelPCF:new Float32Array([1,0,1,1,-1,1,0,1,-1,0,-1,-1,1,-1,0,-1]),precision:"highp",_lastRenderNotCastShadow:!1,_frameBuffer:new f["a"],_textures:{},_shadowMapNumber:{POINT_LIGHT:0,DIRECTIONAL_LIGHT:0,SPOT_LIGHT:0},_depthMaterials:{},_distanceMaterials:{},_receivers:[],_lightsCastShadow:[],_lightCameras:{},_lightMaterials:{},_texturePool:new _["a"]}}),(function(){this._gaussianPassH=new y["a"]({fragment:c["a"].source("clay.compositor.gaussian_blur")}),this._gaussianPassV=new y["a"]({fragment:c["a"].source("clay.compositor.gaussian_blur")}),this._gaussianPassH.setUniform("blurSize",this.shadowBlur),this._gaussianPassH.setUniform("blurDir",0),this._gaussianPassV.setUniform("blurSize",this.shadowBlur),this._gaussianPassV.setUniform("blurDir",1),this._outputDepthPass=new y["a"]({fragment:c["a"].source("clay.sm.debug_depth")})}),{render:function(e,t,n,r){n||(n=t.getMainCamera()),this.trigger("beforerender",this,e,t,n),this._renderShadowPass(e,t,n,r),this.trigger("afterrender",this,e,t,n)},renderDebug:function(e,t){e.saveClear();var n=e.viewport,r=0,i=0,o=t||n.width/4,a=o;for(var s in this.softShadow===S.VSM?this._outputDepthPass.material.define("fragment","USE_VSM"):this._outputDepthPass.material.undefine("fragment","USE_VSM"),this._textures){var l=this._textures[s];e.setViewport(r,i,o*l.width/l.height,a),this._outputDepthPass.setUniform("depthMap",l),this._outputDepthPass.render(e),r+=o*l.width/l.height}e.setViewport(n),e.restoreClear()},_updateReceivers:function(e,t){if(t.receiveShadow?(this._receivers.push(t),t.material.set("shadowEnabled",1),t.material.set("pcfKernel",this.kernelPCF)):t.material.set("shadowEnabled",0),this.softShadow===S.VSM)t.material.define("fragment","USE_VSM"),t.material.undefine("fragment","PCF_KERNEL_SIZE");else{t.material.undefine("fragment","USE_VSM");var n=this.kernelPCF;n&&n.length?t.material.define("fragment","PCF_KERNEL_SIZE",n.length/2):t.material.undefine("fragment","PCF_KERNEL_SIZE")}},_update:function(e,t){var n=this;t.traverse((function(t){t.isRenderable()&&n._updateReceivers(e,t)}));for(var r=0;r<t.lights.length;r++){var i=t.lights[r];i.castShadow&&!i.invisible&&this._lightsCastShadow.push(i)}},_renderShadowPass:function(e,t,n,r){for(var i in this._shadowMapNumber)this._shadowMapNumber[i]=0;this._lightsCastShadow.length=0,this._receivers.length=0;var o=e.gl;if(r||t.update(),n&&n.update(),t.updateLights(),this._update(e,t),this._lightsCastShadow.length||!this._lastRenderNotCastShadow){this._lastRenderNotCastShadow=0===this._lightsCastShadow,o.enable(o.DEPTH_TEST),o.depthMask(!0),o.disable(o.BLEND),o.clearColor(1,1,1,1);for(var a,s=[],l=[],u=[],c=[],d=[],f=[],h=0;h<this._lightsCastShadow.length;h++){var p=this._lightsCastShadow[h];if("DIRECTIONAL_LIGHT"===p.type){if(a){console.warn("Only one direectional light supported with shadow cascade");continue}if(p.shadowCascade>4){console.warn("Support at most 4 cascade");continue}p.shadowCascade>1&&(a=p),this.renderDirectionalLightShadow(e,t,n,p,d,c,u)}else"SPOT_LIGHT"===p.type?this.renderSpotLightShadow(e,t,p,l,s):"POINT_LIGHT"===p.type&&this.renderPointLightShadow(e,t,p,f);this._shadowMapNumber[p.type]++}for(var m in this._shadowMapNumber){var v=this._shadowMapNumber[m],g=m+"_SHADOWMAP_COUNT";for(h=0;h<this._receivers.length;h++){var y=this._receivers[h],_=y.material;_.fragmentDefines[g]!==v&&(v>0?_.define("fragment",g,v):_.isDefined("fragment",g)&&_.undefine("fragment",g))}}for(h=0;h<this._receivers.length;h++){y=this._receivers[h],_=y.material;a?_.define("fragment","SHADOW_CASCADE",a.shadowCascade):_.undefine("fragment","SHADOW_CASCADE")}var x=t.shadowUniforms;if(u.length>0){var b=u.map(S);if(x.directionalLightShadowMaps={value:u,type:"tv"},x.directionalLightMatrices={value:c,type:"m4v"},x.directionalLightShadowMapSizes={value:b,type:"1fv"},a){var w=d.slice(),A=d.slice();w.pop(),A.shift(),w.reverse(),A.reverse(),c.reverse(),x.shadowCascadeClipsNear={value:w,type:"1fv"},x.shadowCascadeClipsFar={value:A,type:"1fv"}}}if(s.length>0){var T=s.map(S);x=t.shadowUniforms;x.spotLightShadowMaps={value:s,type:"tv"},x.spotLightMatrices={value:l,type:"m4v"},x.spotLightShadowMapSizes={value:T,type:"1fv"}}f.length>0&&(x.pointLightShadowMaps={value:f,type:"tv"})}function S(e){return e.height}},renderDirectionalLightShadow:function(){var e=new s["a"],t=new l["a"],n=new a["a"],r=new l["a"],i=new l["a"],o=new l["a"],c=new l["a"];return function(a,s,d,f,h,p,m){var g=this._getDepthMaterial(f),y={getMaterial:function(e){return e.shadowDepthMaterial||g},isMaterialChanged:T,getUniform:A,ifRender:function(e){return e.castShadow},sortCompare:u["a"].opaqueSortCompare};if(!s.viewBoundingBoxLastFrame.isFinite()){var _=s.getBoundingBox();s.viewBoundingBoxLastFrame.copy(_).applyTransform(d.viewMatrix)}var b=Math.min(-s.viewBoundingBoxLastFrame.min.z,d.far),w=Math.max(-s.viewBoundingBoxLastFrame.max.z,d.near),E=this._getDirectionalLightCamera(f,s,d),C=o.array;c.copy(E.projectionMatrix),x["a"].invert(i.array,E.worldTransform.array),x["a"].multiply(i.array,i.array,d.worldTransform.array),x["a"].multiply(C,c.array,i.array);for(var M=[],L=d instanceof v["a"],N=(d.near+d.far)/(d.near-d.far),D=2*d.near*d.far/(d.near-d.far),O=0;O<=f.shadowCascade;O++){var I=w*Math.pow(b/w,O/f.shadowCascade),R=w+(b-w)*O/f.shadowCascade,P=I*f.cascadeSplitLogFactor+R*(1-f.cascadeSplitLogFactor);M.push(P),h.push(-(-P*N+D)/-P)}var k=this._getTexture(f,f.shadowCascade);m.push(k);var B=a.viewport,F=a.gl;this._frameBuffer.attach(k),this._frameBuffer.bind(a),F.clear(F.COLOR_BUFFER_BIT|F.DEPTH_BUFFER_BIT);for(O=0;O<f.shadowCascade;O++){var z=M[O],H=M[O+1];L?x["a"].perspective(t.array,d.fov/180*Math.PI,d.aspect,z,H):x["a"].ortho(t.array,d.left,d.right,d.bottom,d.top,z,H),e.setFromProjection(t),e.getTransformedBoundingBox(n,i),n.applyProjection(c);var U=n.min.array,G=n.max.array;U[0]=Math.max(U[0],-1),U[1]=Math.max(U[1],-1),G[0]=Math.min(G[0],1),G[1]=Math.min(G[1],1),r.ortho(U[0],G[0],U[1],G[1],1,-1),E.projectionMatrix.multiplyLeft(r);var V=f.shadowResolution||512;a.setViewport((f.shadowCascade-O-1)*V,0,V,V,1);var j=s.updateRenderList(E);a.renderPass(j.opaque,E,y),this.softShadow===S.VSM&&this._gaussianFilter(a,k,k.width);var W=new l["a"];W.copy(E.viewMatrix).multiplyLeft(E.projectionMatrix),p.push(W.array),E.projectionMatrix.copy(c)}this._frameBuffer.unbind(a),a.setViewport(B)}}(),renderSpotLightShadow:function(e,t,n,r,i){var o=this._getTexture(n),a=this._getSpotLightCamera(n),s=e.gl;this._frameBuffer.attach(o),this._frameBuffer.bind(e),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT);var c=this._getDepthMaterial(n),d={getMaterial:function(e){return e.shadowDepthMaterial||c},isMaterialChanged:T,getUniform:A,ifRender:function(e){return e.castShadow},sortCompare:u["a"].opaqueSortCompare},f=t.updateRenderList(a);e.renderPass(f.opaque,a,d),this._frameBuffer.unbind(e),this.softShadow===S.VSM&&this._gaussianFilter(e,o,o.width);var h=new l["a"];h.copy(a.worldTransform).invert().multiplyLeft(a.projectionMatrix),i.push(o),r.push(h.array)},renderPointLightShadow:function(e,t,n,r){var i=this._getTexture(n),s=e.gl;r.push(i);var l=this._getDepthMaterial(n),c={getMaterial:function(e){return e.shadowDepthMaterial||l},getUniform:A,sortCompare:u["a"].opaqueSortCompare},d={px:[],py:[],pz:[],nx:[],ny:[],nz:[]},f=new a["a"],h=n.getWorldPosition().array,p=new a["a"],m=n.range;p.min.setArray(h),p.max.setArray(h);var v=new o["a"](m,m,m);p.max.add(v),p.min.sub(v);var g={px:!1,py:!1,pz:!1,nx:!1,ny:!1,nz:!1};t.traverse((function(e){if(e.isRenderable()&&e.castShadow){var t=e.geometry;if(!t.boundingBox){for(var n=0;n<w.length;n++)d[w[n]].push(e);return}if(f.transformFrom(t.boundingBox,e.worldTransform),!f.intersectBoundingBox(p))return;f.updateVertices();for(n=0;n<w.length;n++)g[w[n]]=!1;for(n=0;n<8;n++){var r=f.vertices[n],i=r[0]-h[0],o=r[1]-h[1],a=r[2]-h[2],s=Math.abs(i),l=Math.abs(o),u=Math.abs(a);s>l?s>u?g[i>0?"px":"nx"]=!0:g[a>0?"pz":"nz"]=!0:l>u?g[o>0?"py":"ny"]=!0:g[a>0?"pz":"nz"]=!0}for(n=0;n<w.length;n++)g[w[n]]&&d[w[n]].push(e)}}));for(var y=0;y<6;y++){var _=w[y],x=this._getPointLightCamera(n,_);this._frameBuffer.attach(i,s.COLOR_ATTACHMENT0,s.TEXTURE_CUBE_MAP_POSITIVE_X+y),this._frameBuffer.bind(e),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT),e.renderPass(d[_],x,c)}this._frameBuffer.unbind(e)},_getDepthMaterial:function(e){var t=this._lightMaterials[e.__uid__],n="POINT_LIGHT"===e.type;if(!t){var r=n?"clay.sm.distance.":"clay.sm.depth.";t=new d["a"]({precision:this.precision,shader:new c["a"](c["a"].source(r+"vertex"),c["a"].source(r+"fragment"))}),this._lightMaterials[e.__uid__]=t}return null!=e.shadowSlopeScale&&t.setUniform("slopeScale",e.shadowSlopeScale),null!=e.shadowBias&&t.setUniform("bias",e.shadowBias),this.softShadow===S.VSM?t.define("fragment","USE_VSM"):t.undefine("fragment","USE_VSM"),n&&(t.set("lightPosition",e.getWorldPosition().array),t.set("range",e.range)),t},_gaussianFilter:function(e,t,n){var r={width:n,height:n,type:h["a"].FLOAT},i=this._texturePool.get(r);this._frameBuffer.attach(i),this._frameBuffer.bind(e),this._gaussianPassH.setUniform("texture",t),this._gaussianPassH.setUniform("textureWidth",n),this._gaussianPassH.render(e),this._frameBuffer.attach(t),this._gaussianPassV.setUniform("texture",i),this._gaussianPassV.setUniform("textureHeight",n),this._gaussianPassV.render(e),this._frameBuffer.unbind(e),this._texturePool.put(i)},_getTexture:function(e,t){var n=e.__uid__,r=this._textures[n],o=e.shadowResolution||512;return t=t||1,r||(r="POINT_LIGHT"===e.type?new m["a"]:new p["a"],r.width=o*t,r.height=o,this.softShadow===S.VSM?(r.type=h["a"].FLOAT,r.anisotropic=4):(r.minFilter=i["a"].NEAREST,r.magFilter=i["a"].NEAREST,r.useMipmap=!1),this._textures[n]=r),r},_getPointLightCamera:function(e,t){this._lightCameras.point||(this._lightCameras.point={px:new v["a"],nx:new v["a"],py:new v["a"],ny:new v["a"],pz:new v["a"],nz:new v["a"]});var n=this._lightCameras.point[t];switch(n.far=e.range,n.fov=90,n.position.set(0,0,0),t){case"px":n.lookAt(o["a"].POSITIVE_X,o["a"].NEGATIVE_Y);break;case"nx":n.lookAt(o["a"].NEGATIVE_X,o["a"].NEGATIVE_Y);break;case"py":n.lookAt(o["a"].POSITIVE_Y,o["a"].POSITIVE_Z);break;case"ny":n.lookAt(o["a"].NEGATIVE_Y,o["a"].NEGATIVE_Z);break;case"pz":n.lookAt(o["a"].POSITIVE_Z,o["a"].NEGATIVE_Y);break;case"nz":n.lookAt(o["a"].NEGATIVE_Z,o["a"].NEGATIVE_Y);break}return e.getWorldPosition(n.position),n.update(),n},_getDirectionalLightCamera:function(){var e=new l["a"],t=new a["a"],n=new a["a"];return function(r,i,o){this._lightCameras.directional||(this._lightCameras.directional=new g["a"]);var a=this._lightCameras.directional;t.copy(i.viewBoundingBoxLastFrame),t.intersection(o.frustum.boundingBox),a.position.copy(t.min).add(t.max).scale(.5).transformMat4(o.worldTransform),a.rotation.copy(r.rotation),a.scale.copy(r.scale),a.updateWorldTransform(),l["a"].invert(e,a.worldTransform),l["a"].multiply(e,e,o.worldTransform),n.copy(t).applyTransform(e);var s=n.min.array,u=n.max.array;return a.position.set((s[0]+u[0])/2,(s[1]+u[1])/2,u[2]).transformMat4(a.worldTransform),a.near=0,a.far=-s[2]+u[2],isNaN(this.lightFrustumBias)?a.far*=4:a.far+=this.lightFrustumBias,a.left=s[0],a.right=u[0],a.top=u[1],a.bottom=s[1],a.update(!0),a}}(),_getSpotLightCamera:function(e){this._lightCameras.spot||(this._lightCameras.spot=new v["a"]);var t=this._lightCameras.spot;return t.fov=2*e.penumbraAngle,t.far=e.range,t.worldTransform.copy(e.worldTransform),t.updateProjectionMatrix(),x["a"].invert(t.viewMatrix.array,t.worldTransform.array),t},dispose:function(e){var t=e.gl||e;for(var n in this._frameBuffer&&this._frameBuffer.dispose(t),this._textures)this._textures[n].dispose(t);this._texturePool.clear(e.gl),this._depthMaterials={},this._distanceMaterials={},this._textures={},this._lightCameras={},this._shadowMapNumber={POINT_LIGHT:0,DIRECTIONAL_LIGHT:0,SPOT_LIGHT:0},this._meshMaterials={};for(var r=0;r<this._receivers.length;r++){var i=this._receivers[r];if(i.material){var o=i.material;o.undefine("fragment","POINT_LIGHT_SHADOW_COUNT"),o.undefine("fragment","DIRECTIONAL_LIGHT_SHADOW_COUNT"),o.undefine("fragment","AMBIENT_LIGHT_SHADOW_COUNT"),o.set("shadowEnabled",0)}}this._receivers=[],this._lightsCastShadow=[]}});S.VSM=1,S.PCF=2,t["a"]=S},function(e,t,n){"use strict";t["a"]="@export clay.sm.depth.vertex\nuniform mat4 worldViewProjection : WORLDVIEWPROJECTION;\nattribute vec3 position : POSITION;\nattribute vec2 texcoord : TEXCOORD_0;\n@import clay.chunk.skinning_header\nvarying vec4 v_ViewPosition;\nvarying vec2 v_Texcoord;\nvoid main(){\n vec3 skinnedPosition = position;\n#ifdef SKINNING\n @import clay.chunk.skin_matrix\n skinnedPosition = (skinMatrixWS * vec4(position, 1.0)).xyz;\n#endif\n v_ViewPosition = worldViewProjection * vec4(skinnedPosition, 1.0);\n gl_Position = v_ViewPosition;\n v_Texcoord = texcoord;\n}\n@end\n@export clay.sm.depth.fragment\nvarying vec4 v_ViewPosition;\nvarying vec2 v_Texcoord;\nuniform float bias : 0.001;\nuniform float slopeScale : 1.0;\nuniform sampler2D alphaMap;\nuniform float alphaCutoff: 0.0;\n@import clay.util.encode_float\nvoid main(){\n float depth = v_ViewPosition.z / v_ViewPosition.w;\n if (alphaCutoff > 0.0) {\n if (texture2D(alphaMap, v_Texcoord).a <= alphaCutoff) {\n discard;\n }\n }\n#ifdef USE_VSM\n depth = depth * 0.5 + 0.5;\n float moment1 = depth;\n float moment2 = depth * depth;\n float dx = dFdx(depth);\n float dy = dFdy(depth);\n moment2 += 0.25*(dx*dx+dy*dy);\n gl_FragColor = vec4(moment1, moment2, 0.0, 1.0);\n#else\n float dx = dFdx(depth);\n float dy = dFdy(depth);\n depth += sqrt(dx*dx + dy*dy) * slopeScale + bias;\n gl_FragColor = encodeFloat(depth * 0.5 + 0.5);\n#endif\n}\n@end\n@export clay.sm.debug_depth\nuniform sampler2D depthMap;\nvarying vec2 v_Texcoord;\n@import clay.util.decode_float\nvoid main() {\n vec4 tex = texture2D(depthMap, v_Texcoord);\n#ifdef USE_VSM\n gl_FragColor = vec4(tex.rgb, 1.0);\n#else\n float depth = decodeFloat(tex);\n gl_FragColor = vec4(depth, depth, depth, 1.0);\n#endif\n}\n@end\n@export clay.sm.distance.vertex\nuniform mat4 worldViewProjection : WORLDVIEWPROJECTION;\nuniform mat4 world : WORLD;\nattribute vec3 position : POSITION;\n@import clay.chunk.skinning_header\nvarying vec3 v_WorldPosition;\nvoid main (){\n vec3 skinnedPosition = position;\n#ifdef SKINNING\n @import clay.chunk.skin_matrix\n skinnedPosition = (skinMatrixWS * vec4(position, 1.0)).xyz;\n#endif\n gl_Position = worldViewProjection * vec4(skinnedPosition , 1.0);\n v_WorldPosition = (world * vec4(skinnedPosition, 1.0)).xyz;\n}\n@end\n@export clay.sm.distance.fragment\nuniform vec3 lightPosition;\nuniform float range : 100;\nvarying vec3 v_WorldPosition;\n@import clay.util.encode_float\nvoid main(){\n float dist = distance(lightPosition, v_WorldPosition);\n#ifdef USE_VSM\n gl_FragColor = vec4(dist, dist * dist, 0.0, 0.0);\n#else\n dist = dist / range;\n gl_FragColor = encodeFloat(dist);\n#endif\n}\n@end\n@export clay.plugin.shadow_map_common\n@import clay.util.decode_float\nfloat tapShadowMap(sampler2D map, vec2 uv, float z){\n vec4 tex = texture2D(map, uv);\n return step(z, decodeFloat(tex) * 2.0 - 1.0);\n}\nfloat pcf(sampler2D map, vec2 uv, float z, float textureSize, vec2 scale) {\n float shadowContrib = tapShadowMap(map, uv, z);\n vec2 offset = vec2(1.0 / textureSize) * scale;\n#ifdef PCF_KERNEL_SIZE\n for (int _idx_ = 0; _idx_ < PCF_KERNEL_SIZE; _idx_++) {{\n shadowContrib += tapShadowMap(map, uv + offset * pcfKernel[_idx_], z);\n }}\n return shadowContrib / float(PCF_KERNEL_SIZE + 1);\n#else\n shadowContrib += tapShadowMap(map, uv+vec2(offset.x, 0.0), z);\n shadowContrib += tapShadowMap(map, uv+vec2(offset.x, offset.y), z);\n shadowContrib += tapShadowMap(map, uv+vec2(-offset.x, offset.y), z);\n shadowContrib += tapShadowMap(map, uv+vec2(0.0, offset.y), z);\n shadowContrib += tapShadowMap(map, uv+vec2(-offset.x, 0.0), z);\n shadowContrib += tapShadowMap(map, uv+vec2(-offset.x, -offset.y), z);\n shadowContrib += tapShadowMap(map, uv+vec2(offset.x, -offset.y), z);\n shadowContrib += tapShadowMap(map, uv+vec2(0.0, -offset.y), z);\n return shadowContrib / 9.0;\n#endif\n}\nfloat pcf(sampler2D map, vec2 uv, float z, float textureSize) {\n return pcf(map, uv, z, textureSize, vec2(1.0));\n}\nfloat chebyshevUpperBound(vec2 moments, float z){\n float p = 0.0;\n z = z * 0.5 + 0.5;\n if (z <= moments.x) {\n p = 1.0;\n }\n float variance = moments.y - moments.x * moments.x;\n variance = max(variance, 0.0000001);\n float mD = moments.x - z;\n float pMax = variance / (variance + mD * mD);\n pMax = clamp((pMax-0.4)/(1.0-0.4), 0.0, 1.0);\n return max(p, pMax);\n}\nfloat computeShadowContrib(\n sampler2D map, mat4 lightVPM, vec3 position, float textureSize, vec2 scale, vec2 offset\n) {\n vec4 posInLightSpace = lightVPM * vec4(position, 1.0);\n posInLightSpace.xyz /= posInLightSpace.w;\n float z = posInLightSpace.z;\n if(all(greaterThan(posInLightSpace.xyz, vec3(-0.99, -0.99, -1.0))) &&\n all(lessThan(posInLightSpace.xyz, vec3(0.99, 0.99, 1.0)))){\n vec2 uv = (posInLightSpace.xy+1.0) / 2.0;\n #ifdef USE_VSM\n vec2 moments = texture2D(map, uv * scale + offset).xy;\n return chebyshevUpperBound(moments, z);\n #else\n return pcf(map, uv * scale + offset, z, textureSize, scale);\n #endif\n }\n return 1.0;\n}\nfloat computeShadowContrib(sampler2D map, mat4 lightVPM, vec3 position, float textureSize) {\n return computeShadowContrib(map, lightVPM, position, textureSize, vec2(1.0), vec2(0.0));\n}\nfloat computeShadowContribOmni(samplerCube map, vec3 direction, float range)\n{\n float dist = length(direction);\n vec4 shadowTex = textureCube(map, direction);\n#ifdef USE_VSM\n vec2 moments = shadowTex.xy;\n float variance = moments.y - moments.x * moments.x;\n float mD = moments.x - dist;\n float p = variance / (variance + mD * mD);\n if(moments.x + 0.001 < dist){\n return clamp(p, 0.0, 1.0);\n }else{\n return 1.0;\n }\n#else\n return step(dist, (decodeFloat(shadowTex) + 0.0002) * range);\n#endif\n}\n@end\n@export clay.plugin.compute_shadow_map\n#if defined(SPOT_LIGHT_SHADOWMAP_COUNT) || defined(DIRECTIONAL_LIGHT_SHADOWMAP_COUNT) || defined(POINT_LIGHT_SHADOWMAP_COUNT)\n#ifdef SPOT_LIGHT_SHADOWMAP_COUNT\nuniform sampler2D spotLightShadowMaps[SPOT_LIGHT_SHADOWMAP_COUNT]:unconfigurable;\nuniform mat4 spotLightMatrices[SPOT_LIGHT_SHADOWMAP_COUNT]:unconfigurable;\nuniform float spotLightShadowMapSizes[SPOT_LIGHT_SHADOWMAP_COUNT]:unconfigurable;\n#endif\n#ifdef DIRECTIONAL_LIGHT_SHADOWMAP_COUNT\n#if defined(SHADOW_CASCADE)\nuniform sampler2D directionalLightShadowMaps[1]:unconfigurable;\nuniform mat4 directionalLightMatrices[SHADOW_CASCADE]:unconfigurable;\nuniform float directionalLightShadowMapSizes[1]:unconfigurable;\nuniform float shadowCascadeClipsNear[SHADOW_CASCADE]:unconfigurable;\nuniform float shadowCascadeClipsFar[SHADOW_CASCADE]:unconfigurable;\n#else\nuniform sampler2D directionalLightShadowMaps[DIRECTIONAL_LIGHT_SHADOWMAP_COUNT]:unconfigurable;\nuniform mat4 directionalLightMatrices[DIRECTIONAL_LIGHT_SHADOWMAP_COUNT]:unconfigurable;\nuniform float directionalLightShadowMapSizes[DIRECTIONAL_LIGHT_SHADOWMAP_COUNT]:unconfigurable;\n#endif\n#endif\n#ifdef POINT_LIGHT_SHADOWMAP_COUNT\nuniform samplerCube pointLightShadowMaps[POINT_LIGHT_SHADOWMAP_COUNT]:unconfigurable;\n#endif\nuniform bool shadowEnabled : true;\n#ifdef PCF_KERNEL_SIZE\nuniform vec2 pcfKernel[PCF_KERNEL_SIZE];\n#endif\n@import clay.plugin.shadow_map_common\n#if defined(SPOT_LIGHT_SHADOWMAP_COUNT)\nvoid computeShadowOfSpotLights(vec3 position, inout float shadowContribs[SPOT_LIGHT_COUNT] ) {\n float shadowContrib;\n for(int _idx_ = 0; _idx_ < SPOT_LIGHT_SHADOWMAP_COUNT; _idx_++) {{\n shadowContrib = computeShadowContrib(\n spotLightShadowMaps[_idx_], spotLightMatrices[_idx_], position,\n spotLightShadowMapSizes[_idx_]\n );\n shadowContribs[_idx_] = shadowContrib;\n }}\n for(int _idx_ = SPOT_LIGHT_SHADOWMAP_COUNT; _idx_ < SPOT_LIGHT_COUNT; _idx_++){{\n shadowContribs[_idx_] = 1.0;\n }}\n}\n#endif\n#if defined(DIRECTIONAL_LIGHT_SHADOWMAP_COUNT)\n#ifdef SHADOW_CASCADE\nvoid computeShadowOfDirectionalLights(vec3 position, inout float shadowContribs[DIRECTIONAL_LIGHT_COUNT]){\n float depth = (2.0 * gl_FragCoord.z - gl_DepthRange.near - gl_DepthRange.far)\n / (gl_DepthRange.far - gl_DepthRange.near);\n float shadowContrib;\n shadowContribs[0] = 1.0;\n for (int _idx_ = 0; _idx_ < SHADOW_CASCADE; _idx_++) {{\n if (\n depth >= shadowCascadeClipsNear[_idx_] &&\n depth <= shadowCascadeClipsFar[_idx_]\n ) {\n shadowContrib = computeShadowContrib(\n directionalLightShadowMaps[0], directionalLightMatrices[_idx_], position,\n directionalLightShadowMapSizes[0],\n vec2(1.0 / float(SHADOW_CASCADE), 1.0),\n vec2(float(_idx_) / float(SHADOW_CASCADE), 0.0)\n );\n shadowContribs[0] = shadowContrib;\n }\n }}\n for(int _idx_ = DIRECTIONAL_LIGHT_SHADOWMAP_COUNT; _idx_ < DIRECTIONAL_LIGHT_COUNT; _idx_++) {{\n shadowContribs[_idx_] = 1.0;\n }}\n}\n#else\nvoid computeShadowOfDirectionalLights(vec3 position, inout float shadowContribs[DIRECTIONAL_LIGHT_COUNT]){\n float shadowContrib;\n for(int _idx_ = 0; _idx_ < DIRECTIONAL_LIGHT_SHADOWMAP_COUNT; _idx_++) {{\n shadowContrib = computeShadowContrib(\n directionalLightShadowMaps[_idx_], directionalLightMatrices[_idx_], position,\n directionalLightShadowMapSizes[_idx_]\n );\n shadowContribs[_idx_] = shadowContrib;\n }}\n for(int _idx_ = DIRECTIONAL_LIGHT_SHADOWMAP_COUNT; _idx_ < DIRECTIONAL_LIGHT_COUNT; _idx_++) {{\n shadowContribs[_idx_] = 1.0;\n }}\n}\n#endif\n#endif\n#if defined(POINT_LIGHT_SHADOWMAP_COUNT)\nvoid computeShadowOfPointLights(vec3 position, inout float shadowContribs[POINT_LIGHT_COUNT] ){\n vec3 lightPosition;\n vec3 direction;\n for(int _idx_ = 0; _idx_ < POINT_LIGHT_SHADOWMAP_COUNT; _idx_++) {{\n lightPosition = pointLightPosition[_idx_];\n direction = position - lightPosition;\n shadowContribs[_idx_] = computeShadowContribOmni(pointLightShadowMaps[_idx_], direction, pointLightRange[_idx_]);\n }}\n for(int _idx_ = POINT_LIGHT_SHADOWMAP_COUNT; _idx_ < POINT_LIGHT_COUNT; _idx_++) {{\n shadowContribs[_idx_] = 1.0;\n }}\n}\n#endif\n#endif\n@end"},function(e,t,n){"use strict";var r=n(8),i=n(5),o=n(4),a=n(10),s=n(177),l=n(189),u=n(191),c=n(193),d=n(1),f=n(194),h=n(196),p=(n(9),n(197)),m=n(87),v=n(88),g=n(89),y=n(90),_=n(91),x=n(92),b=n(93),w=n(94),A=n(95),T=n(198),S=n(199);r["a"]["import"](m["a"]),r["a"]["import"](v["a"]),r["a"]["import"](g["a"]),r["a"]["import"](y["a"]),r["a"]["import"](_["a"]),r["a"]["import"](x["a"]),r["a"]["import"](b["a"]),r["a"]["import"](w["a"]),r["a"]["import"](A["a"]),r["a"]["import"](T["a"]),r["a"]["import"](S["a"]);var E={color:{parameters:{width:function(e){return e.getWidth()},height:function(e){return e.getHeight()}}}},C=["composite","FXAA"];function M(){this._sourceTexture=new i["a"]({type:o["a"].HALF_FLOAT}),this._depthTexture=new i["a"]({format:o["a"].DEPTH_COMPONENT,type:o["a"].UNSIGNED_INT}),this._framebuffer=new a["a"],this._framebuffer.attach(this._sourceTexture),this._framebuffer.attach(this._depthTexture,a["a"].DEPTH_ATTACHMENT),this._normalPass=new f["a"],this._compositor=Object(s["a"])(p["a"]);var e=this._compositor.getNodeByName("source");e.texture=this._sourceTexture;var t=this._compositor.getNodeByName("coc");this._sourceNode=e,this._cocNode=t,this._compositeNode=this._compositor.getNodeByName("composite"),this._fxaaNode=this._compositor.getNodeByName("FXAA"),this._dofBlurNodes=["dof_far_blur","dof_near_blur","dof_coc_blur"].map((function(e){return this._compositor.getNodeByName(e)}),this),this._dofBlurKernel=0,this._dofBlurKernelSize=new Float32Array(0),this._finalNodesChain=C.map((function(e){return this._compositor.getNodeByName(e)}),this);var n={normalTexture:this._normalPass.getNormalTexture(),depthTexture:this._normalPass.getDepthTexture()};this._ssaoPass=new l["a"](n),this._ssrPass=new u["a"](n),this._edgePass=new h["a"](n)}M.prototype.resize=function(e,t,n){n=n||1;e*=n,t*=n;var r=this._sourceTexture,i=this._depthTexture;r.width=e,r.height=t,i.width=e,i.height=t},M.prototype._ifRenderNormalPass=function(){return this._enableSSAO||this._enableEdge||this._enableSSR},M.prototype._getPrevNode=function(e){var t=C.indexOf(e.name)-1,n=this._finalNodesChain[t];while(n&&!this._compositor.getNodeByName(n.name))t-=1,n=this._finalNodesChain[t];return n},M.prototype._getNextNode=function(e){var t=C.indexOf(e.name)+1,n=this._finalNodesChain[t];while(n&&!this._compositor.getNodeByName(n.name))t+=1,n=this._finalNodesChain[t];return n},M.prototype._addChainNode=function(e){var t=this._getPrevNode(e),n=this._getNextNode(e);t&&(t.outputs=E,e.inputs.texture=t.name,n?(e.outputs=E,n.inputs.texture=e.name):e.outputs=null,this._compositor.addNode(e))},M.prototype._removeChainNode=function(e){var t=this._getPrevNode(e),n=this._getNextNode(e);t&&(n?(t.outputs=E,n.inputs.texture=t.name):t.outputs=null,this._compositor.removeNode(e))},M.prototype.updateNormal=function(e,t,n,r){this._ifRenderNormalPass()&&this._normalPass.update(e,t,n)},M.prototype.updateSSAO=function(e,t,n,r){this._ssaoPass.update(e,n,r)},M.prototype.enableSSAO=function(){this._enableSSAO=!0},M.prototype.disableSSAO=function(){this._enableSSAO=!1},M.prototype.enableSSR=function(){this._enableSSR=!0},M.prototype.disableSSR=function(){this._enableSSR=!1},M.prototype.getSSAOTexture=function(){return this._ssaoPass.getTargetTexture()},M.prototype.getSourceFrameBuffer=function(){return this._framebuffer},M.prototype.getSourceTexture=function(){return this._sourceTexture},M.prototype.disableFXAA=function(){this._removeChainNode(this._fxaaNode)},M.prototype.enableFXAA=function(){this._addChainNode(this._fxaaNode)},M.prototype.enableBloom=function(){this._compositeNode.inputs.bloom="bloom_composite",this._compositor.dirty()},M.prototype.disableBloom=function(){this._compositeNode.inputs.bloom=null,this._compositor.dirty()},M.prototype.enableDOF=function(){this._compositeNode.inputs.texture="dof_composite",this._compositor.dirty()},M.prototype.disableDOF=function(){this._compositeNode.inputs.texture="source",this._compositor.dirty()},M.prototype.enableColorCorrection=function(){this._compositeNode.define("COLOR_CORRECTION"),this._enableColorCorrection=!0},M.prototype.disableColorCorrection=function(){this._compositeNode.undefine("COLOR_CORRECTION"),this._enableColorCorrection=!1},M.prototype.enableEdge=function(){this._enableEdge=!0},M.prototype.disableEdge=function(){this._enableEdge=!1},M.prototype.setBloomIntensity=function(e){this._compositeNode.setParameter("bloomIntensity",e)},M.prototype.setSSAOParameter=function(e,t){switch(e){case"quality":var n={low:6,medium:12,high:32,ultra:62}[t]||12;this._ssaoPass.setParameter("kernelSize",n);break;case"radius":this._ssaoPass.setParameter(e,t),this._ssaoPass.setParameter("bias",t/200);break;case"intensity":this._ssaoPass.setParameter(e,t);break;default:console.warn("Unkown SSAO parameter "+e)}},M.prototype.setDOFParameter=function(e,t){switch(e){case"focalDistance":case"focalRange":case"fstop":this._cocNode.setParameter(e,t);break;case"blurRadius":for(var n=0;n<this._dofBlurNodes.length;n++)this._dofBlurNodes[n].setParameter("blurRadius",t);break;case"quality":var r={low:4,medium:8,high:16,ultra:32}[t]||8;this._dofBlurKernelSize=r;for(n=0;n<this._dofBlurNodes.length;n++)this._dofBlurNodes[n].pass.material.define("POISSON_KERNEL_SIZE",r);this._dofBlurKernel=new Float32Array(2*r);break;default:console.warn("Unkown DOF parameter "+e)}},M.prototype.setSSRParameter=function(e,t){if(null!=t)switch(e){case"quality":var n={low:10,medium:15,high:30,ultra:80}[t]||20,r={low:32,medium:16,high:8,ultra:4}[t]||16;this._ssrPass.setParameter("maxIteration",n),this._ssrPass.setParameter("pixelStride",r);break;case"maxRoughness":this._ssrPass.setParameter("minGlossiness",Math.max(Math.min(1-t,1),0));break;case"physical":this.setPhysicallyCorrectSSR(t);break;default:console.warn("Unkown SSR parameter "+e)}},M.prototype.setPhysicallyCorrectSSR=function(e){this._ssrPass.setPhysicallyCorrect(e)},M.prototype.setEdgeColor=function(e){var t=d["a"].parseColor(e);this._edgePass.setParameter("edgeColor",t)},M.prototype.setExposure=function(e){this._compositeNode.setParameter("exposure",Math.pow(2,e))},M.prototype.setColorLookupTexture=function(e,t){this._compositeNode.pass.material.setTextureImage("lut",this._enableColorCorrection?e:"none",t,{minFilter:d["a"].Texture.NEAREST,magFilter:d["a"].Texture.NEAREST,flipY:!1})},M.prototype.setColorCorrection=function(e,t){this._compositeNode.setParameter(e,t)},M.prototype.isSSREnabled=function(){return this._enableSSR},M.prototype.composite=function(e,t,n,r,i){var o=this._sourceTexture,a=o;this._enableEdge&&(this._edgePass.update(e,n,o,i),o=a=this._edgePass.getTargetTexture()),this._enableSSR&&(this._ssrPass.update(e,n,o,i),a=this._ssrPass.getTargetTexture(),this._ssrPass.setSSAOTexture(this._enableSSAO?this._ssaoPass.getTargetTexture():null)),this._sourceNode.texture=a,this._cocNode.setParameter("depth",this._depthTexture);for(var s=this._dofBlurKernel,l=this._dofBlurKernelSize,u=Math.floor(c["a"].length/2/l),d=i%u,f=0;f<2*l;f++)s[f]=c["a"][f+d*l*2];for(f=0;f<this._dofBlurNodes.length;f++)this._dofBlurNodes[f].setParameter("percent",i/30),this._dofBlurNodes[f].setParameter("poissonKernel",s);this._cocNode.setParameter("zNear",n.near),this._cocNode.setParameter("zFar",n.far),this._compositor.render(e,r)},M.prototype.dispose=function(e){this._sourceTexture.dispose(e),this._depthTexture.dispose(e),this._framebuffer.dispose(e),this._compositor.dispose(e),this._normalPass.dispose(e),this._ssaoPass.dispose(e)},t["a"]=M},function(e,t,n){"use strict";var r=n(178);t["a"]=r["a"]},function(e,t,n){"use strict";var r=n(23),i=n(179),o=n(181),a=n(182),s=n(183),l=n(8),u=n(4),c=n(5),d=n(27),f=n(184);Object(f["a"])(l["a"]);var h=/^#source\((.*?)\)/;function p(e,t){var n=new i["a"];t=t||{};var r={textures:{},parameters:{}},o=function(i,o){for(var a=0;a<e.nodes.length;a++){var s=e.nodes[a],l=m(s,r,t);l&&n.addNode(l)}};for(var a in e.parameters){var s=e.parameters[a];r.parameters[a]=y(s)}return _(e,r,t,(function(e){r.textures=e,o()})),n}function m(e,t,n){var r,i,u,c,d=e.type||"filter";if("filter"===d){var f=e.shader.trim(),p=h.exec(f);if(p?r=l["a"].source(p[1].trim()):"#"===f.charAt(0)&&(r=t.shaders[f.substr(1)]),r||(r=f),!r)return}if(e.inputs)for(var m in i={},e.inputs)"string"===typeof e.inputs[m]?i[m]=e.inputs[m]:i[m]={node:e.inputs[m].node,pin:e.inputs[m].pin};if(e.outputs)for(var m in u={},e.outputs){var v=e.outputs[m];u[m]={},null!=v.attachment&&(u[m].attachment=v.attachment),null!=v.keepLastFrame&&(u[m].keepLastFrame=v.keepLastFrame),null!=v.outputLastFrame&&(u[m].outputLastFrame=v.outputLastFrame),v.parameters&&(u[m].parameters=y(v.parameters))}if(c="scene"===d?new o["a"]({name:e.name,scene:n.scene,camera:n.camera,outputs:u}):"texture"===d?new a["a"]({name:e.name,outputs:u}):new s["a"]({name:e.name,shader:r,inputs:i,outputs:u}),c){if(e.parameters)for(var m in e.parameters){var g=e.parameters[m];"string"===typeof g&&(g=g.trim(),"#"===g.charAt(0)?g=t.textures[g.substr(1)]:c.on("beforerender",x(m,w(g)))),c.setParameter(m,g)}if(e.defines&&c.pass)for(var m in e.defines){g=e.defines[m];c.pass.material.define("fragment",m,g)}}return c}function v(e,t){return e}function g(e,t){return t}function y(e){var t={};if(!e)return t;["type","minFilter","magFilter","wrapS","wrapT","flipY","useMipmap"].forEach((function(n){var r=e[n];null!=r&&("string"===typeof r&&(r=u["a"][r]),t[n]=r)}));var n=e.scale||1;return["width","height"].forEach((function(r){if(null!=e[r]){var i=e[r];"string"===typeof i?(i=i.trim(),t[r]=b(r,w(i),n)):t[r]=i}})),t.width||(t.width=v),t.height||(t.height=g),null!=e.useMipmap&&(t.useMipmap=e.useMipmap),t}function _(e,t,n,i){if(e.textures){var o={},a=0,s=!1,l=n.textureRootPath;r["a"].each(e.textures,(function(e,t){var n,u=e.path,f=y(e.parameters);if(Array.isArray(u)&&6===u.length)l&&(u=u.map((function(e){return r["a"].relative2absolute(e,l)}))),n=new d["a"](f);else{if("string"!==typeof u)return;l&&(u=r["a"].relative2absolute(u,l)),n=new c["a"](f)}n.load(u),a++,n.once("success",(function(){o[t]=n,a--,0===a&&(i(o),s=!0)}))})),0!==a||s||i(o)}else i({})}function x(e,t){return function(n){var r=n.getDevicePixelRatio(),i=n.getWidth(),o=n.getHeight(),a=t(i,o,r);this.setParameter(e,a)}}function b(e,t,n){return n=n||1,function(e){var r=e.getDevicePixelRatio(),i=e.getWidth()*n,o=e.getHeight()*n;return t(i,o,r)}}function w(e){var t=/^expr\((.*)\)$/.exec(e);if(t)try{var n=new Function("width","height","dpr","return "+t[1]);return n(1,1),n}catch(r){throw new Error("Invalid expression.")}}t["a"]=p},function(e,t,n){"use strict";var r=n(180),i=n(86),o=n(10),a=r["a"].extend((function(){return{_outputs:[],_texturePool:new i["a"],_frameBuffer:new o["a"]({depthBuffer:!1})}}),{addNode:function(e){r["a"].prototype.addNode.call(this,e),e._compositor=this},render:function(e,t){if(this._dirty){this.update(),this._dirty=!1,this._outputs.length=0;for(var n=0;n<this.nodes.length;n++)this.nodes[n].outputs||this._outputs.push(this.nodes[n])}for(n=0;n<this.nodes.length;n++)this.nodes[n].beforeFrame();for(n=0;n<this._outputs.length;n++)this._outputs[n].updateReference();for(n=0;n<this._outputs.length;n++)this._outputs[n].render(e,t);for(n=0;n<this.nodes.length;n++)this.nodes[n].afterFrame()},allocateTexture:function(e){return this._texturePool.get(e)},releaseTexture:function(e){this._texturePool.put(e)},getFrameBuffer:function(){return this._frameBuffer},dispose:function(e){this._texturePool.clear(e)}});t["a"]=a},function(e,t,n){"use strict";var r=n(7),i=n(48),o=r["a"].extend((function(){return{nodes:[]}}),{dirty:function(){this._dirty=!0},addNode:function(e){this.nodes.indexOf(e)>=0||(this.nodes.push(e),this._dirty=!0)},removeNode:function(e){"string"===typeof e&&(e=this.getNodeByName(e));var t=this.nodes.indexOf(e);t>=0&&(this.nodes.splice(t,1),this._dirty=!0)},getNodeByName:function(e){for(var t=0;t<this.nodes.length;t++)if(this.nodes[t].name===e)return this.nodes[t]},update:function(){for(var e=0;e<this.nodes.length;e++)this.nodes[e].clear();for(e=0;e<this.nodes.length;e++){var t=this.nodes[e];if(t.inputs)for(var n in t.inputs)if(t.inputs[n])if(!t.pass||t.pass.material.isUniformEnabled(n)){var r=t.inputs[n],i=this.findPin(r);i?t.link(n,i.node,i.pin):"string"===typeof r?console.warn("Node "+r+" not exist"):console.warn("Pin of "+r.node+"."+r.pin+" not exist")}else console.warn("Pin "+t.name+"."+n+" not used.")}},findPin:function(e){var t;if(("string"===typeof e||e instanceof i["a"])&&(e={node:e}),"string"===typeof e.node)for(var n=0;n<this.nodes.length;n++){var r=this.nodes[n];r.name===e.node&&(t=r)}else t=e.node;if(t){var o=e.pin;if(o||t.outputs&&(o=Object.keys(t.outputs)[0]),t.outputs[o])return{node:t,pin:o}}}});t["a"]=o},function(e,t,n){"use strict";var r=n(48),i=n(11),o=n(10),a=r["a"].extend({name:"scene",scene:null,camera:null,autoUpdateScene:!0,preZ:!1},(function(){this.frameBuffer=new o["a"]}),{render:function(e){this._rendering=!0;var t,n=e.gl;if(this.trigger("beforerender"),this.outputs){var r=this.frameBuffer;for(var o in this.outputs){var a=this.updateParameter(o,e),s=this.outputs[o],l=this._compositor.allocateTexture(a);this._outputTextures[o]=l;var u=s.attachment||n.COLOR_ATTACHMENT0;"string"==typeof u&&(u=n[u]),r.attach(l,u)}r.bind(e);var c=e.getGLExtension("EXT_draw_buffers");if(c){var d=[];for(var u in this.outputs)u=parseInt(u),u>=n.COLOR_ATTACHMENT0&&u<=n.COLOR_ATTACHMENT0+8&&d.push(u);c.drawBuffersEXT(d)}e.saveClear(),e.clearBit=i["a"].DEPTH_BUFFER_BIT|i["a"].COLOR_BUFFER_BIT,t=e.render(this.scene,this.camera,!this.autoUpdateScene,this.preZ),e.restoreClear(),r.unbind(e)}else t=e.render(this.scene,this.camera,!this.autoUpdateScene,this.preZ);this.trigger("afterrender",t),this._rendering=!1,this._rendered=!0}});t["a"]=a},function(e,t,n){"use strict";var r=n(48),i=r["a"].extend((function(){return{texture:null,outputs:{color:{}}}}),(function(){}),{getOutput:function(e,t){return this.texture},beforeFrame:function(){},afterFrame:function(){}});t["a"]=i},function(e,t,n){"use strict";var r=n(16),i=n(48),o=i["a"].extend((function(){return{name:"",inputs:{},outputs:null,shader:"",inputLinks:{},outputLinks:{},pass:null,_prevOutputTextures:{},_outputTextures:{},_outputReferences:{},_rendering:!1,_rendered:!1,_compositor:null}}),(function(){var e=new r["a"]({fragment:this.shader});this.pass=e}),{render:function(e,t){this.trigger("beforerender",e),this._rendering=!0;var n=e.gl;for(var r in this.inputLinks){var i=this.inputLinks[r],o=i.node.getOutput(e,i.pin);this.pass.setUniform(r,o)}if(this.outputs){this.pass.outputs={};var a={};for(var s in this.outputs){var l=this.updateParameter(s,e);isNaN(l.width)&&this.updateParameter(s,e);var u=this.outputs[s],c=this._compositor.allocateTexture(l);this._outputTextures[s]=c;var d=u.attachment||n.COLOR_ATTACHMENT0;"string"===typeof d&&(d=n[d]),a[d]=c}for(var d in this._compositor.getFrameBuffer().bind(e),a)this._compositor.getFrameBuffer().attach(a[d],d);this.pass.render(e),this._compositor.getFrameBuffer().updateMipmap(e)}else this.pass.outputs=null,this._compositor.getFrameBuffer().unbind(e),this.pass.render(e,t);for(var r in this.inputLinks){i=this.inputLinks[r];i.node.removeReference(i.pin)}this._rendering=!1,this._rendered=!0,this.trigger("afterrender",e)},updateParameter:function(e,t){var n,r,i=this.outputs[e],o=i.parameters,a=i._parametersCopy;if(a||(a=i._parametersCopy={}),o)for(var s in o)"width"!==s&&"height"!==s&&(a[s]=o[s]);return n=o.width instanceof Function?o.width.call(this,t):o.width,r=o.height instanceof Function?o.height.call(this,t):o.height,n=Math.ceil(n),r=Math.ceil(r),a.width===n&&a.height===r||this._outputTextures[e]&&this._outputTextures[e].dispose(t),a.width=n,a.height=r,a},setParameter:function(e,t){this.pass.setUniform(e,t)},getParameter:function(e){return this.pass.getUniform(e)},setParameters:function(e){for(var t in e)this.setParameter(t,e[t])},define:function(e,t){this.pass.material.define("fragment",e,t)},undefine:function(e){this.pass.material.undefine("fragment",e)},removeReference:function(e){if(this._outputReferences[e]--,0===this._outputReferences[e]){var t=this.outputs[e];t.keepLastFrame?(this._prevOutputTextures[e]&&this._compositor.releaseTexture(this._prevOutputTextures[e]),this._prevOutputTextures[e]=this._outputTextures[e]):this._compositor.releaseTexture(this._outputTextures[e])}},clear:function(){i["a"].prototype.clear.call(this),this.pass.material.disableTexturesAll()}});t["a"]=o},function(e,t,n){"use strict";t["a"]=v;var r=n(185),i=n(87),o=n(186),a=n(88),s=n(187),l=n(89),u=n(90),c=n(91),d=n(92),f=n(93),h=n(188),p=n(94),m=n(95);function v(e){e["import"](r["a"]),e["import"](i["a"]),e["import"](o["a"]),e["import"](a["a"]),e["import"](s["a"]),e["import"](l["a"]),e["import"](u["a"]),e["import"](c["a"]),e["import"](d["a"]),e["import"](f["a"]),e["import"](h["a"]),e["import"](p["a"]),e["import"](m["a"])}},function(e,t,n){"use strict";t["a"]="@export clay.compositor.coloradjust\nvarying vec2 v_Texcoord;\nuniform sampler2D texture;\nuniform float brightness : 0.0;\nuniform float contrast : 1.0;\nuniform float exposure : 0.0;\nuniform float gamma : 1.0;\nuniform float saturation : 1.0;\nconst vec3 w = vec3(0.2125, 0.7154, 0.0721);\nvoid main()\n{\n vec4 tex = texture2D( texture, v_Texcoord);\n vec3 color = clamp(tex.rgb + vec3(brightness), 0.0, 1.0);\n color = clamp( (color-vec3(0.5))*contrast+vec3(0.5), 0.0, 1.0);\n color = clamp( color * pow(2.0, exposure), 0.0, 1.0);\n color = clamp( pow(color, vec3(gamma)), 0.0, 1.0);\n float luminance = dot( color, w );\n color = mix(vec3(luminance), color, saturation);\n gl_FragColor = vec4(color, tex.a);\n}\n@end\n@export clay.compositor.brightness\nvarying vec2 v_Texcoord;\nuniform sampler2D texture;\nuniform float brightness : 0.0;\nvoid main()\n{\n vec4 tex = texture2D( texture, v_Texcoord);\n vec3 color = tex.rgb + vec3(brightness);\n gl_FragColor = vec4(color, tex.a);\n}\n@end\n@export clay.compositor.contrast\nvarying vec2 v_Texcoord;\nuniform sampler2D texture;\nuniform float contrast : 1.0;\nvoid main()\n{\n vec4 tex = texture2D( texture, v_Texcoord);\n vec3 color = (tex.rgb-vec3(0.5))*contrast+vec3(0.5);\n gl_FragColor = vec4(color, tex.a);\n}\n@end\n@export clay.compositor.exposure\nvarying vec2 v_Texcoord;\nuniform sampler2D texture;\nuniform float exposure : 0.0;\nvoid main()\n{\n vec4 tex = texture2D(texture, v_Texcoord);\n vec3 color = tex.rgb * pow(2.0, exposure);\n gl_FragColor = vec4(color, tex.a);\n}\n@end\n@export clay.compositor.gamma\nvarying vec2 v_Texcoord;\nuniform sampler2D texture;\nuniform float gamma : 1.0;\nvoid main()\n{\n vec4 tex = texture2D(texture, v_Texcoord);\n vec3 color = pow(tex.rgb, vec3(gamma));\n gl_FragColor = vec4(color, tex.a);\n}\n@end\n@export clay.compositor.saturation\nvarying vec2 v_Texcoord;\nuniform sampler2D texture;\nuniform float saturation : 1.0;\nconst vec3 w = vec3(0.2125, 0.7154, 0.0721);\nvoid main()\n{\n vec4 tex = texture2D(texture, v_Texcoord);\n vec3 color = tex.rgb;\n float luminance = dot(color, w);\n color = mix(vec3(luminance), color, saturation);\n gl_FragColor = vec4(color, tex.a);\n}\n@end"},function(e,t,n){"use strict";t["a"]="@export clay.compositor.hdr.log_lum\nvarying vec2 v_Texcoord;\nuniform sampler2D texture;\nconst vec3 w = vec3(0.2125, 0.7154, 0.0721);\n@import clay.util.rgbm\nvoid main()\n{\n vec4 tex = decodeHDR(texture2D(texture, v_Texcoord));\n float luminance = dot(tex.rgb, w);\n luminance = log(luminance + 0.001);\n gl_FragColor = encodeHDR(vec4(vec3(luminance), 1.0));\n}\n@end\n@export clay.compositor.hdr.lum_adaption\nvarying vec2 v_Texcoord;\nuniform sampler2D adaptedLum;\nuniform sampler2D currentLum;\nuniform float frameTime : 0.02;\n@import clay.util.rgbm\nvoid main()\n{\n float fAdaptedLum = decodeHDR(texture2D(adaptedLum, vec2(0.5, 0.5))).r;\n float fCurrentLum = exp(encodeHDR(texture2D(currentLum, vec2(0.5, 0.5))).r);\n fAdaptedLum += (fCurrentLum - fAdaptedLum) * (1.0 - pow(0.98, 30.0 * frameTime));\n gl_FragColor = encodeHDR(vec4(vec3(fAdaptedLum), 1.0));\n}\n@end\n@export clay.compositor.lum\nvarying vec2 v_Texcoord;\nuniform sampler2D texture;\nconst vec3 w = vec3(0.2125, 0.7154, 0.0721);\nvoid main()\n{\n vec4 tex = texture2D( texture, v_Texcoord );\n float luminance = dot(tex.rgb, w);\n gl_FragColor = vec4(vec3(luminance), 1.0);\n}\n@end"},function(e,t,n){"use strict";t["a"]="@export clay.compositor.vignette\n#define OUTPUT_ALPHA\nvarying vec2 v_Texcoord;\nuniform sampler2D texture;\nuniform float darkness: 1;\nuniform float offset: 1;\n@import clay.util.rgbm\nvoid main()\n{\n vec4 texel = decodeHDR(texture2D(texture, v_Texcoord));\n gl_FragColor.rgb = texel.rgb;\n vec2 uv = (v_Texcoord - vec2(0.5)) * vec2(offset);\n gl_FragColor = encodeHDR(vec4(mix(texel.rgb, vec3(1.0 - darkness), dot(uv, uv)), texel.a));\n}\n@end"},function(e,t,n){"use strict";t["a"]="@export clay.compositor.lensflare\n#define SAMPLE_NUMBER 8\nuniform sampler2D texture;\nuniform sampler2D lenscolor;\nuniform vec2 textureSize : [512, 512];\nuniform float dispersal : 0.3;\nuniform float haloWidth : 0.4;\nuniform float distortion : 1.0;\nvarying vec2 v_Texcoord;\n@import clay.util.rgbm\nvec4 textureDistorted(\n in vec2 texcoord,\n in vec2 direction,\n in vec3 distortion\n) {\n return vec4(\n decodeHDR(texture2D(texture, texcoord + direction * distortion.r)).r,\n decodeHDR(texture2D(texture, texcoord + direction * distortion.g)).g,\n decodeHDR(texture2D(texture, texcoord + direction * distortion.b)).b,\n 1.0\n );\n}\nvoid main()\n{\n vec2 texcoord = -v_Texcoord + vec2(1.0); vec2 textureOffset = 1.0 / textureSize;\n vec2 ghostVec = (vec2(0.5) - texcoord) * dispersal;\n vec2 haloVec = normalize(ghostVec) * haloWidth;\n vec3 distortion = vec3(-textureOffset.x * distortion, 0.0, textureOffset.x * distortion);\n vec4 result = vec4(0.0);\n for (int i = 0; i < SAMPLE_NUMBER; i++)\n {\n vec2 offset = fract(texcoord + ghostVec * float(i));\n float weight = length(vec2(0.5) - offset) / length(vec2(0.5));\n weight = pow(1.0 - weight, 10.0);\n result += textureDistorted(offset, normalize(ghostVec), distortion) * weight;\n }\n result *= texture2D(lenscolor, vec2(length(vec2(0.5) - texcoord)) / length(vec2(0.5)));\n float weight = length(vec2(0.5) - fract(texcoord + haloVec)) / length(vec2(0.5));\n weight = pow(1.0 - weight, 10.0);\n vec2 offset = fract(texcoord + haloVec);\n result += textureDistorted(offset, normalize(ghostVec), distortion) * weight;\n gl_FragColor = result;\n}\n@end"},function(e,t,n){"use strict";var r=n(9),i=n(3),o=n(5),a=n(4),s=n(16),l=n(8),u=n(10),c=n(49),d=n(190);function f(e){for(var t=new Uint8Array(e*e*4),n=0,r=new i["a"],o=0;o<e;o++)for(var a=0;a<e;a++)r.set(2*Math.random()-1,2*Math.random()-1,0).normalize(),t[n++]=255*(.5*r.x+.5),t[n++]=255*(.5*r.y+.5),t[n++]=0,t[n++]=255;return t}function h(e){return new o["a"]({pixels:f(e),wrapS:a["a"].REPEAT,wrapT:a["a"].REPEAT,width:e,height:e})}function p(e,t,n){var r=new Float32Array(3*e);t=t||0;for(var i=0;i<e;i++){var o=Object(c["a"])(i+t,2)*(n?1:2)*Math.PI,a=Object(c["a"])(i+t,3)*Math.PI,s=Math.random(),l=Math.cos(o)*Math.sin(a)*s,u=Math.cos(a)*s,d=Math.sin(o)*Math.sin(a)*s;r[3*i]=l,r[3*i+1]=u,r[3*i+2]=d}return r}function m(e){e=e||{},this._ssaoPass=new s["a"]({fragment:l["a"].source("ecgl.ssao.estimate")}),this._blurPass=new s["a"]({fragment:l["a"].source("ecgl.ssao.blur")}),this._framebuffer=new u["a"]({depthBuffer:!1}),this._ssaoTexture=new o["a"],this._blurTexture=new o["a"],this._blurTexture2=new o["a"],this._depthTex=e.depthTexture,this._normalTex=e.normalTexture,this.setNoiseSize(4),this.setKernelSize(e.kernelSize||12),null!=e.radius&&this.setParameter("radius",e.radius),null!=e.power&&this.setParameter("power",e.power),this._normalTex||(this._ssaoPass.material.disableTexture("normalTex"),this._blurPass.material.disableTexture("normalTex")),this._depthTex||this._blurPass.material.disableTexture("depthTex"),this._blurPass.material.setUniform("normalTex",this._normalTex),this._blurPass.material.setUniform("depthTex",this._depthTex)}l["a"].import(d["a"]),m.prototype.setDepthTexture=function(e){this._depthTex=e},m.prototype.setNormalTexture=function(e){this._normalTex=e,this._ssaoPass.material[e?"enableTexture":"disableTexture"]("normalTex"),this.setKernelSize(this._kernelSize)},m.prototype.update=function(e,t,n){var i=e.getWidth(),o=e.getHeight(),a=this._ssaoPass,s=this._blurPass;a.setUniform("kernel",this._kernels[n%this._kernels.length]),a.setUniform("depthTex",this._depthTex),null!=this._normalTex&&a.setUniform("normalTex",this._normalTex),a.setUniform("depthTexSize",[this._depthTex.width,this._depthTex.height]);var l=new r["a"];r["a"].transpose(l,t.worldTransform),a.setUniform("projection",t.projectionMatrix.array),a.setUniform("projectionInv",t.invProjectionMatrix.array),a.setUniform("viewInverseTranspose",l.array);var u=this._ssaoTexture,c=this._blurTexture,d=this._blurTexture2;u.width=i/2,u.height=o/2,c.width=i,c.height=o,d.width=i,d.height=o,this._framebuffer.attach(u),this._framebuffer.bind(e),e.gl.clearColor(1,1,1,1),e.gl.clear(e.gl.COLOR_BUFFER_BIT),a.render(e),s.setUniform("textureSize",[i/2,o/2]),s.setUniform("projection",t.projectionMatrix.array),this._framebuffer.attach(c),s.setUniform("direction",0),s.setUniform("ssaoTexture",u),s.render(e),this._framebuffer.attach(d),s.setUniform("textureSize",[i,o]),s.setUniform("direction",1),s.setUniform("ssaoTexture",c),s.render(e),this._framebuffer.unbind(e);var f=e.clearColor;e.gl.clearColor(f[0],f[1],f[2],f[3])},m.prototype.getTargetTexture=function(){return this._blurTexture2},m.prototype.setParameter=function(e,t){"noiseTexSize"===e?this.setNoiseSize(t):"kernelSize"===e?this.setKernelSize(t):"intensity"===e?this._ssaoPass.material.set("intensity",t):this._ssaoPass.setUniform(e,t)},m.prototype.setKernelSize=function(e){this._kernelSize=e,this._ssaoPass.material.define("fragment","KERNEL_SIZE",e),this._kernels=this._kernels||[];for(var t=0;t<30;t++)this._kernels[t]=p(e,t*e,!!this._normalTex)},m.prototype.setNoiseSize=function(e){var t=this._ssaoPass.getUniform("noiseTex");t?(t.data=f(e),t.width=t.height=e,t.dirty()):(t=h(e),this._ssaoPass.setUniform("noiseTex",h(e))),this._ssaoPass.setUniform("noiseTexSize",[e,e])},m.prototype.dispose=function(e){this._blurTexture.dispose(e),this._ssaoTexture.dispose(e),this._blurTexture2.dispose(e)},t["a"]=m},function(e,t,n){"use strict";t["a"]="@export ecgl.ssao.estimate\n\nuniform sampler2D depthTex;\n\nuniform sampler2D normalTex;\n\nuniform sampler2D noiseTex;\n\nuniform vec2 depthTexSize;\n\nuniform vec2 noiseTexSize;\n\nuniform mat4 projection;\n\nuniform mat4 projectionInv;\n\nuniform mat4 viewInverseTranspose;\n\nuniform vec3 kernel[KERNEL_SIZE];\n\nuniform float radius : 1;\n\nuniform float power : 1;\n\nuniform float bias: 1e-2;\n\nuniform float intensity: 1.0;\n\nvarying vec2 v_Texcoord;\n\nfloat ssaoEstimator(in vec3 originPos, in mat3 kernelBasis) {\n float occlusion = 0.0;\n\n for (int i = 0; i < KERNEL_SIZE; i++) {\n vec3 samplePos = kernel[i];\n#ifdef NORMALTEX_ENABLED\n samplePos = kernelBasis * samplePos;\n#endif\n samplePos = samplePos * radius + originPos;\n\n vec4 texCoord = projection * vec4(samplePos, 1.0);\n texCoord.xy /= texCoord.w;\n\n vec4 depthTexel = texture2D(depthTex, texCoord.xy * 0.5 + 0.5);\n\n float sampleDepth = depthTexel.r * 2.0 - 1.0;\n if (projection[3][3] == 0.0) {\n sampleDepth = projection[3][2] / (sampleDepth * projection[2][3] - projection[2][2]);\n }\n else {\n sampleDepth = (sampleDepth - projection[3][2]) / projection[2][2];\n }\n \n float rangeCheck = smoothstep(0.0, 1.0, radius / abs(originPos.z - sampleDepth));\n occlusion += rangeCheck * step(samplePos.z, sampleDepth - bias);\n }\n#ifdef NORMALTEX_ENABLED\n occlusion = 1.0 - occlusion / float(KERNEL_SIZE);\n#else\n occlusion = 1.0 - clamp((occlusion / float(KERNEL_SIZE) - 0.6) * 2.5, 0.0, 1.0);\n#endif\n return pow(occlusion, power);\n}\n\nvoid main()\n{\n\n vec4 depthTexel = texture2D(depthTex, v_Texcoord);\n\n#ifdef NORMALTEX_ENABLED\n vec4 tex = texture2D(normalTex, v_Texcoord);\n if (dot(tex.rgb, tex.rgb) == 0.0) {\n gl_FragColor = vec4(1.0);\n return;\n }\n vec3 N = tex.rgb * 2.0 - 1.0;\n N = (viewInverseTranspose * vec4(N, 0.0)).xyz;\n\n vec2 noiseTexCoord = depthTexSize / vec2(noiseTexSize) * v_Texcoord;\n vec3 rvec = texture2D(noiseTex, noiseTexCoord).rgb * 2.0 - 1.0;\n vec3 T = normalize(rvec - N * dot(rvec, N));\n vec3 BT = normalize(cross(N, T));\n mat3 kernelBasis = mat3(T, BT, N);\n#else\n if (depthTexel.r > 0.99999) {\n gl_FragColor = vec4(1.0);\n return;\n }\n mat3 kernelBasis;\n#endif\n\n float z = depthTexel.r * 2.0 - 1.0;\n\n vec4 projectedPos = vec4(v_Texcoord * 2.0 - 1.0, z, 1.0);\n vec4 p4 = projectionInv * projectedPos;\n\n vec3 position = p4.xyz / p4.w;\n\n float ao = ssaoEstimator(position, kernelBasis);\n ao = clamp(1.0 - (1.0 - ao) * intensity, 0.0, 1.0);\n gl_FragColor = vec4(vec3(ao), 1.0);\n}\n\n@end\n\n\n@export ecgl.ssao.blur\n#define SHADER_NAME SSAO_BLUR\n\nuniform sampler2D ssaoTexture;\n\n#ifdef NORMALTEX_ENABLED\nuniform sampler2D normalTex;\n#endif\n\nvarying vec2 v_Texcoord;\n\nuniform vec2 textureSize;\nuniform float blurSize : 1.0;\n\nuniform int direction: 0.0;\n\n#ifdef DEPTHTEX_ENABLED\nuniform sampler2D depthTex;\nuniform mat4 projection;\nuniform float depthRange : 0.5;\n\nfloat getLinearDepth(vec2 coord)\n{\n float depth = texture2D(depthTex, coord).r * 2.0 - 1.0;\n return projection[3][2] / (depth * projection[2][3] - projection[2][2]);\n}\n#endif\n\nvoid main()\n{\n float kernel[5];\n kernel[0] = 0.122581;\n kernel[1] = 0.233062;\n kernel[2] = 0.288713;\n kernel[3] = 0.233062;\n kernel[4] = 0.122581;\n\n vec2 off = vec2(0.0);\n if (direction == 0) {\n off[0] = blurSize / textureSize.x;\n }\n else {\n off[1] = blurSize / textureSize.y;\n }\n\n vec2 coord = v_Texcoord;\n\n float sum = 0.0;\n float weightAll = 0.0;\n\n#ifdef NORMALTEX_ENABLED\n vec3 centerNormal = texture2D(normalTex, v_Texcoord).rgb * 2.0 - 1.0;\n#endif\n#if defined(DEPTHTEX_ENABLED)\n float centerDepth = getLinearDepth(v_Texcoord);\n#endif\n\n for (int i = 0; i < 5; i++) {\n vec2 coord = clamp(v_Texcoord + vec2(float(i) - 2.0) * off, vec2(0.0), vec2(1.0));\n\n float w = kernel[i];\n#ifdef NORMALTEX_ENABLED\n vec3 normal = texture2D(normalTex, coord).rgb * 2.0 - 1.0;\n w *= clamp(dot(normal, centerNormal), 0.0, 1.0);\n#endif\n#ifdef DEPTHTEX_ENABLED\n float d = getLinearDepth(coord);\n w *= (1.0 - smoothstep(abs(centerDepth - d) / depthRange, 0.0, 1.0));\n#endif\n\n weightAll += w;\n sum += texture2D(ssaoTexture, coord).r * w;\n }\n\n gl_FragColor = vec4(vec3(sum / weightAll), 1.0);\n}\n\n@end\n"},function(e,t,n){"use strict";var r=n(9),i=(n(3),n(5)),o=n(4),a=n(16),s=n(8),l=n(10),u=(n(49),n(77)),c=n(192);function d(e){e=e||{},this._ssrPass=new a["a"]({fragment:s["a"].source("ecgl.ssr.main"),clearColor:[0,0,0,0]}),this._blurPass1=new a["a"]({fragment:s["a"].source("ecgl.ssr.blur"),clearColor:[0,0,0,0]}),this._blurPass2=new a["a"]({fragment:s["a"].source("ecgl.ssr.blur"),clearColor:[0,0,0,0]}),this._blendPass=new a["a"]({fragment:s["a"].source("clay.compositor.blend")}),this._blendPass.material.disableTexturesAll(),this._blendPass.material.enableTexture(["texture1","texture2"]),this._ssrPass.setUniform("gBufferTexture1",e.normalTexture),this._ssrPass.setUniform("gBufferTexture2",e.depthTexture),this._blurPass1.setUniform("gBufferTexture1",e.normalTexture),this._blurPass1.setUniform("gBufferTexture2",e.depthTexture),this._blurPass2.setUniform("gBufferTexture1",e.normalTexture),this._blurPass2.setUniform("gBufferTexture2",e.depthTexture),this._blurPass2.material.define("fragment","VERTICAL"),this._blurPass2.material.define("fragment","BLEND"),this._ssrTexture=new i["a"]({type:o["a"].HALF_FLOAT}),this._texture2=new i["a"]({type:o["a"].HALF_FLOAT}),this._texture3=new i["a"]({type:o["a"].HALF_FLOAT}),this._prevTexture=new i["a"]({type:o["a"].HALF_FLOAT}),this._currentTexture=new i["a"]({type:o["a"].HALF_FLOAT}),this._frameBuffer=new l["a"]({depthBuffer:!1}),this._normalDistribution=null,this._totalSamples=256,this._samplePerFrame=4,this._ssrPass.material.define("fragment","SAMPLE_PER_FRAME",this._samplePerFrame),this._ssrPass.material.define("fragment","TOTAL_SAMPLES",this._totalSamples),this._downScale=1}s["a"].import(c["a"]),d.prototype.setAmbientCubemap=function(e,t){this._ssrPass.material.set("specularCubemap",e),this._ssrPass.material.set("specularIntensity",t);var n=e&&t;this._ssrPass.material[n?"enableTexture":"disableTexture"]("specularCubemap")},d.prototype.update=function(e,t,n,i){var o=e.getWidth(),a=e.getHeight(),s=this._ssrTexture,l=this._texture2,u=this._texture3;s.width=this._prevTexture.width=this._currentTexture.width=o/this._downScale,s.height=this._prevTexture.height=this._currentTexture.height=a/this._downScale,l.width=u.width=o,l.height=u.height=a;var c=this._frameBuffer,d=this._ssrPass,f=this._blurPass1,h=this._blurPass2,p=this._blendPass,m=new r["a"],v=new r["a"];r["a"].transpose(m,t.worldTransform),r["a"].transpose(v,t.viewMatrix),d.setUniform("sourceTexture",n),d.setUniform("projection",t.projectionMatrix.array),d.setUniform("projectionInv",t.invProjectionMatrix.array),d.setUniform("toViewSpace",m.array),d.setUniform("toWorldSpace",v.array),d.setUniform("nearZ",t.near);var g=i/this._totalSamples*this._samplePerFrame;if(d.setUniform("jitterOffset",g),d.setUniform("sampleOffset",i*this._samplePerFrame),f.setUniform("textureSize",[s.width,s.height]),h.setUniform("textureSize",[o,a]),h.setUniform("sourceTexture",n),f.setUniform("projection",t.projectionMatrix.array),h.setUniform("projection",t.projectionMatrix.array),c.attach(s),c.bind(e),d.render(e),this._physicallyCorrect&&(c.attach(this._currentTexture),p.setUniform("texture1",this._prevTexture),p.setUniform("texture2",s),p.material.set({weight1:i>=1?.95:0,weight2:i>=1?.05:1}),p.render(e)),c.attach(l),f.setUniform("texture",this._physicallyCorrect?this._currentTexture:s),f.render(e),c.attach(u),h.setUniform("texture",l),h.render(e),c.unbind(e),this._physicallyCorrect){var y=this._prevTexture;this._prevTexture=this._currentTexture,this._currentTexture=y}},d.prototype.getTargetTexture=function(){return this._texture3},d.prototype.setParameter=function(e,t){"maxIteration"===e?this._ssrPass.material.define("fragment","MAX_ITERATION",t):this._ssrPass.setUniform(e,t)},d.prototype.setPhysicallyCorrect=function(e){e?(this._normalDistribution||(this._normalDistribution=u["a"].generateNormalDistribution(64,this._totalSamples)),this._ssrPass.material.define("fragment","PHYSICALLY_CORRECT"),this._ssrPass.material.set("normalDistribution",this._normalDistribution),this._ssrPass.material.set("normalDistributionSize",[64,this._totalSamples])):this._ssrPass.material.undefine("fragment","PHYSICALLY_CORRECT"),this._physicallyCorrect=e},d.prototype.setSSAOTexture=function(e){var t=this._blurPass2;e?(t.material.enableTexture("ssaoTex"),t.material.set("ssaoTex",e)):t.material.disableTexture("ssaoTex")},d.prototype.isFinished=function(e){return!this._physicallyCorrect||e>this._totalSamples/this._samplePerFrame},d.prototype.dispose=function(e){this._ssrTexture.dispose(e),this._texture2.dispose(e),this._texture3.dispose(e),this._prevTexture.dispose(e),this._currentTexture.dispose(e),this._frameBuffer.dispose(e)},t["a"]=d},function(e,t,n){"use strict";t["a"]="@export ecgl.ssr.main\n\n#define SHADER_NAME SSR\n#define MAX_ITERATION 20;\n#define SAMPLE_PER_FRAME 5;\n#define TOTAL_SAMPLES 128;\n\nuniform sampler2D sourceTexture;\nuniform sampler2D gBufferTexture1;\nuniform sampler2D gBufferTexture2;\nuniform sampler2D gBufferTexture3;\nuniform samplerCube specularCubemap;\nuniform float specularIntensity: 1;\n\nuniform mat4 projection;\nuniform mat4 projectionInv;\nuniform mat4 toViewSpace;\nuniform mat4 toWorldSpace;\n\nuniform float maxRayDistance: 200;\n\nuniform float pixelStride: 16;\nuniform float pixelStrideZCutoff: 50; \nuniform float screenEdgeFadeStart: 0.9; \nuniform float eyeFadeStart : 0.2; uniform float eyeFadeEnd: 0.8; \nuniform float minGlossiness: 0.2; uniform float zThicknessThreshold: 1;\n\nuniform float nearZ;\nuniform vec2 viewportSize : VIEWPORT_SIZE;\n\nuniform float jitterOffset: 0;\n\nvarying vec2 v_Texcoord;\n\n#ifdef DEPTH_DECODE\n@import clay.util.decode_float\n#endif\n\n#ifdef PHYSICALLY_CORRECT\nuniform sampler2D normalDistribution;\nuniform float sampleOffset: 0;\nuniform vec2 normalDistributionSize;\n\nvec3 transformNormal(vec3 H, vec3 N) {\n vec3 upVector = N.y > 0.999 ? vec3(1.0, 0.0, 0.0) : vec3(0.0, 1.0, 0.0);\n vec3 tangentX = normalize(cross(N, upVector));\n vec3 tangentZ = cross(N, tangentX);\n return normalize(tangentX * H.x + N * H.y + tangentZ * H.z);\n}\nvec3 importanceSampleNormalGGX(float i, float roughness, vec3 N) {\n float p = fract((i + sampleOffset) / float(TOTAL_SAMPLES));\n vec3 H = texture2D(normalDistribution,vec2(roughness, p)).rgb;\n return transformNormal(H, N);\n}\nfloat G_Smith(float g, float ndv, float ndl) {\n float roughness = 1.0 - g;\n float k = roughness * roughness / 2.0;\n float G1V = ndv / (ndv * (1.0 - k) + k);\n float G1L = ndl / (ndl * (1.0 - k) + k);\n return G1L * G1V;\n}\nvec3 F_Schlick(float ndv, vec3 spec) {\n return spec + (1.0 - spec) * pow(1.0 - ndv, 5.0);\n}\n#endif\n\nfloat fetchDepth(sampler2D depthTexture, vec2 uv)\n{\n vec4 depthTexel = texture2D(depthTexture, uv);\n return depthTexel.r * 2.0 - 1.0;\n}\n\nfloat linearDepth(float depth)\n{\n if (projection[3][3] == 0.0) {\n return projection[3][2] / (depth * projection[2][3] - projection[2][2]);\n }\n else {\n return (depth - projection[3][2]) / projection[2][2];\n }\n}\n\nbool rayIntersectDepth(float rayZNear, float rayZFar, vec2 hitPixel)\n{\n if (rayZFar > rayZNear)\n {\n float t = rayZFar; rayZFar = rayZNear; rayZNear = t;\n }\n float cameraZ = linearDepth(fetchDepth(gBufferTexture2, hitPixel));\n return rayZFar <= cameraZ && rayZNear >= cameraZ - zThicknessThreshold;\n}\n\n\nbool traceScreenSpaceRay(\n vec3 rayOrigin, vec3 rayDir, float jitter,\n out vec2 hitPixel, out vec3 hitPoint, out float iterationCount\n)\n{\n float rayLength = ((rayOrigin.z + rayDir.z * maxRayDistance) > -nearZ)\n ? (-nearZ - rayOrigin.z) / rayDir.z : maxRayDistance;\n\n vec3 rayEnd = rayOrigin + rayDir * rayLength;\n\n vec4 H0 = projection * vec4(rayOrigin, 1.0);\n vec4 H1 = projection * vec4(rayEnd, 1.0);\n\n float k0 = 1.0 / H0.w, k1 = 1.0 / H1.w;\n\n vec3 Q0 = rayOrigin * k0, Q1 = rayEnd * k1;\n\n vec2 P0 = (H0.xy * k0 * 0.5 + 0.5) * viewportSize;\n vec2 P1 = (H1.xy * k1 * 0.5 + 0.5) * viewportSize;\n\n P1 += dot(P1 - P0, P1 - P0) < 0.0001 ? 0.01 : 0.0;\n vec2 delta = P1 - P0;\n\n bool permute = false;\n if (abs(delta.x) < abs(delta.y)) {\n permute = true;\n delta = delta.yx;\n P0 = P0.yx;\n P1 = P1.yx;\n }\n float stepDir = sign(delta.x);\n float invdx = stepDir / delta.x;\n\n vec3 dQ = (Q1 - Q0) * invdx;\n float dk = (k1 - k0) * invdx;\n\n vec2 dP = vec2(stepDir, delta.y * invdx);\n\n float strideScaler = 1.0 - min(1.0, -rayOrigin.z / pixelStrideZCutoff);\n float pixStride = 1.0 + strideScaler * pixelStride;\n\n dP *= pixStride; dQ *= pixStride; dk *= pixStride;\n\n vec4 pqk = vec4(P0, Q0.z, k0);\n vec4 dPQK = vec4(dP, dQ.z, dk);\n\n pqk += dPQK * jitter;\n float rayZFar = (dPQK.z * 0.5 + pqk.z) / (dPQK.w * 0.5 + pqk.w);\n float rayZNear;\n\n bool intersect = false;\n\n vec2 texelSize = 1.0 / viewportSize;\n\n iterationCount = 0.0;\n\n for (int i = 0; i < MAX_ITERATION; i++)\n {\n pqk += dPQK;\n\n rayZNear = rayZFar;\n rayZFar = (dPQK.z * 0.5 + pqk.z) / (dPQK.w * 0.5 + pqk.w);\n\n hitPixel = permute ? pqk.yx : pqk.xy;\n hitPixel *= texelSize;\n\n intersect = rayIntersectDepth(rayZNear, rayZFar, hitPixel);\n\n iterationCount += 1.0;\n\n dPQK *= 1.2;\n\n if (intersect) {\n break;\n }\n }\n\n Q0.xy += dQ.xy * iterationCount;\n Q0.z = pqk.z;\n hitPoint = Q0 / pqk.w;\n\n return intersect;\n}\n\nfloat calculateAlpha(\n float iterationCount, float reflectivity,\n vec2 hitPixel, vec3 hitPoint, float dist, vec3 rayDir\n)\n{\n float alpha = clamp(reflectivity, 0.0, 1.0);\n alpha *= 1.0 - (iterationCount / float(MAX_ITERATION));\n vec2 hitPixelNDC = hitPixel * 2.0 - 1.0;\n float maxDimension = min(1.0, max(abs(hitPixelNDC.x), abs(hitPixelNDC.y)));\n alpha *= 1.0 - max(0.0, maxDimension - screenEdgeFadeStart) / (1.0 - screenEdgeFadeStart);\n\n float _eyeFadeStart = eyeFadeStart;\n float _eyeFadeEnd = eyeFadeEnd;\n if (_eyeFadeStart > _eyeFadeEnd) {\n float tmp = _eyeFadeEnd;\n _eyeFadeEnd = _eyeFadeStart;\n _eyeFadeStart = tmp;\n }\n\n float eyeDir = clamp(rayDir.z, _eyeFadeStart, _eyeFadeEnd);\n alpha *= 1.0 - (eyeDir - _eyeFadeStart) / (_eyeFadeEnd - _eyeFadeStart);\n\n alpha *= 1.0 - clamp(dist / maxRayDistance, 0.0, 1.0);\n\n return alpha;\n}\n\n@import clay.util.rand\n\n@import clay.util.rgbm\n\nvoid main()\n{\n vec4 normalAndGloss = texture2D(gBufferTexture1, v_Texcoord);\n\n if (dot(normalAndGloss.rgb, vec3(1.0)) == 0.0) {\n discard;\n }\n\n float g = normalAndGloss.a;\n#if !defined(PHYSICALLY_CORRECT)\n if (g <= minGlossiness) {\n discard;\n }\n#endif\n\n float reflectivity = (g - minGlossiness) / (1.0 - minGlossiness);\n\n vec3 N = normalize(normalAndGloss.rgb * 2.0 - 1.0);\n N = normalize((toViewSpace * vec4(N, 0.0)).xyz);\n\n vec4 projectedPos = vec4(v_Texcoord * 2.0 - 1.0, fetchDepth(gBufferTexture2, v_Texcoord), 1.0);\n vec4 pos = projectionInv * projectedPos;\n vec3 rayOrigin = pos.xyz / pos.w;\n vec3 V = -normalize(rayOrigin);\n\n float ndv = clamp(dot(N, V), 0.0, 1.0);\n float iterationCount;\n float jitter = rand(fract(v_Texcoord + jitterOffset));\n\n#ifdef PHYSICALLY_CORRECT\n vec4 color = vec4(vec3(0.0), 1.0);\n vec4 albedoMetalness = texture2D(gBufferTexture3, v_Texcoord);\n vec3 albedo = albedoMetalness.rgb;\n float m = albedoMetalness.a;\n vec3 diffuseColor = albedo * (1.0 - m);\n vec3 spec = mix(vec3(0.04), albedo, m);\n\n float jitter2 = rand(fract(v_Texcoord)) * float(TOTAL_SAMPLES);\n\n for (int i = 0; i < SAMPLE_PER_FRAME; i++) {\n vec3 H = importanceSampleNormalGGX(float(i) + jitter2, 1.0 - g, N);\n vec3 rayDir = normalize(reflect(-V, H));\n#else\n vec3 rayDir = normalize(reflect(-V, N));\n#endif\n vec2 hitPixel;\n vec3 hitPoint;\n\n bool intersect = traceScreenSpaceRay(rayOrigin, rayDir, jitter, hitPixel, hitPoint, iterationCount);\n\n float dist = distance(rayOrigin, hitPoint);\n\n vec3 hitNormal = texture2D(gBufferTexture1, hitPixel).rgb * 2.0 - 1.0;\n hitNormal = normalize((toViewSpace * vec4(hitNormal, 0.0)).xyz);\n#ifdef PHYSICALLY_CORRECT\n float ndl = clamp(dot(N, rayDir), 0.0, 1.0);\n float vdh = clamp(dot(V, H), 0.0, 1.0);\n float ndh = clamp(dot(N, H), 0.0, 1.0);\n vec3 litTexel = vec3(0.0);\n if (dot(hitNormal, rayDir) < 0.0 && intersect) {\n litTexel = texture2D(sourceTexture, hitPixel).rgb;\n litTexel *= pow(clamp(1.0 - dist / 200.0, 0.0, 1.0), 3.0);\n\n }\n else {\n #ifdef SPECULARCUBEMAP_ENABLED\n vec3 rayDirW = normalize(toWorldSpace * vec4(rayDir, 0.0)).rgb;\n litTexel = RGBMDecode(textureCubeLodEXT(specularCubemap, rayDirW, 0.0), 8.12).rgb * specularIntensity;\n#endif\n }\n color.rgb += ndl * litTexel * (\n F_Schlick(ndl, spec) * G_Smith(g, ndv, ndl) * vdh / (ndh * ndv + 0.001)\n );\n }\n color.rgb /= float(SAMPLE_PER_FRAME);\n#else\n #if !defined(SPECULARCUBEMAP_ENABLED)\n if (dot(hitNormal, rayDir) >= 0.0) {\n discard;\n }\n if (!intersect) {\n discard;\n }\n#endif\n float alpha = clamp(calculateAlpha(iterationCount, reflectivity, hitPixel, hitPoint, dist, rayDir), 0.0, 1.0);\n vec4 color = texture2D(sourceTexture, hitPixel);\n color.rgb *= alpha;\n\n#ifdef SPECULARCUBEMAP_ENABLED\n vec3 rayDirW = normalize(toWorldSpace * vec4(rayDir, 0.0)).rgb;\n alpha = alpha * (intersect ? 1.0 : 0.0);\n float bias = (1.0 -g) * 5.0;\n color.rgb += (1.0 - alpha)\n * RGBMDecode(textureCubeLodEXT(specularCubemap, rayDirW, bias), 8.12).rgb\n * specularIntensity;\n#endif\n\n#endif\n\n gl_FragColor = encodeHDR(color);\n}\n@end\n\n@export ecgl.ssr.blur\n\nuniform sampler2D texture;\nuniform sampler2D gBufferTexture1;\nuniform sampler2D gBufferTexture2;\nuniform mat4 projection;\nuniform float depthRange : 0.05;\n\nvarying vec2 v_Texcoord;\n\nuniform vec2 textureSize;\nuniform float blurSize : 1.0;\n\n#ifdef BLEND\n #ifdef SSAOTEX_ENABLED\nuniform sampler2D ssaoTex;\n #endif\nuniform sampler2D sourceTexture;\n#endif\n\nfloat getLinearDepth(vec2 coord)\n{\n float depth = texture2D(gBufferTexture2, coord).r * 2.0 - 1.0;\n return projection[3][2] / (depth * projection[2][3] - projection[2][2]);\n}\n\n@import clay.util.rgbm\n\n\nvoid main()\n{\n @import clay.compositor.kernel.gaussian_9\n\n vec4 centerNTexel = texture2D(gBufferTexture1, v_Texcoord);\n float g = centerNTexel.a;\n float maxBlurSize = clamp(1.0 - g, 0.0, 1.0) * blurSize;\n#ifdef VERTICAL\n vec2 off = vec2(0.0, maxBlurSize / textureSize.y);\n#else\n vec2 off = vec2(maxBlurSize / textureSize.x, 0.0);\n#endif\n\n vec2 coord = v_Texcoord;\n\n vec4 sum = vec4(0.0);\n float weightAll = 0.0;\n\n vec3 cN = centerNTexel.rgb * 2.0 - 1.0;\n float cD = getLinearDepth(v_Texcoord);\n for (int i = 0; i < 9; i++) {\n vec2 coord = clamp((float(i) - 4.0) * off + v_Texcoord, vec2(0.0), vec2(1.0));\n float w = gaussianKernel[i]\n * clamp(dot(cN, texture2D(gBufferTexture1, coord).rgb * 2.0 - 1.0), 0.0, 1.0);\n float d = getLinearDepth(coord);\n w *= (1.0 - smoothstep(abs(cD - d) / depthRange, 0.0, 1.0));\n\n weightAll += w;\n sum += decodeHDR(texture2D(texture, coord)) * w;\n }\n\n#ifdef BLEND\n float aoFactor = 1.0;\n #ifdef SSAOTEX_ENABLED\n aoFactor = texture2D(ssaoTex, v_Texcoord).r;\n #endif\n gl_FragColor = encodeHDR(\n sum / weightAll * aoFactor + decodeHDR(texture2D(sourceTexture, v_Texcoord))\n );\n#else\n gl_FragColor = encodeHDR(sum / weightAll);\n#endif\n}\n\n@end"},function(e,t,n){"use strict";t["a"]=[0,0,-.321585265978,-.154972575841,.458126042375,.188473391593,.842080129861,.527766490688,.147304551086,-.659453822776,-.331943915203,-.940619700594,.0479226680259,.54812163202,.701581552186,-.709825561388,-.295436780218,.940589268233,-.901489676764,.237713156085,.973570876096,-.109899459384,-.866792314779,-.451805525005,.330975007087,.800048655954,-.344275183665,.381779221166,-.386139432542,-.437418421534,-.576478634965,-.0148463392551,.385798197415,-.262426961053,-.666302061145,.682427250835,-.628010632582,-.732836215494,.10163141741,-.987658134403,.711995289051,-.320024291314,.0296005138058,.950296523438,.0130612307608,-.351024443122,-.879596633704,-.10478487883,.435712737232,.504254490347,.779203817497,.206477676721,.388264289969,-.896736162545,-.153106280781,-.629203242522,-.245517550697,.657969239148,.126830499058,.26862328493,-.634888119007,-.302301223431,.617074219636,.779817204925]},function(e,t,n){"use strict";var r=n(5),i=n(4),o=n(8),a=n(10),s=n(19),l=n(16),u=n(61),c=n(195);function d(e,t,n,r,i){var o=e.gl;t.setUniform(o,"1i",n,i),o.activeTexture(o.TEXTURE0+i),r.isRenderable()?r.bind(e):r.unbind(e)}function f(e,t,n,r,i){var o,a,s,l,u=e.gl;return function(i,c,f){if(!l||l.material!==i.material){var h=i.material,p=i.__program,m=h.get("roughness");null==m&&(m=1);var v=h.get("normalMap")||t,g=h.get("roughnessMap"),y=h.get("bumpMap"),_=h.get("uvRepeat"),x=h.get("uvOffset"),b=h.get("detailUvRepeat"),w=h.get("detailUvOffset"),A=!!y&&h.isTextureEnabled("bumpMap"),T=!!g&&h.isTextureEnabled("roughnessMap"),S=h.isDefined("fragment","DOUBLE_SIDED");y=y||n,g=g||r,f!==c?(c.set("normalMap",v),c.set("bumpMap",y),c.set("roughnessMap",g),c.set("useBumpMap",A),c.set("useRoughnessMap",T),c.set("doubleSide",S),null!=_&&c.set("uvRepeat",_),null!=x&&c.set("uvOffset",x),null!=b&&c.set("detailUvRepeat",b),null!=w&&c.set("detailUvOffset",w),c.set("roughness",m)):(p.setUniform(u,"1f","roughness",m),o!==v&&d(e,p,"normalMap",v,0),a!==y&&y&&d(e,p,"bumpMap",y,1),s!==g&&g&&d(e,p,"roughnessMap",g,2),null!=_&&p.setUniform(u,"2f","uvRepeat",_),null!=x&&p.setUniform(u,"2f","uvOffset",x),null!=b&&p.setUniform(u,"2f","detailUvRepeat",b),null!=w&&p.setUniform(u,"2f","detailUvOffset",w),p.setUniform(u,"1i","useBumpMap",+A),p.setUniform(u,"1i","useRoughnessMap",+T),p.setUniform(u,"1i","doubleSide",+S)),o=v,a=y,s=g,l=i}}}function h(e){e=e||{},this._depthTex=new r["a"]({format:i["a"].DEPTH_COMPONENT,type:i["a"].UNSIGNED_INT}),this._normalTex=new r["a"]({type:i["a"].HALF_FLOAT}),this._framebuffer=new a["a"],this._framebuffer.attach(this._normalTex),this._framebuffer.attach(this._depthTex,a["a"].DEPTH_ATTACHMENT),this._normalMaterial=new s["a"]({shader:new o["a"](o["a"].source("ecgl.normal.vertex"),o["a"].source("ecgl.normal.fragment"))}),this._normalMaterial.enableTexture(["normalMap","bumpMap","roughnessMap"]),this._defaultNormalMap=u["a"].createBlank("#000"),this._defaultBumpMap=u["a"].createBlank("#000"),this._defaultRoughessMap=u["a"].createBlank("#000"),this._debugPass=new l["a"]({fragment:o["a"].source("clay.compositor.output")}),this._debugPass.setUniform("texture",this._normalTex),this._debugPass.material.undefine("fragment","OUTPUT_ALPHA")}o["a"].import(c["a"]),h.prototype.getDepthTexture=function(){return this._depthTex},h.prototype.getNormalTexture=function(){return this._normalTex},h.prototype.update=function(e,t,n){var r=e.getWidth(),i=e.getHeight(),o=this._depthTex,a=this._normalTex,s=this._normalMaterial;o.width=r,o.height=i,a.width=r,a.height=i;var l=t.getRenderList(n).opaque;this._framebuffer.bind(e),e.gl.clearColor(0,0,0,0),e.gl.clear(e.gl.COLOR_BUFFER_BIT|e.gl.DEPTH_BUFFER_BIT),e.gl.disable(e.gl.BLEND),e.renderPass(l,n,{getMaterial:function(){return s},ifRender:function(e){return e.renderNormal},beforeRender:f(e,this._defaultNormalMap,this._defaultBumpMap,this._defaultRoughessMap,this._normalMaterial),sort:e.opaqueSortCompare}),this._framebuffer.unbind(e)},h.prototype.renderDebug=function(e){this._debugPass.render(e)},h.prototype.dispose=function(e){this._depthTex.dispose(e),this._normalTex.dispose(e)},t["a"]=h},function(e,t,n){"use strict";t["a"]="@export ecgl.normal.vertex\n\n@import ecgl.common.transformUniforms\n\n@import ecgl.common.uv.header\n\n@import ecgl.common.attributes\n\nvarying vec3 v_Normal;\nvarying vec3 v_WorldPosition;\n\n@import ecgl.common.normalMap.vertexHeader\n\n@import ecgl.common.vertexAnimation.header\n\nvoid main()\n{\n\n @import ecgl.common.vertexAnimation.main\n\n @import ecgl.common.uv.main\n\n v_Normal = normalize((worldInverseTranspose * vec4(normal, 0.0)).xyz);\n v_WorldPosition = (world * vec4(pos, 1.0)).xyz;\n\n @import ecgl.common.normalMap.vertexMain\n\n gl_Position = worldViewProjection * vec4(pos, 1.0);\n\n}\n\n\n@end\n\n\n@export ecgl.normal.fragment\n\n#define ROUGHNESS_CHANEL 0\n\nuniform bool useBumpMap;\nuniform bool useRoughnessMap;\nuniform bool doubleSide;\nuniform float roughness;\n\n@import ecgl.common.uv.fragmentHeader\n\nvarying vec3 v_Normal;\nvarying vec3 v_WorldPosition;\n\nuniform mat4 viewInverse : VIEWINVERSE;\n\n@import ecgl.common.normalMap.fragmentHeader\n@import ecgl.common.bumpMap.header\n\nuniform sampler2D roughnessMap;\n\nvoid main()\n{\n vec3 N = v_Normal;\n \n bool flipNormal = false;\n if (doubleSide) {\n vec3 eyePos = viewInverse[3].xyz;\n vec3 V = normalize(eyePos - v_WorldPosition);\n\n if (dot(N, V) < 0.0) {\n flipNormal = true;\n }\n }\n\n @import ecgl.common.normalMap.fragmentMain\n\n if (useBumpMap) {\n N = bumpNormal(v_WorldPosition, v_Normal, N);\n }\n\n float g = 1.0 - roughness;\n\n if (useRoughnessMap) {\n float g2 = 1.0 - texture2D(roughnessMap, v_DetailTexcoord)[ROUGHNESS_CHANEL];\n g = clamp(g2 + (g - 0.5) * 2.0, 0.0, 1.0);\n }\n\n if (flipNormal) {\n N = -N;\n }\n\n gl_FragColor.rgb = (N.xyz + 1.0) * 0.5;\n gl_FragColor.a = g;\n}\n@end"},function(e,t,n){"use strict";n(9),n(3);var r=n(5),i=n(4),o=n(16),a=n(8),s=n(10);function l(e){e=e||{},this._edgePass=new o["a"]({fragment:a["a"].source("ecgl.edge")}),this._edgePass.setUniform("normalTexture",e.normalTexture),this._edgePass.setUniform("depthTexture",e.depthTexture),this._targetTexture=new r["a"]({type:i["a"].HALF_FLOAT}),this._frameBuffer=new s["a"],this._frameBuffer.attach(this._targetTexture)}l.prototype.update=function(e,t,n,r){var i=e.getWidth(),o=e.getHeight(),a=this._targetTexture;a.width=i,a.height=o;var s=this._frameBuffer;s.bind(e),this._edgePass.setUniform("projectionInv",t.invProjectionMatrix.array),this._edgePass.setUniform("textureSize",[i,o]),this._edgePass.setUniform("texture",n),this._edgePass.render(e),s.unbind(e)},l.prototype.getTargetTexture=function(){return this._targetTexture},l.prototype.setParameter=function(e,t){this._edgePass.setUniform(e,t)},l.prototype.dispose=function(e){this._targetTexture.dispose(e),this._frameBuffer.dispose(e)},t["a"]=l},function(e,t,n){"use strict";t["a"]={type:"compositor",nodes:[{name:"source",type:"texture",outputs:{color:{}}},{name:"source_half",shader:"#source(clay.compositor.downsample)",inputs:{texture:"source"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 2)",height:"expr(height * 1.0 / 2)",type:"HALF_FLOAT"}}},parameters:{textureSize:"expr( [width * 1.0, height * 1.0] )"}},{name:"bright",shader:"#source(clay.compositor.bright)",inputs:{texture:"source_half"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 2)",height:"expr(height * 1.0 / 2)",type:"HALF_FLOAT"}}},parameters:{threshold:2,scale:4,textureSize:"expr([width * 1.0 / 2, height / 2])"}},{name:"bright_downsample_4",shader:"#source(clay.compositor.downsample)",inputs:{texture:"bright"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 4)",height:"expr(height * 1.0 / 4)",type:"HALF_FLOAT"}}},parameters:{textureSize:"expr( [width * 1.0 / 2, height / 2] )"}},{name:"bright_downsample_8",shader:"#source(clay.compositor.downsample)",inputs:{texture:"bright_downsample_4"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 8)",height:"expr(height * 1.0 / 8)",type:"HALF_FLOAT"}}},parameters:{textureSize:"expr( [width * 1.0 / 4, height / 4] )"}},{name:"bright_downsample_16",shader:"#source(clay.compositor.downsample)",inputs:{texture:"bright_downsample_8"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 16)",height:"expr(height * 1.0 / 16)",type:"HALF_FLOAT"}}},parameters:{textureSize:"expr( [width * 1.0 / 8, height / 8] )"}},{name:"bright_downsample_32",shader:"#source(clay.compositor.downsample)",inputs:{texture:"bright_downsample_16"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 32)",height:"expr(height * 1.0 / 32)",type:"HALF_FLOAT"}}},parameters:{textureSize:"expr( [width * 1.0 / 16, height / 16] )"}},{name:"bright_upsample_16_blur_h",shader:"#source(clay.compositor.gaussian_blur)",inputs:{texture:"bright_downsample_32"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 16)",height:"expr(height * 1.0 / 16)",type:"HALF_FLOAT"}}},parameters:{blurSize:1,blurDir:0,textureSize:"expr( [width * 1.0 / 32, height / 32] )"}},{name:"bright_upsample_16_blur_v",shader:"#source(clay.compositor.gaussian_blur)",inputs:{texture:"bright_upsample_16_blur_h"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 16)",height:"expr(height * 1.0 / 16)",type:"HALF_FLOAT"}}},parameters:{blurSize:1,blurDir:1,textureSize:"expr( [width * 1.0 / 16, height * 1.0 / 16] )"}},{name:"bright_upsample_8_blur_h",shader:"#source(clay.compositor.gaussian_blur)",inputs:{texture:"bright_downsample_16"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 8)",height:"expr(height * 1.0 / 8)",type:"HALF_FLOAT"}}},parameters:{blurSize:1,blurDir:0,textureSize:"expr( [width * 1.0 / 16, height * 1.0 / 16] )"}},{name:"bright_upsample_8_blur_v",shader:"#source(clay.compositor.gaussian_blur)",inputs:{texture:"bright_upsample_8_blur_h"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 8)",height:"expr(height * 1.0 / 8)",type:"HALF_FLOAT"}}},parameters:{blurSize:1,blurDir:1,textureSize:"expr( [width * 1.0 / 8, height * 1.0 / 8] )"}},{name:"bright_upsample_8_blend",shader:"#source(clay.compositor.blend)",inputs:{texture1:"bright_upsample_8_blur_v",texture2:"bright_upsample_16_blur_v"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 8)",height:"expr(height * 1.0 / 8)",type:"HALF_FLOAT"}}},parameters:{weight1:.3,weight2:.7}},{name:"bright_upsample_4_blur_h",shader:"#source(clay.compositor.gaussian_blur)",inputs:{texture:"bright_downsample_8"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 4)",height:"expr(height * 1.0 / 4)",type:"HALF_FLOAT"}}},parameters:{blurSize:1,blurDir:0,textureSize:"expr( [width * 1.0 / 8, height * 1.0 / 8] )"}},{name:"bright_upsample_4_blur_v",shader:"#source(clay.compositor.gaussian_blur)",inputs:{texture:"bright_upsample_4_blur_h"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 4)",height:"expr(height * 1.0 / 4)",type:"HALF_FLOAT"}}},parameters:{blurSize:1,blurDir:1,textureSize:"expr( [width * 1.0 / 4, height * 1.0 / 4] )"}},{name:"bright_upsample_4_blend",shader:"#source(clay.compositor.blend)",inputs:{texture1:"bright_upsample_4_blur_v",texture2:"bright_upsample_8_blend"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 4)",height:"expr(height * 1.0 / 4)",type:"HALF_FLOAT"}}},parameters:{weight1:.3,weight2:.7}},{name:"bright_upsample_2_blur_h",shader:"#source(clay.compositor.gaussian_blur)",inputs:{texture:"bright_downsample_4"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 2)",height:"expr(height * 1.0 / 2)",type:"HALF_FLOAT"}}},parameters:{blurSize:1,blurDir:0,textureSize:"expr( [width * 1.0 / 4, height * 1.0 / 4] )"}},{name:"bright_upsample_2_blur_v",shader:"#source(clay.compositor.gaussian_blur)",inputs:{texture:"bright_upsample_2_blur_h"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 2)",height:"expr(height * 1.0 / 2)",type:"HALF_FLOAT"}}},parameters:{blurSize:1,blurDir:1,textureSize:"expr( [width * 1.0 / 2, height * 1.0 / 2] )"}},{name:"bright_upsample_2_blend",shader:"#source(clay.compositor.blend)",inputs:{texture1:"bright_upsample_2_blur_v",texture2:"bright_upsample_4_blend"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 2)",height:"expr(height * 1.0 / 2)",type:"HALF_FLOAT"}}},parameters:{weight1:.3,weight2:.7}},{name:"bright_upsample_full_blur_h",shader:"#source(clay.compositor.gaussian_blur)",inputs:{texture:"bright"},outputs:{color:{parameters:{width:"expr(width * 1.0)",height:"expr(height * 1.0)",type:"HALF_FLOAT"}}},parameters:{blurSize:1,blurDir:0,textureSize:"expr( [width * 1.0 / 2, height * 1.0 / 2] )"}},{name:"bright_upsample_full_blur_v",shader:"#source(clay.compositor.gaussian_blur)",inputs:{texture:"bright_upsample_full_blur_h"},outputs:{color:{parameters:{width:"expr(width * 1.0)",height:"expr(height * 1.0)",type:"HALF_FLOAT"}}},parameters:{blurSize:1,blurDir:1,textureSize:"expr( [width * 1.0, height * 1.0] )"}},{name:"bloom_composite",shader:"#source(clay.compositor.blend)",inputs:{texture1:"bright_upsample_full_blur_v",texture2:"bright_upsample_2_blend"},outputs:{color:{parameters:{width:"expr(width * 1.0)",height:"expr(height * 1.0)",type:"HALF_FLOAT"}}},parameters:{weight1:.3,weight2:.7}},{name:"coc",shader:"#source(ecgl.dof.coc)",outputs:{color:{parameters:{minFilter:"NEAREST",magFilter:"NEAREST",width:"expr(width * 1.0)",height:"expr(height * 1.0)"}}},parameters:{focalDist:50,focalRange:30}},{name:"dof_far_blur",shader:"#source(ecgl.dof.diskBlur)",inputs:{texture:"source",coc:"coc"},outputs:{color:{parameters:{width:"expr(width * 1.0)",height:"expr(height * 1.0)",type:"HALF_FLOAT"}}},parameters:{textureSize:"expr( [width * 1.0, height * 1.0] )"}},{name:"dof_near_blur",shader:"#source(ecgl.dof.diskBlur)",inputs:{texture:"source",coc:"coc"},outputs:{color:{parameters:{width:"expr(width * 1.0)",height:"expr(height * 1.0)",type:"HALF_FLOAT"}}},parameters:{textureSize:"expr( [width * 1.0, height * 1.0] )"},defines:{BLUR_NEARFIELD:null}},{name:"dof_coc_blur",shader:"#source(ecgl.dof.diskBlur)",inputs:{texture:"coc"},outputs:{color:{parameters:{minFilter:"NEAREST",magFilter:"NEAREST",width:"expr(width * 1.0)",height:"expr(height * 1.0)"}}},parameters:{textureSize:"expr( [width * 1.0, height * 1.0] )"},defines:{BLUR_COC:null}},{name:"dof_composite",shader:"#source(ecgl.dof.composite)",inputs:{original:"source",blurred:"dof_far_blur",nearfield:"dof_near_blur",coc:"coc",nearcoc:"dof_coc_blur"},outputs:{color:{parameters:{width:"expr(width * 1.0)",height:"expr(height * 1.0)",type:"HALF_FLOAT"}}}},{name:"composite",shader:"#source(clay.compositor.hdr.composite)",inputs:{texture:"source",bloom:"bloom_composite"},defines:{}},{name:"FXAA",shader:"#source(clay.compositor.fxaa)",inputs:{texture:"composite"}}]}},function(e,t,n){"use strict";t["a"]="@export ecgl.dof.coc\n\nuniform sampler2D depth;\n\nuniform float zNear: 0.1;\nuniform float zFar: 2000;\n\nuniform float focalDistance: 3;\nuniform float focalRange: 1;\nuniform float focalLength: 30;\nuniform float fstop: 2.8;\n\nvarying vec2 v_Texcoord;\n\n@import clay.util.encode_float\n\nvoid main()\n{\n float z = texture2D(depth, v_Texcoord).r * 2.0 - 1.0;\n\n float dist = 2.0 * zNear * zFar / (zFar + zNear - z * (zFar - zNear));\n\n float aperture = focalLength / fstop;\n\n float coc;\n\n float uppper = focalDistance + focalRange;\n float lower = focalDistance - focalRange;\n if (dist <= uppper && dist >= lower) {\n coc = 0.5;\n }\n else {\n float focalAdjusted = dist > uppper ? uppper : lower;\n\n coc = abs(aperture * (focalLength * (dist - focalAdjusted)) / (dist * (focalAdjusted - focalLength)));\n coc = clamp(coc, 0.0, 2.0) / 2.00001;\n\n if (dist < lower) {\n coc = -coc;\n }\n coc = coc * 0.5 + 0.5;\n }\n\n gl_FragColor = encodeFloat(coc);\n}\n@end\n\n\n@export ecgl.dof.composite\n\n#define DEBUG 0\n\nuniform sampler2D original;\nuniform sampler2D blurred;\nuniform sampler2D nearfield;\nuniform sampler2D coc;\nuniform sampler2D nearcoc;\nvarying vec2 v_Texcoord;\n\n@import clay.util.rgbm\n@import clay.util.float\n\nvoid main()\n{\n vec4 blurredColor = texture2D(blurred, v_Texcoord);\n vec4 originalColor = texture2D(original, v_Texcoord);\n\n float fCoc = decodeFloat(texture2D(coc, v_Texcoord));\n\n fCoc = abs(fCoc * 2.0 - 1.0);\n\n float weight = smoothstep(0.0, 1.0, fCoc);\n \n#ifdef NEARFIELD_ENABLED\n vec4 nearfieldColor = texture2D(nearfield, v_Texcoord);\n float fNearCoc = decodeFloat(texture2D(nearcoc, v_Texcoord));\n fNearCoc = abs(fNearCoc * 2.0 - 1.0);\n\n gl_FragColor = encodeHDR(\n mix(\n nearfieldColor, mix(originalColor, blurredColor, weight),\n pow(1.0 - fNearCoc, 4.0)\n )\n );\n#else\n gl_FragColor = encodeHDR(mix(originalColor, blurredColor, weight));\n#endif\n\n}\n\n@end\n\n\n\n@export ecgl.dof.diskBlur\n\n#define POISSON_KERNEL_SIZE 16;\n\nuniform sampler2D texture;\nuniform sampler2D coc;\nvarying vec2 v_Texcoord;\n\nuniform float blurRadius : 10.0;\nuniform vec2 textureSize : [512.0, 512.0];\n\nuniform vec2 poissonKernel[POISSON_KERNEL_SIZE];\n\nuniform float percent;\n\nfloat nrand(const in vec2 n) {\n return fract(sin(dot(n.xy ,vec2(12.9898,78.233))) * 43758.5453);\n}\n\n@import clay.util.rgbm\n@import clay.util.float\n\n\nvoid main()\n{\n vec2 offset = blurRadius / textureSize;\n\n float rnd = 6.28318 * nrand(v_Texcoord + 0.07 * percent );\n float cosa = cos(rnd);\n float sina = sin(rnd);\n vec4 basis = vec4(cosa, -sina, sina, cosa);\n\n#if !defined(BLUR_NEARFIELD) && !defined(BLUR_COC)\n offset *= abs(decodeFloat(texture2D(coc, v_Texcoord)) * 2.0 - 1.0);\n#endif\n\n#ifdef BLUR_COC\n float cocSum = 0.0;\n#else\n vec4 color = vec4(0.0);\n#endif\n\n\n float weightSum = 0.0;\n\n for (int i = 0; i < POISSON_KERNEL_SIZE; i++) {\n vec2 ofs = poissonKernel[i];\n\n ofs = vec2(dot(ofs, basis.xy), dot(ofs, basis.zw));\n\n vec2 uv = v_Texcoord + ofs * offset;\n vec4 texel = texture2D(texture, uv);\n\n float w = 1.0;\n#ifdef BLUR_COC\n float fCoc = decodeFloat(texel) * 2.0 - 1.0;\n cocSum += clamp(fCoc, -1.0, 0.0) * w;\n#else\n texel = texel;\n #if !defined(BLUR_NEARFIELD)\n float fCoc = decodeFloat(texture2D(coc, uv)) * 2.0 - 1.0;\n w *= abs(fCoc);\n #endif\n texel.rgb *= texel.a;\n color += texel * w;\n#endif\n\n weightSum += w;\n }\n\n#ifdef BLUR_COC\n gl_FragColor = encodeFloat(clamp(cocSum / weightSum, -1.0, 0.0) * 0.5 + 0.5);\n#else\n color /= weightSum;\n color.rgb /= (color.a + 0.0001);\n gl_FragColor = color;\n#endif\n}\n\n@end"},function(e,t,n){"use strict";t["a"]="@export ecgl.edge\n\nuniform sampler2D texture;\n\nuniform sampler2D normalTexture;\nuniform sampler2D depthTexture;\n\nuniform mat4 projectionInv;\n\nuniform vec2 textureSize;\n\nuniform vec4 edgeColor: [0,0,0,0.8];\n\nvarying vec2 v_Texcoord;\n\nvec3 packColor(vec2 coord) {\n float z = texture2D(depthTexture, coord).r * 2.0 - 1.0;\n vec4 p = vec4(v_Texcoord * 2.0 - 1.0, z, 1.0);\n vec4 p4 = projectionInv * p;\n\n return vec3(\n texture2D(normalTexture, coord).rg,\n -p4.z / p4.w / 5.0\n );\n}\n\nvoid main() {\n vec2 cc = v_Texcoord;\n vec3 center = packColor(cc);\n\n float size = clamp(1.0 - (center.z - 10.0) / 100.0, 0.0, 1.0) * 0.5;\n float dx = size / textureSize.x;\n float dy = size / textureSize.y;\n\n vec2 coord;\n vec3 topLeft = packColor(cc+vec2(-dx, -dy));\n vec3 top = packColor(cc+vec2(0.0, -dy));\n vec3 topRight = packColor(cc+vec2(dx, -dy));\n vec3 left = packColor(cc+vec2(-dx, 0.0));\n vec3 right = packColor(cc+vec2(dx, 0.0));\n vec3 bottomLeft = packColor(cc+vec2(-dx, dy));\n vec3 bottom = packColor(cc+vec2(0.0, dy));\n vec3 bottomRight = packColor(cc+vec2(dx, dy));\n\n vec3 v = -topLeft-2.0*top-topRight+bottomLeft+2.0*bottom+bottomRight;\n vec3 h = -bottomLeft-2.0*left-topLeft+bottomRight+2.0*right+topRight;\n\n float edge = sqrt(dot(h, h) + dot(v, v));\n\n edge = smoothstep(0.8, 1.0, edge);\n\n gl_FragColor = mix(texture2D(texture, v_Texcoord), vec4(edgeColor.rgb, 1.0), edgeColor.a * edge);\n}\n@end"},function(e,t,n){"use strict";var r=n(49),i=n(16),o=n(10),a=n(5),s=n(8),l=n(9);function u(e){for(var t=[],n=0;n<30;n++)t.push([Object(r["a"])(n,2),Object(r["a"])(n,3)]);this._haltonSequence=t,this._frame=0,this._sourceTex=new a["a"],this._sourceFb=new o["a"],this._sourceFb.attach(this._sourceTex),this._prevFrameTex=new a["a"],this._outputTex=new a["a"];var l=this._blendPass=new i["a"]({fragment:s["a"].source("clay.compositor.blend")});l.material.disableTexturesAll(),l.material.enableTexture(["texture1","texture2"]),this._blendFb=new o["a"]({depthBuffer:!1}),this._outputPass=new i["a"]({fragment:s["a"].source("clay.compositor.output"),blendWithPrevious:!0}),this._outputPass.material.define("fragment","OUTPUT_ALPHA"),this._outputPass.material.blend=function(e){e.blendEquationSeparate(e.FUNC_ADD,e.FUNC_ADD),e.blendFuncSeparate(e.ONE,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA)}}u.prototype={constructor:u,jitterProjection:function(e,t){var n=e.viewport,r=n.devicePixelRatio||e.getDevicePixelRatio(),i=n.width*r,o=n.height*r,a=this._haltonSequence[this._frame%this._haltonSequence.length],s=new l["a"];s.array[12]=(2*a[0]-1)/i,s.array[13]=(2*a[1]-1)/o,l["a"].mul(t.projectionMatrix,s,t.projectionMatrix),l["a"].invert(t.invProjectionMatrix,t.projectionMatrix)},resetFrame:function(){this._frame=0},getFrame:function(){return this._frame},getSourceFrameBuffer:function(){return this._sourceFb},getOutputTexture:function(){return this._outputTex},resize:function(e,t){this._prevFrameTex.width=e,this._prevFrameTex.height=t,this._outputTex.width=e,this._outputTex.height=t,this._sourceTex.width=e,this._sourceTex.height=t,this._prevFrameTex.dirty(),this._outputTex.dirty(),this._sourceTex.dirty()},isFinished:function(){return this._frame>=this._haltonSequence.length},render:function(e,t,n){var r=this._blendPass;0===this._frame?(r.setUniform("weight1",0),r.setUniform("weight2",1)):(r.setUniform("weight1",.9),r.setUniform("weight2",.1)),r.setUniform("texture1",this._prevFrameTex),r.setUniform("texture2",t||this._sourceTex),this._blendFb.attach(this._outputTex),this._blendFb.bind(e),r.render(e),this._blendFb.unbind(e),n||(this._outputPass.setUniform("texture",this._outputTex),this._outputPass.render(e));var i=this._prevFrameTex;this._prevFrameTex=this._outputTex,this._outputTex=i,this._frame++},dispose:function(e){this._sourceFb.dispose(e),this._blendFb.dispose(e),this._prevFrameTex.dispose(e),this._outputTex.dispose(e),this._sourceTex.dispose(e),this._outputPass.dispose(e),this._blendPass.dispose(e)}},t["a"]=u},function(e,t,n){"use strict";var r=n(0),i=n.n(r);n(202),n(203),n(98);i.a.registerAction({type:"geo3DChangeCamera",event:"geo3dcamerachanged",update:"series:updateCamera"},(function(e,t){t.eachComponent({mainType:"geo3D",query:e},(function(t){t.setView(e)}))}))},function(e,t,n){"use strict";var r=n(0),i=n.n(r),o=n(44),a=n(28),s=n(29),l=n(31),u=n(96),c=i.a.extendComponentModel({type:"geo3D",layoutMode:"box",coordinateSystem:null,optionUpdated:function(){var e=this.option;e.regions=this.getFilledRegions(e.regions,e.map);var t=i.a.helper.completeDimensions(["value"],e.data,{encodeDef:this.get("encode"),dimsDef:this.get("dimensions")}),n=new i.a.List(t,this);n.initData(e.regions);var r={};n.each((function(e){var t=n.getName(e),i=n.getItemModel(e);r[t]=i})),this._regionModelMap=r,this._data=n},getData:function(){return this._data},getRegionModel:function(e){var t=this.getData().getName(e);return this._regionModelMap[t]||new i.a.Model(null,this)},getRegionPolygonCoords:function(e){var t=this.getData().getName(e),n=this.coordinateSystem.getRegion(t);return n?n.geometries:[]},getFormattedLabel:function(e,t){var n=this._data.getName(e),r=this.getRegionModel(n),i=r.get("normal"===t?["label","formatter"]:["emphasis","label","formatter"]);null==i&&(i=r.get(["label","formatter"]));var o={name:n};if("function"===typeof i)return o.status=t,i(o);if("string"===typeof i){var a=o.seriesName;return i.replace("{a}",null!=a?a:"")}return n},defaultOption:{regions:[]}});i.a.util.merge(c.prototype,u["a"]),i.a.util.merge(c.prototype,o["a"]),i.a.util.merge(c.prototype,a["a"]),i.a.util.merge(c.prototype,s["a"]),i.a.util.merge(c.prototype,l["a"])},function(e,t,n){"use strict";var r=n(64),i=n(0),o=n.n(i),a=n(1),s=n(45),l=n(30);o.a.extendComponentView({type:"geo3D",__ecgl__:!0,init:function(e,t){this._geo3DBuilder=new r["a"](t),this.groupGL=new a["a"].Node,this._lightRoot=new a["a"].Node,this._sceneHelper=new l["a"](this._lightRoot),this._sceneHelper.initLight(this._lightRoot),this._control=new s["a"]({zr:t.getZr()}),this._control.init()},render:function(e,t,n){this.groupGL.add(this._geo3DBuilder.rootNode);var r=e.coordinateSystem;if(r&&r.viewGL){r.viewGL.add(this._lightRoot),e.get("show")?r.viewGL.add(this.groupGL):r.viewGL.remove(this.groupGL);var i=this._control;i.setViewGL(r.viewGL);var o=e.getModel("viewControl");i.setFromViewControlModel(o,0),this._sceneHelper.setScene(r.viewGL.scene),this._sceneHelper.updateLight(e),r.viewGL.setPostEffect(e.getModel("postEffect"),n),r.viewGL.setTemporalSuperSampling(e.getModel("temporalSuperSampling")),this._geo3DBuilder.update(e,t,n,0,e.getData().count());var a=r.viewGL.isLinearSpace()?"define":"undefine";this._geo3DBuilder.rootNode.traverse((function(e){e.material&&e.material[a]("fragment","SRGB_DECODE")})),i.off("update"),i.on("update",(function(){n.dispatchAction({type:"geo3DChangeCamera",alpha:i.getAlpha(),beta:i.getBeta(),distance:i.getDistance(),center:i.getCenter(),from:this.uid,geo3DId:e.id})})),i.update()}},afterRender:function(e,t,n,r){var i=r.renderer;this._sceneHelper.updateAmbientCubemap(i,e,n),this._sceneHelper.updateSkybox(i,e,n)},dispose:function(){this._control.dispose()}})},function(e,t,n){"use strict";function r(e,t,n){n=n||2;var r,o,s,l,u,c,f,h=t&&t.length,p=h?t[0]*n:e.length,m=i(e,0,p,n,!0),v=[];if(!m)return v;if(h&&(m=d(e,t,m,n)),e.length>80*n){r=s=e[0],o=l=e[1];for(var g=n;g<p;g+=n)u=e[g],c=e[g+1],u<r&&(r=u),c<o&&(o=c),u>s&&(s=u),c>l&&(l=c);f=Math.max(s-r,l-o)}return a(m,v,n,r,o,f),v}function i(e,t,n,r,i){var o,a;if(i===D(e,t,n,r)>0)for(o=t;o<n;o+=r)a=M(o,e[o],e[o+1],a);else for(o=n-r;o>=t;o-=r)a=M(o,e[o],e[o+1],a);return a&&w(a,a.next)&&(L(a),a=a.next),a}function o(e,t){if(!e)return e;t||(t=e);var n,r=e;do{if(n=!1,r.steiner||!w(r,r.next)&&0!==b(r.prev,r,r.next))r=r.next;else{if(L(r),r=t=r.prev,r===r.next)return null;n=!0}}while(n||r!==t);return t}function a(e,t,n,r,i,d,f){if(e){!f&&d&&m(e,r,i,d);var h,p,v=e;while(e.prev!==e.next)if(h=e.prev,p=e.next,d?l(e,r,i,d):s(e))t.push(h.i/n),t.push(e.i/n),t.push(p.i/n),L(e),e=p.next,v=p.next;else if(e=p,e===v){f?1===f?(e=u(e,t,n),a(e,t,n,r,i,d,2)):2===f&&c(e,t,n,r,i,d):a(o(e),t,n,r,i,d,1);break}}}function s(e){var t=e.prev,n=e,r=e.next;if(b(t,n,r)>=0)return!1;var i=e.next.next;while(i!==e.prev){if(_(t.x,t.y,n.x,n.y,r.x,r.y,i.x,i.y)&&b(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function l(e,t,n,r){var i=e.prev,o=e,a=e.next;if(b(i,o,a)>=0)return!1;var s=i.x<o.x?i.x<a.x?i.x:a.x:o.x<a.x?o.x:a.x,l=i.y<o.y?i.y<a.y?i.y:a.y:o.y<a.y?o.y:a.y,u=i.x>o.x?i.x>a.x?i.x:a.x:o.x>a.x?o.x:a.x,c=i.y>o.y?i.y>a.y?i.y:a.y:o.y>a.y?o.y:a.y,d=g(s,l,t,n,r),f=g(u,c,t,n,r),h=e.nextZ;while(h&&h.z<=f){if(h!==e.prev&&h!==e.next&&_(i.x,i.y,o.x,o.y,a.x,a.y,h.x,h.y)&&b(h.prev,h,h.next)>=0)return!1;h=h.nextZ}h=e.prevZ;while(h&&h.z>=d){if(h!==e.prev&&h!==e.next&&_(i.x,i.y,o.x,o.y,a.x,a.y,h.x,h.y)&&b(h.prev,h,h.next)>=0)return!1;h=h.prevZ}return!0}function u(e,t,n){var r=e;do{var i=r.prev,o=r.next.next;!w(i,o)&&A(i,r,r.next,o)&&S(i,o)&&S(o,i)&&(t.push(i.i/n),t.push(r.i/n),t.push(o.i/n),L(r),L(r.next),r=e=o),r=r.next}while(r!==e);return r}function c(e,t,n,r,i,s){var l=e;do{var u=l.next.next;while(u!==l.prev){if(l.i!==u.i&&x(l,u)){var c=C(l,u);return l=o(l,l.next),c=o(c,c.next),a(l,t,n,r,i,s),void a(c,t,n,r,i,s)}u=u.next}l=l.next}while(l!==e)}function d(e,t,n,r){var a,s,l,u,c,d=[];for(a=0,s=t.length;a<s;a++)l=t[a]*r,u=a<s-1?t[a+1]*r:e.length,c=i(e,l,u,r,!1),c===c.next&&(c.steiner=!0),d.push(y(c));for(d.sort(f),a=0;a<d.length;a++)h(d[a],n),n=o(n,n.next);return n}function f(e,t){return e.x-t.x}function h(e,t){if(t=p(e,t),t){var n=C(t,e);o(n,n.next)}}function p(e,t){var n,r=t,i=e.x,o=e.y,a=-1/0;do{if(o<=r.y&&o>=r.next.y&&r.next.y!==r.y){var s=r.x+(o-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=i&&s>a){if(a=s,s===i){if(o===r.y)return r;if(o===r.next.y)return r.next}n=r.x<r.next.x?r:r.next}}r=r.next}while(r!==t);if(!n)return null;if(i===a)return n.prev;var l,u=n,c=n.x,d=n.y,f=1/0;r=n.next;while(r!==u)i>=r.x&&r.x>=c&&i!==r.x&&_(o<d?i:a,o,c,d,o<d?a:i,o,r.x,r.y)&&(l=Math.abs(o-r.y)/(i-r.x),(l<f||l===f&&r.x>n.x)&&S(r,e)&&(n=r,f=l)),r=r.next;return n}function m(e,t,n,r){var i=e;do{null===i.z&&(i.z=g(i.x,i.y,t,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,v(i)}function v(e){var t,n,r,i,o,a,s,l,u=1;do{n=e,e=null,o=null,a=0;while(n){for(a++,r=n,s=0,t=0;t<u;t++)if(s++,r=r.nextZ,!r)break;l=u;while(s>0||l>0&&r)0!==s&&(0===l||!r||n.z<=r.z)?(i=n,n=n.nextZ,s--):(i=r,r=r.nextZ,l--),o?o.nextZ=i:e=i,i.prevZ=o,o=i;n=r}o.nextZ=null,u*=2}while(a>1);return e}function g(e,t,n,r,i){return e=32767*(e-n)/i,t=32767*(t-r)/i,e=16711935&(e|e<<8),e=252645135&(e|e<<4),e=858993459&(e|e<<2),e=1431655765&(e|e<<1),t=16711935&(t|t<<8),t=252645135&(t|t<<4),t=858993459&(t|t<<2),t=1431655765&(t|t<<1),e|t<<1}function y(e){var t=e,n=e;do{t.x<n.x&&(n=t),t=t.next}while(t!==e);return n}function _(e,t,n,r,i,o,a,s){return(i-a)*(t-s)-(e-a)*(o-s)>=0&&(e-a)*(r-s)-(n-a)*(t-s)>=0&&(n-a)*(o-s)-(i-a)*(r-s)>=0}function x(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!T(e,t)&&S(e,t)&&S(t,e)&&E(e,t)}function b(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function w(e,t){return e.x===t.x&&e.y===t.y}function A(e,t,n,r){return!!(w(e,t)&&w(n,r)||w(e,r)&&w(n,t))||b(e,t,n)>0!==b(e,t,r)>0&&b(n,r,e)>0!==b(n,r,t)>0}function T(e,t){var n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&A(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}function S(e,t){return b(e.prev,e,e.next)<0?b(e,t,e.next)>=0&&b(e,e.prev,t)>=0:b(e,t,e.prev)<0||b(e,e.next,t)<0}function E(e,t){var n=e,r=!1,i=(e.x+t.x)/2,o=(e.y+t.y)/2;do{n.y>o!==n.next.y>o&&n.next.y!==n.y&&i<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==e);return r}function C(e,t){var n=new N(e.i,e.x,e.y),r=new N(t.i,t.x,t.y),i=e.next,o=t.prev;return e.next=t,t.prev=e,n.next=i,i.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r}function M(e,t,n,r){var i=new N(e,t,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function L(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function N(e,t,n){this.i=e,this.x=t,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function D(e,t,n,r){for(var i=0,o=t,a=n-r;o<n;o+=r)i+=(e[a]-e[o])*(e[o+1]+e[a+1]),a=o;return i}t["a"]=r,r.deviation=function(e,t,n,r){var i=t&&t.length,o=i?t[0]*n:e.length,a=Math.abs(D(e,0,o,n));if(i)for(var s=0,l=t.length;s<l;s++){var u=t[s]*n,c=s<l-1?t[s+1]*n:e.length;a-=Math.abs(D(e,u,c,n))}var d=0;for(s=0;s<r.length;s+=3){var f=r[s]*n,h=r[s+1]*n,p=r[s+2]*n;d+=Math.abs((e[f]-e[p])*(e[h+1]-e[f+1])-(e[f]-e[h])*(e[p+1]-e[f+1]))}return 0===a&&0===d?0:Math.abs((d-a)/a)}},function(e,t,n){var r=n(13),i={"南海诸岛":[32,80],"广东":[0,-10],"香港":[10,5],"澳门":[-10,10],"天津":[5,5]};function o(e){r.each(e.regions,(function(e){var t=i[e.name];if(t){var n=e.center;n[0]+=t[0]/10.5,n[1]+=-t[1]/14}}))}e.exports=o},function(e,t,n){var r=n(13),i={Russia:[100,60],"United States":[-99,38],"United States of America":[-99,38]};function o(e){r.each(e.regions,(function(e){var t=i[e.name];if(t){var n=e.center;n[0]=t[0],n[1]=t[1]}}))}e.exports=o},function(e,t,n){"use strict";var r=n(0),i=n.n(r);n(208),n(209),n(211);i.a.registerAction({type:"globeChangeCamera",event:"globecamerachanged",update:"series:updateCamera"},(function(e,t){t.eachComponent({mainType:"globe",query:e},(function(t){t.setView(e)}))})),i.a.registerAction({type:"globeUpdateDisplacment",event:"globedisplacementupdated",update:"update"},(function(e,t){}))},function(e,t,n){"use strict";var r=n(0),i=n.n(r),o=n(44),a=n(28),s=n(29),l=n(31);function u(e,t){e.id=e.id||e.name||t+""}var c=i.a.extendComponentModel({type:"globe",layoutMode:"box",coordinateSystem:null,init:function(){c.superApply(this,"init",arguments),i.a.util.each(this.option.layers,(function(e,t){i.a.util.merge(e,this.defaultLayerOption),u(e,t)}),this)},mergeOption:function(e){var t=this.option.layers;function n(e){return i.a.util.reduce(e,(function(e,t,n){return u(t,n),e[t.id]=t,e}),{})}if(this.option.layers=null,c.superApply(this,"mergeOption",arguments),t&&t.length){var r=n(e.layers),o=n(t);for(var a in r)o[a]?i.a.util.merge(o[a],r[a],!0):t.push(e.layers[a]);this.option.layers=t}i.a.util.each(this.option.layers,(function(e){i.a.util.merge(e,this.defaultLayerOption)}),this)},optionUpdated:function(){this.updateDisplacementHash()},defaultLayerOption:{show:!0,type:"overlay"},defaultOption:{show:!0,zlevel:-10,left:0,top:0,width:"100%",height:"100%",environment:"auto",baseColor:"#fff",baseTexture:"",heightTexture:"",displacementTexture:"",displacementScale:0,displacementQuality:"medium",globeRadius:100,globeOuterRadius:150,shading:"lambert",light:{main:{time:""}},viewControl:{autoRotate:!0,panSensitivity:0,targetCoord:null},layers:[]},setDisplacementData:function(e,t,n){this.displacementData=e,this.displacementWidth=t,this.displacementHeight=n},getDisplacementTexture:function(){return this.get("displacementTexture")||this.get("heightTexture")},getDisplacemenScale:function(){var e=this.getDisplacementTexture(),t=this.get("displacementScale");return e&&"none"!==e||(t=0),t},hasDisplacement:function(){return this.getDisplacemenScale()>0},_displacementChanged:!0,_displacementScale:0,updateDisplacementHash:function(){var e=this.getDisplacementTexture(),t=this.getDisplacemenScale();this._displacementChanged=this._displacementTexture!==e||this._displacementScale!==t,this._displacementTexture=e,this._displacementScale=t},isDisplacementChanged:function(){return this._displacementChanged}});i.a.util.merge(c.prototype,o["a"]),i.a.util.merge(c.prototype,a["a"]),i.a.util.merge(c.prototype,s["a"]),i.a.util.merge(c.prototype,l["a"])},function(e,t,n){"use strict";var r=n(0),i=n.n(r),o=n(1),a=n(45),s=n(30),l=n(210),u=n(2);i.a.extendComponentView({type:"globe",__ecgl__:!0,_displacementScale:0,init:function(e,t){this.groupGL=new o["a"].Node,this._sphereGeometry=new o["a"].SphereGeometry({widthSegments:200,heightSegments:100,dynamic:!0}),this._overlayGeometry=new o["a"].SphereGeometry({widthSegments:80,heightSegments:40}),this._planeGeometry=new o["a"].PlaneGeometry,this._earthMesh=new o["a"].Mesh({renderNormal:!0}),this._lightRoot=new o["a"].Node,this._sceneHelper=new s["a"],this._sceneHelper.initLight(this._lightRoot),this.groupGL.add(this._earthMesh),this._control=new a["a"]({zr:t.getZr()}),this._control.init(),this._layerMeshes={}},render:function(e,t,n){var r=e.coordinateSystem,i=e.get("shading");r.viewGL.add(this._lightRoot),e.get("show")?r.viewGL.add(this.groupGL):r.viewGL.remove(this.groupGL),this._sceneHelper.setScene(r.viewGL.scene),r.viewGL.setPostEffect(e.getModel("postEffect"),n),r.viewGL.setTemporalSuperSampling(e.getModel("temporalSuperSampling"));var a=this._earthMesh;a.geometry=this._sphereGeometry;var s="ecgl."+i;a.material&&a.material.shader.name===s||(a.material=o["a"].createMaterial(s)),o["a"].setMaterialFromModel(i,a.material,e,n),["roughnessMap","metalnessMap","detailMap","normalMap"].forEach((function(e){var t=a.material.get(e);t&&(t.flipY=!1)})),a.material.set("color",o["a"].parseColor(e.get("baseColor")));var l=.99*r.radius;a.scale.set(l,l,l);var u=a.material.setTextureImage("diffuseMap",e.get("baseTexture"),n,{flipY:!1,anisotropic:8});u&&u.surface&&u.surface.attachToMesh(a);var c=a.material.setTextureImage("bumpMap",e.get("heightTexture"),n,{flipY:!1,anisotropic:8});c&&c.surface&&c.surface.attachToMesh(a),a.material[e.get("postEffect.enable")?"define":"undefine"]("fragment","SRGB_DECODE"),this._updateLight(e,n),this._displaceVertices(e,n),this._updateViewControl(e,n),this._updateLayers(e,n)},afterRender:function(e,t,n,r){var i=r.renderer;this._sceneHelper.updateAmbientCubemap(i,e,n),this._sceneHelper.updateSkybox(i,e,n)},_updateLayers:function(e,t){var n=e.coordinateSystem,r=e.get("layers"),a=n.radius,s=[],l=[],c=[],d=[];i.a.util.each(r,(function(e){var r=new i.a.Model(e),f=r.get("type"),h=o["a"].loadTexture(r.get("texture"),t,{flipY:!1,anisotropic:8});if(h.surface&&h.surface.attachToMesh(this._earthMesh),"blend"===f){var p=r.get("blendTo"),m=u["a"].firstNotNull(r.get("intensity"),1);"emission"===p?(c.push(h),d.push(m)):(s.push(h),l.push(m))}else{var v=r.get("id"),g=this._layerMeshes[v];g||(g=this._layerMeshes[v]=new o["a"].Mesh({geometry:this._overlayGeometry,castShadow:!1,ignorePicking:!0}));var y=r.get("shading");"lambert"===y?(g.material=g.__lambertMaterial||new o["a"].Material({autoUpdateTextureStatus:!1,shader:o["a"].createShader("ecgl.lambert"),transparent:!0,depthMask:!1}),g.__lambertMaterial=g.material):(g.material=g.__colorMaterial||new o["a"].Material({autoUpdateTextureStatus:!1,shader:o["a"].createShader("ecgl.color"),transparent:!0,depthMask:!1}),g.__colorMaterial=g.material),g.material.enableTexture("diffuseMap");var _=r.get("distance"),x=a+(null==_?n.radius/100:_);g.scale.set(x,x,x),a=x;var b=this._blankTexture||(this._blankTexture=o["a"].createBlankTexture("rgba(255, 255, 255, 0)"));g.material.set("diffuseMap",b),o["a"].loadTexture(r.get("texture"),t,{flipY:!1,anisotropic:8},(function(e){e.surface&&e.surface.attachToMesh(g),g.material.set("diffuseMap",e),t.getZr().refresh()})),r.get("show")?this.groupGL.add(g):this.groupGL.remove(g)}}),this);var f=this._earthMesh.material;f.define("fragment","LAYER_DIFFUSEMAP_COUNT",s.length),f.define("fragment","LAYER_EMISSIVEMAP_COUNT",c.length),f.set("layerDiffuseMap",s),f.set("layerDiffuseIntensity",l),f.set("layerEmissiveMap",c),f.set("layerEmissionIntensity",d);var h=e.getModel("debug.wireframe");if(h.get("show")){f.define("both","WIREFRAME_TRIANGLE");var p=o["a"].parseColor(h.get("lineStyle.color")||"rgba(0,0,0,0.5)"),m=u["a"].firstNotNull(h.get("lineStyle.width"),1);f.set("wireframeLineWidth",m),f.set("wireframeLineColor",p)}else f.undefine("both","WIREFRAME_TRIANGLE")},_updateViewControl:function(e,t){var n=e.coordinateSystem,r=e.getModel("viewControl"),i=(n.viewGL.camera,this);function o(){return{type:"globeChangeCamera",alpha:a.getAlpha(),beta:a.getBeta(),distance:a.getDistance()-n.radius,center:a.getCenter(),from:i.uid,globeId:e.id}}var a=this._control;a.setViewGL(n.viewGL);var s,l,u=r.get("targetCoord");null!=u&&(l=u[0]+90,s=u[1]),a.setFromViewControlModel(r,{baseDistance:n.radius,alpha:s,beta:l}),a.off("update"),a.on("update",(function(){t.dispatchAction(o())}))},_displaceVertices:function(e,t){var n=e.get("displacementQuality"),r=e.get("debug.wireframe.show"),i=e.coordinateSystem;if(e.isDisplacementChanged()||n!==this._displacementQuality||r!==this._showDebugWireframe){this._displacementQuality=n,this._showDebugWireframe=r;var o=this._sphereGeometry,a={low:100,medium:200,high:400,ultra:800}[n]||200,s=a/2;(o.widthSegments!==a||r)&&(o.widthSegments=a,o.heightSegments=s,o.build()),this._doDisplaceVertices(o,i),r&&o.generateBarycentric()}},_doDisplaceVertices:function(e,t){var n=e.attributes.position.value,r=e.attributes.texcoord0.value,i=e.__originalPosition;i&&i.length===n.length||(i=new Float32Array(n.length),i.set(n),e.__originalPosition=i);for(var o=t.displacementWidth,a=t.displacementHeight,s=t.displacementData,l=0;l<e.vertexCount;l++){var u=3*l,c=2*l,d=i[u+1],f=i[u+2],h=i[u+3],p=r[c++],m=r[c++],v=Math.round(p*(o-1)),g=Math.round(m*(a-1)),y=g*o+v,_=s?s[y]:0;n[u+1]=d+d*_,n[u+2]=f+f*_,n[u+3]=h+h*_}e.generateVertexNormals(),e.dirty(),e.updateBoundingBox()},_updateLight:function(e,t){var n=this._earthMesh;this._sceneHelper.updateLight(e);var r=this._sceneHelper.mainLight,o=e.get("light.main.time")||new Date,a=l["a"].getPosition(i.a.number.parseDate(o),0,0),s=Math.cos(a.altitude);r.position.y=-s*Math.cos(a.azimuth),r.position.x=Math.sin(a.altitude),r.position.z=s*Math.sin(a.azimuth),r.lookAt(n.getWorldPosition())},dispose:function(e,t){this.groupGL.removeAll(),this._control.dispose()}})},function(e,t,n){"use strict";var r=Math.PI,i=Math.sin,o=Math.cos,a=Math.tan,s=Math.asin,l=Math.atan2,u=r/180,c=864e5,d=2440588,f=2451545;function h(e){return e.valueOf()/c-.5+d}function p(e){return h(e)-f}var m=23.4397*u;function v(e,t){return l(i(e)*o(m)-a(t)*i(m),o(e))}function g(e,t){return s(i(t)*o(m)+o(t)*i(m)*i(e))}function y(e,t,n){return l(i(e),o(e)*i(t)-a(n)*o(t))}function _(e,t,n){return s(i(t)*i(n)+o(t)*o(n)*o(e))}function x(e,t){return u*(280.16+360.9856235*e)-t}function b(e){return u*(357.5291+.98560028*e)}function w(e){var t=u*(1.9148*i(e)+.02*i(2*e)+3e-4*i(3*e)),n=102.9372*u;return e+t+n+r}function A(e){var t=b(e),n=w(t);return{dec:g(n,0),ra:v(n,0)}}var T={getPosition:function(e,t,n){var r=u*-n,i=u*t,o=p(e),a=A(o),s=x(o,r)-a.ra;return{azimuth:y(s,i,a.dec),altitude:_(s,i,a.dec)}}};t["a"]=T},function(e,t,n){"use strict";var r=n(212),i=n(0),o=n.n(i),a=n(47),s=n.n(a),l=n(22),u=n(2),c=n(1);function d(e,t){var n=document.createElement("canvas"),r=n.getContext("2d"),i=e.width,o=e.height;n.width=i,n.height=o,r.drawImage(e,0,0,i,o);for(var a=r.getImageData(0,0,i,o).data,s=new Float32Array(a.length/4),l=0;l<a.length/4;l++){var u=a[4*l];s[l]=u/255*t}return{data:s,width:i,height:o}}function f(e,t){var n=e.getBoxLayoutParams(),r=s.a.getLayoutRect(n,{width:t.getWidth(),height:t.getHeight()});r.y=t.getHeight()-r.y-r.height,this.viewGL.setViewport(r.x,r.y,r.width,r.height,t.getDevicePixelRatio()),this.radius=e.get("globeRadius");var i=e.get("globeOuterRadius");this.altitudeAxis&&this.altitudeAxis.setExtent(0,i-this.radius)}function h(e,t){var n=[1/0,-1/0];if(e.eachSeries((function(e){if(e.coordinateSystem===this){var t=e.getData(),r=e.coordDimToDataDim("alt"),i=r&&r[0];if(i){var o=t.getDataExtent(i,!0);n[0]=Math.min(n[0],o[0]),n[1]=Math.max(n[1],o[1])}}}),this),n&&isFinite(n[1]-n[0])){var r=o.a.helper.createScale(n,{type:"value",min:"dataMin",max:"dataMax"});this.altitudeAxis=new o.a.Axis("altitude",r),this.resize(this.model,t)}}var p={dimensions:r["a"].prototype.dimensions,create:function(e,t){var n=[];return e.eachComponent("globe",(function(e){e.__viewGL=e.__viewGL||new l["a"];var i=new r["a"];i.viewGL=e.__viewGL,e.coordinateSystem=i,i.model=e,n.push(i),i.resize=f,i.resize(e,t),i.update=h})),e.eachSeries((function(t){if("globe"===t.get("coordinateSystem")){var n=t.getReferringComponents("globe")[0];if(n||(n=e.getComponent("globe")),!n)throw new Error('globe "'+u["a"].firstNotNull(t.get("globe3DIndex"),t.get("globe3DId"),0)+'" not found');var r=n.coordinateSystem;t.coordinateSystem=r}})),e.eachComponent("globe",(function(e,n){var r=e.coordinateSystem,i=e.getDisplacementTexture(),o=e.getDisplacemenScale();if(e.isDisplacementChanged()){if(e.hasDisplacement()){var a=!0;c["a"].loadTexture(i,t,(function(n){var r=n.image,i=d(r,o);e.setDisplacementData(i.data,i.width,i.height),a||t.dispatchAction({type:"globeUpdateDisplacment"})})),a=!1}else r.setDisplacementData(null,0,0);r.setDisplacementData(e.displacementData,e.displacementWidth,e.displacementHeight)}})),n}};o.a.registerCoordinateSystem("globe",p)},function(e,t,n){"use strict";var r=n(6),i=r["a"].vec3;function o(e){this.radius=e,this.viewGL=null,this.altitudeAxis,this.displacementData=null,this.displacementWidth,this.displacementHeight}o.prototype={constructor:o,dimensions:["lng","lat","alt"],type:"globe",containPoint:function(){},setDisplacementData:function(e,t,n){this.displacementData=e,this.displacementWidth=t,this.displacementHeight=n},_getDisplacementScale:function(e,t){var n=(e+180)/360*(this.displacementWidth-1),r=(90-t)/180*(this.displacementHeight-1),i=Math.round(n)+Math.round(r)*this.displacementWidth;return this.displacementData[i]},dataToPoint:function(e,t){var n=e[0],r=e[1],i=e[2]||0,o=this.radius;this.displacementData&&(o*=1+this._getDisplacementScale(n,r)),this.altitudeAxis&&(o+=this.altitudeAxis.dataToCoord(i)),n=n*Math.PI/180,r=r*Math.PI/180;var a=Math.cos(r)*o;return t=t||[],t[0]=-a*Math.cos(n+Math.PI),t[1]=Math.sin(r)*o,t[2]=a*Math.sin(n+Math.PI),t},pointToData:function(e,t){var n=e[0],r=e[1],o=e[2],a=i.len(e);n/=a,r/=a,o/=a;var s=Math.asin(r),l=Math.atan2(o,-n);l<0&&(l=2*Math.PI+l);var u=180*s/Math.PI,c=180*l/Math.PI-180;return t=t||[],t[0]=c,t[1]=u,t[2]=a-this.radius,this.altitudeAxis&&(t[2]=this.altitudeAxis.coordToData(t[2])),t}},t["a"]=o},function(e,t,n){"use strict";var r=n(0),i=n.n(r);n(214),n(216),n(217);i.a.registerAction({type:"mapbox3DChangeCamera",event:"mapbox3dcamerachanged",update:"mapbox3D:updateCamera"},(function(e,t){t.eachComponent({mainType:"mapbox3D",query:e},(function(t){t.setMapboxCameraOption(e)}))}))},function(e,t,n){"use strict";var r=n(215),i=n(0),o=n.n(i),a=n(101),s=Object(a["a"])("mapbox3D",r["a"],(function(e){e.forEach((function(e){e.setCameraOption(e.model.getMapboxCameraOption())}))}));o.a.registerCoordinateSystem("mapbox3D",s)},function(e,t,n){"use strict";var r=n(100);function i(){r["a"].apply(this,arguments)}i.prototype=new r["a"],i.prototype.constructor=i,i.prototype.type="mapbox3D",t["a"]=i},function(e,t,n){"use strict";var r=n(0),i=n.n(r),o=n(28),a=n(29),s=["zoom","center","pitch","bearing"],l=i.a.extendComponentModel({type:"mapbox3D",layoutMode:"box",coordinateSystem:null,defaultOption:{zlevel:-10,style:"mapbox://styles/mapbox/light-v9",center:[0,0],zoom:0,pitch:0,bearing:0,light:{main:{alpha:20,beta:30}},altitudeScale:1,boxHeight:"auto"},getMapboxCameraOption:function(){var e=this;return s.reduce((function(t,n){return t[n]=e.get(n),t}),{})},setMapboxCameraOption:function(e){null!=e&&s.forEach((function(t){null!=e[t]&&(this.option[t]=e[t])}),this)},getMapbox:function(){return this._mapbox},setMapbox:function(e){this._mapbox=e}});i.a.util.merge(l.prototype,o["a"]),i.a.util.merge(l.prototype,a["a"])},function(e,t,n){"use strict";var r=n(0),i=n.n(r),o=n(218),a=n(30),s=n(1),l=n(102);s["a"].Shader.import(l["a"]);i.a.extendComponentView({type:"mapbox3D",__ecgl__:!0,init:function(e,t){var n=t.getZr();this._zrLayer=new o["a"]("mapbox3D",n),n.painter.insertLayer(-1e3,this._zrLayer),this._lightRoot=new s["a"].Node,this._sceneHelper=new a["a"](this._lightRoot),this._sceneHelper.initLight(this._lightRoot);var r=this._zrLayer.getMapbox(),i=this._dispatchInteractAction.bind(this,t,r);["zoom","rotate","drag","pitch","rotate","move"].forEach((function(e){r.on(e,i)})),this._groundMesh=new s["a"].Mesh({geometry:new s["a"].PlaneGeometry,material:new s["a"].Material({shader:new s["a"].Shader({vertex:s["a"].Shader.source("ecgl.displayShadow.vertex"),fragment:s["a"].Shader.source("ecgl.displayShadow.fragment")}),depthMask:!1}),renderOrder:-100,culling:!1,castShadow:!1,$ignorePicking:!0,renderNormal:!0})},render:function(e,t,n){var r=this._zrLayer.getMapbox(),i=e.get("style"),o=JSON.stringify(i);o!==this._oldStyleStr&&i&&r.setStyle(i),this._oldStyleStr=o,r.setCenter(e.get("center")),r.setZoom(e.get("zoom")),r.setPitch(e.get("pitch")),r.setBearing(e.get("bearing")),e.setMapbox(r);var a=e.coordinateSystem;a.viewGL.scene.add(this._lightRoot),a.viewGL.add(this._groundMesh),this._updateGroundMesh(),this._sceneHelper.setScene(a.viewGL.scene),this._sceneHelper.updateLight(e),a.viewGL.setPostEffect(e.getModel("postEffect"),n),a.viewGL.setTemporalSuperSampling(e.getModel("temporalSuperSampling")),this._mapbox3DModel=e},afterRender:function(e,t,n,r){var i=r.renderer;this._sceneHelper.updateAmbientCubemap(i,e,n),this._sceneHelper.updateSkybox(i,e,n),e.coordinateSystem.viewGL.scene.traverse((function(e){e.material&&(e.material.define("fragment","NORMAL_UP_AXIS",2),e.material.define("fragment","NORMAL_FRONT_AXIS",1))}))},updateCamera:function(e,t,n,r){e.coordinateSystem.setCameraOption(r),this._updateGroundMesh(),n.getZr().refresh()},_dispatchInteractAction:function(e,t,n){e.dispatchAction({type:"mapbox3DChangeCamera",pitch:t.getPitch(),zoom:t.getZoom(),center:t.getCenter().toArray(),bearing:t.getBearing(),mapbox3DId:this._mapbox3DModel&&this._mapbox3DModel.id})},_updateGroundMesh:function(){if(this._mapbox3DModel){var e=this._mapbox3DModel.coordinateSystem,t=e.dataToPoint(e.center);this._groundMesh.position.set(t[0],t[1],-.001);var n=new s["a"].Plane(new s["a"].Vector3(0,0,1),0),r=e.viewGL.camera.castRay(new s["a"].Vector2(-1,-1)),i=e.viewGL.camera.castRay(new s["a"].Vector2(1,1)),o=r.intersectPlane(n),a=i.intersectPlane(n),l=o.dist(a)/e.viewGL.rootNode.scale.x;this._groundMesh.scale.set(l,l,1)}},dispose:function(e,t){this._zrLayer&&this._zrLayer.dispose(),t.getZr().painter.delLayer(-1e3)}})},function(e,t,n){"use strict";function r(e,t){if(this.id=e,this.zr=t,this.dom=document.createElement("div"),this.dom.style.cssText="position:absolute;left:0;right:0;top:0;bottom:0;",!mapboxgl)throw new Error("Mapbox GL library must be included. See https://www.mapbox.com/mapbox-gl-js/api/");this._mapbox=new mapboxgl.Map({container:this.dom}),this._initEvents()}r.prototype.resize=function(){this._mapbox.resize()},r.prototype.getMapbox=function(){return this._mapbox},r.prototype.clear=function(){},r.prototype.refresh=function(){this._mapbox.resize()};var i=["mousedown","mouseup","click","dblclick","mousemove","mousewheel","wheel","touchstart","touchend","touchmove","touchcancel"];r.prototype._initEvents=function(){var e=this._mapbox.getCanvasContainer();this._handlers=this._handlers||{contextmenu:function(e){return e.preventDefault(),!1}},i.forEach((function(t){this._handlers[t]=function(t){var n={};for(var r in t)n[r]=t[r];n.bubbles=!1;var i=new t.constructor(t.type,n);e.dispatchEvent(i)},this.zr.dom.addEventListener(t,this._handlers[t])}),this),this.zr.dom.addEventListener("contextmenu",this._handlers.contextmenu)},r.prototype.dispose=function(){i.forEach((function(e){this.zr.dom.removeEventListener(e,this._handlers[e])}),this)},t["a"]=r},function(e,t,n){"use strict";var r=n(0),i=n.n(r);n(220),n(222),n(223);i.a.registerAction({type:"maptalks3DChangeCamera",event:"maptalks3dcamerachanged",update:"maptalks3D:updateCamera"},(function(e,t){t.eachComponent({mainType:"maptalks3D",query:e},(function(t){t.setMaptalksCameraOption(e)}))}))},function(e,t,n){"use strict";var r=n(221),i=n(0),o=n.n(i),a=n(101),s=Object(a["a"])("maptalks3D",r["a"],(function(e){e.forEach((function(e){e.setCameraOption(e.model.getMaptalksCameraOption())}))}));o.a.registerCoordinateSystem("maptalks3D",s)},function(e,t,n){"use strict";var r=n(100);function i(){r["a"].apply(this,arguments),this.maxPitch=85,this.zoomOffset=1}i.prototype=new r["a"],i.prototype.constructor=i,i.prototype.type="maptalks3D",t["a"]=i},function(e,t,n){"use strict";var r=n(0),i=n.n(r),o=n(28),a=n(29),s=["zoom","center","pitch","bearing"],l=i.a.extendComponentModel({type:"maptalks3D",layoutMode:"box",coordinateSystem:null,defaultOption:{zlevel:-10,urlTemplate:"http://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png",attribution:'&copy; <a href="http://osm.org">OpenStreetMap</a> contributors, &copy; <a href="https://carto.com/">CARTO</a>',center:[0,0],zoom:0,pitch:0,bearing:0,light:{main:{alpha:20,beta:30}},altitudeScale:1,boxHeight:"auto"},getMaptalksCameraOption:function(){var e=this;return s.reduce((function(t,n){return t[n]=e.get(n),t}),{})},setMaptalksCameraOption:function(e){null!=e&&s.forEach((function(t){null!=e[t]&&(this.option[t]=e[t])}),this)},getMaptalks:function(){return this._maptalks},setMaptalks:function(e){this._maptalks=e}});i.a.util.merge(l.prototype,o["a"]),i.a.util.merge(l.prototype,a["a"])},function(e,t,n){"use strict";var r=n(0),i=n.n(r),o=n(224),a=n(30),s=n(1),l=n(102);s["a"].Shader.import(l["a"]);i.a.extendComponentView({type:"maptalks3D",__ecgl__:!0,init:function(e,t){this._groundMesh=new s["a"].Mesh({geometry:new s["a"].PlaneGeometry,material:new s["a"].Material({shader:new s["a"].Shader({vertex:s["a"].Shader.source("ecgl.displayShadow.vertex"),fragment:s["a"].Shader.source("ecgl.displayShadow.fragment")}),depthMask:!1}),renderOrder:-100,culling:!1,castShadow:!1,$ignorePicking:!0,renderNormal:!0})},_initMaptalksLayer:function(e,t){var n=t.getZr();this._zrLayer=new o["a"]("maptalks3D",n,e.get("center"),e.get("zoom")),n.painter.insertLayer(-1e3,this._zrLayer),this._lightRoot=new s["a"].Node,this._sceneHelper=new a["a"](this._lightRoot),this._sceneHelper.initLight(this._lightRoot);var r=this._zrLayer.getMaptalks(),i=this._dispatchInteractAction.bind(this,t,r);["zoomend","zooming","zoomstart","dragrotating","pitch","pitchend","movestart","moving","moveend","resize","touchstart","touchmove","touchend"].forEach((function(e){r.on(e,i)}))},render:function(e,t,n){this._zrLayer||this._initMaptalksLayer(e,n);var r=this._zrLayer.getMaptalks(),i=e.get("urlTemplate"),o=r.getBaseLayer();i!==this._oldUrlTemplate&&(o?o.setOptions({urlTemplate:i,attribution:e.get("attribution")}):(o=new maptalks.TileLayer("maptalks-echarts-gl-baselayer",{urlTemplate:i,subdomains:["a","b","c"],attribution:e.get("attribution")}),r.setBaseLayer(o))),this._oldUrlTemplate=i,r.setCenter(e.get("center")),r.setZoom(e.get("zoom"),{animation:!1}),r.setPitch(e.get("pitch")),r.setBearing(e.get("bearing")),e.setMaptalks(r);var a=e.coordinateSystem;a.viewGL.scene.add(this._lightRoot),a.viewGL.add(this._groundMesh),this._updateGroundMesh(),this._sceneHelper.setScene(a.viewGL.scene),this._sceneHelper.updateLight(e),a.viewGL.setPostEffect(e.getModel("postEffect"),n),a.viewGL.setTemporalSuperSampling(e.getModel("temporalSuperSampling")),this._maptalks3DModel=e},afterRender:function(e,t,n,r){var i=r.renderer;this._sceneHelper.updateAmbientCubemap(i,e,n),this._sceneHelper.updateSkybox(i,e,n),e.coordinateSystem.viewGL.scene.traverse((function(e){e.material&&(e.material.define("fragment","NORMAL_UP_AXIS",2),e.material.define("fragment","NORMAL_FRONT_AXIS",1))}))},updateCamera:function(e,t,n,r){e.coordinateSystem.setCameraOption(r),this._updateGroundMesh(),n.getZr().refresh()},_dispatchInteractAction:function(e,t,n){e.dispatchAction({type:"maptalks3DChangeCamera",pitch:t.getPitch(),zoom:t.getZoom(),center:t.getCenter().toArray(),bearing:t.getBearing(),maptalks3DId:this._maptalks3DModel&&this._maptalks3DModel.id})},_updateGroundMesh:function(){if(this._maptalks3DModel){var e=this._maptalks3DModel.coordinateSystem,t=e.dataToPoint(e.center);this._groundMesh.position.set(t[0],t[1],-.001);var n=new s["a"].Plane(new s["a"].Vector3(0,0,1),0),r=e.viewGL.camera.castRay(new s["a"].Vector2(-1,-1)),i=e.viewGL.camera.castRay(new s["a"].Vector2(1,1)),o=r.intersectPlane(n),a=i.intersectPlane(n),l=o.dist(a)/e.viewGL.rootNode.scale.x;this._groundMesh.scale.set(l,l,1)}},dispose:function(e,t){this._zrLayer&&this._zrLayer.dispose(),t.getZr().painter.delLayer(-1e3)}})},function(e,t,n){"use strict";function r(e,t,n,r){if(this.id=e,this.zr=t,this.dom=document.createElement("div"),this.dom.style.cssText="position:absolute;left:0;right:0;top:0;bottom:0;",!maptalks)throw new Error("Maptalks library must be included. See https://maptalks.org");this._maptalks=new maptalks.Map(this.dom,{center:n,zoom:r,fog:!1}),this._initEvents()}r.prototype.resize=function(){this._maptalks.checkSize()},r.prototype.getMaptalks=function(){return this._maptalks},r.prototype.clear=function(){},r.prototype.refresh=function(){this._maptalks.checkSize()};var i=["mousedown","mouseup","click","dblclick","mousemove","mousewheel","DOMMouseScroll","touchstart","touchend","touchmove","touchcancel"];r.prototype._initEvents=function(){var e=this.dom;this._handlers=this._handlers||{contextmenu:function(e){return e.preventDefault(),!1}},i.forEach((function(t){this._handlers[t]=function(n){var r={};for(var i in n)r[i]=n[i];r.bubbles=!1;var o=new n.constructor(n.type,r);"mousewheel"===t||"DOMMouseScroll"===t?e.dispatchEvent(o):e.firstElementChild.dispatchEvent(o)},this.zr.dom.addEventListener(t,this._handlers[t])}),this),this.zr.dom.addEventListener("contextmenu",this._handlers.contextmenu)},r.prototype.dispose=function(){i.forEach((function(e){this.zr.dom.removeEventListener(e,this._handlers[e])}),this),this._maptalks.remove()},t["a"]=r},function(e,t,n){"use strict";var r=n(0),i=n.n(r),o=(n(226),n(229),n(231),n(17));i.a.registerVisual(Object(o["a"])("bar3D")),i.a.registerProcessor((function(e,t){e.eachSeriesByType("bar3d",(function(e){var t=e.getData();t.filterSelf((function(e){return t.hasValue(e)}))}))}))},function(e,t,n){"use strict";var r=n(0),i=n.n(r),o=n(3),a=n(6),s=n(227),l=n(228),u=a["a"].vec3,c=i.a.helper.dataStack.isDimensionStacked;function d(e,t){var n=e.getData(),r=e.get("minHeight")||0,a=e.get("barSize"),s=["lng","lat","alt"].map((function(t){return e.coordDimToDataDim(t)[0]}));if(null==a){var c=t.radius*Math.PI,d=Object(l["a"])(n,s[0],s[1]);a=[c/Math.sqrt(n.count()/d),c/Math.sqrt(n.count()/d)]}else i.a.util.isArray(a)||(a=[a,a]);var f=p(n,s);n.each(s,(function(e,i,o,s){var l=n.get(f.dimension,s),c=f.isStacked?l-o:t.altitudeAxis.scale.getExtent()[0],d=Math.max(t.altitudeAxis.dataToCoord(o),r),h=t.dataToPoint([e,i,c]),p=t.dataToPoint([e,i,l]),m=u.sub([],p,h);u.normalize(m,m);var v=[a[0],d,a[1]];n.setItemLayout(s,[h,m,v])})),n.setLayout("orient",o["a"].UP.array)}function f(e,t){var n=e.getData(),r=e.get("barSize"),o=e.get("minHeight")||0,a=["lng","lat","alt"].map((function(t){return e.coordDimToDataDim(t)[0]}));if(null==r){var s=Math.min(t.size[0],t.size[2]),u=Object(l["a"])(n,a[0],a[1]);r=[s/Math.sqrt(n.count()/u),s/Math.sqrt(n.count()/u)]}else i.a.util.isArray(r)||(r=[r,r]);var c=[0,1,0],d=p(n,a);n.each(a,(function(e,i,a,s){var l=n.get(d.dimension,s),u=d.isStacked?l-a:t.altitudeAxis.scale.getExtent()[0],f=Math.max(t.altitudeAxis.dataToCoord(a),o),h=t.dataToPoint([e,i,u]),p=[r[0],f,r[1]];n.setItemLayout(s,[h,c,p])})),n.setLayout("orient",[1,0,0])}function h(e,t){var n=e.getData(),r=e.coordDimToDataDim("lng")[0],o=e.coordDimToDataDim("lat")[0],a=e.coordDimToDataDim("alt")[0],s=e.get("barSize"),u=e.get("minHeight")||0;if(null==s){var c=n.getDataExtent(r),d=n.getDataExtent(o),f=t.dataToPoint([c[0],d[0]]),h=t.dataToPoint([c[1],d[1]]),m=Math.min(Math.abs(f[0]-h[0]),Math.abs(f[1]-h[1]))||1,v=Object(l["a"])(n,r,o);s=[m/Math.sqrt(n.count()/v),m/Math.sqrt(n.count()/v)]}else i.a.util.isArray(s)||(s=[s,s]),s[0]/=t.getScale()/16,s[1]/=t.getScale()/16;var g=[0,0,1],y=[r,o,a],_=p(n,y);n.each(y,(function(e,r,i,o){var a=n.get(_.dimension,o),l=_.isStacked?a-i:0,c=t.dataToPoint([e,r,l]),d=t.dataToPoint([e,r,a]),f=Math.max(d[2]-c[2],u),h=[s[0],f,s[1]];n.setItemLayout(o,[c,g,h])})),n.setLayout("orient",[1,0,0])}function p(e,t){var n=c(e,t[2]);return{dimension:n?e.getCalculationInfo("stackResultDimension"):t[2],isStacked:n}}i.a.registerLayout((function(e,t){e.eachSeriesByType("bar3D",(function(e){var t=e.coordinateSystem,n=t&&t.type;if("globe"===n)d(e,t);else if("cartesian3D"===n)Object(s["a"])(e,t);else if("geo3D"===n)f(e,t);else{if("mapbox3D"!==n&&"maptalks3D"!==n)throw t?new Error("bar3D doesn't support coordinate system "+t.type):new Error("bar3D doesn't have coordinate system.");h(e,t)}}))}))},function(e,t,n){"use strict";var r=n(0),i=n.n(r),o=n(6),a=o["a"].vec3,s=i.a.helper.dataStack.isDimensionStacked;function l(e){var t=e[0],n=e[1];return!(t>0&&n>0||t<0&&n<0)}function u(e,t){var n=e.getData(),r=e.get("barSize");if(null==r){var o,u,c=t.size,d=t.getAxis("x"),f=t.getAxis("y");o="category"===d.type?.7*d.getBandWidth():.6*Math.round(c[0]/Math.sqrt(n.count())),u="category"===f.type?.7*f.getBandWidth():.6*Math.round(c[1]/Math.sqrt(n.count())),r=[o,u]}else i.a.util.isArray(r)||(r=[r,r]);var h=t.getAxis("z").scale.getExtent(),p=l(h),m=["x","y","z"].map((function(t){return e.coordDimToDataDim(t)[0]})),v=s(n,m[2]),g=v?n.getCalculationInfo("stackResultDimension"):m[2];n.each(m,(function(e,i,o,s){var l=n.get(g,s),u=v?l-o:p?0:h[0],c=t.dataToPoint([e,i,u]),d=t.dataToPoint([e,i,l]),f=a.dist(c,d),m=[0,d[1]<c[1]?-1:1,0];0===Math.abs(f)&&(f=.1);var y=[r[0],f,r[1]];n.setItemLayout(s,[c,m,y])})),n.setLayout("orient",[1,0,0])}t["a"]=u},function(e,t,n){"use strict";t["a"]=function(e,t,n){for(var r=e.getDataExtent(t),i=e.getDataExtent(n),o=r[1]-r[0]||r[0],a=i[1]-i[0]||i[0],s=50,l=new Uint8Array(s*s),u=0;u<e.count();u++){var c=e.get(t,u),d=e.get(n,u),f=Math.floor((c-r[0])/o*(s-1)),h=Math.floor((d-i[0])/a*(s-1)),p=h*s+f;l[p]=l[p]||1}var m=0;for(u=0;u<l.length;u++)l[u]&&m++;return m/l.length}},function(e,t,n){"use strict";var r=n(0),i=n.n(r),o=n(1),a=n(2),s=n(32),l=n(230),u=n(66),c=n(6),d=c["a"].vec3;i.a.extendChartView({type:"bar3D",__ecgl__:!0,init:function(e,t){this.groupGL=new o["a"].Node,this._api=t,this._labelsBuilder=new u["a"](256,256,t);var n=this;this._labelsBuilder.getLabelPosition=function(e,t,r){if(n._data){var i=n._data.getItemLayout(e),o=i[0],a=i[1],s=i[2][1];return d.scaleAndAdd([],o,a,r+s)}return[0,0]},this._labelsBuilder.getMesh().renderOrder=100},render:function(e,t,n){var r=this._prevBarMesh;this._prevBarMesh=this._barMesh,this._barMesh=r,this._barMesh||(this._barMesh=new o["a"].Mesh({geometry:new l["a"],shadowDepthMaterial:new o["a"].Material({shader:new o["a"].Shader(o["a"].Shader.source("ecgl.sm.depth.vertex"),o["a"].Shader.source("ecgl.sm.depth.fragment"))}),culling:"cartesian3D"===e.coordinateSystem.type,renderOrder:10,renderNormal:!0})),this.groupGL.remove(this._prevBarMesh),this.groupGL.add(this._barMesh),this.groupGL.add(this._labelsBuilder.getMesh());var i=e.coordinateSystem;if(this._doRender(e,n),i&&i.viewGL){i.viewGL.add(this.groupGL);var a=i.viewGL.isLinearSpace()?"define":"undefine";this._barMesh.material[a]("fragment","SRGB_DECODE")}this._data=e.getData(),this._labelsBuilder.updateData(this._data),this._labelsBuilder.updateLabels(),this._updateAnimation(e)},_updateAnimation:function(e){o["a"].updateVertexAnimation([["prevPosition","position"],["prevNormal","normal"]],this._prevBarMesh,this._barMesh,e)},_doRender:function(e,t){var n=e.getData(),r=e.get("shading"),i="color"!==r,a=this,s=this._barMesh,l="ecgl."+r;s.material&&s.material.shader.name===l||(s.material=o["a"].createMaterial(l,["VERTEX_COLOR"])),o["a"].setMaterialFromModel(r,s.material,e,t),s.geometry.enableNormal=i,s.geometry.resetOffset();var u=e.get("bevelSize"),c=e.get("bevelSmoothness");s.geometry.bevelSegments=c,s.geometry.bevelSize=u;var d=[],f=new Float32Array(4*n.count()),h=0,p=0,m=!1;n.each((function(e){if(n.hasValue(e)){var t=n.getItemVisual(e,"color"),r=n.getItemVisual(e,"opacity");null==r&&(r=1),o["a"].parseColor(t,d),d[3]*=r,f[h++]=d[0],f[h++]=d[1],f[h++]=d[2],f[h++]=d[3],d[3]>0&&(p++,d[3]<.99&&(m=!0))}})),s.geometry.setBarCount(p);var v=n.getLayout("orient"),g=this._barIndexOfData=new Int32Array(n.count());p=0;n.each((function(e){if(n.hasValue(e)){var t=n.getItemLayout(e),r=t[0],i=t[1],o=t[2],s=4*e;d[0]=f[s++],d[1]=f[s++],d[2]=f[s++],d[3]=f[s++],d[3]>0&&(a._barMesh.geometry.addBar(r,i,v,o,d,e),g[e]=p++)}else g[e]=-1})),s.geometry.dirty(),s.geometry.updateBoundingBox();var y=s.material;y.transparent=m,y.depthMask=!m,s.geometry.sortTriangles=m,this._initHandler(e,t)},_initHandler:function(e,t){var n=e.getData(),r=this._barMesh,i="cartesian3D"===e.coordinateSystem.type;r.seriesIndex=e.seriesIndex;var o=-1;r.off("mousemove"),r.off("mouseout"),r.on("mousemove",(function(e){var a=r.geometry.getDataIndexOfVertex(e.triangle[0]);a!==o&&(this._downplay(o),this._highlight(a),this._labelsBuilder.updateLabels([a]),i&&t.dispatchAction({type:"grid3DShowAxisPointer",value:[n.get("x",a),n.get("y",a),n.get("z",a,!0)]})),o=a,r.dataIndex=a}),this),r.on("mouseout",(function(e){this._downplay(o),this._labelsBuilder.updateLabels(),o=-1,r.dataIndex=-1,i&&t.dispatchAction({type:"grid3DHideAxisPointer"})}),this)},_highlight:function(e){var t=this._data;if(t){var n=this._barIndexOfData[e];if(!(n<0)){var r=t.getItemModel(e),a=r.getModel("emphasis.itemStyle"),s=a.get("color"),l=a.get("opacity");if(null==s){var u=t.getItemVisual(e,"color");s=i.a.color.lift(u,-.4)}null==l&&(l=t.getItemVisual(e,"opacity"));var c=o["a"].parseColor(s);c[3]*=l,this._barMesh.geometry.setColor(n,c),this._api.getZr().refresh()}}},_downplay:function(e){var t=this._data;if(t){var n=this._barIndexOfData[e];if(!(n<0)){var r=t.getItemVisual(e,"color"),i=t.getItemVisual(e,"opacity"),a=o["a"].parseColor(r);a[3]*=i,this._barMesh.geometry.setColor(n,a),this._api.getZr().refresh()}}},highlight:function(e,t,n,r){this._toggleStatus("highlight",e,t,n,r)},downplay:function(e,t,n,r){this._toggleStatus("downplay",e,t,n,r)},_toggleStatus:function(e,t,n,r,o){var l=t.getData(),u=a["a"].queryDataIndex(l,o),c=this;null!=u?i.a.util.each(s["a"].normalizeToArray(u),(function(t){"highlight"===e?this._highlight(t):this._downplay(t)}),this):l.each((function(t){"highlight"===e?c._highlight(t):c._downplay(t)}))},remove:function(){this.groupGL.removeAll()},dispose:function(){this.groupGL.removeAll()}})},function(e,t,n){"use strict";var r=n(0),i=n.n(r),o=n(38),a=n(65),s=n(15),l=n(6),u=l["a"].vec3,c=l["a"].mat3,d=s["a"].extend((function(){return{attributes:{position:new s["a"].Attribute("position","float",3,"POSITION"),normal:new s["a"].Attribute("normal","float",3,"NORMAL"),color:new s["a"].Attribute("color","float",4,"COLOR"),prevPosition:new s["a"].Attribute("prevPosition","float",3),prevNormal:new s["a"].Attribute("prevNormal","float",3)},dynamic:!0,enableNormal:!1,bevelSize:1,bevelSegments:0,_dataIndices:null,_vertexOffset:0,_triangleOffset:0}}),{resetOffset:function(){this._vertexOffset=0,this._triangleOffset=0},setBarCount:function(e){var t=this.enableNormal,n=this.getBarVertexCount()*e,r=this.getBarTriangleCount()*e;this.vertexCount!==n&&(this.attributes.position.init(n),t?this.attributes.normal.init(n):this.attributes.normal.value=null,this.attributes.color.init(n)),this.triangleCount!==r&&(this.indices=n>65535?new Uint32Array(3*r):new Uint16Array(3*r),this._dataIndices=new Uint32Array(n))},getBarVertexCount:function(){var e=this.bevelSize>0?this.bevelSegments:0;return e>0?this._getBevelBarVertexCount(e):this.enableNormal?24:8},getBarTriangleCount:function(){var e=this.bevelSize>0?this.bevelSegments:0;return e>0?this._getBevelBarTriangleCount(e):12},_getBevelBarVertexCount:function(e){return 4*(e+1)*(e+1)*2},_getBevelBarTriangleCount:function(e){var t=4*e+3,n=2*e+1;return(t+1)*n*2+4},setColor:function(e,t){for(var n=this.getBarVertexCount(),r=n*e,i=n*(e+1),o=r;o<i;o++)this.attributes.color.set(o,t);this.dirtyAttribute("color")},getDataIndexOfVertex:function(e){return this._dataIndices?this._dataIndices[e]:null},addBar:function(){for(var e=u.create,t=u.scaleAndAdd,n=e(),r=e(),i=e(),o=e(),a=e(),s=e(),l=e(),c=[],d=[],f=0;f<8;f++)c[f]=e();var h=[[0,1,5,4],[2,3,7,6],[4,5,6,7],[3,2,1,0],[0,4,7,3],[1,2,6,5]],p=[0,1,2,0,2,3],m=[];for(f=0;f<h.length;f++)for(var v=h[f],g=0;g<2;g++){for(var y=[],_=0;_<3;_++)y.push(v[p[3*g+_]]);m.push(y)}return function(e,f,v,g,y,_){var x=this._vertexOffset;if(this.bevelSize>0&&this.bevelSegments>0)this._addBevelBar(e,f,v,g,this.bevelSize,this.bevelSegments,y);else{u.copy(i,f),u.normalize(i,i),u.cross(o,v,i),u.normalize(o,o),u.cross(r,i,o),u.normalize(o,o),u.negate(a,r),u.negate(s,i),u.negate(l,o),t(c[0],e,r,g[0]/2),t(c[0],c[0],o,g[2]/2),t(c[1],e,r,g[0]/2),t(c[1],c[1],l,g[2]/2),t(c[2],e,a,g[0]/2),t(c[2],c[2],l,g[2]/2),t(c[3],e,a,g[0]/2),t(c[3],c[3],o,g[2]/2),t(n,e,i,g[1]),t(c[4],n,r,g[0]/2),t(c[4],c[4],o,g[2]/2),t(c[5],n,r,g[0]/2),t(c[5],c[5],l,g[2]/2),t(c[6],n,a,g[0]/2),t(c[6],c[6],l,g[2]/2),t(c[7],n,a,g[0]/2),t(c[7],c[7],o,g[2]/2);var b=this.attributes;if(this.enableNormal){d[0]=r,d[1]=a,d[2]=i,d[3]=s,d[4]=o,d[5]=l;for(var w=this._vertexOffset,A=0;A<h.length;A++){for(var T=3*this._triangleOffset,S=0;S<6;S++)this.indices[T++]=w+p[S];w+=4,this._triangleOffset+=2}for(A=0;A<h.length;A++){var E=d[A];for(S=0;S<4;S++){var C=h[A][S];b.position.set(this._vertexOffset,c[C]),b.normal.set(this._vertexOffset,E),b.color.set(this._vertexOffset++,y)}}}else{for(A=0;A<m.length;A++){for(T=3*this._triangleOffset,S=0;S<3;S++)this.indices[T+S]=m[A][S]+this._vertexOffset;this._triangleOffset++}for(A=0;A<c.length;A++)b.position.set(this._vertexOffset,c[A]),b.color.set(this._vertexOffset++,y)}}var M=this._vertexOffset;for(A=x;A<M;A++)this._dataIndices[A]=_}}(),_addBevelBar:function(){var e=u.create(),t=u.create(),n=u.create(),r=c.create(),i=[],o=[1,-1,-1,1],a=[1,1,-1,-1],s=[2,0];return function(l,c,d,f,h,p,m){u.copy(t,c),u.normalize(t,t),u.cross(n,d,t),u.normalize(n,n),u.cross(e,t,n),u.normalize(n,n),r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=t[0],r[4]=t[1],r[5]=t[2],r[6]=n[0],r[7]=n[1],r[8]=n[2],h=Math.min(f[0],f[2])/2*h;for(var v=0;v<3;v++)i[v]=Math.max(f[v]-2*h,0);var g=(f[0]-i[0])/2,y=(f[1]-i[1])/2,_=(f[2]-i[2])/2,x=[],b=[],w=this._vertexOffset,A=[];for(v=0;v<2;v++){A[v]=A[v]=[];for(var T=0;T<=p;T++)for(var S=0;S<4;S++){(0===T&&0===v||1===v&&T===p)&&A[v].push(w);for(var E=0;E<=p;E++){var C=E/p*Math.PI/2+Math.PI/2*S,M=T/p*Math.PI/2+Math.PI/2*v;b[0]=g*Math.cos(C)*Math.sin(M),b[1]=y*Math.cos(M),b[2]=_*Math.sin(C)*Math.sin(M),x[0]=b[0]+o[S]*i[0]/2,x[1]=b[1]+y+s[v]*i[1]/2,x[2]=b[2]+a[S]*i[2]/2,Math.abs(g-y)<1e-6&&Math.abs(y-_)<1e-6||(b[0]/=g*g,b[1]/=y*y,b[2]/=_*_),u.normalize(b,b),u.transformMat3(x,x,r),u.transformMat3(b,b,r),u.add(x,x,l),this.attributes.position.set(w,x),this.enableNormal&&this.attributes.normal.set(w,b),this.attributes.color.set(w,m),w++}}}var L=4*p+3,N=2*p+1,D=L+1;for(S=0;S<N;S++)for(v=0;v<=L;v++){var O=S*D+v+this._vertexOffset,I=S*D+(v+1)%D+this._vertexOffset,R=(S+1)*D+(v+1)%D+this._vertexOffset,P=(S+1)*D+v+this._vertexOffset;this.setTriangleIndices(this._triangleOffset++,[R,O,I]),this.setTriangleIndices(this._triangleOffset++,[R,P,O])}this.setTriangleIndices(this._triangleOffset++,[A[0][0],A[0][2],A[0][1]]),this.setTriangleIndices(this._triangleOffset++,[A[0][0],A[0][3],A[0][2]]),this.setTriangleIndices(this._triangleOffset++,[A[1][0],A[1][1],A[1][2]]),this.setTriangleIndices(this._triangleOffset++,[A[1][0],A[1][2],A[1][3]]),this._vertexOffset=w}}()});i.a.util.defaults(d.prototype,o["a"]),i.a.util.defaults(d.prototype,a["a"]),t["a"]=d},function(e,t,n){"use strict";var r=n(0),i=n.n(r),o=n(31),a=n(32),s=n(39),l=n(50),u=i.a.extendSeriesModel({type:"series.bar3D",dependencies:["globe"],visualColorAccessPath:"itemStyle.color",getInitialData:function(e,t){return Object(l["a"])(this)},getFormattedLabel:function(e,t,n,r){var i=a["a"].getFormattedLabel(this,e,t,n,r);return null==i&&(i=this.getData().get("z",e)),i},formatTooltip:function(e){return Object(s["a"])(this,e)},defaultOption:{coordinateSystem:"cartesian3D",globeIndex:0,grid3DIndex:0,zlevel:-10,bevelSize:0,bevelSmoothness:2,onGridPlane:"xy",shading:"color",minHeight:0,itemStyle:{opacity:1},label:{show:!1,distance:2,textStyle:{fontSize:14,color:"#000",backgroundColor:"rgba(255,255,255,0.7)",padding:3,borderRadius:3}},emphasis:{label:{show:!0}},animationDurationUpdate:500}});i.a.util.merge(u.prototype,o["a"])},function(e,t,n){"use strict";var r=n(0),i=n.n(r),o=(n(233),n(234),n(51)),a=n.n(o),s=n(17);i.a.registerVisual(a()("line3D","circle",null)),i.a.registerVisual(Object(s["a"])("line3D")),i.a.registerLayout((function(e,t){e.eachSeriesByType("line3D",(function(e){var t=e.getData(),n=e.coordinateSystem;if(n){if("cartesian3D"!==n.type)return void console.error("line3D needs cartesian3D coordinateSystem");var r=new Float32Array(3*t.count()),i=[],o=[],a=n.dimensions,s=a.map((function(t){return e.coordDimToDataDim(t)[0]}));n&&t.each(s,(function(e,t,a,s){i[0]=e,i[1]=t,i[2]=a,n.dataToPoint(i,o),r[3*s]=o[0],r[3*s+1]=o[1],r[3*s+2]=o[2]})),t.setLayout("points",r)}}))}))},function(e,t,n){"use strict";var r=n(0),i=n.n(r),o=n(39),a=n(50);i.a.extendSeriesModel({type:"series.line3D",dependencies:["grid3D"],visualColorAccessPath:"lineStyle.color",getInitialData:function(e,t){return Object(a["a"])(this)},formatTooltip:function(e){return Object(o["a"])(this,e)},defaultOption:{coordinateSystem:"cartesian3D",zlevel:-10,grid3DIndex:0,lineStyle:{width:2},animationDurationUpdate:500}})},function(e,t,n){"use strict";var r=n(0),i=n.n(r),o=n(1),a=n(2),s=n(25),l=n(9),u=n(3),c=n(235),d=n.n(c),f=n(6),h=n(46),p=f["a"].vec3;o["a"].Shader.import(h["a"]);i.a.extendChartView({type:"line3D",__ecgl__:!0,init:function(e,t){this.groupGL=new o["a"].Node,this._api=t},render:function(e,t,n){var r=this._prevLine3DMesh;this._prevLine3DMesh=this._line3DMesh,this._line3DMesh=r,this._line3DMesh||(this._line3DMesh=new o["a"].Mesh({geometry:new s["a"]({useNativeLine:!1,sortTriangles:!0}),material:new o["a"].Material({shader:o["a"].createShader("ecgl.meshLines3D")}),renderOrder:10}),this._line3DMesh.geometry.pick=this._pick.bind(this)),this.groupGL.remove(this._prevLine3DMesh),this.groupGL.add(this._line3DMesh);var i=e.coordinateSystem;if(i&&i.viewGL){i.viewGL.add(this.groupGL);var a=i.viewGL.isLinearSpace()?"define":"undefine";this._line3DMesh.material[a]("fragment","SRGB_DECODE")}this._doRender(e,n),this._data=e.getData(),this._camera=i.viewGL.camera,this.updateCamera(),this._updateAnimation(e)},updateCamera:function(){this._updateNDCPosition()},_doRender:function(e,t){var n=e.getData(),r=this._line3DMesh;r.geometry.resetOffset();var i=n.getLayout("points"),s=[],l=new Float32Array(i.length/3*4),u=0,c=!1;n.each((function(e){var t=n.getItemVisual(e,"color"),r=n.getItemVisual(e,"opacity");null==r&&(r=1),o["a"].parseColor(t,s),s[3]*=r,l[u++]=s[0],l[u++]=s[1],l[u++]=s[2],l[u++]=s[3],s[3]<.99&&(c=!0)})),r.geometry.setVertexCount(r.geometry.getPolylineVertexCount(i)),r.geometry.setTriangleCount(r.geometry.getPolylineTriangleCount(i)),r.geometry.addPolyline(i,l,a["a"].firstNotNull(e.get("lineStyle.width"),1)),r.geometry.dirty(),r.geometry.updateBoundingBox();var d=r.material;d.transparent=c,d.depthMask=!c;var f=e.getModel("debug.wireframe");f.get("show")?(r.geometry.createAttribute("barycentric","float",3),r.geometry.generateBarycentric(),r.material.set("both","WIREFRAME_TRIANGLE"),r.material.set("wireframeLineColor",o["a"].parseColor(f.get("lineStyle.color")||"rgba(0,0,0,0.5)")),r.material.set("wireframeLineWidth",a["a"].firstNotNull(f.get("lineStyle.width"),1))):r.material.set("both","WIREFRAME_TRIANGLE"),this._points=i,this._initHandler(e,t)},_updateAnimation:function(e){o["a"].updateVertexAnimation([["prevPosition","position"],["prevPositionPrev","positionPrev"],["prevPositionNext","positionNext"]],this._prevLine3DMesh,this._line3DMesh,e)},_initHandler:function(e,t){var n=e.getData(),r=e.coordinateSystem,i=this._line3DMesh,o=-1;i.seriesIndex=e.seriesIndex,i.off("mousemove"),i.off("mouseout"),i.on("mousemove",(function(e){var a=r.pointToData(e.point.array),s=n.indicesOfNearest("x",a[0])[0];s!==o&&(t.dispatchAction({type:"grid3DShowAxisPointer",value:[n.get("x",s),n.get("y",s),n.get("z",s)]}),i.dataIndex=s),o=s}),this),i.on("mouseout",(function(e){o=-1,i.dataIndex=-1,t.dispatchAction({type:"grid3DHideAxisPointer"})}),this)},_updateNDCPosition:function(){var e=new l["a"],t=this._camera;l["a"].multiply(e,t.projectionMatrix,t.viewMatrix);var n=this._positionNDC,r=this._points,i=r.length/3;n&&n.length/2===i||(n=this._positionNDC=new Float32Array(2*i));for(var o=[],a=0;a<i;a++){var s=3*a,u=2*a;o[0]=r[s],o[1]=r[s+1],o[2]=r[s+2],o[3]=1,p.transformMat4(o,o,e.array),n[u]=o[0]/o[3],n[u+1]=o[1]/o[3]}},_pick:function(e,t,n,r,i,o){var a=this._positionNDC,s=this._data.hostModel,l=s.get("lineStyle.width"),c=-1,f=n.viewport.width,h=n.viewport.height,p=.5*f,m=.5*h;e=(e+1)*p,t=(t+1)*m;for(var v=1;v<a.length/2;v++){var g=(a[2*(v-1)]+1)*p,y=(a[2*(v-1)+1]+1)*m,_=(a[2*v]+1)*p,x=(a[2*v+1]+1)*m;if(d.a.containStroke(g,y,_,x,l,e,t)){var b=(g-e)*(g-e)+(y-t)*(y-t),w=(_-e)*(_-e)+(x-t)*(x-t);c=b<w?v-1:v}}if(c>=0){var A=3*c,T=new u["a"](this._points[A],this._points[A+1],this._points[A+2]);o.push({dataIndex:c,point:T,pointWorld:T.clone(),target:this._line3DMesh,distance:this._camera.getWorldPosition().dist(T)})}},remove:function(){this.groupGL.removeAll()},dispose:function(){this.groupGL.removeAll()}})},function(e,t){function n(e,t,n,r,i,o,a){if(0===i)return!1;var s=i,l=0,u=e;if(a>t+s&&a>r+s||a<t-s&&a<r-s||o>e+s&&o>n+s||o<e-s&&o<n-s)return!1;if(e===n)return Math.abs(o-e)<=s/2;l=(t-r)/(e-n),u=(e*r-n*t)/(e-n);var c=l*o-a+u,d=c*c/(l*l+1);return d<=s/2*s/2}t.containStroke=n},function(e,t,n){"use strict";var r=n(0),i=n.n(r),o=(n(237),n(238),n(51)),a=n.n(o),s=n(17);i.a.registerVisual(a()("scatter3D","circle",null)),i.a.registerVisual(Object(s["a"])("scatter3D")),i.a.registerLayout({seriesType:"scatter3D",reset:function(e){var t=e.coordinateSystem;if(t){var n=t.dimensions;if(n.length<3)return void console.error("scatter3D needs 3D coordinateSystem");var r=n.map((function(t){return e.coordDimToDataDim(t)[0]})),i=[],o=[];return{progress:function(e,n){for(var a=new Float32Array(3*(e.end-e.start)),s=e.start;s<e.end;s++){var l=3*(s-e.start);i[0]=n.get(r[0],s),i[1]=n.get(r[1],s),i[2]=n.get(r[2],s),t.dataToPoint(i,o),a[l]=o[0],a[l+1]=o[1],a[l+2]=o[2]}n.setLayout("points",a)}}}}})},function(e,t,n){"use strict";var r=n(0),i=n.n(r),o=n(32),a=n(39),s=n(50);i.a.extendSeriesModel({type:"series.scatter3D",dependencies:["globe","grid3D","geo3D"],visualColorAccessPath:"itemStyle.color",getInitialData:function(e,t){return Object(s["a"])(this)},getFormattedLabel:function(e,t,n,r){var i=o["a"].getFormattedLabel(this,e,t,n,r);if(null==i){var a=this.getData(),s=a.dimensions[a.dimensions.length-1];i=a.get(s,e)}return i},formatTooltip:function(e){return Object(a["a"])(this,e)},defaultOption:{coordinateSystem:"cartesian3D",zlevel:-10,progressive:1e5,progressiveThreshold:1e5,grid3DIndex:0,globeIndex:0,symbol:"circle",symbolSize:10,blendMode:"source-over",label:{show:!1,position:"right",distance:5,textStyle:{fontSize:14,color:"#000",backgroundColor:"rgba(255,255,255,0.7)",padding:3,borderRadius:3}},itemStyle:{opacity:.8},emphasis:{label:{show:!0}},animationDurationUpdate:500}})},function(e,t,n){"use strict";var r=n(0),i=n.n(r),o=n(1),a=n(2),s=n(32),l=n(67);i.a.extendChartView({type:"scatter3D",__ecgl__:!0,init:function(e,t){this.groupGL=new o["a"].Node,this._pointsBuilderList=[],this._currentStep=0},render:function(e,t,n){if(this.groupGL.removeAll(),e.getData().count()){var r=e.coordinateSystem;if(!r||!r.viewGL)throw new Error("Invalid coordinate system");r.viewGL.add(this.groupGL),this._camera=r.viewGL.camera;var i=this._pointsBuilderList[0];i||(i=this._pointsBuilderList[0]=new l["a"](!1,n)),this._pointsBuilderList.length=1,this.groupGL.add(i.rootNode),i.update(e,t,n),i.updateView(r.viewGL.camera)}},incrementalPrepareRender:function(e,t,n){var r=e.coordinateSystem;if(!r||!r.viewGL)throw new Error("Invalid coordinate system");r.viewGL.add(this.groupGL),this._camera=r.viewGL.camera,this.groupGL.removeAll(),this._currentStep=0},incrementalRender:function(e,t,n,r){if(!(e.end<=e.start)){var i=this._pointsBuilderList[this._currentStep];i||(i=new l["a"](!1,r),this._pointsBuilderList[this._currentStep]=i),this.groupGL.add(i.rootNode),i.update(t,n,r,e.start,e.end),i.updateView(t.coordinateSystem.viewGL.camera),this._currentStep++}},updateCamera:function(){this._pointsBuilderList.forEach((function(e){e.updateView(this._camera)}),this)},highlight:function(e,t,n,r){this._toggleStatus("highlight",e,t,n,r)},downplay:function(e,t,n,r){this._toggleStatus("downplay",e,t,n,r)},_toggleStatus:function(e,t,n,r,o){var l=t.getData(),u=a["a"].queryDataIndex(l,o),c="highlight"===e;null!=u?i.a.util.each(s["a"].normalizeToArray(u),(function(e){for(var t=0;t<this._pointsBuilderList.length;t++){var n=this._pointsBuilderList[t];c?n.highlight(l,e):n.downplay(l,e)}}),this):l.each((function(e){for(var t=0;t<this._pointsBuilderList.length;t++){var n=this._pointsBuilderList[t];c?n.highlight(l,e):n.downplay(l,e)}}))},dispose:function(){this.groupGL.removeAll()},remove:function(){this.groupGL.removeAll()}})},function(e,t,n){"use strict";var r=n(0),i=n.n(r);function o(e,t,n){t=t||document.createElement("canvas");t.width=e,t.height=e;var r=t.getContext("2d");return n&&n(r),t}function a(e,t,n,r){i.a.util.isArray(t)||(t=[t,t]);var o=l.getMarginByStyle(n,r),a=t[0]+o.left+o.right,s=t[1]+o.top+o.bottom,u=i.a.helper.createSymbol(e,0,0,t[0],t[1]),c=Math.max(a,s);u.position=[o.left,o.top],a>s?u.position[1]+=(c-s)/2:u.position[0]+=(c-a)/2;var d=u.getBoundingRect();return u.position[0]-=d.x,u.position[1]-=d.y,u.setStyle(n),u.update(),u.__size=c,u}function s(e,t,n){var r=t.width,i=t.height,o=e.canvas.width,a=e.canvas.height,s=r/o,l=i/a;function u(e){return e<128?1:-1}function c(e,o){var a=1/0;e=Math.floor(e*s),o=Math.floor(o*l);for(var c=o*r+e,d=t.data[4*c],f=u(d),h=Math.max(o-n,0);h<Math.min(o+n,i);h++)for(var p=Math.max(e-n,0);p<Math.min(e+n,r);p++){c=h*r+p;var m=t.data[4*c],v=u(m),g=p-e,y=h-o;if(f!==v){var _=g*g+y*y;_<a&&(a=_)}}return f*Math.sqrt(a)}for(var d=e.createImageData(o,a),f=0;f<a;f++)for(var h=0;h<o;h++){var p=c(h,f),m=p/n*.5+.5,v=4*(f*o+h);d.data[v++]=255*(1-m),d.data[v++]=255*(1-m),d.data[v++]=255*(1-m),d.data[v++]=255}return d}var l={getMarginByStyle:function(e){var t=e.minMargin||0,n=0;e.stroke&&"none"!==e.stroke&&(n=null==e.lineWidth?1:e.lineWidth);var r=e.shadowBlur||0,i=e.shadowOffsetX||0,o=e.shadowOffsetY||0,a={};return a.left=Math.max(n/2,-i+r,t),a.right=Math.max(n/2,i+r,t),a.top=Math.max(n/2,-o+r,t),a.bottom=Math.max(n/2,o+r,t),a},createSymbolSprite:function(e,t,n,r){var i=a(e,t,n),s=l.getMarginByStyle(n);return{image:o(i.__size,r,(function(e){i.brush(e)})),margin:s}},createSDFFromCanvas:function(e,t,n,r){return o(t,r,(function(t){var r=e.getContext("2d"),i=r.getImageData(0,0,e.width,e.height);t.putImageData(s(t,i,n),0,0)}))},createSimpleSprite:function(e,t){return o(e,t,(function(t){var n=e/2;t.beginPath(),t.arc(n,n,60,0,2*Math.PI,!1),t.closePath();var r=t.createRadialGradient(n,n,0,n,n,n);r.addColorStop(0,"rgba(255, 255, 255, 1)"),r.addColorStop(.5,"rgba(255, 255, 255, 0.5)"),r.addColorStop(1,"rgba(255, 255, 255, 0)"),t.fillStyle=r,t.fill()}))}};t["a"]=l},function(e,t,n){"use strict";var r=n(1),i=n(241),o=n(0),a=n.n(o),s=n(6),l=n(242),u=s["a"].vec4;r["a"].Shader.import(l["a"]);var c=r["a"].Mesh.extend((function(){var e=new r["a"].Geometry({dynamic:!0,attributes:{color:new r["a"].Geometry.Attribute("color","float",4,"COLOR"),position:new r["a"].Geometry.Attribute("position","float",3,"POSITION"),size:new r["a"].Geometry.Attribute("size","float",1),prevPosition:new r["a"].Geometry.Attribute("prevPosition","float",3),prevSize:new r["a"].Geometry.Attribute("prevSize","float",1)}});a.a.util.extend(e,i["a"]);var t=new r["a"].Material({shader:r["a"].createShader("ecgl.sdfSprite"),transparent:!0,depthMask:!1});t.enableTexture("sprite"),t.define("both","VERTEX_COLOR"),t.define("both","VERTEX_SIZE");var n=new r["a"].Texture2D({image:document.createElement("canvas"),flipY:!1});return t.set("sprite",n),e.pick=this._pick.bind(this),{geometry:e,material:t,mode:r["a"].Mesh.POINTS,sizeScale:1}}),{_pick:function(e,t,n,i,o,a){var s=this._positionNDC;if(s)for(var l=n.viewport,u=2/l.width,c=2/l.height,d=this.geometry.vertexCount-1;d>=0;d--){var f;f=this.geometry.indices?this.geometry.indices[d]:d;var h=s[2*f],p=s[2*f+1],m=this.geometry.attributes.size.get(f)/this.sizeScale,v=m/2;if(e>h-v*u&&e<h+v*u&&t>p-v*c&&t<p+v*c){var g=new r["a"].Vector3,y=new r["a"].Vector3;this.geometry.attributes.position.get(f,g.array),r["a"].Vector3.transformMat4(y,g,this.worldTransform),a.push({vertexIndex:f,point:g,pointWorld:y,target:this,distance:y.distance(i.getWorldPosition())})}}},updateNDCPosition:function(e,t,n){var r=this._positionNDC,i=this.geometry;r&&r.length/2===i.vertexCount||(r=this._positionNDC=new Float32Array(2*i.vertexCount));for(var o=u.create(),a=0;a<i.vertexCount;a++)i.attributes.position.get(a,o),o[3]=1,u.transformMat4(o,o,e.array),u.scale(o,o,1/o[3]),r[2*a]=o[0],r[2*a+1]=o[1]}});t["a"]=c},function(e,t,n){"use strict";var r=n(97),i=n(6),o=i["a"].vec3;t["a"]={needsSortVertices:function(){return this.sortVertices},needsSortVerticesProgressively:function(){return this.needsSortVertices()&&this.vertexCount>=2e4},doSortVertices:function(e,t){var n=this.indices,r=o.create();if(!n){n=this.indices=this.vertexCount>65535?new Uint32Array(this.vertexCount):new Uint16Array(this.vertexCount);for(var i=0;i<n.length;i++)n[i]=i}if(0===t){var a,s=this.attributes.position,l=(e=e.array,0);this._zList&&this._zList.length===this.vertexCount||(this._zList=new Float32Array(this.vertexCount));for(i=0;i<this.vertexCount;i++){s.get(i,r);var u=o.sqrDist(r,e);isNaN(u)&&(u=1e7,l++),0===i?(a=u,u=0):u-=a,this._zList[i]=u}this._noneCount=l}if(this.vertexCount<2e4)0===t&&this._simpleSort(this._noneCount/this.vertexCount>.05);else for(i=0;i<3;i++)this._progressiveQuickSort(3*t+i);this.dirtyIndices()},_simpleSort:function(e){var t=this._zList,n=this.indices;function i(e,n){return t[n]-t[e]}e?Array.prototype.sort.call(n,i):r["a"].sort(n,i,0,n.length-1)},_progressiveQuickSort:function(e){var t=this._zList,n=this.indices;this._quickSort=this._quickSort||new r["a"],this._quickSort.step(n,(function(e,n){return t[n]-t[e]}),e)}}},function(e,t,n){"use strict";t["a"]="@export ecgl.sdfSprite.vertex\n\nuniform mat4 worldViewProjection : WORLDVIEWPROJECTION;\nuniform float elapsedTime : 0;\n\nattribute vec3 position : POSITION;\n\n#ifdef VERTEX_SIZE\nattribute float size;\n#else\nuniform float u_Size;\n#endif\n\n#ifdef VERTEX_COLOR\nattribute vec4 a_FillColor: COLOR;\nvarying vec4 v_Color;\n#endif\n\n#ifdef VERTEX_ANIMATION\nattribute vec3 prevPosition;\nattribute float prevSize;\nuniform float percent : 1.0;\n#endif\n\n\n#ifdef POSITIONTEXTURE_ENABLED\nuniform sampler2D positionTexture;\n#endif\n\nvarying float v_Size;\n\nvoid main()\n{\n\n#ifdef POSITIONTEXTURE_ENABLED\n gl_Position = worldViewProjection * vec4(texture2D(positionTexture, position.xy).xy, -10.0, 1.0);\n#else\n\n #ifdef VERTEX_ANIMATION\n vec3 pos = mix(prevPosition, position, percent);\n #else\n vec3 pos = position;\n #endif\n gl_Position = worldViewProjection * vec4(pos, 1.0);\n#endif\n\n#ifdef VERTEX_SIZE\n#ifdef VERTEX_ANIMATION\n v_Size = mix(prevSize, size, percent);\n#else\n v_Size = size;\n#endif\n#else\n v_Size = u_Size;\n#endif\n\n#ifdef VERTEX_COLOR\n v_Color = a_FillColor;\n #endif\n\n gl_PointSize = v_Size;\n}\n\n@end\n\n@export ecgl.sdfSprite.fragment\n\nuniform vec4 color: [1, 1, 1, 1];\nuniform vec4 strokeColor: [1, 1, 1, 1];\nuniform float smoothing: 0.07;\n\nuniform float lineWidth: 0.0;\n\n#ifdef VERTEX_COLOR\nvarying vec4 v_Color;\n#endif\n\nvarying float v_Size;\n\nuniform sampler2D sprite;\n\n@import clay.util.srgb\n\nvoid main()\n{\n gl_FragColor = color;\n\n vec4 _strokeColor = strokeColor;\n\n#ifdef VERTEX_COLOR\n gl_FragColor *= v_Color;\n #endif\n\n#ifdef SPRITE_ENABLED\n float d = texture2D(sprite, gl_PointCoord).r;\n gl_FragColor.a *= smoothstep(0.5 - smoothing, 0.5 + smoothing, d);\n\n if (lineWidth > 0.0) {\n float sLineWidth = lineWidth / 2.0;\n\n float outlineMaxValue0 = 0.5 + sLineWidth;\n float outlineMaxValue1 = 0.5 + sLineWidth + smoothing;\n float outlineMinValue0 = 0.5 - sLineWidth - smoothing;\n float outlineMinValue1 = 0.5 - sLineWidth;\n\n if (d <= outlineMaxValue1 && d >= outlineMinValue0) {\n float a = _strokeColor.a;\n if (d <= outlineMinValue1) {\n a = a * smoothstep(outlineMinValue0, outlineMinValue1, d);\n }\n else {\n a = a * smoothstep(outlineMaxValue1, outlineMaxValue0, d);\n }\n gl_FragColor.rgb = mix(gl_FragColor.rgb * gl_FragColor.a, _strokeColor.rgb, a);\n gl_FragColor.a = gl_FragColor.a * (1.0 - a) + a;\n }\n }\n#endif\n\n#ifdef SRGB_DECODE\n gl_FragColor = sRGBToLinear(gl_FragColor);\n#endif\n}\n@end"},function(e,t,n){"use strict";var r=n(0),i=n.n(r),o=(n(244),n(245),n(248),n(17));i.a.registerVisual(Object(o["a"])("lines3D")),i.a.registerAction({type:"lines3DPauseEffect",event:"lines3deffectpaused",update:"series.lines3D:pauseEffect"},(function(){})),i.a.registerAction({type:"lines3DResumeEffect",event:"lines3deffectresumed",update:"series.lines3D:resumeEffect"},(function(){})),i.a.registerAction({type:"lines3DToggleEffect",event:"lines3deffectchanged",update:"series.lines3D:toggleEffect"},(function(){}))},function(e,t,n){"use strict";var r=n(0),i=n.n(r),o=n(6),a=o["a"].vec3,s=o["a"].vec2,l=a.normalize,u=a.cross,c=a.sub,d=a.add,f=a.create,h=f(),p=f(),m=f(),v=f(),g=[],y=[];function _(e,t){s.copy(g,e[0]),s.copy(y,e[1]);var n=[],r=n[0]=f(),i=n[1]=f(),o=n[2]=f(),_=n[3]=f();t.dataToPoint(g,r),t.dataToPoint(y,_),l(h,r),c(p,_,r),l(p,p),u(m,p,h),l(m,m),u(p,h,m),d(i,h,p),l(i,i),l(h,_),c(p,r,_),l(p,p),u(m,p,h),l(m,m),u(p,h,m),d(o,h,p),l(o,o),d(v,r,_),l(v,v);var x=a.dot(r,v),b=a.dot(v,i),w=(Math.max(a.len(r),a.len(_))-x)/b*2;return a.scaleAndAdd(i,r,i,w),a.scaleAndAdd(o,_,o,w),n}function x(e,t,n){var r=[],i=r[0]=a.create(),o=r[1]=a.create(),s=r[2]=a.create(),l=r[3]=a.create();t.dataToPoint(e[0],i),t.dataToPoint(e[1],l);var u=a.dist(i,l);return a.lerp(o,i,l,.3),a.lerp(s,i,l,.3),a.scaleAndAdd(o,o,n,Math.min(.1*u,10)),a.scaleAndAdd(s,s,n,Math.min(.1*u,10)),r}function b(e,t){for(var n=new Float32Array(3*e.length),r=0,i=[],o=0;o<e.length;o++)t.dataToPoint(e[o],i),n[r++]=i[0],n[r++]=i[1],n[r++]=i[2];return n}function w(e){var t=[];return e.each((function(n){var r=e.getItemModel(n),i=r.option instanceof Array?r.option:r.getShallow("coords",!0);if(!(i instanceof Array&&i.length>0&&i[0]instanceof Array))throw new Error("Invalid coords "+JSON.stringify(i)+". Lines must have 2d coords array in data item.");t.push(i)})),{coordsList:t}}function A(e,t){var n=e.getData(),r=e.get("polyline");n.setLayout("lineType",r?"polyline":"cubicBezier");var i=w(n);n.each((function(e){var o=i.coordsList[e],a=r?b:_;n.setItemLayout(e,a(o,t))}))}function T(e,t,n){var r=e.getData(),i=e.get("polyline"),o=w(r);r.setLayout("lineType",i?"polyline":"cubicBezier"),r.each((function(e){var a=o.coordsList[e],s=i?b(a,t):x(a,t,n);r.setItemLayout(e,s)}))}i.a.registerLayout((function(e,t){e.eachSeriesByType("lines3D",(function(e){var t=e.coordinateSystem;"globe"===t.type?A(e,t):"geo3D"===t.type?T(e,t,[0,1,0]):"mapbox3D"!==t.type&&"maptalks3D"!==t.type||T(e,t,[0,0,1])}))}))},function(e,t,n){"use strict";var r=n(0),i=n.n(r),o=n(1),a=n(25),s=n(246),l=n(46);function u(e){return null!=e.radius?e.radius:null!=e.size?Math.max(e.size[0],e.size[1],e.size[2]):100}o["a"].Shader.import(l["a"]);i.a.extendChartView({type:"lines3D",__ecgl__:!0,init:function(e,t){this.groupGL=new o["a"].Node,this._meshLinesMaterial=new o["a"].Material({shader:o["a"].createShader("ecgl.meshLines3D"),transparent:!0,depthMask:!1}),this._linesMesh=new o["a"].Mesh({geometry:new a["a"],material:this._meshLinesMaterial,$ignorePicking:!0}),this._trailMesh=new s["a"]},render:function(e,t,n){this.groupGL.add(this._linesMesh);var r=e.coordinateSystem,i=e.getData();if(r&&r.viewGL){var a=r.viewGL;a.add(this.groupGL),this._updateLines(e,t,n);var s=r.viewGL.isLinearSpace()?"define":"undefine";this._linesMesh.material[s]("fragment","SRGB_DECODE"),this._trailMesh.material[s]("fragment","SRGB_DECODE")}var l=this._trailMesh;if(l.stopAnimation(),e.get("effect.show")){this.groupGL.add(l),l.updateData(i,n,this._linesMesh.geometry),l.__time=l.__time||0;var u=36e5;this._curveEffectsAnimator=l.animate("",{loop:!0}).when(u,{__time:u}).during((function(){l.setAnimationTime(l.__time)})).start()}else this.groupGL.remove(l),this._curveEffectsAnimator=null;this._linesMesh.material.blend=this._trailMesh.material.blend="lighter"===e.get("blendMode")?o["a"].additiveBlend:null},pauseEffect:function(){this._curveEffectsAnimator&&this._curveEffectsAnimator.pause()},resumeEffect:function(){this._curveEffectsAnimator&&this._curveEffectsAnimator.resume()},toggleEffect:function(){var e=this._curveEffectsAnimator;e&&(e.isPaused()?e.resume():e.pause())},_updateLines:function(e,t,n){var r=e.getData(),i=e.coordinateSystem,a=this._linesMesh.geometry,s=e.get("polyline");a.expandLine=!0;var l=u(i);a.segmentScale=l/20;var c="lineStyle.width".split("."),d=n.getDevicePixelRatio(),f=0;r.each((function(e){var t=r.getItemModel(e),n=t.get(c);null==n&&(n=1),r.setItemVisual(e,"lineWidth",n),f=Math.max(n,f)})),a.useNativeLine=!1;var h=0,p=0;r.each((function(e){var t=r.getItemLayout(e);s?(h+=a.getPolylineVertexCount(t),p+=a.getPolylineTriangleCount(t)):(h+=a.getCubicCurveVertexCount(t[0],t[1],t[2],t[3]),p+=a.getCubicCurveTriangleCount(t[0],t[1],t[2],t[3]))})),a.setVertexCount(h),a.setTriangleCount(p),a.resetOffset();var m=[];r.each((function(e){var t=r.getItemLayout(e),n=r.getItemVisual(e,"color"),i=r.getItemVisual(e,"opacity"),l=r.getItemVisual(e,"lineWidth")*d;null==i&&(i=1),m=o["a"].parseColor(n,m),m[3]*=i,s?a.addPolyline(t,m,l):a.addCubicCurve(t[0],t[1],t[2],t[3],m,l)})),a.dirty()},remove:function(){this.groupGL.removeAll()},dispose:function(){this.groupGL.removeAll()}})},function(e,t,n){"use strict";var r=n(0),i=(n.n(r),n(1)),o=n(6),a=n(25),s=n(247),l=o["a"].vec3;function u(e){return e>0?1:-1}i["a"].Shader.import(s["a"]),t["a"]=i["a"].Mesh.extend((function(){var e=new i["a"].Material({shader:new i["a"].Shader(i["a"].Shader.source("ecgl.trail2.vertex"),i["a"].Shader.source("ecgl.trail2.fragment")),transparent:!0,depthMask:!1}),t=new a["a"]({dynamic:!0});return t.createAttribute("dist","float",1),t.createAttribute("distAll","float",1),t.createAttribute("start","float",1),{geometry:t,material:e,culling:!1,$ignorePicking:!0}}),{updateData:function(e,t,n){var r=e.hostModel,o=this.geometry,a=r.getModel("effect"),s=a.get("trailWidth")*t.getDevicePixelRatio(),c=a.get("trailLength"),d=r.get("effect.constantSpeed"),f=1e3*r.get("effect.period"),h=null!=d;this.getScene()||console.error("TrailMesh must been add to scene before updateData"),h?this.material.set("speed",d/1e3):this.material.set("period",f),this.material[h?"define":"undefine"]("vertex","CONSTANT_SPEED");var p=r.get("polyline");o.trailLength=c,this.material.set("trailLength",c),o.resetOffset(),["position","positionPrev","positionNext"].forEach((function(e){o.attributes[e].value=n.attributes[e].value}));var m=["dist","distAll","start","offset","color"];m.forEach((function(e){o.attributes[e].init(o.vertexCount)})),o.indices=n.indices;var v=[],g=a.get("trailColor"),y=a.get("trailOpacity"),_=null!=g,x=null!=y;this.updateWorldTransform();var b=this.worldTransform.x.len(),w=this.worldTransform.y.len(),A=this.worldTransform.z.len(),T=0,S=0;e.each((function(t){var r=e.getItemLayout(t),a=x?y:e.getItemVisual(t,"opacity"),c=e.getItemVisual(t,"color");null==a&&(a=1),v=i["a"].parseColor(_?g:c,v),v[3]*=a;for(var d=p?n.getPolylineVertexCount(r):n.getCubicCurveVertexCount(r[0],r[1],r[2],r[3]),m=0,E=[],C=[],M=T;M<T+d;M++)o.attributes.position.get(M,E),E[0]*=b,E[1]*=w,E[2]*=A,M>T&&(m+=l.dist(E,C)),o.attributes.dist.set(M,m),l.copy(C,E);S=Math.max(S,m);var L=Math.random()*(h?m:f);for(M=T;M<T+d;M++)o.attributes.distAll.set(M,m),o.attributes.start.set(M,L),o.attributes.offset.set(M,u(n.attributes.offset.get(M))*s/2),o.attributes.color.set(M,v);T+=d})),this.material.set("spotSize",.1*S*c),this.material.set("spotIntensity",a.get("spotIntensity")),o.dirty()},setAnimationTime:function(e){this.material.set("time",e)}})},function(e,t,n){"use strict";t["a"]="@export ecgl.trail2.vertex\nattribute vec3 position: POSITION;\nattribute vec3 positionPrev;\nattribute vec3 positionNext;\nattribute float offset;\nattribute float dist;\nattribute float distAll;\nattribute float start;\n\nattribute vec4 a_Color : COLOR;\n\nuniform mat4 worldViewProjection : WORLDVIEWPROJECTION;\nuniform vec4 viewport : VIEWPORT;\nuniform float near : NEAR;\n\nuniform float speed : 0;\nuniform float trailLength: 0.3;\nuniform float time;\nuniform float period: 1000;\n\nuniform float spotSize: 1;\n\nvarying vec4 v_Color;\nvarying float v_Percent;\nvarying float v_SpotPercent;\n\n@import ecgl.common.wireframe.vertexHeader\n\n@import ecgl.lines3D.clipNear\n\nvoid main()\n{\n @import ecgl.lines3D.expandLine\n\n gl_Position = currProj;\n\n v_Color = a_Color;\n\n @import ecgl.common.wireframe.vertexMain\n\n#ifdef CONSTANT_SPEED\n float t = mod((speed * time + start) / distAll, 1. + trailLength) - trailLength;\n#else\n float t = mod((time + start) / period, 1. + trailLength) - trailLength;\n#endif\n\n float trailLen = distAll * trailLength;\n\n v_Percent = (dist - t * distAll) / trailLen;\n\n v_SpotPercent = spotSize / distAll;\n\n }\n@end\n\n\n@export ecgl.trail2.fragment\n\nuniform vec4 color : [1.0, 1.0, 1.0, 1.0];\nuniform float spotIntensity: 5;\n\nvarying vec4 v_Color;\nvarying float v_Percent;\nvarying float v_SpotPercent;\n\n@import ecgl.common.wireframe.fragmentHeader\n\n@import clay.util.srgb\n\nvoid main()\n{\n if (v_Percent > 1.0 || v_Percent < 0.0) {\n discard;\n }\n\n float fade = v_Percent;\n\n#ifdef SRGB_DECODE\n gl_FragColor = sRGBToLinear(color * v_Color);\n#else\n gl_FragColor = color * v_Color;\n#endif\n\n @import ecgl.common.wireframe.fragmentMain\n\n if (v_Percent > (1.0 - v_SpotPercent)) {\n gl_FragColor.rgb *= spotIntensity;\n }\n\n gl_FragColor.a *= fade;\n}\n\n@end"},function(e,t,n){"use strict";var r=n(0),i=n.n(r);i.a.extendSeriesModel({type:"series.lines3D",dependencies:["globe"],visualColorAccessPath:"lineStyle.color",getInitialData:function(e,t){var n=new i.a.List(["value"],this);return n.hasItemOption=!1,n.initData(e.data,[],(function(e,t,r,i){if(e instanceof Array)return NaN;n.hasItemOption=!0;var o=e.value;return null!=o?o instanceof Array?o[i]:o:void 0})),n},defaultOption:{coordinateSystem:"globe",globeIndex:0,geo3DIndex:0,zlevel:-10,polyline:!1,effect:{show:!1,period:4,trailWidth:4,trailLength:.2,spotIntensity:6},silent:!0,blendMode:"source-over",lineStyle:{width:1,opacity:.5}}})},function(e,t,n){"use strict";var r=n(0),i=n.n(r),o=(n(250),n(251),n(17));i.a.registerVisual(Object(o["a"])("polygons3D"))},function(e,t,n){"use strict";var r=n(0),i=n.n(r),o=n(31);function a(e,t){for(var n=[],r=0;r<t.length;r++)n.push(e.dataToPoint(t[r]));return n}var s=i.a.extendSeriesModel({type:"series.polygons3D",getRegionModel:function(e){return this.getData().getItemModel(e)},getRegionPolygonCoords:function(e){var t=this.coordinateSystem,n=this.getData().getItemModel(e),r=n.option instanceof Array?n.option:n.getShallow("coords");n.get("multiPolygon")||(r=[r]);for(var i=[],o=0;o<r.length;o++){for(var s=[],l=1;l<r[o].length;l++)s.push(a(t,r[o][l]));i.push({exterior:a(t,r[o][0]),interiors:s})}return i},getInitialData:function(e){var t=new i.a.List(["value"],this);return t.hasItemOption=!1,t.initData(e.data,[],(function(e,n,r,i){if(e instanceof Array)return NaN;t.hasItemOption=!0;var o=e.value;return null!=o?o instanceof Array?o[i]:o:void 0})),t},defaultOption:{show:!0,data:null,multiPolygon:!1,progressiveThreshold:1e3,progressive:1e3,zlevel:-10,label:{show:!1,distance:2,textStyle:{fontSize:20,color:"#000",backgroundColor:"rgba(255,255,255,0.7)",padding:3,borderRadius:4}},itemStyle:{color:"#fff",borderWidth:0,borderColor:"#333"},emphasis:{itemStyle:{color:"#639fc0"},label:{show:!0}}}});i.a.util.merge(s.prototype,o["a"])},function(e,t,n){"use strict";var r=n(0),i=n.n(r),o=n(64),a=n(1);i.a.extendChartView({type:"polygons3D",__ecgl__:!0,init:function(e,t){this.groupGL=new a["a"].Node,this._geo3DBuilderList=[],this._currentStep=0},render:function(e,t,n){this.groupGL.removeAll();var r=e.coordinateSystem;r&&r.viewGL&&r.viewGL.add(this.groupGL);var i=this._geo3DBuilderList[0];i||(i=new o["a"](n),i.extrudeY="mapbox3D"!==r.type&&"maptalks3D"!==r.type,this._geo3DBuilderList[0]=i),this._updateShaderDefines(r,i),i.update(e,t,n),this._geo3DBuilderList.length=1,this.groupGL.add(i.rootNode)},incrementalPrepareRender:function(e,t,n){this.groupGL.removeAll();var r=e.coordinateSystem;r&&r.viewGL&&r.viewGL.add(this.groupGL),this._currentStep=0},incrementalRender:function(e,t,n,r){var i=this._geo3DBuilderList[this._currentStep],a=t.coordinateSystem;i||(i=new o["a"](r),i.extrudeY="mapbox3D"!==a.type&&"maptalks3D"!==a.type,this._geo3DBuilderList[this._currentStep]=i),i.update(t,n,r,e.start,e.end),this.groupGL.add(i.rootNode),this._updateShaderDefines(a,i),this._currentStep++},_updateShaderDefines:function(e,t){var n=e.viewGL.isLinearSpace()?"define":"undefine";t.rootNode.traverse((function(t){t.material&&(t.material[n]("fragment","SRGB_DECODE"),"mapbox3D"!==e.type&&"maptalks3D"!==e.type||(t.material.define("fragment","NORMAL_UP_AXIS",2),t.material.define("fragment","NORMAL_FRONT_AXIS",1)))}))},remove:function(){this.groupGL.removeAll()},dispose:function(){this.groupGL.removeAll()}})},function(e,t,n){"use strict";var r=n(0),i=n.n(r),o=(n(253),n(254),n(255),n(17));i.a.registerVisual(Object(o["a"])("surface"))},function(e,t,n){"use strict";var r=n(0),i=n.n(r),o=n(31),a=n(39),s=n(50),l=i.a.extendSeriesModel({type:"series.surface",dependencies:["globe","grid3D","geo3D"],visualColorAccessPath:"itemStyle.color",formatTooltip:function(e){return Object(a["a"])(this,e)},getInitialData:function(e,t){var n=e.data;function r(e){return!(isNaN(e.min)||isNaN(e.max)||isNaN(e.step))}function o(e){var t=i.a.number.getPrecisionSafe;return Math.max(t(e.min),t(e.max),t(e.step))+1}if(!n)if(e.parametric){var a=e.parametricEquation||{},l=a.u||{},u=a.v||{};["u","v"].forEach((function(e){r(a[e])||console.error("Invalid parametricEquation.%s",e)})),["x","y","z"].forEach((function(e){"function"===typeof a[e]||console.error("parametricEquation.%s needs to be function",e)}));var c=Math.floor((l.max+l.step-l.min)/l.step),d=Math.floor((u.max+u.step-u.min)/u.step);n=new Float32Array(c*d*5);var f=o(l),h=o(u);for(S=0,E=0;E<d;E++)for(C=0;C<c;C++){var p=C*l.step+l.min,m=E*u.step+u.min,v=i.a.number.round(Math.min(p,l.max),f),g=i.a.number.round(Math.min(m,u.max),h);M=a.x(v,g),L=a.y(v,g),O=a.z(v,g);n[S++]=M,n[S++]=L,n[S++]=O,n[S++]=v,n[S++]=g}}else{var y=e.equation||{},_=y.x||{},x=y.y||{};if(["x","y"].forEach((function(e){r(y[e])||console.error("Invalid equation.%s",e)})),"function"!==typeof y.z)return void console.error("equation.z needs to be function");var b=Math.floor((_.max+_.step-_.min)/_.step),w=Math.floor((x.max+x.step-x.min)/x.step);n=new Float32Array(b*w*3);for(var A=o(_),T=o(x),S=0,E=0;E<w;E++)for(var C=0;C<b;C++){var M=C*_.step+_.min,L=E*x.step+x.min,N=i.a.number.round(Math.min(M,_.max),A),D=i.a.number.round(Math.min(L,x.max),T),O=y.z(N,D);n[S++]=N,n[S++]=D,n[S++]=O}}var I=["x","y","z"];e.parametric&&I.push("u","v");var R=Object(s["a"])(this,I,n);return R},defaultOption:{coordinateSystem:"cartesian3D",zlevel:-10,grid3DIndex:0,shading:"lambert",parametric:!1,wireframe:{show:!0,lineStyle:{color:"rgba(0,0,0,0.5)",width:1}},equation:{x:{min:-1,max:1,step:.1},y:{min:-1,max:1,step:.1},z:null},parametricEquation:{u:{min:-1,max:1,step:.1},v:{min:-1,max:1,step:.1},x:null,y:null,z:null},itemStyle:{},animationDurationUpdate:500}});i.a.util.merge(l.prototype,o["a"])},function(e,t,n){"use strict";var r=n(0),i=n.n(r),o=n(1),a=(n(2),n(6)),s=n(65),l=a["a"].vec3;function u(e){return isNaN(e[0])||isNaN(e[1])||isNaN(e[2])}i.a.extendChartView({type:"surface",__ecgl__:!0,init:function(e,t){this.groupGL=new o["a"].Node},render:function(e,t,n){var r=this._prevSurfaceMesh;this._prevSurfaceMesh=this._surfaceMesh,this._surfaceMesh=r,this._surfaceMesh||(this._surfaceMesh=this._createSurfaceMesh()),this.groupGL.remove(this._prevSurfaceMesh),this.groupGL.add(this._surfaceMesh);var i=e.coordinateSystem,a=e.get("shading"),s=e.getData(),l="ecgl."+a;if(this._surfaceMesh.material&&this._surfaceMesh.material.shader.name===l||(this._surfaceMesh.material=o["a"].createMaterial(l,["VERTEX_COLOR","DOUBLE_SIDED"])),o["a"].setMaterialFromModel(a,this._surfaceMesh.material,e,n),i&&i.viewGL){i.viewGL.add(this.groupGL);var u=i.viewGL.isLinearSpace()?"define":"undefine";this._surfaceMesh.material[u]("fragment","SRGB_DECODE")}var c=e.get("parametric"),d=this._getDataShape(s,c),f=e.getModel("wireframe"),h=f.get("lineStyle.width"),p=f.get("show")&&h>0;this._updateSurfaceMesh(this._surfaceMesh,e,d,p);var m=this._surfaceMesh.material;p?(m.define("WIREFRAME_QUAD"),m.set("wireframeLineWidth",h),m.set("wireframeLineColor",o["a"].parseColor(f.get("lineStyle.color")))):m.undefine("WIREFRAME_QUAD"),this._initHandler(e,n),this._updateAnimation(e)},_updateAnimation:function(e){o["a"].updateVertexAnimation([["prevPosition","position"],["prevNormal","normal"]],this._prevSurfaceMesh,this._surfaceMesh,e)},_createSurfaceMesh:function(){var e=new o["a"].Mesh({geometry:new o["a"].Geometry({dynamic:!0,sortTriangles:!0}),shadowDepthMaterial:new o["a"].Material({shader:new o["a"].Shader(o["a"].Shader.source("ecgl.sm.depth.vertex"),o["a"].Shader.source("ecgl.sm.depth.fragment"))}),culling:!1,renderOrder:10,renderNormal:!0});return e.geometry.createAttribute("barycentric","float",4),e.geometry.createAttribute("prevPosition","float",3),e.geometry.createAttribute("prevNormal","float",3),i.a.util.extend(e.geometry,s["a"]),e},_initHandler:function(e,t){var n=e.getData(),r=this._surfaceMesh,i=e.coordinateSystem;function o(e,t){for(var n=1/0,i=-1,o=[],a=0;a<e.length;a++){r.geometry.attributes.position.get(e[a],o);var s=l.dist(t.array,o);s<n&&(n=s,i=e[a])}return i}r.seriesIndex=e.seriesIndex;var a=-1;r.off("mousemove"),r.off("mouseout"),r.on("mousemove",(function(e){var s=o(e.triangle,e.point);if(s>=0){var u=[];r.geometry.attributes.position.get(s,u);for(var c=i.pointToData(u),d=1/0,f=-1,h=[],p=0;p<n.count();p++){h[0]=n.get("x",p),h[1]=n.get("y",p),h[2]=n.get("z",p);var m=l.squaredDistance(h,c);m<d&&(f=p,d=m)}f!==a&&t.dispatchAction({type:"grid3DShowAxisPointer",value:c}),a=f,r.dataIndex=f}else r.dataIndex=-1}),this),r.on("mouseout",(function(e){a=-1,r.dataIndex=-1,t.dispatchAction({type:"grid3DHideAxisPointer"})}),this)},_updateSurfaceMesh:function(e,t,n,r){var i=e.geometry,a=t.getData(),s=a.getLayout("points"),c=0;a.each((function(e){a.hasValue(e)||c++}));var d=c||r,f=i.attributes.position,h=i.attributes.normal,p=i.attributes.texcoord0,m=i.attributes.barycentric,v=i.attributes.color,g=n.row,y=n.column,_=t.get("shading"),x="color"!==_;if(d){var b=(g-1)*(y-1)*4;f.init(b),r&&m.init(b)}else f.value=new Float32Array(s);v.init(i.vertexCount),p.init(i.vertexCount);var w=[0,3,1,1,3,2],A=[[1,1,0,0],[0,1,0,1],[1,0,0,1],[1,0,1,0]],T=i.indices=new(i.vertexCount>65535?Uint32Array:Uint16Array)((g-1)*(y-1)*6),S=function(e,t,n){n[1]=e*y+t,n[0]=e*y+t+1,n[3]=(e+1)*y+t+1,n[2]=(e+1)*y+t},E=!1;if(d){var C=[],M=[],L=0;x?h.init(i.vertexCount):h.value=null;for(var N=[[],[],[]],D=[],O=[],I=l.create(),R=function(e,t,n){var r=3*t;return n[0]=e[r],n[1]=e[r+1],n[2]=e[r+2],n},P=new Float32Array(s.length),k=new Float32Array(s.length/3*4),B=0;B<a.count();B++)if(a.hasValue(B)){var F=o["a"].parseColor(a.getItemVisual(B,"color")),z=a.getItemVisual(B,"opacity");F[3]*=z,F[3]<.99&&(E=!0);for(var H=0;H<4;H++)k[4*B+H]=F[H]}var U=[1e7,1e7,1e7];for(B=0;B<g-1;B++)for(var G=0;G<y-1;G++){var V=B*(y-1)+G,j=4*V;S(B,G,C);var W=!1;for(H=0;H<4;H++)R(s,C[H],M),u(M)&&(W=!0);for(H=0;H<4;H++)W?f.set(j+H,U):(R(s,C[H],M),f.set(j+H,M)),r&&m.set(j+H,A[H]);for(H=0;H<6;H++)T[L++]=w[H]+j;if(x&&!W)for(H=0;H<2;H++){for(var X=3*H,Y=0;Y<3;Y++){var q=C[w[X]+Y];R(s,q,N[Y])}l.sub(D,N[0],N[1]),l.sub(O,N[1],N[2]),l.cross(I,D,O);for(Y=0;Y<3;Y++){var Q=3*C[w[X]+Y];P[Q]=P[Q]+I[0],P[Q+1]=P[Q+1]+I[1],P[Q+2]=P[Q+2]+I[2]}}}if(x)for(B=0;B<P.length/3;B++)R(P,B,I),l.normalize(I,I),P[3*B]=I[0],P[3*B+1]=I[1],P[3*B+2]=I[2];F=[];var $=[];for(B=0;B<g-1;B++)for(G=0;G<y-1;G++){V=B*(y-1)+G,j=4*V;S(B,G,C);for(H=0;H<4;H++){for(Y=0;Y<4;Y++)F[Y]=k[4*C[H]+Y];v.set(j+H,F),x&&(R(P,C[H],I),h.set(j+H,I));q=C[H];$[0]=q%y/(y-1),$[1]=Math.floor(q/y)/(g-1),p.set(j+H,$)}V++}}else{for($=[],B=0;B<a.count();B++){$[0]=B%y/(y-1),$[1]=Math.floor(B/y)/(g-1);F=o["a"].parseColor(a.getItemVisual(B,"color")),z=a.getItemVisual(B,"opacity");F[3]*=z,F[3]<.99&&(E=!0),v.set(B,F),p.set(B,$)}C=[];var K=0;for(B=0;B<g-1;B++)for(G=0;G<y-1;G++){S(B,G,C);for(H=0;H<6;H++)T[K++]=C[w[H]]}x?i.generateVertexNormals():h.value=null}e.material.get("normalMap")&&i.generateTangents(),i.updateBoundingBox(),i.dirty(),e.material.transparent=E,e.material.depthMask=!E},_getDataShape:function(e,t){for(var n=-1/0,r=0,i=0,o=0,a=t?"u":"x",s=0;s<e.count();s++){var l=e.get(a,s);if(l<n){if(o&&o!==i)throw new Error("Invalid data. data should be a row major 2d array.");o=i,i=0,r++}n=l,i++}return{row:r+1,column:i}},dispose:function(){this.groupGL.removeAll()},remove:function(){this.groupGL.removeAll()}})},function(e,t,n){"use strict";var r=n(0),i=n.n(r);i.a.registerLayout((function(e,t){e.eachSeriesByType("surface",(function(e){var t=e.coordinateSystem;t&&"cartesian3D"===t.type||console.error("Surface chart only support cartesian3D coordinateSystem");var n=e.getData(),r=new Float32Array(3*n.count()),i=[NaN,NaN,NaN];if(t&&"cartesian3D"===t.type){var o=t.dimensions,a=o.map((function(t){return e.coordDimToDataDim(t)[0]}));n.each(a,(function(e,o,a,s){var l;l=n.hasValue(s)?t.dataToPoint([e,o,a]):i,r[3*s]=l[0],r[3*s+1]=l[1],r[3*s+2]=l[2]}))}n.setLayout("points",r)}))}))},function(e,t,n){"use strict";var r=n(0),i=n.n(r),o=(n(99),n(257),n(258),n(17));i.a.registerVisual(Object(o["a"])("map3D")),i.a.registerAction({type:"map3DChangeCamera",event:"map3dcamerachanged",update:"series:updateCamera"},(function(e,t){t.eachComponent({mainType:"series",subType:"map3D",query:e},(function(t){t.setView(e)}))}))},function(e,t,n){"use strict";var r=n(0),i=n.n(r),o=n(44),a=n(28),s=n(29),l=n(31),u=n(96),c=n(32),d=n(39),f=n(98);function h(e,t){for(var n=[],r=0;r<t.length;r++)n.push(e.dataToPoint(t[r]));return n}var p=i.a.extendSeriesModel({type:"series.map3D",layoutMode:"box",coordinateSystem:null,visualColorAccessPath:"itemStyle.color",optionUpdated:function(e){e=e||{};var t=this.get("coordinateSystem");if(null!=t&&"geo3D"!==t){var n=["left","top","width","height","boxWidth","boxDepth","boxHeight","light","viewControl","postEffect","temporalSuperSampling","environment","groundPlane"],r=[];n.forEach((function(t){null!=e[t]&&r.push(t)})),r.length&&console.warn("Property %s in map3D series will be ignored if coordinate system is %s",r.join(", "),t),this.get("groundPlane.show")&&(this.option.groundPlane.show=!1),this._geo=null}},getInitialData:function(e){e.data=this.getFilledRegions(e.data,e.map);var t=i.a.helper.completeDimensions(["value"],e.data),n=new i.a.List(t,this);n.initData(e.data);var r={};return n.each((function(e){var t=n.getName(e),i=n.getItemModel(e);r[t]=i})),this._regionModelMap=r,n},formatTooltip:function(e){return Object(d["a"])(this,e)},getRegionModel:function(e){var t=this.getData().getName(e);return this._regionModelMap[t]||new i.a.Model(null,this)},getRegionPolygonCoords:function(e){var t=this.coordinateSystem,n=this.getData().getName(e);if(t.transform){var r=t.getRegion(n);return r?r.geometries:[]}this._geo||(this._geo=f["a"].createGeo3D(this));r=this._geo.getRegion(n);for(var i=[],o=0;o<r.geometries.length;o++){var a=r.geometries[o],s=[],l=h(t,a.exterior);if(s&&s.length)for(var u=0;u<a.interiors.length;u++)s.push(h(t,s[u]));i.push({interiors:s,exterior:l})}return i},getFormattedLabel:function(e,t){var n=c["a"].getFormattedLabel(this,e,t);return null==n&&(n=this.getData().getName(e)),n},defaultOption:{coordinateSystem:"geo3D",data:null}});i.a.util.merge(p.prototype,u["a"]),i.a.util.merge(p.prototype,o["a"]),i.a.util.merge(p.prototype,a["a"]),i.a.util.merge(p.prototype,s["a"]),i.a.util.merge(p.prototype,l["a"])},function(e,t,n){"use strict";var r=n(0),i=n.n(r),o=n(1),a=n(45),s=n(30),l=n(64);i.a.extendChartView({type:"map3D",__ecgl__:!0,init:function(e,t){this._geo3DBuilder=new l["a"](t),this.groupGL=new o["a"].Node},render:function(e,t,n){var r=e.coordinateSystem;if(r&&r.viewGL){if(this.groupGL.add(this._geo3DBuilder.rootNode),r.viewGL.add(this.groupGL),"geo3D"===r.type){r,this._sceneHelper||(this._sceneHelper=new s["a"],this._sceneHelper.initLight(this.groupGL)),this._sceneHelper.setScene(r.viewGL.scene),this._sceneHelper.updateLight(e),r.viewGL.setPostEffect(e.getModel("postEffect"),n),r.viewGL.setTemporalSuperSampling(e.getModel("temporalSuperSampling"));var i=this._control;i||(i=this._control=new a["a"]({zr:n.getZr()}),this._control.init());var o=e.getModel("viewControl");i.setViewGL(r.viewGL),i.setFromViewControlModel(o,0),i.off("update"),i.on("update",(function(){n.dispatchAction({type:"map3DChangeCamera",alpha:i.getAlpha(),beta:i.getBeta(),distance:i.getDistance(),from:this.uid,map3DId:e.id})})),this._geo3DBuilder.extrudeY=!0}else this._control&&(this._control.dispose(),this._control=null),this._sceneHelper&&(this._sceneHelper.dispose(),this._sceneHelper=null),e.getData().getLayout("geo3D"),this._geo3DBuilder.extrudeY=!1;this._geo3DBuilder.update(e,t,n,0,e.getData().count());var l=r.viewGL.isLinearSpace()?"define":"undefine";this._geo3DBuilder.rootNode.traverse((function(e){e.material&&e.material[l]("fragment","SRGB_DECODE")}))}},afterRender:function(e,t,n,r){var i=r.renderer,o=e.coordinateSystem;o&&"geo3D"===o.type&&(this._sceneHelper.updateAmbientCubemap(i,e,n),this._sceneHelper.updateSkybox(i,e,n))},dispose:function(){this.groupGL.removeAll(),this._control.dispose()}})},function(e,t,n){"use strict";var r=n(0),i=n.n(r),o=(n(260),n(261),n(51)),a=n.n(o),s=n(17);i.a.registerVisual(a()("scatterGL","circle",null)),i.a.registerVisual(Object(s["a"])("scatterGL")),i.a.registerLayout({seriesType:"scatterGL",reset:function(e){var t,n=e.coordinateSystem;if(n){var r=n.dimensions,i=[];1===r.length?t=function(e,t){for(var i=new Float32Array(2*(e.end-e.start)),o=e.start;o<e.end;o++){var a=2*(o-e.start),s=t.get(r[0],o),l=n.dataToPoint(s);i[a]=l[0],i[a+1]=l[1]}t.setLayout("points",i)}:2===r.length&&(t=function(e,t){for(var o=new Float32Array(2*(e.end-e.start)),a=e.start;a<e.end;a++){var s=2*(a-e.start),l=t.get(r[0],a),u=t.get(r[1],a);i[0]=l,i[1]=u,i=n.dataToPoint(i),o[s]=i[0],o[s+1]=i[1]}t.setLayout("points",o)})}return{progress:t}}})},function(e,t,n){"use strict";var r=n(0),i=n.n(r);i.a.extendSeriesModel({type:"series.scatterGL",dependencies:["grid","polar","geo","singleAxis"],visualColorAccessPath:"itemStyle.color",getInitialData:function(){return i.a.helper.createList(this)},defaultOption:{coordinateSystem:"cartesian2d",zlevel:10,progressive:1e5,progressiveThreshold:1e5,large:!1,symbol:"circle",symbolSize:10,zoomScale:0,blendMode:"source-over",itemStyle:{opacity:.8},postEffect:{enable:!1,colorCorrection:{exposure:0,brightness:0,contrast:1,saturation:1,enable:!0}}}})},function(e,t,n){"use strict";var r=n(0),i=n.n(r),o=n(1),a=n(22),s=n(67),l=n(103);n(2);i.a.extendChartView({type:"scatterGL",__ecgl__:!0,init:function(e,t){this.groupGL=new o["a"].Node,this.viewGL=new a["a"]("orthographic"),this.viewGL.add(this.groupGL),this._pointsBuilderList=[],this._currentStep=0,this._sizeScale=1,this._glViewHelper=new l["a"](this.viewGL)},render:function(e,t,n){if(this.groupGL.removeAll(),this._glViewHelper.reset(e,n),e.getData().count()){var r=this._pointsBuilderList[0];r||(r=this._pointsBuilderList[0]=new s["a"](!0,n)),this._pointsBuilderList.length=1,this.groupGL.add(r.rootNode),this._removeTransformInPoints(e.getData().getLayout("points")),r.update(e,t,n),this.viewGL.setPostEffect(e.getModel("postEffect"),n)}},incrementalPrepareRender:function(e,t,n){this.groupGL.removeAll(),this._glViewHelper.reset(e,n),this._currentStep=0,this.viewGL.setPostEffect(e.getModel("postEffect"),n)},incrementalRender:function(e,t,n,r){if(!(e.end<=e.start)){var i=this._pointsBuilderList[this._currentStep];i||(i=new s["a"](!0,r),this._pointsBuilderList[this._currentStep]=i),this.groupGL.add(i.rootNode),this._removeTransformInPoints(t.getData().getLayout("points")),i.setSizeScale(this._sizeScale),i.update(t,n,r,e.start,e.end),r.getZr().refresh(),this._currentStep++}},updateTransform:function(e,t,n){if(e.coordinateSystem.getRoamTransform){this._glViewHelper.updateTransform(e,n);var r=this._glViewHelper.getZoom(),i=Math.max((e.get("zoomScale")||0)*(r-1)+1,0);this._sizeScale=i,this._pointsBuilderList.forEach((function(e){e.setSizeScale(i)}))}},_removeTransformInPoints:function(e){if(e)for(var t=[],n=0;n<e.length;n+=2)t[0]=e[n],t[1]=e[n+1],this._glViewHelper.removeTransformInPoint(t),e[n]=t[0],e[n+1]=t[1]},dispose:function(){this.groupGL.removeAll()},remove:function(){this.groupGL.removeAll()}})},function(e,t,n){"use strict";var r=n(0),i=n.n(r),o=(n(263),n(268),n(51)),a=n.n(o),s=n(17);function l(){}i.a.registerVisual(a()("graphGL","circle",null)),i.a.registerVisual(Object(s["a"])("graphGL")),i.a.registerVisual((function(e){var t={};e.eachSeriesByType("graphGL",(function(e){var n=e.getCategoriesData(),r=e.getData(),i={};n.each((function(r){var o=n.getName(r);i[o]=r;var a=n.getItemModel(r),s=a.get("itemStyle.color")||e.getColorFromPalette(o,t);n.setItemVisual(r,"color",s)})),n.count()&&r.each((function(e){var t=r.getItemModel(e),o=t.getShallow("category");null!=o&&("string"===typeof o&&(o=i[o]),r.getItemVisual(e,"color",!0)||r.setItemVisual(e,"color",n.getItemVisual(o,"color")))}))}))})),i.a.registerVisual((function(e){e.eachSeriesByType("graphGL",(function(e){var t=e.getGraph(),n=e.getEdgeData(),r="lineStyle.color".split("."),i="lineStyle.opacity".split(".");n.setVisual("color",e.get(r)),n.setVisual("opacity",e.get(i)),n.each((function(e){var o=n.getItemModel(e),a=t.getEdgeByIndex(e),s=o.get(r),l=o.get(i);switch(s){case"source":s=a.node1.getVisual("color");break;case"target":s=a.node2.getVisual("color");break}a.setVisual("color",s),a.setVisual("opacity",l)}))}))})),i.a.registerAction({type:"graphGLRoam",event:"graphglroam",update:"series.graphGL:roam"},(function(e,t){t.eachComponent({mainType:"series",query:e},(function(t){t.setView(e)}))})),i.a.registerAction({type:"graphGLStartLayout",event:"graphgllayoutstarted",update:"series.graphGL:startLayout"},l),i.a.registerAction({type:"graphGLStopLayout",event:"graphgllayoutstopped",update:"series.graphGL:stopLayout"},l),i.a.registerAction({type:"graphGLFocusNodeAdjacency",event:"graphGLFocusNodeAdjacency",update:"series.graphGL:focusNodeAdjacency"},l),i.a.registerAction({type:"graphGLUnfocusNodeAdjacency",event:"graphGLUnfocusNodeAdjacency",update:"series.graphGL:unfocusNodeAdjacency"},l)},function(e,t,n){"use strict";var r=n(0),i=n.n(r),o=n(264),a=n(32),s=i.a.extendSeriesModel({type:"series.graphGL",visualColorAccessPath:"itemStyle.color",init:function(e){s.superApply(this,"init",arguments),this.legendDataProvider=function(){return this._categoriesData},this._updateCategoriesData()},mergeOption:function(e){s.superApply(this,"mergeOption",arguments),this._updateCategoriesData()},getFormattedLabel:function(e,t,n,r){var i=a["a"].getFormattedLabel(this,e,t,n,r);if(null==i){var o=this.getData(),s=o.dimensions[o.dimensions.length-1];i=o.get(s,e)}return i},getInitialData:function(e,t){var n=e.edges||e.links||[],r=e.data||e.nodes||[],a=this;if(r&&n)return Object(o["a"])(r,n,this,!0,s).data;function s(e,n){e.wrapMethod("getItemModel",(function(e){var t=a._categoriesModels,n=e.getShallow("category"),r=t[n];return r&&(r.parentModel=e.parentModel,e.parentModel=r),e}));var r=a.getModel("edgeLabel"),o=new i.a.Model({label:r.option},r.parentModel,t);function s(e){return e=this.parsePath(e),e&&"label"===e[0]?o:this.parentModel}n.wrapMethod("getItemModel",(function(e){return e.customizeGetParent(s),e}))}},getGraph:function(){return this.getData().graph},getEdgeData:function(){return this.getGraph().edgeData},getCategoriesData:function(){return this._categoriesData},formatTooltip:function(e,t,n){if("edge"===n){var r=this.getData(),o=this.getDataParams(e,n),a=r.graph.getEdgeByIndex(e),l=r.getName(a.node1.dataIndex),u=r.getName(a.node2.dataIndex),c=[];return null!=l&&c.push(l),null!=u&&c.push(u),c=i.a.format.encodeHTML(c.join(" > ")),o.value&&(c+=" : "+i.a.format.encodeHTML(o.value)),c}return s.superApply(this,"formatTooltip",arguments)},_updateCategoriesData:function(){var e=(this.option.categories||[]).map((function(e){return null!=e.value?e:i.a.util.extend({value:0},e)})),t=new i.a.List(["value"],this);t.initData(e),this._categoriesData=t,this._categoriesModels=t.mapArray((function(e){return t.getItemModel(e,!0)}))},setView:function(e){null!=e.zoom&&(this.option.zoom=e.zoom),null!=e.offset&&(this.option.offset=e.offset)},setNodePosition:function(e){for(var t=0;t<e.length/2;t++){var n=e[2*t],r=e[2*t+1],i=this.getData().getRawDataItem(t);i.x=n,i.y=r}},isAnimationEnabled:function(){return s.superCall(this,"isAnimationEnabled")&&!("force"===this.get("layout")&&this.get("force.layoutAnimation"))},defaultOption:{zlevel:10,z:2,legendHoverLink:!0,layout:"forceAtlas2",forceAtlas2:{initLayout:null,GPU:!0,steps:1,maxSteps:1e3,repulsionByDegree:!0,linLogMode:!1,strongGravityMode:!1,gravity:1,edgeWeightInfluence:1,edgeWeight:[1,4],nodeWeight:[1,4],preventOverlap:!1,gravityCenter:null},focusNodeAdjacency:!0,focusNodeAdjacencyOn:"mouseover",left:"center",top:"center",symbol:"circle",symbolSize:5,roam:!1,center:null,zoom:1,label:{show:!1,formatter:"{b}",position:"right",distance:5,textStyle:{fontSize:14}},itemStyle:{},lineStyle:{color:"#aaa",width:1,opacity:.5},emphasis:{label:{show:!0}},animation:!1}})},function(e,t,n){"use strict";var r=n(0),i=n.n(r),o=n(265),a=n.n(o),s=n(267),l=n.n(s),u=n(2);t["a"]=function(e,t,n,r,o){for(var s=new a.a(r),c=0;c<e.length;c++)s.addNode(u["a"].firstNotNull(e[c].id,e[c].name,c),c);var d,f=[],h=[],p=0;for(c=0;c<t.length;c++){var m=t[c],v=m.source,g=m.target;s.addEdge(v,g,p)&&(h.push(m),f.push(u["a"].firstNotNull(m.id,v+" > "+g)),p++)}var y=i.a.helper.completeDimensions(["value"],e);d=new i.a.List(y,n),d.initData(e);var _=new i.a.List(["value"],n);return _.initData(h,f),o&&o(d,_),l()({mainData:d,struct:s,structAttr:"graph",datas:{node:d,edge:_},datasAttr:{node:"data",edge:"edgeData"}}),s.update(),s}},function(e,t,n){var r=n(104),i=(r.__DEV__,n(13)),o=n(266),a=o.enableClassCheck;function s(e){return"_EC_"+e}var l=function(e){this._directed=e||!1,this.nodes=[],this.edges=[],this._nodesMap={},this._edgesMap={},this.data,this.edgeData},u=l.prototype;function c(e,t){this.id=null==e?"":e,this.inEdges=[],this.outEdges=[],this.edges=[],this.hostGraph,this.dataIndex=null==t?-1:t}function d(e,t,n){this.node1=e,this.node2=t,this.dataIndex=null==n?-1:n}u.type="graph",u.isDirected=function(){return this._directed},u.addNode=function(e,t){e=e||""+t;var n=this._nodesMap;if(!n[s(e)]){var r=new c(e,t);return r.hostGraph=this,this.nodes.push(r),n[s(e)]=r,r}},u.getNodeByIndex=function(e){var t=this.data.getRawIndex(e);return this.nodes[t]},u.getNodeById=function(e){return this._nodesMap[s(e)]},u.addEdge=function(e,t,n){var r=this._nodesMap,i=this._edgesMap;if("number"===typeof e&&(e=this.nodes[e]),"number"===typeof t&&(t=this.nodes[t]),c.isInstance(e)||(e=r[s(e)]),c.isInstance(t)||(t=r[s(t)]),e&&t){var o=e.id+"-"+t.id;if(!i[o]){var a=new d(e,t,n);return a.hostGraph=this,this._directed&&(e.outEdges.push(a),t.inEdges.push(a)),e.edges.push(a),e!==t&&t.edges.push(a),this.edges.push(a),i[o]=a,a}}},u.getEdgeByIndex=function(e){var t=this.edgeData.getRawIndex(e);return this.edges[t]},u.getEdge=function(e,t){c.isInstance(e)&&(e=e.id),c.isInstance(t)&&(t=t.id);var n=this._edgesMap;return this._directed?n[e+"-"+t]:n[e+"-"+t]||n[t+"-"+e]},u.eachNode=function(e,t){for(var n=this.nodes,r=n.length,i=0;i<r;i++)n[i].dataIndex>=0&&e.call(t,n[i],i)},u.eachEdge=function(e,t){for(var n=this.edges,r=n.length,i=0;i<r;i++)n[i].dataIndex>=0&&n[i].node1.dataIndex>=0&&n[i].node2.dataIndex>=0&&e.call(t,n[i],i)},u.breadthFirstTraverse=function(e,t,n,r){if(c.isInstance(t)||(t=this._nodesMap[s(t)]),t){for(var i="out"===n?"outEdges":"in"===n?"inEdges":"edges",o=0;o<this.nodes.length;o++)this.nodes[o].__visited=!1;if(!e.call(r,t,null)){var a=[t];while(a.length){var l=a.shift(),u=l[i];for(o=0;o<u.length;o++){var d=u[o],f=d.node1===l?d.node2:d.node1;if(!f.__visited){if(e.call(r,f,l))return;a.push(f),f.__visited=!0}}}}}},u.update=function(){for(var e=this.data,t=this.edgeData,n=this.nodes,r=this.edges,i=0,o=n.length;i<o;i++)n[i].dataIndex=-1;for(i=0,o=e.count();i<o;i++)n[e.getRawIndex(i)].dataIndex=i;t.filterSelf((function(e){var n=r[t.getRawIndex(e)];return n.node1.dataIndex>=0&&n.node2.dataIndex>=0}));for(i=0,o=r.length;i<o;i++)r[i].dataIndex=-1;for(i=0,o=t.count();i<o;i++)r[t.getRawIndex(i)].dataIndex=i},u.clone=function(){for(var e=new l(this._directed),t=this.nodes,n=this.edges,r=0;r<t.length;r++)e.addNode(t[r].id,t[r].dataIndex);for(r=0;r<n.length;r++){var i=n[r];e.addEdge(i.node1.id,i.node2.id,i.dataIndex)}return e},c.prototype={constructor:c,degree:function(){return this.edges.length},inDegree:function(){return this.inEdges.length},outDegree:function(){return this.outEdges.length},getModel:function(e){if(!(this.dataIndex<0)){var t=this.hostGraph,n=t.data.getItemModel(this.dataIndex);return n.getModel(e)}}},d.prototype.getModel=function(e){if(!(this.dataIndex<0)){var t=this.hostGraph,n=t.edgeData.getItemModel(this.dataIndex);return n.getModel(e)}};var f=function(e,t){return{getValue:function(n){var r=this[e][t];return r.get(r.getDimension(n||"value"),this.dataIndex)},setVisual:function(n,r){this.dataIndex>=0&&this[e][t].setItemVisual(this.dataIndex,n,r)},getVisual:function(n,r){return this[e][t].getItemVisual(this.dataIndex,n,r)},setLayout:function(n,r){this.dataIndex>=0&&this[e][t].setItemLayout(this.dataIndex,n,r)},getLayout:function(){return this[e][t].getItemLayout(this.dataIndex)},getGraphicEl:function(){return this[e][t].getItemGraphicEl(this.dataIndex)},getRawIndex:function(){return this[e][t].getRawIndex(this.dataIndex)}}};i.mixin(c,f("hostGraph","data")),i.mixin(d,f("hostGraph","edgeData")),l.Node=c,l.Edge=d,a(c),a(d);var h=l;e.exports=h},function(e,t,n){var r=n(104),i=(r.__DEV__,n(13)),o=".",a="___EC__COMPONENT__CONTAINER___";function s(e){var t={main:"",sub:""};return e&&(e=e.split(o),t.main=e[0]||"",t.sub=e[1]||""),t}function l(e){i.assert(/^[a-zA-Z0-9_]+([.][a-zA-Z0-9_]+)?$/.test(e),'componentType "'+e+'" illegal')}function u(e,t){e.$constructor=e,e.extend=function(e){var t=this,n=function(){e.$constructor?e.$constructor.apply(this,arguments):t.apply(this,arguments)};return i.extend(n.prototype,e),n.extend=this.extend,n.superCall=f,n.superApply=h,i.inherits(n,this),n.superClass=t,n}}var c=0;function d(e){var t=["__\0is_clz",c++,Math.random().toFixed(3)].join("_");e.prototype[t]=!0,e.isInstance=function(e){return!(!e||!e[t])}}function f(e,t){var n=i.slice(arguments,2);return this.superClass.prototype[t].apply(e,n)}function h(e,t,n){return this.superClass.prototype[t].apply(e,n)}function p(e,t){t=t||{};var n={};function r(e){var t=n[e.main];return t&&t[a]||(t=n[e.main]={},t[a]=!0),t}if(e.registerClass=function(e,t){if(t)if(l(t),t=s(t),t.sub){if(t.sub!==a){var i=r(t);i[t.sub]=e}}else n[t.main]=e;return e},e.getClass=function(e,t,r){var i=n[e];if(i&&i[a]&&(i=t?i[t]:null),r&&!i)throw new Error(t?"Component "+e+"."+(t||"")+" not exists. Load it first.":e+".type should be specified.");return i},e.getClassesByMainType=function(e){e=s(e);var t=[],r=n[e.main];return r&&r[a]?i.each(r,(function(e,n){n!==a&&t.push(e)})):t.push(r),t},e.hasClass=function(e){return e=s(e),!!n[e.main]},e.getAllClassMainTypes=function(){var e=[];return i.each(n,(function(t,n){e.push(n)})),e},e.hasSubTypes=function(e){e=s(e);var t=n[e.main];return t&&t[a]},e.parseClassType=s,t.registerWhenExtend){var o=e.extend;o&&(e.extend=function(t){var n=o.call(this,t);return e.registerClass(n,t.type)})}return e}function m(e,t){}t.parseClassType=s,t.enableClassExtend=u,t.enableClassCheck=d,t.enableClassManagement=p,t.setReadOnly=m},function(e,t,n){var r=n(13),i=r.each,o="\0__link_datas",a="\0__link_mainData";function s(e){var t=e.mainData,n=e.datas;n||(n={main:t},e.datasAttr={main:"data"}),e.datas=e.mainData=null,h(t,n,e),i(n,(function(n){i(t.TRANSFERABLE_METHODS,(function(t){n.wrapMethod(t,r.curry(l,e))}))})),t.wrapMethod("cloneShallow",r.curry(c,e)),i(t.CHANGABLE_METHODS,(function(n){t.wrapMethod(n,r.curry(u,e))})),r.assert(n[t.dataType]===t)}function l(e,t){if(f(this)){var n=r.extend({},this[o]);n[this.dataType]=t,h(t,n,e)}else p(t,this.dataType,this[a],e);return t}function u(e,t){return e.struct&&e.struct.update(this),t}function c(e,t){return i(t[o],(function(n,r){n!==t&&p(n.cloneShallow(),r,t,e)})),t}function d(e){var t=this[a];return null==e||null==t?t:t[o][e]}function f(e){return e[a]===e}function h(e,t,n){e[o]={},i(t,(function(t,r){p(t,r,e,n)}))}function p(e,t,n,r){n[o][t]=e,e[a]=n,e.dataType=t,r.struct&&(e[r.structAttr]=r.struct,r.struct[r.datasAttr[t]]=e),e.getLinkedData=d}var m=s;e.exports=m},function(e,t,n){"use strict";var r=n(0),i=n.n(r),o=n(47),a=n.n(o),s=n(1),l=n(22),u=n(105),c=n(2),d=n(269),f=n(271),h=n(80),p=n.n(h),m=n(6),v=n(273),g=n(67),y=n(274),_=m["a"].vec2;s["a"].Shader.import(y["a"]);var x=1;i.a.extendChartView({type:"graphGL",__ecgl__:!0,init:function(e,t){this.groupGL=new s["a"].Node,this.viewGL=new l["a"]("orthographic"),this.viewGL.camera.left=this.viewGL.camera.right=0,this.viewGL.add(this.groupGL),this._pointsBuilder=new g["a"](!0,t),this._forceEdgesMesh=new s["a"].Mesh({material:new s["a"].Material({shader:s["a"].createShader("ecgl.forceAtlas2.edges"),transparent:!0,depthMask:!1,depthTest:!1}),$ignorePicking:!0,geometry:new s["a"].Geometry({attributes:{node:new s["a"].Geometry.Attribute("node","float",2),color:new s["a"].Geometry.Attribute("color","float",4,"COLOR")},dynamic:!0,mainAttribute:"node"}),renderOrder:-1,mode:s["a"].Mesh.LINES}),this._edgesMesh=new s["a"].Mesh({material:new s["a"].Material({shader:s["a"].createShader("ecgl.meshLines2D"),transparent:!0,depthMask:!1,depthTest:!1}),$ignorePicking:!0,geometry:new u["a"]({useNativeLine:!1,dynamic:!0}),renderOrder:-1,culling:!1}),this._layoutId=0,this._control=new v["a"]({zr:t.getZr(),viewGL:this.viewGL}),this._control.setTarget(this.groupGL),this._control.init(),this._clickHandler=this._clickHandler.bind(this)},render:function(e,t,n){this.groupGL.add(this._pointsBuilder.rootNode),this._model=e,this._api=n,this._initLayout(e,t,n),this._pointsBuilder.update(e,t,n),this._forceLayoutInstance instanceof d["a"]||this.groupGL.remove(this._forceEdgesMesh),this._updateCamera(e,n),this._control.off("update"),this._control.on("update",(function(){n.dispatchAction({type:"graphGLRoam",seriesId:e.id,zoom:this._control.getZoom(),offset:this._control.getOffset()}),this._pointsBuilder.updateView(this.viewGL.camera)}),this),this._control.setZoom(c["a"].firstNotNull(e.get("zoom"),1)),this._control.setOffset(e.get("offset")||[0,0]);var r=this._pointsBuilder.getPointsMesh();if(r.off("mousemove",this._mousemoveHandler),r.off("mouseout",this._mouseOutHandler,this),n.getZr().off("click",this._clickHandler),this._pointsBuilder.highlightOnMouseover=!0,e.get("focusNodeAdjacency")){var i=e.get("focusNodeAdjacencyOn");"click"===i?n.getZr().on("click",this._clickHandler):"mouseover"===i?(r.on("mousemove",this._mousemoveHandler,this),r.on("mouseout",this._mouseOutHandler,this),this._pointsBuilder.highlightOnMouseover=!1):console.warn("Unkown focusNodeAdjacencyOn value s"+i)}this._lastMouseOverDataIndex=-1},_clickHandler:function(e){if(!this._layouting){var t=this._pointsBuilder.getPointsMesh().dataIndex;t>=0?this._api.dispatchAction({type:"graphGLFocusNodeAdjacency",seriesId:this._model.id,dataIndex:t}):this._api.dispatchAction({type:"graphGLUnfocusNodeAdjacency",seriesId:this._model.id})}},_mousemoveHandler:function(e){if(!this._layouting){var t=this._pointsBuilder.getPointsMesh().dataIndex;t>=0?t!==this._lastMouseOverDataIndex&&this._api.dispatchAction({type:"graphGLFocusNodeAdjacency",seriesId:this._model.id,dataIndex:t}):this._mouseOutHandler(e),this._lastMouseOverDataIndex=t}},_mouseOutHandler:function(e){this._layouting||(this._api.dispatchAction({type:"graphGLUnfocusNodeAdjacency",seriesId:this._model.id}),this._lastMouseOverDataIndex=-1)},_updateForceEdgesGeometry:function(e,t){var n=this._forceEdgesMesh.geometry,r=t.getEdgeData(),i=0,o=this._forceLayoutInstance,a=2*r.count();n.attributes.node.init(a),n.attributes.color.init(a),r.each((function(t){var a=e[t];n.attributes.node.set(i,o.getNodeUV(a.node1)),n.attributes.node.set(i+1,o.getNodeUV(a.node2));var l=r.getItemVisual(a.dataIndex,"color"),u=s["a"].parseColor(l);u[3]*=c["a"].firstNotNull(r.getItemVisual(a.dataIndex,"opacity"),1),n.attributes.color.set(i,u),n.attributes.color.set(i+1,u),i+=2})),n.dirty()},_updateMeshLinesGeometry:function(){var e=this._model.getEdgeData(),t=this._edgesMesh.geometry,n=(e=this._model.getEdgeData(),this._model.getData().getLayout("points"));t.resetOffset(),t.setVertexCount(e.count()*t.getLineVertexCount()),t.setTriangleCount(e.count()*t.getLineTriangleCount());var r=[],i=[],o=["lineStyle","width"];this._originalEdgeColors=new Float32Array(4*e.count()),this._edgeIndicesMap=new Float32Array(e.count()),e.each((function(a){var l=e.graph.getEdgeByIndex(a),u=2*l.node1.dataIndex,d=2*l.node2.dataIndex;r[0]=n[u],r[1]=n[u+1],i[0]=n[d],i[1]=n[d+1];var f=e.getItemVisual(l.dataIndex,"color"),h=s["a"].parseColor(f);h[3]*=c["a"].firstNotNull(e.getItemVisual(l.dataIndex,"opacity"),1);var p=e.getItemModel(l.dataIndex),m=c["a"].firstNotNull(p.get(o),1)*this._api.getDevicePixelRatio();t.addLine(r,i,h,m);for(var v=0;v<4;v++)this._originalEdgeColors[4*l.dataIndex+v]=h[v];this._edgeIndicesMap[l.dataIndex]=a}),this),t.dirty()},_updateForceNodesGeometry:function(e){for(var t=this._pointsBuilder.getPointsMesh(),n=[],r=0;r<e.count();r++)this._forceLayoutInstance.getNodeUV(r,n),t.geometry.attributes.position.set(r,n);t.geometry.dirty("position")},_initLayout:function(e,t,n){var r=e.get("layout"),o=e.getGraph(),s=e.getBoxLayoutParams(),l=a.a.getLayoutRect(s,{width:n.getWidth(),height:n.getHeight()});"force"===r&&(console.warn("Currently only forceAtlas2 layout supported."),r="forceAtlas2"),this.stopLayout(e,t,n,{beforeLayout:!0});var u=e.getData(),h=e.getData();if("forceAtlas2"===r){var p=e.getModel("forceAtlas2"),m=this._forceLayoutInstance,v=[],g=[],y=u.getDataExtent("value"),_=h.getDataExtent("value"),x=c["a"].firstNotNull(p.get("edgeWeight"),1),b=c["a"].firstNotNull(p.get("nodeWeight"),1);"number"===typeof x&&(x=[x,x]),"number"===typeof b&&(b=[b,b]);var w=0,A={},T=new Float32Array(2*u.count());if(o.eachNode((function(e){var t,n,r=e.dataIndex,o=u.get("value",r);if(u.hasItemOption){var a=u.getItemModel(r);t=a.get("x"),n=a.get("y")}null==t&&(t=l.x+Math.random()*l.width,n=l.y+Math.random()*l.height),T[2*w]=t,T[2*w+1]=n,A[e.id]=w++;var s=i.a.number.linearMap(o,y,b);isNaN(s)&&(s=isNaN(b[0])?1:b[0]),v.push({x:t,y:n,mass:s,size:u.getItemVisual(r,"symbolSize")})})),u.setLayout("points",T),o.eachEdge((function(e){var t=e.dataIndex,n=u.get("value",t),r=i.a.number.linearMap(n,_,x);isNaN(r)&&(r=isNaN(x[0])?1:x[0]),g.push({node1:A[e.node1.id],node2:A[e.node2.id],weight:r,dataIndex:t})})),!m){var S=p.get("GPU");this._forceLayoutInstance&&((!S||this._forceLayoutInstance instanceof d["a"])&&(S||this._forceLayoutInstance instanceof f["a"])||(this._forceLayoutInstanceToDispose=this._forceLayoutInstance)),m=this._forceLayoutInstance=S?new d["a"]:new f["a"]}m.initData(v,g),m.updateOption(p.option),this._updateForceEdgesGeometry(m.getEdges(),e),this._updatePositionTexture(),n.dispatchAction({type:"graphGLStartLayout",from:this.uid})}else{T=new Float32Array(2*u.count()),w=0;o.eachNode((function(e){var t,n,r=e.dataIndex;if(u.hasItemOption){var i=u.getItemModel(r);t=i.get("x"),n=i.get("y")}T[w++]=t,T[w++]=n})),u.setLayout("points",T),this._updateAfterLayout(e,t,n)}},_updatePositionTexture:function(){var e=this._forceLayoutInstance.getNodePositionTexture();this._pointsBuilder.setPositionTexture(e),this._forceEdgesMesh.material.set("positionTex",e)},startLayout:function(e,t,n,r){if(!r||null==r.from||r.from===this.uid){var i=this.viewGL,o=(n=this._api,this._forceLayoutInstance),a=this._model.getData(),s=this._model.getModel("forceAtlas2");if(o){if(this.groupGL.remove(this._edgesMesh),this.groupGL.add(this._forceEdgesMesh),this._forceLayoutInstance){this._updateForceNodesGeometry(e.getData()),this._pointsBuilder.hideLabels();var l=this,u=this._layoutId=x++,c=s.getShallow("maxSteps"),d=s.getShallow("steps"),f=0,h=Math.max(2*d,20),m=function(t){if(t===l._layoutId)return o.isFinished(c)?(n.dispatchAction({type:"graphGLStopLayout",from:l.uid}),void n.dispatchAction({type:"graphGLFinishLayout",points:a.getLayout("points"),from:l.uid})):void o.update(i.layer.renderer,d,(function(){l._updatePositionTexture(),f+=d,f>=h&&(l._syncNodePosition(e),f=0),n.getZr().refresh(),p()((function(){m(t)}))}))};p()((function(){l._forceLayoutInstanceToDispose&&(l._forceLayoutInstanceToDispose.dispose(i.layer.renderer),l._forceLayoutInstanceToDispose=null),m(u)})),this._layouting=!0}}else console.error("None layout don't have startLayout action")}},stopLayout:function(e,t,n,r){r&&null!=r.from&&r.from!==this.uid||(this._layoutId=0,this.groupGL.remove(this._forceEdgesMesh),this.groupGL.add(this._edgesMesh),this._forceLayoutInstance&&this.viewGL.layer&&(r&&r.beforeLayout||(this._syncNodePosition(e),this._updateAfterLayout(e,t,n)),this._api.getZr().refresh(),this._layouting=!1))},_syncNodePosition:function(e){var t=this._forceLayoutInstance.getNodePosition(this.viewGL.layer.renderer);e.getData().setLayout("points",t),e.setNodePosition(t)},_updateAfterLayout:function(e,t,n){this._updateMeshLinesGeometry(),this._pointsBuilder.removePositionTexture(),this._pointsBuilder.updateLayout(e,t,n),this._pointsBuilder.updateView(this.viewGL.camera),this._pointsBuilder.updateLabels(),this._pointsBuilder.showLabels()},focusNodeAdjacency:function(e,t,n,r){var i=this._model.getData();this._downplayAll();var o=r.dataIndex,a=i.graph,s=[],l=a.getNodeByIndex(o);s.push(l),l.edges.forEach((function(e){e.dataIndex<0||(e.node1!==l&&s.push(e.node1),e.node2!==l&&s.push(e.node2))}),this),this._pointsBuilder.fadeOutAll(.05),this._fadeOutEdgesAll(.05),s.forEach((function(e){this._pointsBuilder.highlight(i,e.dataIndex)}),this),this._pointsBuilder.updateLabels(s.map((function(e){return e.dataIndex})));var u=[];l.edges.forEach((function(e){e.dataIndex>=0&&(this._highlightEdge(e.dataIndex),u.push(e))}),this),this._focusNodes=s,this._focusEdges=u},unfocusNodeAdjacency:function(e,t,n,r){this._downplayAll(),this._pointsBuilder.fadeInAll(),this._fadeInEdgesAll(),this._pointsBuilder.updateLabels()},_highlightEdge:function(e){var t=this._model.getEdgeData().getItemModel(e),n=s["a"].parseColor(t.get("emphasis.lineStyle.color")||t.get("lineStyle.color")),r=c["a"].firstNotNull(t.get("emphasis.lineStyle.opacity"),t.get("lineStyle.opacity"),1);n[3]*=r,this._edgesMesh.geometry.setItemColor(this._edgeIndicesMap[e],n)},_downplayAll:function(){this._focusNodes&&this._focusNodes.forEach((function(e){this._pointsBuilder.downplay(this._model.getData(),e.dataIndex)}),this),this._focusEdges&&this._focusEdges.forEach((function(e){this._downplayEdge(e.dataIndex)}),this)},_downplayEdge:function(e){var t=this._getColor(e,[]);this._edgesMesh.geometry.setItemColor(this._edgeIndicesMap[e],t)},_setEdgeFade:function(){var e=[];return function(t,n){this._getColor(t,e),e[3]*=n,this._edgesMesh.geometry.setItemColor(this._edgeIndicesMap[t],e)}}(),_getColor:function(e,t){for(var n=0;n<4;n++)t[n]=this._originalEdgeColors[4*e+n];return t},_fadeOutEdgesAll:function(e){var t=this._model.getData().graph;t.eachEdge((function(t){this._setEdgeFade(t.dataIndex,e)}),this)},_fadeInEdgesAll:function(){this._fadeOutEdgesAll(1)},_updateCamera:function(e,t){this.viewGL.setViewport(0,0,t.getWidth(),t.getHeight(),t.getDevicePixelRatio());for(var n=this.viewGL.camera,r=e.getData(),i=r.getLayout("points"),o=_.create(1/0,1/0),a=_.create(-1/0,-1/0),s=[],l=0;l<i.length;)s[0]=i[l++],s[1]=i[l++],_.min(o,o,s),_.max(a,a,s);var u=(a[1]+o[1])/2,c=(a[0]+o[0])/2;if(!(c>n.left&&c<n.right&&u<n.bottom&&u>n.top)){var d=Math.max(a[0]-o[0],10),f=d/t.getWidth()*t.getHeight();d*=1.4,f*=1.4,o[0]-=.2*d,n.left=o[0],n.top=u-f/2,n.bottom=u+f/2,n.right=d+o[0],n.near=0,n.far=100}},dispose:function(){var e=this.viewGL.layer.renderer;this._forceLayoutInstance&&this._forceLayoutInstance.dispose(e),this.groupGL.removeAll(),this._layoutId=-1},remove:function(){this.groupGL.removeAll(),this._control.dispose()}})},function(e,t,n){"use strict";var r=n(0),i=n.n(r),o=n(1),a=n(16),s=n(10),l=n(270);o["a"].Shader.import(l["a"]);var u={repulsionByDegree:!0,linLogMode:!1,strongGravityMode:!1,gravity:1,scaling:1,edgeWeightInfluence:1,jitterTolerence:.1,preventOverlap:!1,dissuadeHubs:!1,gravityCenter:null};function c(e){var t={type:o["a"].Texture.FLOAT,minFilter:o["a"].Texture.NEAREST,magFilter:o["a"].Texture.NEAREST};this._positionSourceTex=new o["a"].Texture2D(t),this._positionSourceTex.flipY=!1,this._positionTex=new o["a"].Texture2D(t),this._positionPrevTex=new o["a"].Texture2D(t),this._forceTex=new o["a"].Texture2D(t),this._forcePrevTex=new o["a"].Texture2D(t),this._weightedSumTex=new o["a"].Texture2D(t),this._weightedSumTex.width=this._weightedSumTex.height=1,this._globalSpeedTex=new o["a"].Texture2D(t),this._globalSpeedPrevTex=new o["a"].Texture2D(t),this._globalSpeedTex.width=this._globalSpeedTex.height=1,this._globalSpeedPrevTex.width=this._globalSpeedPrevTex.height=1,this._nodeRepulsionPass=new a["a"]({fragment:o["a"].Shader.source("ecgl.forceAtlas2.updateNodeRepulsion")}),this._positionPass=new a["a"]({fragment:o["a"].Shader.source("ecgl.forceAtlas2.updatePosition")}),this._globalSpeedPass=new a["a"]({fragment:o["a"].Shader.source("ecgl.forceAtlas2.calcGlobalSpeed")}),this._copyPass=new a["a"]({fragment:o["a"].Shader.source("clay.compositor.output")});var n=function(e){e.blendEquation(e.FUNC_ADD),e.blendFunc(e.ONE,e.ONE)};this._edgeForceMesh=new o["a"].Mesh({geometry:new o["a"].Geometry({attributes:{node1:new o["a"].Geometry.Attribute("node1","float",2),node2:new o["a"].Geometry.Attribute("node2","float",2),weight:new o["a"].Geometry.Attribute("weight","float",1)},dynamic:!0,mainAttribute:"node1"}),material:new o["a"].Material({transparent:!0,shader:o["a"].createShader("ecgl.forceAtlas2.updateEdgeAttraction"),blend:n,depthMask:!1,depthText:!1}),mode:o["a"].Mesh.POINTS}),this._weightedSumMesh=new o["a"].Mesh({geometry:new o["a"].Geometry({attributes:{node:new o["a"].Geometry.Attribute("node","float",2)},dynamic:!0,mainAttribute:"node"}),material:new o["a"].Material({transparent:!0,shader:o["a"].createShader("ecgl.forceAtlas2.calcWeightedSum"),blend:n,depthMask:!1,depthText:!1}),mode:o["a"].Mesh.POINTS}),this._framebuffer=new s["a"]({depthBuffer:!1}),this._dummyCamera=new o["a"].OrthographicCamera({left:-1,right:1,top:1,bottom:-1,near:0,far:100}),this._globalSpeed=0}c.prototype.updateOption=function(e){for(var t in u)this[t]=u[t];var n=this._nodes.length;if(this.jitterTolerence=n>5e4?10:n>5e3?1:.1,this.scaling=n>100?2:10,e)for(var t in u)null!=e[t]&&(this[t]=e[t]);if(this.repulsionByDegree)for(var r=this._positionSourceTex.pixels,i=0;i<this._nodes.length;i++)r[4*i+2]=(this._nodes[i].degree||0)+1},c.prototype._updateGravityCenter=function(e){var t=this._nodes,n=this._edges;if(this.gravityCenter)this._gravityCenter=this.gravityCenter;else{for(var r=[1/0,1/0],i=[-1/0,-1/0],o=0;o<t.length;o++)r[0]=Math.min(t[o].x,r[0]),r[1]=Math.min(t[o].y,r[1]),i[0]=Math.max(t[o].x,i[0]),i[1]=Math.max(t[o].y,i[1]);this._gravityCenter=[.5*(r[0]+i[0]),.5*(r[1]+i[1])]}for(o=0;o<n.length;o++){var a=n[o].node1,s=n[o].node2;t[a].degree=(t[a].degree||0)+1,t[s].degree=(t[s].degree||0)+1}},c.prototype.initData=function(e,t){this._nodes=e,this._edges=t,this._updateGravityCenter();var n=Math.ceil(Math.sqrt(e.length)),r=n,i=new Float32Array(n*r*4);this._resize(n,r);for(var o=0,a=0;a<e.length;a++){var s=e[a];i[o++]=s.x||0,i[o++]=s.y||0,i[o++]=s.mass||1,i[o++]=s.size||1}this._positionSourceTex.pixels=i;var l=this._edgeForceMesh.geometry,u=t.length;l.attributes.node1.init(2*u),l.attributes.node2.init(2*u),l.attributes.weight.init(2*u);var c=[];for(a=0;a<t.length;a++){var d=l.attributes,f=t[a].weight;null==f&&(f=1),d.node1.set(a,this.getNodeUV(t[a].node1,c)),d.node2.set(a,this.getNodeUV(t[a].node2,c)),d.weight.set(a,f),d.node1.set(a+u,this.getNodeUV(t[a].node2,c)),d.node2.set(a+u,this.getNodeUV(t[a].node1,c)),d.weight.set(a+u,f)}var h=this._weightedSumMesh.geometry;h.attributes.node.init(e.length);for(a=0;a<e.length;a++)h.attributes.node.set(a,this.getNodeUV(a,c));l.dirty(),h.dirty(),this._nodeRepulsionPass.material.define("fragment","NODE_COUNT",e.length),this._nodeRepulsionPass.material.setUniform("textureSize",[n,r]),this._inited=!1,this._frame=0},c.prototype.getNodes=function(){return this._nodes},c.prototype.getEdges=function(){return this._edges},c.prototype.step=function(e){this._inited||(this._initFromSource(e),this._inited=!0),this._frame++,this._framebuffer.attach(this._forceTex),this._framebuffer.bind(e);var t=this._nodeRepulsionPass;t.setUniform("strongGravityMode",this.strongGravityMode),t.setUniform("gravity",this.gravity),t.setUniform("gravityCenter",this._gravityCenter),t.setUniform("scaling",this.scaling),t.setUniform("preventOverlap",this.preventOverlap),t.setUniform("positionTex",this._positionPrevTex),t.render(e);var n=this._edgeForceMesh;n.material.set("linLogMode",this.linLogMode),n.material.set("edgeWeightInfluence",this.edgeWeightInfluence),n.material.set("preventOverlap",this.preventOverlap),n.material.set("positionTex",this._positionPrevTex),e.gl.enable(e.gl.BLEND),e.renderPass([n],this._dummyCamera),this._framebuffer.attach(this._weightedSumTex),e.gl.clearColor(0,0,0,0),e.gl.clear(e.gl.COLOR_BUFFER_BIT),e.gl.enable(e.gl.BLEND);var r=this._weightedSumMesh;r.material.set("positionTex",this._positionPrevTex),r.material.set("forceTex",this._forceTex),r.material.set("forcePrevTex",this._forcePrevTex),e.renderPass([r],this._dummyCamera),this._framebuffer.attach(this._globalSpeedTex);var i=this._globalSpeedPass;i.setUniform("globalSpeedPrevTex",this._globalSpeedPrevTex),i.setUniform("weightedSumTex",this._weightedSumTex),i.setUniform("jitterTolerence",this.jitterTolerence),e.gl.disable(e.gl.BLEND),i.render(e);var o=this._positionPass;this._framebuffer.attach(this._positionTex),o.setUniform("globalSpeedTex",this._globalSpeedTex),o.setUniform("positionTex",this._positionPrevTex),o.setUniform("forceTex",this._forceTex),o.setUniform("forcePrevTex",this._forcePrevTex),o.render(e),this._framebuffer.unbind(e),this._swapTexture()},c.prototype.update=function(e,t,n){null==t&&(t=1),t=Math.max(t,1);for(var r=0;r<t;r++)this.step(e);n&&n()},c.prototype.getNodePositionTexture=function(){return this._inited?this._positionPrevTex:this._positionSourceTex},c.prototype.getNodeUV=function(e,t){t=t||[];var n=this._positionTex.width,r=this._positionTex.height;return t[0]=e%n/(n-1),t[1]=Math.floor(e/n)/(r-1)||0,t},c.prototype.getNodePosition=function(e,t){var n=this._positionArr,r=this._positionTex.width,i=this._positionTex.height,o=r*i;n&&n.length===4*o||(n=this._positionArr=new Float32Array(4*o)),this._framebuffer.bind(e),this._framebuffer.attach(this._positionPrevTex),e.gl.readPixels(0,0,r,i,e.gl.RGBA,e.gl.FLOAT,n),this._framebuffer.unbind(e),t||(t=new Float32Array(2*this._nodes.length));for(var a=0;a<this._nodes.length;a++)t[2*a]=n[4*a],t[2*a+1]=n[4*a+1];return t},c.prototype.getTextureData=function(e,t){var n=this["_"+t+"Tex"],r=n.width,i=n.height;this._framebuffer.bind(e),this._framebuffer.attach(n);var o=new Float32Array(r*i*4);return e.gl.readPixels(0,0,r,i,e.gl.RGBA,e.gl.FLOAT,o),this._framebuffer.unbind(e),o},c.prototype.getTextureSize=function(){return{width:this._positionTex.width,height:this._positionTex.height}},c.prototype.isFinished=function(e){return this._frame>e},c.prototype._swapTexture=function(){var e=this._positionPrevTex;this._positionPrevTex=this._positionTex,this._positionTex=e;e=this._forcePrevTex;this._forcePrevTex=this._forceTex,this._forceTex=e;e=this._globalSpeedPrevTex;this._globalSpeedPrevTex=this._globalSpeedTex,this._globalSpeedTex=e},c.prototype._initFromSource=function(e){this._framebuffer.attach(this._positionPrevTex),this._framebuffer.bind(e),this._copyPass.setUniform("texture",this._positionSourceTex),this._copyPass.render(e),e.gl.clearColor(0,0,0,0),this._framebuffer.attach(this._forcePrevTex),e.gl.clear(e.gl.COLOR_BUFFER_BIT),this._framebuffer.attach(this._globalSpeedPrevTex),e.gl.clear(e.gl.COLOR_BUFFER_BIT),this._framebuffer.unbind(e)},c.prototype._resize=function(e,t){["_positionSourceTex","_positionTex","_positionPrevTex","_forceTex","_forcePrevTex"].forEach((function(n){this[n].width=e,this[n].height=t,this[n].dirty()}),this)},c.prototype.dispose=function(e){this._framebuffer.dispose(e),this._copyPass.dispose(e),this._nodeRepulsionPass.dispose(e),this._positionPass.dispose(e),this._globalSpeedPass.dispose(e),this._edgeForceMesh.geometry.dispose(e),this._weightedSumMesh.geometry.dispose(e),this._positionSourceTex.dispose(e),this._positionTex.dispose(e),this._positionPrevTex.dispose(e),this._forceTex.dispose(e),this._forcePrevTex.dispose(e),this._weightedSumTex.dispose(e),this._globalSpeedTex.dispose(e),this._globalSpeedPrevTex.dispose(e)},i.a.ForceAtlas2GPU=c,t["a"]=c},function(e,t,n){"use strict";t["a"]="@export ecgl.forceAtlas2.updateNodeRepulsion\n\n#define NODE_COUNT 0\n\nuniform sampler2D positionTex;\n\nuniform vec2 textureSize;\nuniform float gravity;\nuniform float scaling;\nuniform vec2 gravityCenter;\n\nuniform bool strongGravityMode;\nuniform bool preventOverlap;\n\nvarying vec2 v_Texcoord;\n\nvoid main() {\n\n vec4 n0 = texture2D(positionTex, v_Texcoord);\n\n vec2 force = vec2(0.0);\n for (int i = 0; i < NODE_COUNT; i++) {\n vec2 uv = vec2(\n mod(float(i), textureSize.x) / (textureSize.x - 1.0),\n floor(float(i) / textureSize.x) / (textureSize.y - 1.0)\n );\n vec4 n1 = texture2D(positionTex, uv);\n\n vec2 dir = n0.xy - n1.xy;\n float d2 = dot(dir, dir);\n\n if (d2 > 0.0) {\n float factor = 0.0;\n if (preventOverlap) {\n float d = sqrt(d2);\n d = d - n0.w - n1.w;\n if (d > 0.0) {\n factor = scaling * n0.z * n1.z / (d * d);\n }\n else if (d < 0.0) {\n factor = scaling * 100.0 * n0.z * n1.z;\n }\n }\n else {\n factor = scaling * n0.z * n1.z / d2;\n }\n force += dir * factor;\n }\n }\n\n vec2 dir = gravityCenter - n0.xy;\n float d = 1.0;\n if (!strongGravityMode) {\n d = length(dir);\n }\n\n force += dir * n0.z * gravity / (d + 1.0);\n\n gl_FragColor = vec4(force, 0.0, 1.0);\n}\n@end\n\n@export ecgl.forceAtlas2.updateEdgeAttraction.vertex\n\nattribute vec2 node1;\nattribute vec2 node2;\nattribute float weight;\n\nuniform sampler2D positionTex;\nuniform float edgeWeightInfluence;\nuniform bool preventOverlap;\nuniform bool linLogMode;\n\nuniform vec2 windowSize: WINDOW_SIZE;\n\nvarying vec2 v_Force;\n\nvoid main() {\n\n vec4 n0 = texture2D(positionTex, node1);\n vec4 n1 = texture2D(positionTex, node2);\n\n vec2 dir = n1.xy - n0.xy;\n float d = length(dir);\n float w;\n if (edgeWeightInfluence == 0.0) {\n w = 1.0;\n }\n else if (edgeWeightInfluence == 1.0) {\n w = weight;\n }\n else {\n w = pow(weight, edgeWeightInfluence);\n }\n vec2 offset = vec2(1.0 / windowSize.x, 1.0 / windowSize.y);\n vec2 scale = vec2((windowSize.x - 1.0) / windowSize.x, (windowSize.y - 1.0) / windowSize.y);\n vec2 pos = node1 * scale * 2.0 - 1.0;\n gl_Position = vec4(pos + offset, 0.0, 1.0);\n gl_PointSize = 1.0;\n\n float factor;\n if (preventOverlap) {\n d = d - n1.w - n0.w;\n }\n if (d <= 0.0) {\n v_Force = vec2(0.0);\n return;\n }\n\n if (linLogMode) {\n factor = w * log(d) / d;\n }\n else {\n factor = w;\n }\n v_Force = dir * factor;\n}\n@end\n\n@export ecgl.forceAtlas2.updateEdgeAttraction.fragment\n\nvarying vec2 v_Force;\n\nvoid main() {\n gl_FragColor = vec4(v_Force, 0.0, 0.0);\n}\n@end\n\n@export ecgl.forceAtlas2.calcWeightedSum.vertex\n\nattribute vec2 node;\n\nvarying vec2 v_NodeUv;\n\nvoid main() {\n\n v_NodeUv = node;\n gl_Position = vec4(0.0, 0.0, 0.0, 1.0);\n gl_PointSize = 1.0;\n}\n@end\n\n@export ecgl.forceAtlas2.calcWeightedSum.fragment\n\nvarying vec2 v_NodeUv;\n\nuniform sampler2D positionTex;\nuniform sampler2D forceTex;\nuniform sampler2D forcePrevTex;\n\nvoid main() {\n vec2 force = texture2D(forceTex, v_NodeUv).rg;\n vec2 forcePrev = texture2D(forcePrevTex, v_NodeUv).rg;\n\n float mass = texture2D(positionTex, v_NodeUv).z;\n float swing = length(force - forcePrev) * mass;\n float traction = length(force + forcePrev) * 0.5 * mass;\n\n gl_FragColor = vec4(swing, traction, 0.0, 0.0);\n}\n@end\n\n@export ecgl.forceAtlas2.calcGlobalSpeed\n\nuniform sampler2D globalSpeedPrevTex;\nuniform sampler2D weightedSumTex;\nuniform float jitterTolerence;\n\nvoid main() {\n vec2 weightedSum = texture2D(weightedSumTex, vec2(0.5)).xy;\n float prevGlobalSpeed = texture2D(globalSpeedPrevTex, vec2(0.5)).x;\n float globalSpeed = jitterTolerence * jitterTolerence\n * weightedSum.y / weightedSum.x;\n if (prevGlobalSpeed > 0.0) {\n globalSpeed = min(globalSpeed / prevGlobalSpeed, 1.5) * prevGlobalSpeed;\n }\n gl_FragColor = vec4(globalSpeed, 0.0, 0.0, 1.0);\n}\n@end\n\n@export ecgl.forceAtlas2.updatePosition\n\nuniform sampler2D forceTex;\nuniform sampler2D forcePrevTex;\nuniform sampler2D positionTex;\nuniform sampler2D globalSpeedTex;\n\nvarying vec2 v_Texcoord;\n\nvoid main() {\n vec2 force = texture2D(forceTex, v_Texcoord).xy;\n vec2 forcePrev = texture2D(forcePrevTex, v_Texcoord).xy;\n vec4 node = texture2D(positionTex, v_Texcoord);\n\n float globalSpeed = texture2D(globalSpeedTex, vec2(0.5)).r;\n float swing = length(force - forcePrev);\n float speed = 0.1 * globalSpeed / (0.1 + globalSpeed * sqrt(swing));\n\n float df = length(force);\n if (df > 0.0) {\n speed = min(df * speed, 10.0) / df;\n\n gl_FragColor = vec4(node.xy + speed * force, node.zw);\n }\n else {\n gl_FragColor = node;\n }\n}\n@end\n\n@export ecgl.forceAtlas2.edges.vertex\nuniform mat4 worldViewProjection : WORLDVIEWPROJECTION;\n\nattribute vec2 node;\nattribute vec4 a_Color : COLOR;\nvarying vec4 v_Color;\n\nuniform sampler2D positionTex;\n\nvoid main()\n{\n gl_Position = worldViewProjection * vec4(\n texture2D(positionTex, node).xy, -10.0, 1.0\n );\n v_Color = a_Color;\n}\n@end\n\n@export ecgl.forceAtlas2.edges.fragment\nuniform vec4 color : [1.0, 1.0, 1.0, 1.0];\nvarying vec4 v_Color;\nvoid main() {\n gl_FragColor = color * v_Color;\n}\n@end"},function(e,t,n){"use strict";var r=n(5),i=n(4),o=n(272),a=o["a"].toString();a=a.slice(a.indexOf("{")+1,a.lastIndexOf("}"));var s={barnesHutOptimize:!0,barnesHutTheta:1.5,repulsionByDegree:!0,linLogMode:!1,strongGravityMode:!1,gravity:1,scaling:1,edgeWeightInfluence:1,jitterTolerence:.1,preventOverlap:!1,dissuadeHubs:!1,gravityCenter:null},l=function(e){for(var t in s)this[t]=s[t];if(e)for(var t in e)this[t]=e[t];this._nodes=[],this._edges=[],this._disposed=!1,this._positionTex=new r["a"]({type:i["a"].FLOAT,flipY:!1,minFilter:i["a"].NEAREST,magFilter:i["a"].NEAREST})};l.prototype.initData=function(e,t){var n=new Blob([a]),r=window.URL.createObjectURL(n);this._worker=new Worker(r),this._worker.onmessage=this._$onupdate.bind(this),this._nodes=e,this._edges=t,this._frame=0;for(var i=e.length,o=t.length,s=new Float32Array(2*i),l=new Float32Array(i),u=new Float32Array(i),c=new Float32Array(2*o),d=new Float32Array(o),f=0;f<e.length;f++){var h=e[f];s[2*f]=h.x,s[2*f+1]=h.y,l[f]=null==h.mass?1:h.mass,u[f]=null==h.size?1:h.size}for(f=0;f<t.length;f++){var p=t[f],m=p.node1,v=p.node2;c[2*f]=m,c[2*f+1]=v,d[f]=null==p.weight?1:p.weight}var g=Math.ceil(Math.sqrt(e.length)),y=g,_=new Float32Array(g*y*4),x=this._positionTex;x.width=g,x.height=y,x.pixels=_,this._worker.postMessage({cmd:"init",nodesPosition:s,nodesMass:l,nodesSize:u,edges:c,edgesWeight:d}),this._globalSpeed=1/0},l.prototype.updateOption=function(e){var t={};for(var n in s)t[n]=s[n];var r=this._nodes,i=this._edges,o=r.length;if(t.jitterTolerence=o>5e4?10:o>5e3?1:.1,t.scaling=o>100?2:10,t.barnesHutOptimize=o>1e3,e)for(var n in s)null!=e[n]&&(t[n]=e[n]);if(!t.gravityCenter){for(var a=[1/0,1/0],l=[-1/0,-1/0],u=0;u<r.length;u++)a[0]=Math.min(r[u].x,a[0]),a[1]=Math.min(r[u].y,a[1]),l[0]=Math.max(r[u].x,l[0]),l[1]=Math.max(r[u].y,l[1]);t.gravityCenter=[.5*(a[0]+l[0]),.5*(a[1]+l[1])]}for(u=0;u<i.length;u++){var c=i[u].node1,d=i[u].node2;r[c].degree=(r[c].degree||0)+1,r[d].degree=(r[d].degree||0)+1}this._worker&&this._worker.postMessage({cmd:"updateConfig",config:t})},l.prototype.update=function(e,t,n){null==t&&(t=1),t=Math.max(t,1),this._frame+=t,this._onupdate=n,this._worker&&this._worker.postMessage({cmd:"update",steps:Math.round(t)})},l.prototype._$onupdate=function(e){if(!this._disposed){var t=new Float32Array(e.data.buffer);this._globalSpeed=e.data.globalSpeed,this._positionArr=t,this._updateTexture(t),this._onupdate&&this._onupdate()}},l.prototype.getNodePositionTexture=function(){return this._positionTex},l.prototype.getNodeUV=function(e,t){t=t||[];var n=this._positionTex.width,r=this._positionTex.height;return t[0]=e%n/(n-1),t[1]=Math.floor(e/n)/(r-1),t},l.prototype.getNodes=function(){return this._nodes},l.prototype.getEdges=function(){return this._edges},l.prototype.isFinished=function(e){return this._frame>e},l.prototype.getNodePosition=function(e,t){if(t||(t=new Float32Array(2*this._nodes.length)),this._positionArr)for(var n=0;n<this._positionArr.length;n++)t[n]=this._positionArr[n];return t},l.prototype._updateTexture=function(e){for(var t=this._positionTex.pixels,n=0,r=0;r<e.length;)t[n++]=e[r++],t[n++]=e[r++],t[n++]=1,t[n++]=1;this._positionTex.dirty()},l.prototype.dispose=function(e){this._disposed=!0,this._worker=null},t["a"]=l},function(e,t,n){"use strict";function r(){var e={create:function(){return new Float32Array(2)},dist:function(e,t){var n=t[0]-e[0],r=t[1]-e[1];return Math.sqrt(n*n+r*r)},len:function(e){var t=e[0],n=e[1];return Math.sqrt(t*t+n*n)},scaleAndAdd:function(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e},scale:function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e},add:function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e},sub:function(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e},normalize:function(e,t){var n=t[0],r=t[1],i=n*n+r*r;return i>0&&(i=1/Math.sqrt(i),e[0]=t[0]*i,e[1]=t[1]*i),e},negate:function(e,t){return e[0]=-t[0],e[1]=-t[1],e},copy:function(e,t){return e[0]=t[0],e[1]=t[1],e},set:function(e,t,n){return e[0]=t,e[1]=n,e}};function t(){this.subRegions=[],this.nSubRegions=0,this.node=null,this.mass=0,this.centerOfMass=null,this.bbox=new Float32Array(4),this.size=0}var n=t.prototype;function r(){this.position=new Float32Array(2),this.force=e.create(),this.forcePrev=e.create(),this.mass=1,this.inDegree=0,this.outDegree=0}function i(e,t){this.source=e,this.target=t,this.weight=1}function o(){this.autoSettings=!0,this.barnesHutOptimize=!0,this.barnesHutTheta=1.5,this.repulsionByDegree=!0,this.linLogMode=!1,this.strongGravityMode=!1,this.gravity=1,this.scaling=1,this.edgeWeightInfluence=1,this.jitterTolerence=.1,this.preventOverlap=!1,this.dissuadeHubs=!1,this.rootRegion=new t,this.rootRegion.centerOfMass=e.create(),this.nodes=[],this.edges=[],this.bbox=new Float32Array(4),this.gravityCenter=null,this._massArr=null,this._swingingArr=null,this._sizeArr=null,this._globalSpeed=0}n.beforeUpdate=function(){for(var e=0;e<this.nSubRegions;e++)this.subRegions[e].beforeUpdate();this.mass=0,this.centerOfMass&&(this.centerOfMass[0]=0,this.centerOfMass[1]=0),this.nSubRegions=0,this.node=null},n.afterUpdate=function(){this.subRegions.length=this.nSubRegions;for(var e=0;e<this.nSubRegions;e++)this.subRegions[e].afterUpdate()},n.addNode=function(e){if(0===this.nSubRegions){if(null==this.node)return void(this.node=e);this._addNodeToSubRegion(this.node),this.node=null}this._addNodeToSubRegion(e),this._updateCenterOfMass(e)},n.findSubRegion=function(e,t){for(var n=0;n<this.nSubRegions;n++){var r=this.subRegions[n];if(r.contain(e,t))return r}},n.contain=function(e,t){return this.bbox[0]<=e&&this.bbox[2]>=e&&this.bbox[1]<=t&&this.bbox[3]>=t},n.setBBox=function(e,t,n,r){this.bbox[0]=e,this.bbox[1]=t,this.bbox[2]=n,this.bbox[3]=r,this.size=(n-e+r-t)/2},n._newSubRegion=function(){var e=this.subRegions[this.nSubRegions];return e||(e=new t,this.subRegions[this.nSubRegions]=e),this.nSubRegions++,e},n._addNodeToSubRegion=function(e){var t=this.findSubRegion(e.position[0],e.position[1]),n=this.bbox;if(!t){var r=(n[0]+n[2])/2,i=(n[1]+n[3])/2,o=(n[2]-n[0])/2,a=(n[3]-n[1])/2,s=e.position[0]>=r?1:0,l=e.position[1]>=i?1:0;t=this._newSubRegion();t.setBBox(s*o+n[0],l*a+n[1],(s+1)*o+n[0],(l+1)*a+n[1])}t.addNode(e)},n._updateCenterOfMass=function(e){null==this.centerOfMass&&(this.centerOfMass=new Float32Array(2));var t=this.centerOfMass[0]*this.mass,n=this.centerOfMass[1]*this.mass;t+=e.position[0]*e.mass,n+=e.position[1]*e.mass,this.mass+=e.mass,this.centerOfMass[0]=t/this.mass,this.centerOfMass[1]=n/this.mass};var a=o.prototype;a.initNodes=function(e,t,n){var i=t.length;this.nodes.length=0;for(var o="undefined"!=typeof n,a=0;a<i;a++){var s=new r;s.position[0]=e[2*a],s.position[1]=e[2*a+1],s.mass=t[a],o&&(s.size=n[a]),this.nodes.push(s)}this._massArr=t,this._swingingArr=new Float32Array(i),o&&(this._sizeArr=n)},a.initEdges=function(e,t){var n=e.length/2;this.edges.length=0;for(var r=0;r<n;r++){var o=e[2*r],a=e[2*r+1],s=this.nodes[o],l=this.nodes[a];if(!s||!l)return void console.error("Node not exists, try initNodes before initEdges");s.outDegree++,l.inDegree++;var u=new i(s,l);t&&(u.weight=t[r]),this.edges.push(u)}},a.updateSettings=function(){if(this.repulsionByDegree)for(var e=0;e<this.nodes.length;e++){var t=this.nodes[e];t.mass=t.inDegree+t.outDegree+1}else for(e=0;e<this.nodes.length;e++){t=this.nodes[e];t.mass=this._massArr[e]}},a.update=function(){var t=this.nodes.length;if(this.updateSettings(),this.updateBBox(),this.barnesHutOptimize){this.rootRegion.setBBox(this.bbox[0],this.bbox[1],this.bbox[2],this.bbox[3]),this.rootRegion.beforeUpdate();for(var n=0;n<t;n++)this.rootRegion.addNode(this.nodes[n]);this.rootRegion.afterUpdate()}for(n=0;n<t;n++){var r=this.nodes[n];e.copy(r.forcePrev,r.force),e.set(r.force,0,0)}for(n=0;n<t;n++){var i=this.nodes[n];if(this.barnesHutOptimize)this.applyRegionToNodeRepulsion(this.rootRegion,i);else for(var o=n+1;o<t;o++){var a=this.nodes[o];this.applyNodeToNodeRepulsion(i,a,!1)}this.gravity>0&&(this.strongGravityMode?this.applyNodeStrongGravity(i):this.applyNodeGravity(i))}for(n=0;n<this.edges.length;n++)this.applyEdgeAttraction(this.edges[n]);var s=0,l=0,u=e.create();for(n=0;n<t;n++){r=this.nodes[n];var c=e.dist(r.force,r.forcePrev);s+=c*r.mass,e.add(u,r.force,r.forcePrev);var d=.5*e.len(u);l+=d*r.mass,this._swingingArr[n]=c}var f=this.jitterTolerence*this.jitterTolerence*l/s;this._globalSpeed>0&&(f=Math.min(f/this._globalSpeed,1.5)*this._globalSpeed),this._globalSpeed=f;for(n=0;n<t;n++){r=this.nodes[n],c=this._swingingArr[n];var h=.1*f/(1+f*Math.sqrt(c)),p=e.len(r.force);p>0&&(h=Math.min(p*h,10)/p,e.scaleAndAdd(r.position,r.position,r.force,h))}},a.applyRegionToNodeRepulsion=function(){var t=e.create();return function(n,r){if(n.node)this.applyNodeToNodeRepulsion(n.node,r,!0);else{e.sub(t,r.position,n.centerOfMass);var i=t[0]*t[0]+t[1]*t[1];if(i>this.barnesHutTheta*n.size*n.size){var o=this.scaling*r.mass*n.mass/i;e.scaleAndAdd(r.force,r.force,t,o)}else for(var a=0;a<n.nSubRegions;a++)this.applyRegionToNodeRepulsion(n.subRegions[a],r)}}}(),a.applyNodeToNodeRepulsion=function(){var t=e.create();return function(n,r,i){if(n!=r){e.sub(t,n.position,r.position);var o=t[0]*t[0]+t[1]*t[1];if(0!==o){var a;if(this.preventOverlap){var s=Math.sqrt(o);if(s=s-n.size-r.size,s>0)a=this.scaling*n.mass*r.mass/(s*s);else{if(!(s<0))return;a=100*this.scaling*n.mass*r.mass}}else a=this.scaling*n.mass*r.mass/o;e.scaleAndAdd(n.force,n.force,t,a),e.scaleAndAdd(r.force,r.force,t,-a)}}}}(),a.applyEdgeAttraction=function(){var t=e.create();return function(n){var r=n.source,i=n.target;e.sub(t,r.position,i.position);var o,a,s=e.len(t);o=0===this.edgeWeightInfluence?1:1===this.edgeWeightInfluence?n.weight:Math.pow(n.weight,this.edgeWeightInfluence),this.preventOverlap&&(s=s-r.size-i.size,s<=0)||(a=this.linLogMode?-o*Math.log(s+1)/(s+1):-o,e.scaleAndAdd(r.force,r.force,t,a),e.scaleAndAdd(i.force,i.force,t,-a))}}(),a.applyNodeGravity=function(){var t=e.create();return function(n){e.sub(t,this.gravityCenter,n.position);var r=e.len(t);e.scaleAndAdd(n.force,n.force,t,this.gravity*n.mass/(r+1))}}(),a.applyNodeStrongGravity=function(){var t=e.create();return function(n){e.sub(t,this.gravityCenter,n.position),e.scaleAndAdd(n.force,n.force,t,this.gravity*n.mass)}}(),a.updateBBox=function(){for(var e=1/0,t=1/0,n=-1/0,r=-1/0,i=0;i<this.nodes.length;i++){var o=this.nodes[i].position;e=Math.min(e,o[0]),t=Math.min(t,o[1]),n=Math.max(n,o[0]),r=Math.max(r,o[1])}this.bbox[0]=e,this.bbox[1]=t,this.bbox[2]=n,this.bbox[3]=r},a.getGlobalSpeed=function(){return this._globalSpeed};var s=null;self.onmessage=function(e){switch(e.data.cmd){case"init":s=new o,s.initNodes(e.data.nodesPosition,e.data.nodesMass,e.data.nodesSize),s.initEdges(e.data.edges,e.data.edgesWeight);break;case"updateConfig":if(s)for(var t in e.data.config)s[t]=e.data.config[t];break;case"update":var n=e.data.steps;if(s){for(var r=0;r<n;r++)s.update();var i=s.nodes.length,a=new Float32Array(2*i);for(r=0;r<i;r++){var l=s.nodes[r];a[2*r]=l.position[0],a[2*r+1]=l.position[1]}self.postMessage({buffer:a.buffer,globalSpeed:s.getGlobalSpeed()},[a.buffer])}else{var u=new Float32Array;self.postMessage({buffer:u.buffer,globalSpeed:s.getGlobalSpeed()},[u.buffer])}break}}}t["a"]=r},function(e,t,n){"use strict";var r=n(7),i=(n(2),r["a"].extend((function(){return{zr:null,viewGL:null,minZoom:.2,maxZoom:5,_needsUpdate:!1,_dx:0,_dy:0,_zoom:1}}),(function(){this._mouseDownHandler=this._mouseDownHandler.bind(this),this._mouseWheelHandler=this._mouseWheelHandler.bind(this),this._mouseMoveHandler=this._mouseMoveHandler.bind(this),this._mouseUpHandler=this._mouseUpHandler.bind(this),this._update=this._update.bind(this)}),{init:function(){var e=this.zr;e.on("mousedown",this._mouseDownHandler),e.on("mousewheel",this._mouseWheelHandler),e.on("globalout",this._mouseUpHandler),e.animation.on("frame",this._update)},setTarget:function(e){this._target=e},setZoom:function(e){this._zoom=Math.max(Math.min(e,this.maxZoom),this.minZoom),this._needsUpdate=!0},setOffset:function(e){this._dx=e[0],this._dy=e[1],this._needsUpdate=!0},getZoom:function(){return this._zoom},getOffset:function(){return[this._dx,this._dy]},_update:function(){if(this._target&&this._needsUpdate){var e=this._target,t=this._zoom;e.position.x=this._dx,e.position.y=this._dy,e.scale.set(t,t,t),this.zr.refresh(),this._needsUpdate=!1,this.trigger("update")}},_mouseDownHandler:function(e){if(!e.target){var t=e.offsetX,n=e.offsetY;if(!this.viewGL||this.viewGL.containPoint(t,n)){this.zr.on("mousemove",this._mouseMoveHandler),this.zr.on("mouseup",this._mouseUpHandler);var r=this._convertPos(t,n);this._x=r.x,this._y=r.y}}},_convertPos:function(e,t){var n=this.viewGL.camera,r=this.viewGL.viewport;return{x:(e-r.x)/r.width*(n.right-n.left)+n.left,y:(t-r.y)/r.height*(n.bottom-n.top)+n.top}},_mouseMoveHandler:function(e){var t=this._convertPos(e.offsetX,e.offsetY);this._dx+=t.x-this._x,this._dy+=t.y-this._y,this._x=t.x,this._y=t.y,this._needsUpdate=!0},_mouseUpHandler:function(e){this.zr.off("mousemove",this._mouseMoveHandler),this.zr.off("mouseup",this._mouseUpHandler)},_mouseWheelHandler:function(e){e=e.event;var t=e.wheelDelta||-e.detail;if(0!==t){var n=e.offsetX,r=e.offsetY;if(!this.viewGL||this.viewGL.containPoint(n,r)){var i=t>0?1.1:.9,o=Math.max(Math.min(this._zoom*i,this.maxZoom),this.minZoom);i=o/this._zoom;var a=this._convertPos(n,r),s=(a.x-this._dx)*(i-1),l=(a.y-this._dy)*(i-1);this._dx-=s,this._dy-=l,this._zoom=o,this._needsUpdate=!0}}},dispose:function(){var e=this.zr;e.off("mousedown",this._mouseDownHandler),e.off("mousemove",this._mouseMoveHandler),e.off("mouseup",this._mouseUpHandler),e.off("mousewheel",this._mouseWheelHandler),e.off("globalout",this._mouseUpHandler),e.animation.off("frame",this._update)}}));t["a"]=i},function(e,t,n){"use strict";t["a"]="@export ecgl.lines2D.vertex\n\nuniform mat4 worldViewProjection : WORLDVIEWPROJECTION;\n\nattribute vec2 position: POSITION;\nattribute vec4 a_Color : COLOR;\nvarying vec4 v_Color;\n\n#ifdef POSITIONTEXTURE_ENABLED\nuniform sampler2D positionTexture;\n#endif\n\nvoid main()\n{\n gl_Position = worldViewProjection * vec4(position, -10.0, 1.0);\n\n v_Color = a_Color;\n}\n\n@end\n\n@export ecgl.lines2D.fragment\n\nuniform vec4 color : [1.0, 1.0, 1.0, 1.0];\n\nvarying vec4 v_Color;\n\nvoid main()\n{\n gl_FragColor = color * v_Color;\n}\n@end\n\n\n@export ecgl.meshLines2D.vertex\n\nattribute vec2 position: POSITION;\nattribute vec2 normal;\nattribute float offset;\nattribute vec4 a_Color : COLOR;\n\nuniform mat4 worldViewProjection : WORLDVIEWPROJECTION;\nuniform vec4 viewport : VIEWPORT;\n\nvarying vec4 v_Color;\nvarying float v_Miter;\n\nvoid main()\n{\n vec4 p2 = worldViewProjection * vec4(position + normal, -10.0, 1.0);\n gl_Position = worldViewProjection * vec4(position, -10.0, 1.0);\n\n p2.xy /= p2.w;\n gl_Position.xy /= gl_Position.w;\n\n vec2 N = normalize(p2.xy - gl_Position.xy);\n gl_Position.xy += N * offset / viewport.zw * 2.0;\n\n gl_Position.xy *= gl_Position.w;\n\n v_Color = a_Color;\n}\n@end\n\n\n@export ecgl.meshLines2D.fragment\n\nuniform vec4 color : [1.0, 1.0, 1.0, 1.0];\n\nvarying vec4 v_Color;\nvarying float v_Miter;\n\nvoid main()\n{\n gl_FragColor = color * v_Color;\n}\n\n@end"},function(e,t,n){"use strict";var r=n(0);n.n(r),n(276),n(280)},function(e,t,n){"use strict";var r=n(0),i=n.n(r),o=n(1),a=n(2),s=n(22),l=n(277);i.a.extendChartView({type:"flowGL",__ecgl__:!0,init:function(e,t){this.viewGL=new s["a"]("orthographic"),this.groupGL=new o["a"].Node,this.viewGL.add(this.groupGL),this._particleSurface=new l["a"];var n=new o["a"].Mesh({geometry:new o["a"].PlaneGeometry,material:new o["a"].Material({shader:new o["a"].Shader({vertex:o["a"].Shader.source("ecgl.color.vertex"),fragment:o["a"].Shader.source("ecgl.color.fragment")}),transparent:!0})});n.material.enableTexture("diffuseMap"),this.groupGL.add(n),this._planeMesh=n},render:function(e,t,n){var r=this._particleSurface;r.setParticleType(e.get("particleType")),r.setSupersampling(e.get("supersampling")),this._updateData(e,n),this._updateCamera(n.getWidth(),n.getHeight(),n.getDevicePixelRatio());var i=a["a"].firstNotNull(e.get("particleDensity"),128);r.setParticleDensity(i,i);var s=this._planeMesh,l=+new Date,u=this,c=!0;s.__percent=0,s.stopAnimation(),s.animate("",{loop:!0}).when(1e5,{__percent:1}).during((function(){var e=+new Date,t=Math.min(e-l,20);l+=t,u._renderer&&(r.update(u._renderer,n,t/1e3,c),s.material.set("diffuseMap",r.getSurfaceTexture())),c=!1})).start();var d=e.getModel("itemStyle"),f=o["a"].parseColor(d.get("color"));f[3]*=a["a"].firstNotNull(d.get("opacity"),1),s.material.set("color",f),r.setColorTextureImage(e.get("colorTexture"),n),r.setParticleSize(e.get("particleSize")),r.particleSpeedScaling=e.get("particleSpeed"),r.motionBlurFactor=1-Math.pow(.1,e.get("particleTrail"))},updateTransform:function(e,t,n){this._updateData(e,n)},afterRender:function(e,t,n,r){var i=r.renderer;this._renderer=i},_updateData:function(e,t){var n=e.coordinateSystem,r=n.dimensions.map((function(t){return e.coordDimToDataDim(t)[0]})),i=e.getData(),o=i.getDataExtent(r[0]),a=i.getDataExtent(r[1]),s=e.get("gridWidth"),l=e.get("gridHeight");if(null==s||"auto"===s){var u=(o[1]-o[0])/(a[1]-a[0]);s=Math.round(Math.sqrt(u*i.count()))}null!=l&&"auto"!==l||(l=Math.ceil(i.count()/s));var c=this._particleSurface.vectorFieldTexture,d=c.pixels;if(d&&d.length===l*s*4)for(var f=0;f<d.length;f++)d[f]=0;else d=c.pixels=new Float32Array(s*l*4);var h=0,p=1/0,m=new Float32Array(2*i.count()),v=0,g=[[1/0,1/0],[-1/0,-1/0]];i.each([r[0],r[1],"vx","vy"],(function(e,t,r,i){var o=n.dataToPoint([e,t]);m[v++]=o[0],m[v++]=o[1],g[0][0]=Math.min(o[0],g[0][0]),g[0][1]=Math.min(o[1],g[0][1]),g[1][0]=Math.max(o[0],g[1][0]),g[1][1]=Math.max(o[1],g[1][1]);var a=Math.sqrt(r*r+i*i);h=Math.max(h,a),p=Math.min(p,a)})),i.each(["vx","vy"],(function(e,t,n){var r=Math.round((m[2*n]-g[0][0])/(g[1][0]-g[0][0])*(s-1)),i=l-1-Math.round((m[2*n+1]-g[0][1])/(g[1][1]-g[0][1])*(l-1)),o=4*(i*s+r);d[o]=e/h*.5+.5,d[o+1]=t/h*.5+.5,d[o+3]=1})),c.width=s,c.height=l,"bmap"===e.get("coordinateSystem")&&this._fillEmptyPixels(c),c.dirty(),this._updatePlanePosition(g[0],g[1],e,t),this._updateGradientTexture(i.getVisual("visualMeta"),[p,h])},_fillEmptyPixels:function(e){var t=e.pixels,n=e.width,r=e.height;function i(e,i,o){e=Math.max(Math.min(e,n-1),0),i=Math.max(Math.min(i,r-1),0);var a=4*(i*(n-1)+e);return 0!==t[a+3]&&(o[0]=t[a],o[1]=t[a+1],!0)}function o(e,t,n){n[0]=e[0]+t[0],n[1]=e[1]+t[1]}for(var a=[],s=[],l=[],u=[],c=[],d=0,f=0;f<r;f++)for(var h=0;h<n;h++){var p=4*(f*(n-1)+h);0===t[p+3]&&(d=a[0]=a[1]=0,i(h-1,f,s)&&(d++,o(s,a,a)),i(h+1,f,l)&&(d++,o(l,a,a)),i(h,f-1,u)&&(d++,o(u,a,a)),i(h,f+1,c)&&(d++,o(c,a,a)),a[0]/=d,a[1]/=d,t[p]=a[0],t[p+1]=a[1]),t[p+3]=1}},_updateGradientTexture:function(e,t){if(e&&e.length){this._gradientTexture=this._gradientTexture||new o["a"].Texture2D({image:document.createElement("canvas")});var n=this._gradientTexture,r=n.image;r.width=200,r.height=1;var i=r.getContext("2d"),a=i.createLinearGradient(0,.5,r.width,.5);e[0].stops.forEach((function(e){var n;t[1]===t[0]?n=0:(n=e.value/t[1],n=Math.min(Math.max(n,0),1)),a.addColorStop(n,e.color)})),i.fillStyle=a,i.fillRect(0,0,r.width,r.height),n.dirty(),this._particleSurface.setGradientTexture(this._gradientTexture)}else this._particleSurface.setGradientTexture(null)},_updatePlanePosition:function(e,t,n,r){var i=this._limitInViewportAndFullFill(e,t,n,r);e=i.leftTop,t=i.rightBottom,this._particleSurface.setRegion(i.region),this._planeMesh.position.set((e[0]+t[0])/2,r.getHeight()-(e[1]+t[1])/2,0);var o=t[0]-e[0],a=t[1]-e[1];this._planeMesh.scale.set(o/2,a/2,1),this._particleSurface.resize(Math.max(Math.min(o,2048),1),Math.max(Math.min(a,2048),1)),this._renderer&&this._particleSurface.clearFrame(this._renderer)},_limitInViewportAndFullFill:function(e,t,n,r){var i=[Math.max(e[0],0),Math.max(e[1],0)],o=[Math.min(t[0],r.getWidth()),Math.min(t[1],r.getHeight())];if("bmap"===n.get("coordinateSystem")){var a=n.getData().getDataExtent(n.coordDimToDataDim("lng")[0]),s=Math.floor(a[1]-a[0])>=359;s&&(i[0]>0&&(i[0]=0),o[0]<r.getWidth()&&(o[0]=r.getWidth()))}var l=t[0]-e[0],u=t[1]-e[1],c=o[0]-i[0],d=o[1]-i[1],f=[(i[0]-e[0])/l,1-d/u-(i[1]-e[1])/u,c/l,d/u];return{leftTop:i,rightBottom:o,region:f}},_updateCamera:function(e,t,n){this.viewGL.setViewport(0,0,e,t,n);var r=this.viewGL.camera;r.left=r.bottom=0,r.top=t,r.right=e,r.near=0,r.far=100,r.position.z=10},remove:function(){this._planeMesh.stopAnimation(),this.groupGL.removeAll()},dispose:function(){this._renderer&&this._particleSurface.dispose(this._renderer),this.groupGL.removeAll()}})},function(e,t,n){"use strict";var r=n(16),i=n(15),o=n(40),a=n(19),s=n(8),l=n(5),u=n(4),c=n(37),d=n(43),f=n(10),h=n(278),p=n(279);function m(e){var t=document.createElement("canvas");t.width=t.height=e;var n=t.getContext("2d");return n.fillStyle="#fff",n.arc(e/2,e/2,e/2,0,2*Math.PI),n.fill(),t}s["a"]["import"](p["a"]);var v=function(){this.motionBlurFactor=.99,this.vectorFieldTexture=new l["a"]({type:u["a"].FLOAT,flipY:!1}),this.particleLife=[5,20],this._particleType="point",this._particleSize=1,this.particleColor=[1,1,1,1],this.particleSpeedScaling=1,this._thisFrameTexture=null,this._particlePass=null,this._spawnTexture=null,this._particleTexture0=null,this._particleTexture1=null,this._particlePointsMesh=null,this._surfaceFrameBuffer=null,this._elapsedTime=0,this._scene=null,this._camera=null,this._lastFrameTexture=null,this._supersampling=1,this._downsampleTextures=[],this._width=512,this._height=512,this.init()};v.prototype={constructor:v,init:function(){var e={type:u["a"].FLOAT,minFilter:u["a"].NEAREST,magFilter:u["a"].NEAREST,useMipmap:!1};this._spawnTexture=new l["a"](e),this._particleTexture0=new l["a"](e),this._particleTexture1=new l["a"](e),this._frameBuffer=new f["a"]({depthBuffer:!1}),this._particlePass=new r["a"]({fragment:s["a"].source("ecgl.vfParticle.particle.fragment")}),this._particlePass.setUniform("velocityTexture",this.vectorFieldTexture),this._particlePass.setUniform("spawnTexture",this._spawnTexture),this._downsamplePass=new r["a"]({fragment:s["a"].source("clay.compositor.downsample")});var t=new o["a"]({renderOrder:10,material:new a["a"]({shader:new s["a"](s["a"].source("ecgl.vfParticle.renderPoints.vertex"),s["a"].source("ecgl.vfParticle.renderPoints.fragment"))}),mode:o["a"].POINTS,geometry:new i["a"]({dynamic:!0,mainAttribute:"texcoord0"})}),n=new o["a"]({renderOrder:10,material:new a["a"]({shader:new s["a"](s["a"].source("ecgl.vfParticle.renderLines.vertex"),s["a"].source("ecgl.vfParticle.renderLines.fragment"))}),geometry:new h["a"],culling:!1}),p=new o["a"]({material:new a["a"]({shader:new s["a"](s["a"].source("ecgl.color.vertex"),s["a"].source("ecgl.color.fragment"))}),geometry:new d["a"]});p.material.enableTexture("diffuseMap"),this._particlePointsMesh=t,this._particleLinesMesh=n,this._lastFrameFullQuadMesh=p,this._camera=new c["a"],this._thisFrameTexture=new l["a"],this._lastFrameTexture=new l["a"]},setParticleDensity:function(e,t){for(var n=e*t,r=new Float32Array(4*n),i=0,o=this.particleLife,a=0;a<e;a++)for(var s=0;s<t;s++,i++){r[4*i]=Math.random(),r[4*i+1]=Math.random(),r[4*i+2]=Math.random();var l=(o[1]-o[0])*Math.random()+o[0];r[4*i+3]=l}"line"===this._particleType?this._setLineGeometry(e,t):this._setPointsGeometry(e,t),this._spawnTexture.width=e,this._spawnTexture.height=t,this._spawnTexture.pixels=r,this._particleTexture0.width=this._particleTexture1.width=e,this._particleTexture0.height=this._particleTexture1.height=t,this._particlePass.setUniform("textureSize",[e,t])},_setPointsGeometry:function(e,t){var n=e*t,r=this._particlePointsMesh.geometry,i=r.attributes;i.texcoord0.init(n);for(var o=0,a=0;a<e;a++)for(var s=0;s<t;s++,o++)i.texcoord0.value[2*o]=a/e,i.texcoord0.value[2*o+1]=s/t;r.dirty()},_setLineGeometry:function(e,t){var n=e*t,r=this._getParticleMesh().geometry;r.setLineCount(n),r.resetOffset();for(var i=0;i<e;i++)for(var o=0;o<t;o++)r.addLine([i/e,o/t]);r.dirty()},_getParticleMesh:function(){return"line"===this._particleType?this._particleLinesMesh:this._particlePointsMesh},update:function(e,t,n,r){var i=this._getParticleMesh(),o=this._frameBuffer,a=this._particlePass;r&&this._updateDownsampleTextures(e,t),i.material.set("size",this._particleSize*this._supersampling),i.material.set("color",this.particleColor),a.setUniform("speedScaling",this.particleSpeedScaling),o.attach(this._particleTexture1),a.setUniform("firstFrameTime",r?(this.particleLife[1]+this.particleLife[0])/2:0),a.setUniform("particleTexture",this._particleTexture0),a.setUniform("deltaTime",n),a.setUniform("elapsedTime",this._elapsedTime),a.render(e,o),i.material.set("particleTexture",this._particleTexture1),i.material.set("prevParticleTexture",this._particleTexture0),o.attach(this._thisFrameTexture),o.bind(e),e.gl.clear(e.gl.DEPTH_BUFFER_BIT|e.gl.COLOR_BUFFER_BIT);var s=this._lastFrameFullQuadMesh;s.material.set("diffuseMap",this._lastFrameTexture),s.material.set("color",[1,1,1,this.motionBlurFactor]),this._camera.update(!0),e.renderPass([s,i],this._camera),o.unbind(e),this._downsample(e),this._swapTexture(),this._elapsedTime+=n},_downsample:function(e){var t=this._downsampleTextures;if(0!==t.length){var n=0,r=this._thisFrameTexture,i=t[n];while(i)this._frameBuffer.attach(i),this._downsamplePass.setUniform("texture",r),this._downsamplePass.setUniform("textureSize",[r.width,r.height]),this._downsamplePass.render(e,this._frameBuffer),r=i,i=t[++n]}},getSurfaceTexture:function(){var e=this._downsampleTextures;return e.length>0?e[e.length-1]:this._lastFrameTexture},setRegion:function(e){this._particlePass.setUniform("region",e)},resize:function(e,t){this._lastFrameTexture.width=e*this._supersampling,this._lastFrameTexture.height=t*this._supersampling,this._thisFrameTexture.width=e*this._supersampling,this._thisFrameTexture.height=t*this._supersampling,this._width=e,this._height=t},setParticleSize:function(e){var t=this._getParticleMesh();if(e<=2)return t.material.disableTexture("spriteTexture"),void(t.material.transparent=!1);this._spriteTexture||(this._spriteTexture=new l["a"]),this._spriteTexture.image&&this._spriteTexture.image.width===e||(this._spriteTexture.image=m(e),this._spriteTexture.dirty()),t.material.transparent=!0,t.material.enableTexture("spriteTexture"),t.material.set("spriteTexture",this._spriteTexture),this._particleSize=e},setGradientTexture:function(e){var t=this._getParticleMesh().material;t[e?"enableTexture":"disableTexture"]("gradientTexture"),t.setUniform("gradientTexture",e)},setColorTextureImage:function(e,t){var n=this._getParticleMesh().material;n.setTextureImage("colorTexture",e,t,{flipY:!0})},setParticleType:function(e){this._particleType=e},clearFrame:function(e){var t=this._frameBuffer;t.attach(this._lastFrameTexture),t.bind(e),e.gl.clear(e.gl.DEPTH_BUFFER_BIT|e.gl.COLOR_BUFFER_BIT),t.unbind(e)},setSupersampling:function(e){this._supersampling=e,this.resize(this._width,this._height)},_updateDownsampleTextures:function(e,t){for(var n=this._downsampleTextures,r=Math.max(Math.floor(Math.log(this._supersampling/t.getDevicePixelRatio())/Math.log(2)),0),i=2,o=this._width*this._supersampling,a=this._height*this._supersampling,s=0;s<r;s++)n[s]=n[s]||new l["a"],n[s].width=o/i,n[s].height=a/i,i*=2;for(;s<n.length;s++)n[s].dispose(e);n.length=r},_swapTexture:function(){var e=this._particleTexture0;this._particleTexture0=this._particleTexture1,this._particleTexture1=e;e=this._thisFrameTexture;this._thisFrameTexture=this._lastFrameTexture,this._lastFrameTexture=e},dispose:function(e){e.disposeFrameBuffer(this._frameBuffer),e.disposeTexture(this.vectorFieldTexture),e.disposeTexture(this._spawnTexture),e.disposeTexture(this._particleTexture0),e.disposeTexture(this._particleTexture1),e.disposeTexture(this._thisFrameTexture),e.disposeTexture(this._lastFrameTexture),e.disposeGeometry(this._particleLinesMesh.geometry),e.disposeGeometry(this._particlePointsMesh.geometry),e.disposeGeometry(this._lastFrameFullQuadMesh.geometry),this._spriteTexture&&e.disposeTexture(this._spriteTexture),this._particlePass.dispose(e),this._downsamplePass.dispose(e),this._downsampleTextures.forEach((function(t){t.dispose(e)}))}},t["a"]=v},function(e,t,n){"use strict";var r=n(15),i=n(0),o=(n.n(i),r["a"].extend((function(){return{dynamic:!0,attributes:{position:new r["a"].Attribute("position","float",3,"POSITION")}}}),{resetOffset:function(){this._vertexOffset=0,this._faceOffset=0},setLineCount:function(e){var t=this.attributes,n=4*e,r=2*e;this.vertexCount!==n&&t.position.init(n),this.triangleCount!==r&&(this.indices=0===r?null:this.vertexCount>65535?new Uint32Array(3*r):new Uint16Array(3*r))},addLine:function(e){var t=this._vertexOffset;this.attributes.position.set(t,[e[0],e[1],1]),this.attributes.position.set(t+1,[e[0],e[1],-1]),this.attributes.position.set(t+2,[e[0],e[1],2]),this.attributes.position.set(t+3,[e[0],e[1],-2]),this.setTriangleIndices(this._faceOffset++,[t,t+1,t+2]),this.setTriangleIndices(this._faceOffset++,[t+1,t+2,t+3]),this._vertexOffset+=4}}));t["a"]=o},function(e,t,n){"use strict";t["a"]="@export ecgl.vfParticle.particle.fragment\n\nuniform sampler2D particleTexture;\nuniform sampler2D spawnTexture;\nuniform sampler2D velocityTexture;\n\nuniform float deltaTime;\nuniform float elapsedTime;\n\nuniform float speedScaling : 1.0;\n\nuniform vec2 textureSize;\nuniform vec4 region : [0, 0, 1, 1];\nuniform float firstFrameTime;\n\nvarying vec2 v_Texcoord;\n\n\nvoid main()\n{\n vec4 p = texture2D(particleTexture, v_Texcoord);\n bool spawn = false;\n if (p.w <= 0.0) {\n p = texture2D(spawnTexture, fract(v_Texcoord + elapsedTime / 10.0));\n p.w -= firstFrameTime;\n spawn = true;\n }\n vec2 v = texture2D(velocityTexture, fract(p.xy * region.zw + region.xy)).xy;\n v = (v - 0.5) * 2.0;\n p.z = length(v);\n p.xy += v * deltaTime / 10.0 * speedScaling;\n p.w -= deltaTime;\n\n if (spawn || p.xy != fract(p.xy)) {\n p.z = 0.0;\n }\n p.xy = fract(p.xy);\n\n gl_FragColor = p;\n}\n@end\n\n@export ecgl.vfParticle.renderPoints.vertex\n\n#define PI 3.1415926\n\nattribute vec2 texcoord : TEXCOORD_0;\n\nuniform sampler2D particleTexture;\nuniform mat4 worldViewProjection : WORLDVIEWPROJECTION;\n\nuniform float size : 1.0;\n\nvarying float v_Mag;\nvarying vec2 v_Uv;\n\nvoid main()\n{\n vec4 p = texture2D(particleTexture, texcoord);\n\n if (p.w > 0.0 && p.z > 1e-5) {\n gl_Position = worldViewProjection * vec4(p.xy * 2.0 - 1.0, 0.0, 1.0);\n }\n else {\n gl_Position = vec4(100000.0, 100000.0, 100000.0, 1.0);\n }\n\n v_Mag = p.z;\n v_Uv = p.xy;\n\n gl_PointSize = size;\n}\n\n@end\n\n@export ecgl.vfParticle.renderPoints.fragment\n\nuniform vec4 color : [1.0, 1.0, 1.0, 1.0];\nuniform sampler2D gradientTexture;\nuniform sampler2D colorTexture;\nuniform sampler2D spriteTexture;\n\nvarying float v_Mag;\nvarying vec2 v_Uv;\n\nvoid main()\n{\n gl_FragColor = color;\n#ifdef SPRITETEXTURE_ENABLED\n gl_FragColor *= texture2D(spriteTexture, gl_PointCoord);\n if (color.a == 0.0) {\n discard;\n }\n#endif\n#ifdef GRADIENTTEXTURE_ENABLED\n gl_FragColor *= texture2D(gradientTexture, vec2(v_Mag, 0.5));\n#endif\n#ifdef COLORTEXTURE_ENABLED\n gl_FragColor *= texture2D(colorTexture, v_Uv);\n#endif\n}\n\n@end\n\n@export ecgl.vfParticle.renderLines.vertex\n\n#define PI 3.1415926\n\nattribute vec3 position : POSITION;\n\nuniform sampler2D particleTexture;\nuniform sampler2D prevParticleTexture;\n\nuniform float size : 1.0;\nuniform vec4 vp: VIEWPORT;\nuniform mat4 worldViewProjection : WORLDVIEWPROJECTION;\n\nvarying float v_Mag;\nvarying vec2 v_Uv;\n\n@import clay.util.rand\n\nvoid main()\n{\n vec4 p = texture2D(particleTexture, position.xy);\n vec4 p2 = texture2D(prevParticleTexture, position.xy);\n\n p.xy = p.xy * 2.0 - 1.0;\n p2.xy = p2.xy * 2.0 - 1.0;\n\n if (p.w > 0.0 && p.z > 1e-5) {\n vec2 dir = normalize(p.xy - p2.xy);\n vec2 norm = vec2(dir.y / vp.z, -dir.x / vp.w) * sign(position.z) * size;\n if (abs(position.z) == 2.0) {\n gl_Position = vec4(p.xy + norm, 0.0, 1.0);\n v_Uv = p.xy;\n v_Mag = p.z;\n }\n else {\n gl_Position = vec4(p2.xy + norm, 0.0, 1.0);\n v_Mag = p2.z;\n v_Uv = p2.xy;\n }\n gl_Position = worldViewProjection * gl_Position;\n }\n else {\n gl_Position = vec4(100000.0, 100000.0, 100000.0, 1.0);\n }\n}\n\n@end\n\n@export ecgl.vfParticle.renderLines.fragment\n\nuniform vec4 color : [1.0, 1.0, 1.0, 1.0];\nuniform sampler2D gradientTexture;\nuniform sampler2D colorTexture;\n\nvarying float v_Mag;\nvarying vec2 v_Uv;\n\nvoid main()\n{\n gl_FragColor = color;\n #ifdef GRADIENTTEXTURE_ENABLED\n gl_FragColor *= texture2D(gradientTexture, vec2(v_Mag, 0.5));\n#endif\n#ifdef COLORTEXTURE_ENABLED\n gl_FragColor *= texture2D(colorTexture, v_Uv);\n#endif\n}\n\n@end\n"},function(e,t,n){"use strict";var r=n(0),i=n.n(r);i.a.extendSeriesModel({type:"series.flowGL",dependencies:["geo","grid","bmap"],visualColorAccessPath:"itemStyle.color",getInitialData:function(e,t){var n=i.a.getCoordinateSystemDimensions(this.get("coordinateSystem"))||["x","y"];if(n.length>2)throw new Error("flowGL can only be used on 2d coordinate systems.");n.push("vx","vy");var r=i.a.helper.completeDimensions(n,this.getSource(),{encodeDef:this.get("encode"),dimsDef:this.get("dimensions")}),o=new i.a.List(r,this);return o.initData(this.getSource()),o},defaultOption:{coordinateSystem:"cartesian2d",zlevel:10,supersampling:1,particleType:"point",particleDensity:128,particleSize:1,particleSpeed:1,particleTrail:2,colorTexture:null,gridWidth:"auto",gridHeight:"auto",itemStyle:{color:"#fff",opacity:.8}}})},function(e,t,n){"use strict";var r=n(0),i=n.n(r),o=(n(282),n(283),n(17));i.a.registerVisual(Object(o["a"])("linesGL"))},function(e,t,n){"use strict";var r=n(0),i=n.n(r),o=n(13),a=(n.n(o),i.a.extendSeriesModel({type:"series.linesGL",dependencies:["grid","geo"],visualColorAccessPath:"lineStyle.color",streamEnabled:!0,init:function(e){var t=this._processFlatCoordsArray(e.data);this._flatCoords=t.flatCoords,this._flatCoordsOffset=t.flatCoordsOffset,t.flatCoords&&(e.data=new Float32Array(t.count)),a.superApply(this,"init",arguments)},mergeOption:function(e){var t=this._processFlatCoordsArray(e.data);this._flatCoords=t.flatCoords,this._flatCoordsOffset=t.flatCoordsOffset,t.flatCoords&&(e.data=new Float32Array(t.count)),a.superApply(this,"mergeOption",arguments)},appendData:function(e){var t=this._processFlatCoordsArray(e.data);t.flatCoords&&(this._flatCoords?(this._flatCoords=Object(o["concatArray"])(this._flatCoords,t.flatCoords),this._flatCoordsOffset=Object(o["concatArray"])(this._flatCoordsOffset,t.flatCoordsOffset)):(this._flatCoords=t.flatCoords,this._flatCoordsOffset=t.flatCoordsOffset),e.data=new Float32Array(t.count)),this.getRawData().appendData(e.data)},_getCoordsFromItemModel:function(e){var t=this.getData().getItemModel(e),n=t.option instanceof Array?t.option:t.getShallow("coords");if(!(n instanceof Array&&n.length>0&&n[0]instanceof Array))throw new Error("Invalid coords "+JSON.stringify(n)+". Lines must have 2d coords array in data item.");return n},getLineCoordsCount:function(e){return this._flatCoordsOffset?this._flatCoordsOffset[2*e+1]:this._getCoordsFromItemModel(e).length},getLineCoords:function(e,t){if(this._flatCoordsOffset){for(var n=this._flatCoordsOffset[2*e],r=this._flatCoordsOffset[2*e+1],i=0;i<r;i++)t[i]=t[i]||[],t[i][0]=this._flatCoords[n+2*i],t[i][1]=this._flatCoords[n+2*i+1];return r}var o=this._getCoordsFromItemModel(e);for(i=0;i<o.length;i++)t[i]=t[i]||[],t[i][0]=o[i][0],t[i][1]=o[i][1];return o.length},_processFlatCoordsArray:function(e){var t=0;if(this._flatCoords&&(t=this._flatCoords.length),"number"===typeof e[0]){for(var n=e.length,r=new Uint32Array(n),i=new Float64Array(n),o=0,a=0,s=0,l=0;l<n;){s++;var u=e[l++];r[a++]=o+t,r[a++]=u;for(var c=0;c<u;c++){var d=e[l++],f=e[l++];if(i[o++]=d,i[o++]=f,l>n)throw new Error("Invalid data format.")}}return{flatCoordsOffset:new Uint32Array(r.buffer,0,a),flatCoords:i,count:s}}return{flatCoordsOffset:null,flatCoords:null,count:e.length}},getInitialData:function(e,t){var n=new i.a.List(["value"],this);return n.hasItemOption=!1,n.initData(e.data,[],(function(e,t,r,i){if(e instanceof Array)return NaN;n.hasItemOption=!0;var o=e.value;return null!=o?o instanceof Array?o[i]:o:void 0})),n},defaultOption:{coordinateSystem:"geo",zlevel:10,progressive:1e4,progressiveThreshold:5e4,blendMode:"source-over",lineStyle:{opacity:.8},postEffect:{enable:!1,colorCorrection:{exposure:0,brightness:0,contrast:1,saturation:1,enable:!0}}}}))},function(e,t,n){"use strict";var r=n(0),i=n.n(r),o=n(1),a=n(22),s=n(105),l=n(103),u=n(2);i.a.extendChartView({type:"linesGL",__ecgl__:!0,init:function(e,t){this.groupGL=new o["a"].Node,this.viewGL=new a["a"]("orthographic"),this.viewGL.add(this.groupGL),this._glViewHelper=new l["a"](this.viewGL),this._nativeLinesShader=o["a"].createShader("ecgl.lines3D"),this._meshLinesShader=o["a"].createShader("ecgl.meshLines3D"),this._linesMeshes=[],this._currentStep=0},render:function(e,t,n){this.groupGL.removeAll(),this._glViewHelper.reset(e,n);var r=this._linesMeshes[0];r||(r=this._linesMeshes[0]=this._createLinesMesh(e)),this._linesMeshes.length=1,this.groupGL.add(r),this._updateLinesMesh(e,r,0,e.getData().count()),this.viewGL.setPostEffect(e.getModel("postEffect"),n)},incrementalPrepareRender:function(e,t,n){this.groupGL.removeAll(),this._glViewHelper.reset(e,n),this._currentStep=0,this.viewGL.setPostEffect(e.getModel("postEffect"),n)},incrementalRender:function(e,t,n,r){var i=this._linesMeshes[this._currentStep];i||(i=this._createLinesMesh(t),this._linesMeshes[this._currentStep]=i),this._updateLinesMesh(t,i,e.start,e.end),this.groupGL.add(i),r.getZr().refresh(),this._currentStep++},updateTransform:function(e,t,n){e.coordinateSystem.getRoamTransform&&this._glViewHelper.updateTransform(e,n)},_createLinesMesh:function(e){var t=new o["a"].Mesh({$ignorePicking:!0,material:new o["a"].Material({shader:o["a"].createShader("ecgl.lines3D"),transparent:!0,depthMask:!1,depthTest:!1}),geometry:new s["a"]({segmentScale:10,useNativeLine:!0,dynamic:!1}),mode:o["a"].Mesh.LINES,culling:!1});return t},_updateLinesMesh:function(e,t,n,r){var i=e.getData();t.material.blend="lighter"===e.get("blendMode")?o["a"].additiveBlend:null;var a=e.get("lineStyle.curveness")||0,s=e.get("polyline"),l=t.geometry,c=e.coordinateSystem,d=u["a"].firstNotNull(e.get("lineStyle.width"),1);d>1?(t.material.shader!==this._meshLinesShader&&t.material.attachShader(this._meshLinesShader),t.mode=o["a"].Mesh.TRIANGLES):(t.material.shader!==this._nativeLinesShader&&t.material.attachShader(this._nativeLinesShader),t.mode=o["a"].Mesh.LINES),n=n||0,r=r||i.count(),l.resetOffset();var f=0,h=0,p=[],m=[],v=[],g=[],y=[],_=.3,x=.7;function b(){m[0]=p[0]*x+g[0]*_-(p[1]-g[1])*a,m[1]=p[1]*x+g[1]*_-(g[0]-p[0])*a,v[0]=p[0]*_+g[0]*x-(p[1]-g[1])*a,v[1]=p[1]*_+g[1]*x-(g[0]-p[0])*a}if(s||0!==a)for(var w=n;w<r;w++)if(s){var A=e.getLineCoordsCount(w);f+=l.getPolylineVertexCount(A),h+=l.getPolylineTriangleCount(A)}else e.getLineCoords(w,y),this._glViewHelper.dataToPoint(c,y[0],p),this._glViewHelper.dataToPoint(c,y[1],g),b(),f+=l.getCubicCurveVertexCount(p,m,v,g),h+=l.getCubicCurveTriangleCount(p,m,v,g);else{var T=r-n;f+=T*l.getLineVertexCount(),h+=T*l.getLineVertexCount()}l.setVertexCount(f),l.setTriangleCount(h);var S=n,E=[];for(w=n;w<r;w++){o["a"].parseColor(i.getItemVisual(S,"color"),E);var C=u["a"].firstNotNull(i.getItemVisual(S,"opacity"),1);E[3]*=C;A=e.getLineCoords(w,y);for(var M=0;M<A;M++)this._glViewHelper.dataToPoint(c,y[M],y[M]);s?l.addPolyline(y,E,d,0,A):0!==a?(p=y[0],g=y[1],b(),l.addCubicCurve(p,m,v,g,E,d)):l.addPolyline(y,E,d,0,2),S++}},dispose:function(){this.groupGL.removeAll()},remove:function(){this.groupGL.removeAll()}})}])}))},"87a10":function(e,t,n){e.exports=n("0a4f")},"8d74":function(e,t,n){var r=n("4cef"),i=/^\s+/;function o(e){return e?e.slice(0,r(e)+1).replace(i,""):e}e.exports=o},9523:function(e,t,n){var r=n("a395");function i(e,t,n){return(t=r(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}e.exports=i,e.exports.__esModule=!0,e.exports["default"]=e.exports},9744:function(e,t,n){"use strict";var r=n("4588"),i=n("be13");e.exports=function(e){var t=String(i(this)),n="",o=r(e);if(o<0||o==1/0)throw RangeError("Count can't be negative");for(;o>0;(o>>>=1)&&(t+=t))1&o&&(n+=t);return n}},"9b42":function(e,t){function n(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],l=!0,u=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);l=!0);}catch(e){u=!0,i=e}finally{try{if(!l&&null!=n["return"]&&(a=n["return"](),Object(a)!==a))return}finally{if(u)throw i}}return s}}e.exports=n,e.exports.__esModule=!0,e.exports["default"]=e.exports},"9e69":function(e,t,n){var r=n("2b3e"),i=r.Symbol;e.exports=i},"9e6a":function(e,t,n){"use strict";var r=n("d233"),i=Object.prototype.hasOwnProperty,o=Array.isArray,a={allowDots:!1,allowPrototypes:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decoder:r.decode,delimiter:"&",depth:5,ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},s=function(e){return e.replace(/&#(\d+);/g,(function(e,t){return String.fromCharCode(parseInt(t,10))}))},l="utf8=%26%2310003%3B",u="utf8=%E2%9C%93",c=function(e,t){var n,c={},d=t.ignoreQueryPrefix?e.replace(/^\?/,""):e,f=t.parameterLimit===1/0?void 0:t.parameterLimit,h=d.split(t.delimiter,f),p=-1,m=t.charset;if(t.charsetSentinel)for(n=0;n<h.length;++n)0===h[n].indexOf("utf8=")&&(h[n]===u?m="utf-8":h[n]===l&&(m="iso-8859-1"),p=n,n=h.length);for(n=0;n<h.length;++n)if(n!==p){var v,g,y=h[n],_=y.indexOf("]="),x=-1===_?y.indexOf("="):_+1;-1===x?(v=t.decoder(y,a.decoder,m,"key"),g=t.strictNullHandling?null:""):(v=t.decoder(y.slice(0,x),a.decoder,m,"key"),g=t.decoder(y.slice(x+1),a.decoder,m,"value")),g&&t.interpretNumericEntities&&"iso-8859-1"===m&&(g=s(g)),g&&"string"===typeof g&&t.comma&&g.indexOf(",")>-1&&(g=g.split(",")),y.indexOf("[]=")>-1&&(g=o(g)?[g]:g),i.call(c,v)?c[v]=r.combine(c[v],g):c[v]=g}return c},d=function(e,t,n){for(var r=t,i=e.length-1;i>=0;--i){var o,a=e[i];if("[]"===a&&n.parseArrays)o=[].concat(r);else{o=n.plainObjects?Object.create(null):{};var s="["===a.charAt(0)&&"]"===a.charAt(a.length-1)?a.slice(1,-1):a,l=parseInt(s,10);n.parseArrays||""!==s?!isNaN(l)&&a!==s&&String(l)===s&&l>=0&&n.parseArrays&&l<=n.arrayLimit?(o=[],o[l]=r):o[s]=r:o={0:r}}r=o}return r},f=function(e,t,n){if(e){var r=n.allowDots?e.replace(/\.([^.[]+)/g,"[$1]"):e,o=/(\[[^[\]]*])/,a=/(\[[^[\]]*])/g,s=n.depth>0&&o.exec(r),l=s?r.slice(0,s.index):r,u=[];if(l){if(!n.plainObjects&&i.call(Object.prototype,l)&&!n.allowPrototypes)return;u.push(l)}var c=0;while(n.depth>0&&null!==(s=a.exec(r))&&c<n.depth){if(c+=1,!n.plainObjects&&i.call(Object.prototype,s[1].slice(1,-1))&&!n.allowPrototypes)return;u.push(s[1])}return s&&u.push("["+r.slice(s.index)+"]"),d(u,t,n)}},h=function(e){if(!e)return a;if(null!==e.decoder&&void 0!==e.decoder&&"function"!==typeof e.decoder)throw new TypeError("Decoder has to be a function.");if("undefined"!==typeof e.charset&&"utf-8"!==e.charset&&"iso-8859-1"!==e.charset)throw new Error("The charset option must be either utf-8, iso-8859-1, or undefined");var t="undefined"===typeof e.charset?a.charset:e.charset;return{allowDots:"undefined"===typeof e.allowDots?a.allowDots:!!e.allowDots,allowPrototypes:"boolean"===typeof e.allowPrototypes?e.allowPrototypes:a.allowPrototypes,arrayLimit:"number"===typeof e.arrayLimit?e.arrayLimit:a.arrayLimit,charset:t,charsetSentinel:"boolean"===typeof e.charsetSentinel?e.charsetSentinel:a.charsetSentinel,comma:"boolean"===typeof e.comma?e.comma:a.comma,decoder:"function"===typeof e.decoder?e.decoder:a.decoder,delimiter:"string"===typeof e.delimiter||r.isRegExp(e.delimiter)?e.delimiter:a.delimiter,depth:"number"===typeof e.depth||!1===e.depth?+e.depth:a.depth,ignoreQueryPrefix:!0===e.ignoreQueryPrefix,interpretNumericEntities:"boolean"===typeof e.interpretNumericEntities?e.interpretNumericEntities:a.interpretNumericEntities,parameterLimit:"number"===typeof e.parameterLimit?e.parameterLimit:a.parameterLimit,parseArrays:!1!==e.parseArrays,plainObjects:"boolean"===typeof e.plainObjects?e.plainObjects:a.plainObjects,strictNullHandling:"boolean"===typeof e.strictNullHandling?e.strictNullHandling:a.strictNullHandling}};e.exports=function(e,t){var n=h(t);if(""===e||null===e||"undefined"===typeof e)return n.plainObjects?Object.create(null):{};for(var i="string"===typeof e?c(e,n):e,o=n.plainObjects?Object.create(null):{},a=Object.keys(i),s=0;s<a.length;++s){var l=a[s],u=f(l,i[l],n);o=r.merge(o,u,n)}return r.compact(o)}},a395:function(e,t,n){var r=n("7037")["default"],i=n("e50d");function o(e){var t=i(e,"string");return"symbol"==r(t)?t:t+""}e.exports=o,e.exports.__esModule=!0,e.exports["default"]=e.exports},a7be:function(e,t,n){},b047:function(e,t,n){var r=n("1a8c"),i=n("408c"),o=n("b4b0"),a="Expected a function",s=Math.max,l=Math.min;function u(e,t,n){var u,c,d,f,h,p,m=0,v=!1,g=!1,y=!0;if("function"!=typeof e)throw new TypeError(a);function _(t){var n=u,r=c;return u=c=void 0,m=t,f=e.apply(r,n),f}function x(e){return m=e,h=setTimeout(A,t),v?_(e):f}function b(e){var n=e-p,r=e-m,i=t-n;return g?l(i,d-r):i}function w(e){var n=e-p,r=e-m;return void 0===p||n>=t||n<0||g&&r>=d}function A(){var e=i();if(w(e))return T(e);h=setTimeout(A,b(e))}function T(e){return h=void 0,y&&u?_(e):(u=c=void 0,f)}function S(){void 0!==h&&clearTimeout(h),m=0,u=p=c=h=void 0}function E(){return void 0===h?f:T(i())}function C(){var e=i(),n=w(e);if(u=arguments,c=this,p=e,n){if(void 0===h)return x(p);if(g)return clearTimeout(h),h=setTimeout(A,t),_(p)}return void 0===h&&(h=setTimeout(A,t)),f}return t=o(t)||0,r(n)&&(v=!!n.leading,g="maxWait"in n,d=g?s(o(n.maxWait)||0,t):d,y="trailing"in n?!!n.trailing:y),C.cancel=S,C.flush=E,C}e.exports=u},b311:function(e,t,n){
/*!
 * clipboard.js v2.0.4
 * https://zenorocha.github.io/clipboard.js
 * 
 * Licensed MIT © Zeno Rocha
 */
(function(t,n){e.exports=n()})(0,(function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";var r="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(1),a=d(o),s=n(3),l=d(s),u=n(4),c=d(u);function d(e){return e&&e.__esModule?e:{default:e}}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function p(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var m=function(e){function t(e,n){f(this,t);var r=h(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return r.resolveOptions(n),r.listenClick(e),r}return p(t,e),i(t,[{key:"resolveOptions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.action="function"===typeof e.action?e.action:this.defaultAction,this.target="function"===typeof e.target?e.target:this.defaultTarget,this.text="function"===typeof e.text?e.text:this.defaultText,this.container="object"===r(e.container)?e.container:document.body}},{key:"listenClick",value:function(e){var t=this;this.listener=(0,c.default)(e,"click",(function(e){return t.onClick(e)}))}},{key:"onClick",value:function(e){var t=e.delegateTarget||e.currentTarget;this.clipboardAction&&(this.clipboardAction=null),this.clipboardAction=new a.default({action:this.action(t),target:this.target(t),text:this.text(t),container:this.container,trigger:t,emitter:this})}},{key:"defaultAction",value:function(e){return v("action",e)}},{key:"defaultTarget",value:function(e){var t=v("target",e);if(t)return document.querySelector(t)}},{key:"defaultText",value:function(e){return v("text",e)}},{key:"destroy",value:function(){this.listener.destroy(),this.clipboardAction&&(this.clipboardAction.destroy(),this.clipboardAction=null)}}],[{key:"isSupported",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["copy","cut"],t="string"===typeof e?[e]:e,n=!!document.queryCommandSupported;return t.forEach((function(e){n=n&&!!document.queryCommandSupported(e)})),n}}]),t}(l.default);function v(e,t){var n="data-clipboard-"+e;if(t.hasAttribute(n))return t.getAttribute(n)}e.exports=m},function(e,t,n){"use strict";var r="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(2),a=s(o);function s(e){return e&&e.__esModule?e:{default:e}}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var u=function(){function e(t){l(this,e),this.resolveOptions(t),this.initSelection()}return i(e,[{key:"resolveOptions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.action=e.action,this.container=e.container,this.emitter=e.emitter,this.target=e.target,this.text=e.text,this.trigger=e.trigger,this.selectedText=""}},{key:"initSelection",value:function(){this.text?this.selectFake():this.target&&this.selectTarget()}},{key:"selectFake",value:function(){var e=this,t="rtl"==document.documentElement.getAttribute("dir");this.removeFake(),this.fakeHandlerCallback=function(){return e.removeFake()},this.fakeHandler=this.container.addEventListener("click",this.fakeHandlerCallback)||!0,this.fakeElem=document.createElement("textarea"),this.fakeElem.style.fontSize="12pt",this.fakeElem.style.border="0",this.fakeElem.style.padding="0",this.fakeElem.style.margin="0",this.fakeElem.style.position="absolute",this.fakeElem.style[t?"right":"left"]="-9999px";var n=window.pageYOffset||document.documentElement.scrollTop;this.fakeElem.style.top=n+"px",this.fakeElem.setAttribute("readonly",""),this.fakeElem.value=this.text,this.container.appendChild(this.fakeElem),this.selectedText=(0,a.default)(this.fakeElem),this.copyText()}},{key:"removeFake",value:function(){this.fakeHandler&&(this.container.removeEventListener("click",this.fakeHandlerCallback),this.fakeHandler=null,this.fakeHandlerCallback=null),this.fakeElem&&(this.container.removeChild(this.fakeElem),this.fakeElem=null)}},{key:"selectTarget",value:function(){this.selectedText=(0,a.default)(this.target),this.copyText()}},{key:"copyText",value:function(){var e=void 0;try{e=document.execCommand(this.action)}catch(t){e=!1}this.handleResult(e)}},{key:"handleResult",value:function(e){this.emitter.emit(e?"success":"error",{action:this.action,text:this.selectedText,trigger:this.trigger,clearSelection:this.clearSelection.bind(this)})}},{key:"clearSelection",value:function(){this.trigger&&this.trigger.focus(),window.getSelection().removeAllRanges()}},{key:"destroy",value:function(){this.removeFake()}},{key:"action",set:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"copy";if(this._action=e,"copy"!==this._action&&"cut"!==this._action)throw new Error('Invalid "action" value, use either "copy" or "cut"')},get:function(){return this._action}},{key:"target",set:function(e){if(void 0!==e){if(!e||"object"!==("undefined"===typeof e?"undefined":r(e))||1!==e.nodeType)throw new Error('Invalid "target" value, use a valid Element');if("copy"===this.action&&e.hasAttribute("disabled"))throw new Error('Invalid "target" attribute. Please use "readonly" instead of "disabled" attribute');if("cut"===this.action&&(e.hasAttribute("readonly")||e.hasAttribute("disabled")))throw new Error('Invalid "target" attribute. You can\'t cut text from elements with "readonly" or "disabled" attributes');this._target=e}},get:function(){return this._target}}]),e}();e.exports=u},function(e,t){function n(e){var t;if("SELECT"===e.nodeName)e.focus(),t=e.value;else if("INPUT"===e.nodeName||"TEXTAREA"===e.nodeName){var n=e.hasAttribute("readonly");n||e.setAttribute("readonly",""),e.select(),e.setSelectionRange(0,e.value.length),n||e.removeAttribute("readonly"),t=e.value}else{e.hasAttribute("contenteditable")&&e.focus();var r=window.getSelection(),i=document.createRange();i.selectNodeContents(e),r.removeAllRanges(),r.addRange(i),t=r.toString()}return t}e.exports=n},function(e,t){function n(){}n.prototype={on:function(e,t,n){var r=this.e||(this.e={});return(r[e]||(r[e]=[])).push({fn:t,ctx:n}),this},once:function(e,t,n){var r=this;function i(){r.off(e,i),t.apply(n,arguments)}return i._=t,this.on(e,i,n)},emit:function(e){var t=[].slice.call(arguments,1),n=((this.e||(this.e={}))[e]||[]).slice(),r=0,i=n.length;for(r;r<i;r++)n[r].fn.apply(n[r].ctx,t);return this},off:function(e,t){var n=this.e||(this.e={}),r=n[e],i=[];if(r&&t)for(var o=0,a=r.length;o<a;o++)r[o].fn!==t&&r[o].fn._!==t&&i.push(r[o]);return i.length?n[e]=i:delete n[e],this}},e.exports=n},function(e,t,n){var r=n(5),i=n(6);function o(e,t,n){if(!e&&!t&&!n)throw new Error("Missing required arguments");if(!r.string(t))throw new TypeError("Second argument must be a String");if(!r.fn(n))throw new TypeError("Third argument must be a Function");if(r.node(e))return a(e,t,n);if(r.nodeList(e))return s(e,t,n);if(r.string(e))return l(e,t,n);throw new TypeError("First argument must be a String, HTMLElement, HTMLCollection, or NodeList")}function a(e,t,n){return e.addEventListener(t,n),{destroy:function(){e.removeEventListener(t,n)}}}function s(e,t,n){return Array.prototype.forEach.call(e,(function(e){e.addEventListener(t,n)})),{destroy:function(){Array.prototype.forEach.call(e,(function(e){e.removeEventListener(t,n)}))}}}function l(e,t,n){return i(document.body,e,t,n)}e.exports=o},function(e,t){t.node=function(e){return void 0!==e&&e instanceof HTMLElement&&1===e.nodeType},t.nodeList=function(e){var n=Object.prototype.toString.call(e);return void 0!==e&&("[object NodeList]"===n||"[object HTMLCollection]"===n)&&"length"in e&&(0===e.length||t.node(e[0]))},t.string=function(e){return"string"===typeof e||e instanceof String},t.fn=function(e){var t=Object.prototype.toString.call(e);return"[object Function]"===t}},function(e,t,n){var r=n(7);function i(e,t,n,r,i){var o=a.apply(this,arguments);return e.addEventListener(n,o,i),{destroy:function(){e.removeEventListener(n,o,i)}}}function o(e,t,n,r,o){return"function"===typeof e.addEventListener?i.apply(null,arguments):"function"===typeof n?i.bind(null,document).apply(null,arguments):("string"===typeof e&&(e=document.querySelectorAll(e)),Array.prototype.map.call(e,(function(e){return i(e,t,n,r,o)})))}function a(e,t,n,i){return function(n){n.delegateTarget=r(n.target,t),n.delegateTarget&&i.call(e,n)}}e.exports=o},function(e,t){var n=9;if("undefined"!==typeof Element&&!Element.prototype.matches){var r=Element.prototype;r.matches=r.matchesSelector||r.mozMatchesSelector||r.msMatchesSelector||r.oMatchesSelector||r.webkitMatchesSelector}function i(e,t){while(e&&e.nodeType!==n){if("function"===typeof e.matches&&e.matches(t))return e;e=e.parentNode}}e.exports=i}])}))},b313:function(e,t,n){"use strict";var r=String.prototype.replace,i=/%20/g,o=n("d233"),a={RFC1738:"RFC1738",RFC3986:"RFC3986"};e.exports=o.assign({default:a.RFC3986,formatters:{RFC1738:function(e){return r.call(e,i,"+")},RFC3986:function(e){return String(e)}}},a)},b4b0:function(e,t,n){var r=n("8d74"),i=n("1a8c"),o=n("ffd6"),a=NaN,s=/^[-+]0x[0-9a-f]+$/i,l=/^0b[01]+$/i,u=/^0o[0-7]+$/i,c=parseInt;function d(e){if("number"==typeof e)return e;if(o(e))return a;if(i(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=i(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=r(e);var n=l.test(e);return n||u.test(e)?c(e.slice(2),n?2:8):s.test(e)?a:+e}e.exports=d},b54a:function(e,t,n){"use strict";n("386b")("link",(function(e){return function(t){return e(this,"a","href",t)}}))},b866:function(e,t,n){},bcdf:function(e,t){function n(){}e.exports=n},c03d7:function(e,t,n){var r=n("3eba");r.extendChartView({type:"wordCloud",render:function(e,t,n){var i=this.group;i.removeAll();var o=e.getData(),a=e.get("gridSize");e.layoutInstance.ondraw=function(e,t,n,s){var l=o.getItemModel(n),u=l.getModel("textStyle.normal"),c=l.getModel("textStyle.emphasis"),d=new r.graphic.Text({style:r.graphic.setTextStyle({},u,{x:s.info.fillTextOffsetX,y:s.info.fillTextOffsetY+.5*t,text:e,textBaseline:"middle",textFill:o.getItemVisual(n,"color"),fontSize:t}),scale:[1/s.info.mu,1/s.info.mu],position:[(s.gx+s.info.gw/2)*a,(s.gy+s.info.gh/2)*a],rotation:s.rot});i.add(d),o.setItemGraphicEl(n,d),r.graphic.setHoverStyle(d,r.graphic.setTextStyle({},c,null,{forMerge:!0},!0))},this._model=e},remove:function(){this.group.removeAll(),this._model.layoutInstance.dispose()},dispose:function(){this._model.layoutInstance.dispose()}})},c135:function(e,t){function n(e){if(Array.isArray(e))return e}e.exports=n,e.exports.__esModule=!0,e.exports["default"]=e.exports},c240:function(e,t){function n(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}e.exports=n,e.exports.__esModule=!0,e.exports["default"]=e.exports},cd40:function(e,t,n){var r;(function(t){e.exports=t()})((function(){return function e(t,n,i){function o(s,l){if(!n[s]){if(!t[s]){var u="function"==typeof r&&r;if(!l&&u)return r(s,!0);if(a)return a(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var d=n[s]={exports:{}};t[s][0].call(d.exports,(function(e){var n=t[s][1][e];return o(n||e)}),d,d.exports,e,t,n,i)}return n[s].exports}for(var a="function"==typeof r&&r,s=0;s<i.length;s++)o(i[s]);return o}({1:[function(e,t,n){function r(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function i(e){return"function"===typeof e}function o(e){return"number"===typeof e}function a(e){return"object"===typeof e&&null!==e}function s(e){return void 0===e}t.exports=r,r.EventEmitter=r,r.prototype._events=void 0,r.prototype._maxListeners=void 0,r.defaultMaxListeners=10,r.prototype.setMaxListeners=function(e){if(!o(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},r.prototype.emit=function(e){var t,n,r,o,l,u;if(this._events||(this._events={}),"error"===e&&(!this._events.error||a(this._events.error)&&!this._events.error.length)){if(t=arguments[1],t instanceof Error)throw t;var c=new Error('Uncaught, unspecified "error" event. ('+t+")");throw c.context=t,c}if(n=this._events[e],s(n))return!1;if(i(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:o=Array.prototype.slice.call(arguments,1),n.apply(this,o)}else if(a(n))for(o=Array.prototype.slice.call(arguments,1),u=n.slice(),r=u.length,l=0;l<r;l++)u[l].apply(this,o);return!0},r.prototype.addListener=function(e,t){var n;if(!i(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,i(t.listener)?t.listener:t),this._events[e]?a(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,a(this._events[e])&&!this._events[e].warned&&(n=s(this._maxListeners)?r.defaultMaxListeners:this._maxListeners,n&&n>0&&this._events[e].length>n&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"===typeof console.trace&&console.trace())),this},r.prototype.on=r.prototype.addListener,r.prototype.once=function(e,t){if(!i(t))throw TypeError("listener must be a function");var n=!1;function r(){this.removeListener(e,r),n||(n=!0,t.apply(this,arguments))}return r.listener=t,this.on(e,r),this},r.prototype.removeListener=function(e,t){var n,r,o,s;if(!i(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(n=this._events[e],o=n.length,r=-1,n===t||i(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(a(n)){for(s=o;s-- >0;)if(n[s]===t||n[s].listener&&n[s].listener===t){r=s;break}if(r<0)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(r,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},r.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[e],i(n))this.removeListener(e,n);else if(n)while(n.length)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},r.prototype.listeners=function(e){var t;return t=this._events&&this._events[e]?i(this._events[e])?[this._events[e]]:this._events[e].slice():[],t},r.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(i(t))return 1;if(t)return t.length}return 0},r.listenerCount=function(e,t){return e.listenerCount(t)}},{}],2:[function(e,t,n){var r,i,o,a,s;s=navigator.userAgent.toLowerCase(),a=navigator.platform.toLowerCase(),r=s.match(/(opera|ie|firefox|chrome|version)[\s\/:]([\w\d\.]+)?.*?(safari|version[\s\/:]([\w\d\.]+)|$)/)||[null,"unknown",0],o="ie"===r[1]&&document.documentMode,i={name:"version"===r[1]?r[3]:r[1],version:o||parseFloat("opera"===r[1]&&r[4]?r[4]:r[2]),platform:{name:s.match(/ip(?:ad|od|hone)/)?"ios":(s.match(/(?:webos|android)/)||a.match(/mac|win|linux/)||["other"])[0]}},i[i.name]=!0,i[i.name+parseInt(i.version,10)]=!0,i.platform[i.platform.name]=!0,t.exports=i},{}],3:[function(e,t,n){var r,i,o,a=function(e,t){for(var n in t)s.call(t,n)&&(e[n]=t[n]);function r(){this.constructor=e}return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e},s={}.hasOwnProperty,l=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1},u=[].slice;r=e("events").EventEmitter,o=e("./browser.coffee"),i=function(e){var t,n;function r(e){var n,r,i;for(r in this.running=!1,this.options={},this.frames=[],this.freeWorkers=[],this.activeWorkers=[],this.setOptions(e),t)i=t[r],null==(n=this.options)[r]&&(n[r]=i)}return a(r,e),t={workerScript:"gif.worker.js",workers:2,repeat:0,background:"#fff",quality:10,width:null,height:null,transparent:null,debug:!1,dither:!1},n={delay:500,copy:!1},r.prototype.setOption=function(e,t){if(this.options[e]=t,null!=this._canvas&&("width"===e||"height"===e))return this._canvas[e]=t},r.prototype.setOptions=function(e){var t,n,r;for(t in n=[],e)s.call(e,t)&&(r=e[t],n.push(this.setOption(t,r)));return n},r.prototype.addFrame=function(e,t){var r,i;for(i in null==t&&(t={}),r={},r.transparent=this.options.transparent,n)r[i]=t[i]||n[i];if(null==this.options.width&&this.setOption("width",e.width),null==this.options.height&&this.setOption("height",e.height),"undefined"!==typeof ImageData&&null!==ImageData&&e instanceof ImageData)r.data=e.data;else if("undefined"!==typeof CanvasRenderingContext2D&&null!==CanvasRenderingContext2D&&e instanceof CanvasRenderingContext2D||"undefined"!==typeof WebGLRenderingContext&&null!==WebGLRenderingContext&&e instanceof WebGLRenderingContext)t.copy?r.data=this.getContextData(e):r.context=e;else{if(null==e.childNodes)throw new Error("Invalid image");t.copy?r.data=this.getImageData(e):r.image=e}return this.frames.push(r)},r.prototype.render=function(){var e,t,n;if(this.running)throw new Error("Already running");if(null==this.options.width||null==this.options.height)throw new Error("Width and height must be set prior to rendering");if(this.running=!0,this.nextFrame=0,this.finishedFrames=0,this.imageParts=function(){var e,t,n;for(n=[],e=0,t=this.frames.length;0<=t?e<t:e>t;0<=t?++e:--e)n.push(null);return n}.call(this),t=this.spawnWorkers(),!0===this.options.globalPalette)this.renderNextFrame();else for(e=0,n=t;0<=n?e<n:e>n;0<=n?++e:--e)this.renderNextFrame();return this.emit("start"),this.emit("progress",0)},r.prototype.abort=function(){var e;while(1){if(e=this.activeWorkers.shift(),null==e)break;this.log("killing active worker"),e.terminate()}return this.running=!1,this.emit("abort")},r.prototype.spawnWorkers=function(){var e,t,n;return e=Math.min(this.options.workers,this.frames.length),function(){n=[];for(var r=t=this.freeWorkers.length;t<=e?r<e:r>e;t<=e?r++:r--)n.push(r);return n}.apply(this).forEach(function(e){return function(t){var n;return e.log("spawning worker "+t),n=new Worker(e.options.workerScript),n.onmessage=function(t){return e.activeWorkers.splice(e.activeWorkers.indexOf(n),1),e.freeWorkers.push(n),e.frameFinished(t.data)},e.freeWorkers.push(n)}}(this)),e},r.prototype.frameFinished=function(e){var t,n;if(this.log("frame "+e.index+" finished - "+this.activeWorkers.length+" active"),this.finishedFrames++,this.emit("progress",this.finishedFrames/this.frames.length),this.imageParts[e.index]=e,!0===this.options.globalPalette&&(this.options.globalPalette=e.globalPalette,this.log("global palette analyzed"),this.frames.length>2))for(t=1,n=this.freeWorkers.length;1<=n?t<n:t>n;1<=n?++t:--t)this.renderNextFrame();return l.call(this.imageParts,null)>=0?this.renderNextFrame():this.finishRendering()},r.prototype.finishRendering=function(){var e,t,n,r,i,o,a,s,l,u,c,d,f,h,p,m;for(s=0,h=this.imageParts,i=0,l=h.length;i<l;i++)t=h[i],s+=(t.data.length-1)*t.pageSize+t.cursor;for(s+=t.pageSize-t.cursor,this.log("rendering finished - filesize "+Math.round(s/1e3)+"kb"),e=new Uint8Array(s),d=0,p=this.imageParts,o=0,u=p.length;o<u;o++)for(t=p[o],m=t.data,n=a=0,c=m.length;a<c;n=++a)f=m[n],e.set(f,d),n===t.data.length-1?d+=t.cursor:d+=t.pageSize;return r=new Blob([e],{type:"image/gif"}),this.emit("finished",r,e)},r.prototype.renderNextFrame=function(){var e,t,n;if(0===this.freeWorkers.length)throw new Error("No free workers");if(!(this.nextFrame>=this.frames.length))return e=this.frames[this.nextFrame++],n=this.freeWorkers.shift(),t=this.getTask(e),this.log("starting frame "+(t.index+1)+" of "+this.frames.length),this.activeWorkers.push(n),n.postMessage(t)},r.prototype.getContextData=function(e){return e.getImageData(0,0,this.options.width,this.options.height).data},r.prototype.getImageData=function(e){var t;return null==this._canvas&&(this._canvas=document.createElement("canvas"),this._canvas.width=this.options.width,this._canvas.height=this.options.height),t=this._canvas.getContext("2d"),t.setFill=this.options.background,t.fillRect(0,0,this.options.width,this.options.height),t.drawImage(e,0,0),this.getContextData(t)},r.prototype.getTask=function(e){var t,n;if(t=this.frames.indexOf(e),n={index:t,last:t===this.frames.length-1,delay:e.delay,transparent:e.transparent,width:this.options.width,height:this.options.height,quality:this.options.quality,dither:this.options.dither,globalPalette:this.options.globalPalette,repeat:this.options.repeat,canTransfer:"chrome"===o.name},null!=e.data)n.data=e.data;else if(null!=e.context)n.data=this.getContextData(e.context);else{if(null==e.image)throw new Error("Invalid frame");n.data=this.getImageData(e.image)}return n},r.prototype.log=function(){var e;if(e=1<=arguments.length?u.call(arguments,0):[],this.options.debug)return console.log.apply(console,e)},r}(r),t.exports=i},{"./browser.coffee":2,events:1}]},{},[3])(3)}))},cd9d:function(e,t){function n(e){return e}e.exports=n},ced0:function(e,t,n){(function(e){e(n("56b3"))})((function(e){"use strict";e.defineMode("yaml",(function(){var e=["true","false","on","off","yes","no"],t=new RegExp("\\b(("+e.join(")|(")+"))$","i");return{token:function(e,n){var r=e.peek(),i=n.escaped;if(n.escaped=!1,"#"==r&&(0==e.pos||/\s/.test(e.string.charAt(e.pos-1))))return e.skipToEnd(),"comment";if(e.match(/^('([^']|\\.)*'?|"([^"]|\\.)*"?)/))return"string";if(n.literal&&e.indentation()>n.keyCol)return e.skipToEnd(),"string";if(n.literal&&(n.literal=!1),e.sol()){if(n.keyCol=0,n.pair=!1,n.pairStart=!1,e.match(/---/))return"def";if(e.match(/\.\.\./))return"def";if(e.match(/\s*-\s+/))return"meta"}if(e.match(/^(\{|\}|\[|\])/))return"{"==r?n.inlinePairs++:"}"==r?n.inlinePairs--:"["==r?n.inlineList++:n.inlineList--,"meta";if(n.inlineList>0&&!i&&","==r)return e.next(),"meta";if(n.inlinePairs>0&&!i&&","==r)return n.keyCol=0,n.pair=!1,n.pairStart=!1,e.next(),"meta";if(n.pairStart){if(e.match(/^\s*(\||\>)\s*/))return n.literal=!0,"meta";if(e.match(/^\s*(\&|\*)[a-z0-9\._-]+\b/i))return"variable-2";if(0==n.inlinePairs&&e.match(/^\s*-?[0-9\.\,]+\s?$/))return"number";if(n.inlinePairs>0&&e.match(/^\s*-?[0-9\.\,]+\s?(?=(,|}))/))return"number";if(e.match(t))return"keyword"}return!n.pair&&e.match(/^\s*(?:[,\[\]{}&*!|>'"%@`][^\s'":]|[^,\[\]{}#&*!|>'"%@`])[^#]*?(?=\s*:($|\s))/)?(n.pair=!0,n.keyCol=e.indentation(),"atom"):n.pair&&e.match(/^:\s*/)?(n.pairStart=!0,"meta"):(n.pairStart=!1,n.escaped="\\"==r,e.next(),null)},startState:function(){return{pair:!1,pairStart:!1,keyCol:0,inlinePairs:0,inlineList:0,literal:!1,escaped:!1}},lineComment:"#",fold:"indent"}})),e.defineMIME("text/x-yaml","yaml"),e.defineMIME("text/yaml","yaml")}))},d233:function(e,t,n){"use strict";var r=Object.prototype.hasOwnProperty,i=Array.isArray,o=function(){for(var e=[],t=0;t<256;++t)e.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return e}(),a=function(e){while(e.length>1){var t=e.pop(),n=t.obj[t.prop];if(i(n)){for(var r=[],o=0;o<n.length;++o)"undefined"!==typeof n[o]&&r.push(n[o]);t.obj[t.prop]=r}}},s=function(e,t){for(var n=t&&t.plainObjects?Object.create(null):{},r=0;r<e.length;++r)"undefined"!==typeof e[r]&&(n[r]=e[r]);return n},l=function e(t,n,o){if(!n)return t;if("object"!==typeof n){if(i(t))t.push(n);else{if(!t||"object"!==typeof t)return[t,n];(o&&(o.plainObjects||o.allowPrototypes)||!r.call(Object.prototype,n))&&(t[n]=!0)}return t}if(!t||"object"!==typeof t)return[t].concat(n);var a=t;return i(t)&&!i(n)&&(a=s(t,o)),i(t)&&i(n)?(n.forEach((function(n,i){if(r.call(t,i)){var a=t[i];a&&"object"===typeof a&&n&&"object"===typeof n?t[i]=e(a,n,o):t.push(n)}else t[i]=n})),t):Object.keys(n).reduce((function(t,i){var a=n[i];return r.call(t,i)?t[i]=e(t[i],a,o):t[i]=a,t}),a)},u=function(e,t){return Object.keys(t).reduce((function(e,n){return e[n]=t[n],e}),e)},c=function(e,t,n){var r=e.replace(/\+/g," ");if("iso-8859-1"===n)return r.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(r)}catch(i){return r}},d=function(e,t,n){if(0===e.length)return e;var r=e;if("symbol"===typeof e?r=Symbol.prototype.toString.call(e):"string"!==typeof e&&(r=String(e)),"iso-8859-1"===n)return escape(r).replace(/%u[0-9a-f]{4}/gi,(function(e){return"%26%23"+parseInt(e.slice(2),16)+"%3B"}));for(var i="",a=0;a<r.length;++a){var s=r.charCodeAt(a);45===s||46===s||95===s||126===s||s>=48&&s<=57||s>=65&&s<=90||s>=97&&s<=122?i+=r.charAt(a):s<128?i+=o[s]:s<2048?i+=o[192|s>>6]+o[128|63&s]:s<55296||s>=57344?i+=o[224|s>>12]+o[128|s>>6&63]+o[128|63&s]:(a+=1,s=65536+((1023&s)<<10|1023&r.charCodeAt(a)),i+=o[240|s>>18]+o[128|s>>12&63]+o[128|s>>6&63]+o[128|63&s])}return i},f=function(e){for(var t=[{obj:{o:e},prop:"o"}],n=[],r=0;r<t.length;++r)for(var i=t[r],o=i.obj[i.prop],s=Object.keys(o),l=0;l<s.length;++l){var u=s[l],c=o[u];"object"===typeof c&&null!==c&&-1===n.indexOf(c)&&(t.push({obj:o,prop:u}),n.push(c))}return a(t),e},h=function(e){return"[object RegExp]"===Object.prototype.toString.call(e)},p=function(e){return!(!e||"object"!==typeof e)&&!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))},m=function(e,t){return[].concat(e,t)};e.exports={arrayToObject:s,assign:u,combine:m,compact:f,decode:c,encode:d,isBuffer:p,isRegExp:h,merge:l}},df0f:function(e,t,n){"use strict";n.r(t);var r=function(e,t){var n=document.createElement("_"),r=n.appendChild(document.createElement("_")),i=n.appendChild(document.createElement("_")),o=r.appendChild(document.createElement("_")),a=void 0,s=void 0;return r.style.cssText=n.style.cssText="height:100%;left:0;opacity:0;overflow:hidden;pointer-events:none;position:absolute;top:0;transition:0s;width:100%;z-index:-1",o.style.cssText=i.style.cssText="display:block;height:100%;transition:0s;width:100%",o.style.width=o.style.height="200%",e.appendChild(n),l(),c;function l(){u();var o=e.offsetWidth,c=e.offsetHeight;o===a&&c===s||(a=o,s=c,i.style.width=2*o+"px",i.style.height=2*c+"px",n.scrollLeft=n.scrollWidth,n.scrollTop=n.scrollHeight,r.scrollLeft=r.scrollWidth,r.scrollTop=r.scrollHeight,t({width:o,height:c})),r.addEventListener("scroll",l),n.addEventListener("scroll",l)}function u(){r.removeEventListener("scroll",l),n.removeEventListener("scroll",l)}function c(){u(),e.removeChild(n)}};t["default"]=r},e0ef:function(e,t,n){var r=n("4b17"),i="Expected a function";function o(e,t){var n;if("function"!=typeof t)throw new TypeError(i);return e=r(e),function(){return--e>0&&(n=t.apply(this,arguments)),e<=1&&(t=void 0),n}}e.exports=o},e50d:function(e,t,n){var r=n("7037")["default"];function i(e,t){if("object"!=r(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=r(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}e.exports=i,e.exports.__esModule=!0,e.exports["default"]=e.exports},ffd6:function(e,t,n){var r=n("3729"),i=n("1310"),o="[object Symbol]";function a(e){return"symbol"==typeof e||i(e)&&r(e)==o}e.exports=a}}]);