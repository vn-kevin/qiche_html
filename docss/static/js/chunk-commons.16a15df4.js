(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-commons"],{"27e2":function(e,t,r){"use strict";r("eb46")},"4f59":function(e,t,r){"use strict";var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("span",[r("el-button",{staticClass:"filter-item",attrs:{size:"mini",type:"success",icon:"el-icon-search"},on:{click:e.crud.toQuery}},[e._v("搜索")]),e._v(" "),e.crud.optShow.reset?r("el-button",{staticClass:"filter-item",attrs:{size:"mini",type:"warning",icon:"el-icon-refresh-left"},on:{click:function(t){return e.crud.resetQuery()}}},[e._v("重置")]):e._e()],1)},n=[],i=r("c6db"),o={mixins:[Object(i["a"])()],props:{itemClass:{type:String,required:!1,default:""}}},d=o,u=r("2877"),s=Object(u["a"])(d,a,n,!1,null,null,null);t["a"]=s.exports},"55b8":function(e,t,r){"use strict";var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-pagination",{staticStyle:{"margin-top":"8px"},attrs:{"page-size":e.page.size,total:e.page.total,"current-page":e.page.page,layout:"total, prev, pager, next, sizes"},on:{"update:pageSize":function(t){return e.$set(e.page,"size",t)},"update:page-size":function(t){return e.$set(e.page,"size",t)},"update:currentPage":function(t){return e.$set(e.page,"page",t)},"update:current-page":function(t){return e.$set(e.page,"page",t)},"size-change":function(t){return e.crud.sizeChangeHandler(t)},"current-change":e.crud.pageChangeHandler}})},n=[],i=r("c6db"),o={mixins:[Object(i["e"])()]},d=o,u=(r("27e2"),r("2877")),s=Object(u["a"])(d,a,n,!1,null,"2a14b1ac",null);t["a"]=s.exports},c6db:function(e,t,r){"use strict";r.d(t,"f",(function(){return l})),r.d(t,"d",(function(){return h})),r.d(t,"c",(function(){return S})),r.d(t,"e",(function(){return g})),r.d(t,"a",(function(){return m}));r("5df3"),r("4f7f"),r("0d6d"),r("7514");var a=r("7618"),n=(r("55dd"),r("456d"),r("ac6a"),r("db72")),i=r("7e1e"),o=r("ed08"),d=r("2b0e");function u(e){var t={tag:"default",idField:"id",title:"",url:"",data:[],selections:[],query:{},params:{},form:{},defaultForm:function(){},sort:["create_time,desc"],time:50,crudMethod:{add:function(e){},del:function(e){},edit:function(e){},get:function(e){}},optShow:{add:!0,edit:!0,del:!0,download:!0,reset:!0},props:{},queryOnPresenterCreated:!0,debug:!1};e=c(t,e);var r=Object(n["a"])(Object(n["a"])({},e),{},{dataStatus:{},status:{add:u.STATUS.NORMAL,edit:u.STATUS.NORMAL,get cu(){if(this.add===u.STATUS.NORMAL&&this.edit===u.STATUS.NORMAL)return u.STATUS.NORMAL;if(this.add===u.STATUS.PREPARED||this.edit===u.STATUS.PREPARED)return u.STATUS.PREPARED;if(this.add===u.STATUS.PROCESSING||this.edit===u.STATUS.PROCESSING)return u.STATUS.PROCESSING;throw new Error("wrong crud's cu status")},get title(){return this.add>u.STATUS.NORMAL?"新增".concat(l.title):this.edit>u.STATUS.NORMAL?"编辑".concat(l.title):l.title}},msg:{submit:"提交成功",add:"新增成功",edit:"编辑成功",del:"删除成功"},page:{page:0,size:10,total:0},totalNum:0,totalPrice:0,sumNowMoneyReward:0,sumIntegralReward:0,sumStaticReward:0,sumDynamicReward:0,sumTotalNowMoneyPrice:0,sumTotalPartakeIntegralPrice:0,loading:!1,downloadLoading:!1,delAllLoading:!1}),f={submitSuccessNotify:function(){l.notify(l.msg.submit,u.NOTIFICATION_TYPE.SUCCESS)},addSuccessNotify:function(){l.notify(l.msg.add,u.NOTIFICATION_TYPE.SUCCESS)},editSuccessNotify:function(){l.notify(l.msg.edit,u.NOTIFICATION_TYPE.SUCCESS)},delSuccessNotify:function(){l.notify(l.msg.del,u.NOTIFICATION_TYPE.SUCCESS)},toQuery:function(){l.page.page=1,l.refresh()},refresh:function(){if(s(l,u.HOOK.beforeRefresh))return new Promise((function(e,t){l.loading=!0,Object(i["b"])(l.url,l.getQueryParams()).then((function(t){var r=l.getTable();r&&r.lazy&&(r.store.states.treeData={},r.store.states.lazyTreeNodeMap={}),l.page.total=t.totalElements,l.data=t.content,l.totalNum=t.totalNum,l.totalPrice=t.totalPrice,l.sumNowMoneyReward=t.sumNowMoneyReward,l.sumIntegralReward=t.sumIntegralReward,l.sumStaticReward=t.sumStaticReward,l.sumDynamicReward=t.sumDynamicReward,l.sumTotalNowMoneyPrice=t.sumTotalNowMoneyPrice,l.sumTotalPartakeIntegralPrice=t.sumTotalPartakeIntegralPrice,l.resetDataStatus(),setTimeout((function(){l.loading=!1,s(l,u.HOOK.afterRefresh)}),l.time),e(t)})).catch((function(e){l.loading=!1,t(e)}))}))},toAdd:function(){l.resetForm(),s(l,u.HOOK.beforeToAdd,l.form)&&s(l,u.HOOK.beforeToCU,l.form)&&(l.status.add=u.STATUS.PREPARED,s(l,u.HOOK.afterToAdd,l.form),s(l,u.HOOK.afterToCU,l.form))},toEdit:function(e){l.resetForm(JSON.parse(JSON.stringify(e))),s(l,u.HOOK.beforeToEdit,l.form)&&s(l,u.HOOK.beforeToCU,l.form)&&(l.status.edit=u.STATUS.PREPARED,l.getDataStatus(l.getDataId(e)).edit=u.STATUS.PREPARED,s(l,u.HOOK.afterToEdit,l.form),s(l,u.HOOK.afterToCU,l.form))},toDelete:function(e){l.getDataStatus(l.getDataId(e)).delete=u.STATUS.PREPARED},cancelDelete:function(e){s(l,u.HOOK.beforeDeleteCancel,e)&&(l.getDataStatus(l.getDataId(e)).delete=u.STATUS.NORMAL,s(l,u.HOOK.afterDeleteCancel,e))},cancelCU:function(){var e=l.status.add,t=l.status.edit;if(e===u.STATUS.PREPARED){if(!s(l,u.HOOK.beforeAddCancel,l.form))return;l.status.add=u.STATUS.NORMAL}if(t===u.STATUS.PREPARED){if(!s(l,u.HOOK.beforeEditCancel,l.form))return;l.status.edit=u.STATUS.NORMAL,l.getDataStatus(l.getDataId(l.form)).edit=u.STATUS.NORMAL}l.resetForm(),e===u.STATUS.PREPARED&&s(l,u.HOOK.afterAddCancel,l.form),t===u.STATUS.PREPARED&&s(l,u.HOOK.afterEditCancel,l.form),l.findVM("form").$refs["form"]&&l.findVM("form").$refs["form"].clearValidate()},submitCU:function(){s(l,u.HOOK.beforeValidateCU)&&l.findVM("form").$refs["form"].validate((function(e){e&&s(l,u.HOOK.afterValidateCU)&&(l.status.add===u.STATUS.PREPARED?l.doAdd():l.status.edit===u.STATUS.PREPARED&&l.doEdit())}))},doAdd:function(){s(l,u.HOOK.beforeSubmit)&&(l.status.add=u.STATUS.PROCESSING,l.crudMethod.add(l.form).then((function(){l.status.add=u.STATUS.NORMAL,l.resetForm(),l.addSuccessNotify(),s(l,u.HOOK.afterSubmit),l.toQuery()})).catch((function(){l.status.add=u.STATUS.PREPARED,s(l,u.HOOK.afterAddError)})))},doEdit:function(){s(l,u.HOOK.beforeSubmit)&&(l.status.edit=u.STATUS.PROCESSING,l.crudMethod.edit(l.form).then((function(){l.status.edit=u.STATUS.NORMAL,l.getDataStatus(l.getDataId(l.form)).edit=u.STATUS.NORMAL,l.editSuccessNotify(),l.resetForm(),s(l,u.HOOK.afterSubmit),l.refresh()})).catch((function(){l.status.edit=u.STATUS.PREPARED,s(l,u.HOOK.afterEditError)})))},doDelete:function(e){var t,r=this,a=!1,n=[];if(e instanceof Array?(a=!0,e.forEach((function(e){n.push(r.getDataId(e))}))):(n.push(this.getDataId(e)),t=l.getDataStatus(this.getDataId(e))),s(l,u.HOOK.beforeDelete,e))return a||(t.delete=u.STATUS.PROCESSING),l.crudMethod.del(n).then((function(){a?l.delAllLoading=!1:t.delete=u.STATUS.PREPARED,l.dleChangePage(1),l.delSuccessNotify(),s(l,u.HOOK.afterDelete,e),l.refresh()})).catch((function(){a?l.delAllLoading=!1:t.delete=u.STATUS.PREPARED}))},doExport:function(){l.downloadLoading=!0,Object(i["a"])(l.url+"/download",l.getQueryParams()).then((function(e){Object(o["c"])(e,l.title+"数据","xlsx"),l.downloadLoading=!1})).catch((function(){l.downloadLoading=!1}))},getQueryParams:function(){return 0!==Object.keys(l.query).length&&Object.keys(l.query).forEach((function(e){null!==l.query[e]&&""!==l.query[e]||(l.query[e]=void 0)})),0!==Object.keys(l.params).length&&Object.keys(l.params).forEach((function(e){null!==l.params[e]&&""!==l.params[e]||(l.params[e]=void 0)})),Object(n["a"])(Object(n["a"])({page:l.page.page-1,size:l.page.size,sort:l.sort},l.query),l.params)},pageChangeHandler:function(e){l.page.page=e,l.refresh()},sizeChangeHandler:function(e){l.page.size=e,l.page.page=1,l.refresh()},dleChangePage:function(e){l.data.length===e&&1!==l.page.page&&(l.page.page-=1)},selectionChangeHandler:function(e){l.selections=e},resetQuery:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=JSON.parse(JSON.stringify(l.defaultQuery)),r=l.query;Object.keys(r).forEach((function(e){r[e]=t[e]})),this.params={},e&&l.toQuery()},resetForm:function(e){var t=e||("object"===Object(a["a"])(l.defaultForm)?JSON.parse(JSON.stringify(l.defaultForm)):l.defaultForm.apply(l.findVM("form"))),r=l.form;for(var n in t)r.hasOwnProperty(n)?r[n]=t[n]:d["default"].set(r,n,t[n]);l.findVM("form").$refs["form"]&&l.findVM("form").$refs["form"].clearValidate()},resetDataStatus:function(){var e={};function t(r){r.forEach((function(r){e[l.getDataId(r)]={delete:0,edit:0},r.children&&t(r.children)}))}t(l.data),l.dataStatus=e},getDataStatus:function(e){return l.dataStatus[e]},selectAllChange:function(e){e&&e.length===l.data.length?e.forEach((function(t){l.selectChange(e,t)})):l.findVM("presenter").$refs["table"].clearSelection()},selectChange:function(e,t){e.find((function(e){return e.id===t.id}))?t.children&&t.children.forEach((function(t){l.findVM("presenter").$refs["table"].toggleRowSelection(t,!0),e.push(t),t.children&&l.selectChange(e,t)})):l.toggleRowSelection(e,t)},toggleRowSelection:function(e,t){t.children&&t.children.forEach((function(t){l.findVM("presenter").$refs["table"].toggleRowSelection(t,!1),t.children&&l.toggleRowSelection(e,t)}))},findVM:function(e){return l.vms.find((function(t){return t&&t.type===e})).vm},notify:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:u.NOTIFICATION_TYPE.INFO;l.vms[0].vm.$notify({title:e,type:t,duration:2500})},updateProp:function(e,t){d["default"].set(l.props,e,t)},getDataId:function(e){return e[this.idField]},getTable:function(){return this.findVM("presenter").$refs.table},attchTable:function(){var e=this.getTable();this.updateProp("table",e);var t=this;e.$on("expand-change",(function(r,a){if(a){var n=e.store.states.lazyTreeNodeMap;r.children=n[l.getDataId(r)],r.children&&r.children.forEach((function(e){var r=l.getDataId(e);void 0===t.dataStatus[r]&&(t.dataStatus[r]={delete:0,edit:0})}))}}))}},l=Object.assign({},r);return d["default"].observable(l),Object.assign(l,f),Object.assign(l,{defaultQuery:JSON.parse(JSON.stringify(r.query)),vms:Array(4),registerVM:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,a={type:e,vm:t};r<0?this.vms.push(a):r<4?this.vms[r]=a:(this.vms.length=Math.max(this.vms.length,r),this.vms.splice(r,1,a))},unregisterVM:function(e,t){for(var r=this.vms.length-1;r>=0;r--)if(void 0!==this.vms[r]&&this.vms[r].type===e&&this.vms[r].vm===t){r<4?this.vms[r]=void 0:this.vms.splice(r,1);break}}}),Object.freeze(l),l}function s(e,t){e.debug;for(var r=e.tag?t+"$"+e.tag:null,a=!0,n=[e],i=2;i<arguments.length;++i)n.push(arguments[i]);var o=new Set;return e.vms.forEach((function(e){return e&&o.add(e.vm)})),o.forEach((function(e){e[t]&&(a=!1!==e[t].apply(e,n)&&a),r&&e[r]&&(a=!1!==e[r].apply(e,n)&&a)})),a}function c(e,t){var r=Object(n["a"])({},e);for(var a in e)t.hasOwnProperty(a)&&(r[a]=t[a]);return r}function f(e,t){if(t=t||e.$attrs["crud-tag"]||"default",e.$crud){var r=e.$crud[t];if(r)return r}return e.$parent?f(e.$parent,t):void 0}function l(e){function t(e){return{visible:function(t){return!e||!e[t]||e[t].visible}}}return{data:function(){return{crud:this.crud,columns:t()}},beforeCreate:function(){var t=this;this.$crud=this.$crud||{};var r=this.$options.cruds instanceof Function?this.$options.cruds():e;r instanceof Array||(r=[r]),r.forEach((function(e){t.$crud[e.tag],t.$crud[e.tag]=e,e.registerVM("presenter",t,0)})),this.crud=this.$crud["defalut"]||r[0]},methods:{parseTime:o["f"]},created:function(){for(var e in this.$crud)this.$crud[e].queryOnPresenterCreated&&this.$crud[e].toQuery()},destroyed:function(){for(var e in this.$crud)this.$crud[e].unregisterVM("presenter",this)},mounted:function(){if(void 0!==this.$refs.table){this.crud.attchTable();var e={};this.$refs.table.columns.forEach((function(t){t.property&&"default"===t.type&&(e[t.property]={label:t.label,visible:!0})})),this.columns=t(e),this.crud.updateProp("tableColumns",e)}}}}function h(){return{data:function(){return{crud:this.crud,query:this.crud.query}},beforeCreate:function(){this.crud=f(this),this.crud.registerVM("header",this,1)},destroyed:function(){this.crud.unregisterVM("header",this)}}}function g(){return{data:function(){return{crud:this.crud,page:this.crud.page}},beforeCreate:function(){this.crud=f(this),this.crud.registerVM("pagination",this,2)},destroyed:function(){this.crud.unregisterVM("pagination",this)}}}function S(e){return{data:function(){return{crud:this.crud,form:this.crud.form}},beforeCreate:function(){this.crud=f(this),this.crud.registerVM("form",this,3)},created:function(){this.crud.defaultForm=e,this.crud.resetForm()},destroyed:function(){this.crud.unregisterVM("form",this)}}}function m(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={type:void 0};return e=c(t,e),{data:function(){return{crud:this.crud}},beforeCreate:function(){this.crud=f(this),this.crud.registerVM(e.type,this)},destroyed:function(){this.crud.unregisterVM(e.type,this)}}}u.HOOK={beforeRefresh:"beforeCrudRefresh",afterRefresh:"afterCrudRefresh",beforeDelete:"beforeCrudDelete",afterDelete:"afterCrudDelete",beforeDeleteCancel:"beforeCrudDeleteCancel",afterDeleteCancel:"afterCrudDeleteCancel",beforeToAdd:"beforeCrudToAdd",afterToAdd:"afterCrudToAdd",beforeToEdit:"beforeCrudToEdit",afterToEdit:"afterCrudToEdit",beforeToCU:"beforeCrudToCU",afterToCU:"afterCrudToCU",beforeValidateCU:"beforeCrudValidateCU",afterValidateCU:"afterCrudValidateCU",beforeAddCancel:"beforeCrudAddCancel",afterAddCancel:"afterCrudAddCancel",beforeEditCancel:"beforeCrudEditCancel",afterEditCancel:"afterCrudEditCancel",beforeSubmit:"beforeCrudSubmitCU",afterSubmit:"afterCrudSubmitCU",afterAddError:"afterCrudAddError",afterEditError:"afterCrudEditError"},u.STATUS={NORMAL:0,PREPARED:1,PROCESSING:2},u.NOTIFICATION_TYPE={SUCCESS:"success",WARNING:"warning",INFO:"info",ERROR:"error"},t["b"]=u},eb46:function(e,t,r){}}]);